<!DOCTYPE html>
<html>
<head>
    <title>angular</title>

    <script type="text/javascript" src="/apps/2.0rc3/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                (function(window,document,undefined){"use strict";function minErr(module){return function(){var code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments,stringify=function(obj){return"function"==typeof obj?(""+obj).replace(/ \{[\s\S]*$/,""):obj===undefined?"undefined":"string"!=typeof obj?JSON.stringify(obj):obj},message,i;for(message=prefix+template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1),arg;return templateArgs.length>index+2?(arg=templateArgs[index+2],"function"==typeof arg?(""+arg).replace(/ ?\{[\s\S]*$/,""):arg===undefined?"undefined":"string"!=typeof arg?toJson(arg):arg):match}),message=message+"\nhttp://errors.angularjs.org/1.2.18/"+(module?module+"/":"")+code,i=2;arguments.length>i;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(stringify(arguments[i]));return Error(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return 1===obj.nodeType&&length?!0:isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj}function forEach(obj,iterator,context){var key;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key);else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context);else if(isArrayLike(obj))for(key=0;obj.length>key;key++)iterator.call(context,obj[key],key);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);return obj}function sortedKeys(obj){var keys=[];for(var key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys.sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;keys.length>i;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){for(var index=uid.length,digit;index;){if(index--,digit=uid[index].charCodeAt(0),57==digit)return uid[index]="A",uid.join("");if(90!=digit)return uid[index]=String.fromCharCode(digit+1),uid.join("");uid[index]="0"}return uid.unshift("0"),uid.join("")}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){var h=dst.$$hashKey;return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst[key]=value})}),setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return value===undefined}function isDefined(value){return value!==undefined}function isObject(value){return null!=value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var obj={},items=str.split(","),i;for(i=0;items.length>i;i++)obj[items[i]]=!0;return obj}function map(obj,iterator,context){var results=[];return forEach(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results}function size(obj,ownPropsOnly){var count=0,key;if(isArray(obj)||isString(obj))return obj.length;if(isObject(obj))for(key in obj)(!ownPropsOnly||obj.hasOwnProperty(key))&&count++;return count}function includes(array,obj){return-1!=indexOf(array,obj)}function indexOf(array,obj){if(array.indexOf)return array.indexOf(obj);for(var i=0;array.length>i;i++)if(obj===array[i])return i;return-1}function arrayRemove(array,value){var index=indexOf(array,value);return index>=0&&array.splice(index,1),value}function isLeafNode(node){if(node)switch(node.nodeName){case"OPTION":case"PRE":case"TITLE":return!0}return!1}function copy(source,destination,stackSource,stackDest){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");if(stackSource=stackSource||[],stackDest=stackDest||[],isObject(source)){var index=indexOf(stackSource,source);if(-1!==index)return stackDest[index];stackSource.push(source),stackDest.push(destination)}var result;if(isArray(source)){destination.length=0;for(var i=0;source.length>i;i++)result=copy(source[i],null,stackSource,stackDest),isObject(source[i])&&(stackSource.push(source[i]),stackDest.push(result)),destination.push(result)}else{var h=destination.$$hashKey;forEach(destination,function(value,key){delete destination[key]});for(var key in source)result=copy(source[key],null,stackSource,stackDest),isObject(source[key])&&(stackSource.push(source[key]),stackDest.push(result)),destination[key]=result;setHashKey(destination,h)}}else destination=source,source&&(isArray(source)?destination=copy(source,[],stackSource,stackDest):isDate(source)?destination=new Date(source.getTime()):isRegExp(source)?destination=RegExp(source.source):isObject(source)&&(destination=copy(source,{},stackSource,stackDest)));return destination}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0;src.length>i;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)!hasOwnProperty.call(src,key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var t1=typeof o1,t2=typeof o2,length,key,keySet;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)&&o1.getTime()==o2.getTime();if(isRegExp(o1)&&isRegExp(o2))return""+o1==""+o2;if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function csp(){return document.securityPolicy&&document.securityPolicy.isActive||document.querySelector&&!(!document.querySelector("[ng-csp]")&&!document.querySelector("[data-ng-csp]"))}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,curryArgs.concat(slice.call(arguments,0))):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return obj===undefined?undefined:JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function fromJson(json){return isString(json)?JSON.parse(json):json}function toBoolean(value){if("function"==typeof value)value=!0;else if(value&&0!==value.length){var v=lowercase(""+value);value=!("f"==v||"0"==v||"false"==v||"no"==v||"n"==v||"[]"==v)}else value=!1;return value}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var TEXT_NODE=3,elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===TEXT_NODE?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var obj={},key_value,key;return forEach((keyValue||"").split("&"),function(keyValue){if(keyValue&&(key_value=keyValue.split("="),key=tryDecodeURIComponent(key_value[0]),isDefined(key))){var val=isDefined(key_value[1])?tryDecodeURIComponent(key_value[1]):!0;obj[key]?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val}}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function angularInit(element,bootstrap){function append(element){element&&elements.push(element)}var elements=[element],appElement,module,names=["ng:app","ng-app","x-ng-app","data-ng-app"],NG_APP_CLASS_REGEXP=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;forEach(names,function(name){names[name]=!0,append(document.getElementById(name)),name=name.replace(":","\\:"),element.querySelectorAll&&(forEach(element.querySelectorAll("."+name),append),forEach(element.querySelectorAll("."+name+"\\:"),append),forEach(element.querySelectorAll("["+name+"]"),append))}),forEach(elements,function(element){if(!appElement){var className=" "+element.className+" ",match=NG_APP_CLASS_REGEXP.exec(className);match?(appElement=element,module=(match[2]||"").replace(/\s+/g,",")):forEach(element.attributes,function(attr){!appElement&&names[attr.name]&&(appElement=element,module=attr.value)})}}),appElement&&bootstrap(appElement,module?[module]:[])}function bootstrap(element,modules){var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag)}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),modules.unshift("ng");var injector=createInjector(modules);return injector.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(scope,element,compile,injector,animate){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},undefined)}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){jQuery=window.jQuery,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),jqLitePatchJQueryRemove("remove",!0,!0,!1),jqLitePatchJQueryRemove("empty",!1,!1,!1),jqLitePatchJQueryRemove("html",!1,!1,!0)):jqLite=JQLite,angular.element=jqLite}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var keys=path.split("."),key,lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockElements(nodes){var startNode=nodes[0],endNode=nodes[nodes.length-1];if(startNode===endNode)return jqLite(startNode);var element=startNode,elements=[element];do{if(element=element.nextSibling,!element)break;elements.push(element)}while(element!==endNode);return jqLite(elements)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function module(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod){return function(){return invokeQueue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],runBlocks=[],config=invokeLater("$injector","invoke"),moduleInstance={_invokeQueue:invokeQueue,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),animation:invokeLater("$animateProvider","register"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},$$minErr:minErr,$$csp:csp}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function ngModule($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,required:requiredDirective,ngRequired:requiredDirective,ngValue:ngValueDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$asyncCallback:$$AsyncCallbackProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLitePatchJQueryRemove(name,dispatchThis,filterElems,getterIfNoArguments){function removePatch(param){var list=filterElems&&param?[this.filter(param)]:[this],fireEvent=dispatchThis,set,setIndex,setLength,element,childIndex,childLength,children;if(!getterIfNoArguments||null!=param)for(;list.length;)for(set=list.shift(),setIndex=0,setLength=set.length;setLength>setIndex;setIndex++)for(element=jqLite(set[setIndex]),fireEvent?element.triggerHandler("$destroy"):fireEvent=!fireEvent,childIndex=0,childLength=(children=element.children()).length;childLength>childIndex;childIndex++)list.push(jQuery(children[childIndex]));return originalJqFn.apply(this,arguments)}var originalJqFn=jQuery.fn[name];originalJqFn=originalJqFn.$original||originalJqFn,removePatch.$original=originalJqFn,jQuery.fn[name]=removePatch}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteBuildFragment(html,context){var elem,tmp,tag,wrap,fragment=context.createDocumentFragment(),nodes=[],i,j,jj;if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML="<div>&#160;</div>"+wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],tmp.removeChild(tmp.firstChild),i=wrap[0];i--;)tmp=tmp.lastChild;for(j=0,jj=tmp.childNodes.length;jj>j;++j)nodes.push(tmp.childNodes[j]);tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",nodes}function jqLiteParseHTML(html,context){context=context||document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:jqLiteBuildFragment(html,context)}function JQLite(element){if(element instanceof JQLite)return element;if(isString(element)&&(element=trim(element)),!(this instanceof JQLite)){if(isString(element)&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}if(isString(element)){jqLiteAddNodes(this,jqLiteParseHTML(element));var fragment=jqLite(document.createDocumentFragment());fragment.append(this)}else jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element){jqLiteRemoveData(element);for(var i=0,children=element.childNodes||[];children.length>i;i++)jqLiteDealoc(children[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");handle&&(isUndefined(type)?forEach(events,function(eventHandler,type){removeEventListenerFn(element,type,eventHandler),delete events[type]}):forEach(type.split(" "),function(type){isUndefined(fn)?(removeEventListenerFn(element,type,events[type]),delete events[type]):arrayRemove(events[type]||[],fn)}))}function jqLiteRemoveData(element,name){var expandoId=element[jqName],expandoStore=jqCache[expandoId];if(expandoStore){if(name)return delete jqCache[expandoId].data[name],undefined;expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element[jqName]=undefined}}function jqLiteExpandoStore(element,key,value){var expandoId=element[jqName],expandoStore=jqCache[expandoId||-1];return isDefined(value)?(expandoStore||(element[jqName]=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={}),expandoStore[key]=value,undefined):expandoStore&&expandoStore[key]}function jqLiteData(element,key,value){var data=jqLiteExpandoStore(element,"data"),isSetter=isDefined(value),keyDefined=!isSetter&&isDefined(key),isSimpleGetter=keyDefined&&!isObject(key);if(data||isSimpleGetter||jqLiteExpandoStore(element,"data",data={}),isSetter)data[key]=value;else{if(!keyDefined)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements){elements=elements.nodeName||!isDefined(elements.length)||isWindow(elements)?[elements]:elements;for(var i=0;elements.length>i;i++)root.push(elements[i])}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element=jqLite(element),9==element[0].nodeType&&(element=element.find("html"));for(var names=isArray(name)?name:[name];element.length;){for(var node=element[0],i=0,ii=names.length;ii>i;i++)if((value=element.data(names[i]))!==undefined)return value;element=jqLite(node.parentNode||11===node.nodeType&&node.host)}}function jqLiteEmpty(element){for(var i=0,childNodes=element.childNodes;childNodes.length>i;i++)jqLiteDealoc(childNodes[i]);for(;element.firstChild;)element.removeChild(element.firstChild)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[element.nodeName]&&booleanAttr}function createEventHandler(element,events){var eventHandler=function(event,type){if(event.preventDefault||(event.preventDefault=function(){event.returnValue=!1}),event.stopPropagation||(event.stopPropagation=function(){event.cancelBubble=!0}),event.target||(event.target=event.srcElement||document),isUndefined(event.defaultPrevented)){var prevent=event.preventDefault;event.preventDefault=function(){event.defaultPrevented=!0,prevent.call(event)},event.defaultPrevented=!1}event.isDefaultPrevented=function(){return event.defaultPrevented||event.returnValue===!1};var eventHandlersCopy=shallowCopy(events[type||event.type]||[]);forEach(eventHandlersCopy,function(fn){fn.call(element,event)}),8>=msie?(event.preventDefault=null,event.stopPropagation=null,event.isDefaultPrevented=null):(delete event.preventDefault,delete event.stopPropagation,delete event.isDefaultPrevented)};return eventHandler.elem=element,eventHandler}function hashKey(obj){var objType=typeof obj,key;return"object"==objType&&null!==obj?"function"==typeof(key=obj.$$hashKey)?key=obj.$$hashKey():key===undefined&&(key=obj.$$hashKey=nextUid()):key=obj,objType+":"+key}function HashMap(array){forEach(array,this.put,this)}function annotate(fn){var $inject,fnText,argDecl,last;return"function"==typeof fn?($inject=fn.$inject)||($inject=[],fn.length&&(fnText=(""+fn).replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})),fn.$inject=$inject):isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0),$inject}function createInjector(modulesToLoad){function supportObject(delegate){return function(key,value){return isObject(key)?(forEach(key,reverseParams(delegate)),undefined):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function factory(name,factoryFn){return provider(name,{$get:factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val))}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var runBlocks=[],moduleFn,invokeQueue,i,ii;return forEach(modulesToLoad,function(module){if(!loadedModules.get(module)){loadedModules.put(module,!0);try{if(isString(module))for(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),invokeQueue=moduleFn._invokeQueue,i=0,ii=invokeQueue.length;ii>i;i++){var invokeArgs=invokeQueue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}else isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals){var args=[],$inject=annotate(fn),length,i,key;for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key))}return fn.$inject||(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals){var Constructor=function(){},instance,returnedValue;return Constructor.prototype=(isArray(Type)?Type[Type.length-1]:Type).prototype,instance=new Constructor,returnedValue=invoke(Type,instance,locals),isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap,providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(){throw $injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(servicename){var provider=providerInjector.get(servicename+providerSuffix);return instanceInjector.invoke(provider.$get,provider)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return forEach(list,function(element){result||"a"!==lowercase(element.nodeName)||(result=element)}),result}function scroll(){var hash=$location.hash(),elm;hash?(elm=document.getElementById(hash))?elm.scrollIntoView():(elm=getFirstAnchor(document.getElementsByName(hash)))?elm.scrollIntoView():"top"===hash&&$window.scrollTo(0,0):$window.scrollTo(0,0)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function autoScrollWatch(){return $location.hash()},function autoScrollWatchAction(){$rootScope.$evalAsync(scroll)}),scroll}]}function $$AsyncCallbackProvider(){this.$get=["$$rAF","$timeout",function($$rAF,$timeout){return $$rAF.supported?function(fn){return $$rAF(fn)}:function(fn){return $timeout(fn,0,!1)}}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function startPoller(interval,setTimeout){(function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)})()}function fireUrlChange(){newLocation=null,lastBrowserUrl!=self.url()&&(lastBrowserUrl=self.url(),forEach(urlChangeListeners,function(listener){listener(self.url())}))}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollFns=[],pollTimeout;self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn
};var lastBrowserUrl=location.href,baseElement=document.find("base"),newLocation=null;self.url=function(url,replace){if(location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){if(lastBrowserUrl==url)return;return lastBrowserUrl=url,$sniffer.history?replace?history.replaceState(null,"",url):(history.pushState(null,"",url),baseElement.attr("href",baseElement.attr("href"))):(newLocation=url,replace?location.replace(url):location.href=url),self}return newLocation||location.href.replace(/%27/g,"'")};var urlChangeListeners=[],urlChangeInit=!1;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",fireUrlChange),$sniffer.hashchange?jqLite(window).on("hashchange",fireUrlChange):self.addPollFn(fireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;cookieArray.length>i;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=unescape(cookie.substring(0,index)),lastCookies[name]===undefined&&(lastCookies[name]=unescape(cookie.substring(index+1))));return lastCookies}value===undefined?rawDocument.cookie=escape(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=escape(name)+"="+escape(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(Number.MAX_VALUE>capacity){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}if(!isUndefined(value))return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value},get:function(key){if(Number.MAX_VALUE>capacity){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(Number.MAX_VALUE>capacity){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}delete data[key],size--},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"A",directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$http,$templateCache,$parse,$controller,$rootScope,$document,$sce,$animate,$$sanitizeUri){function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){3==node.nodeType&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=node=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);return safeAddClass($compileNodes,"ng-scope"),function publicLinkFn(scope,cloneConnectFn,transcludeControllers,parentBoundTranscludeFn){assertArg(scope,"scope");var $linkNode=cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes;forEach(transcludeControllers,function(instance,name){$linkNode.data("$"+name+"Controller",instance)});for(var i=0,ii=$linkNode.length;ii>i;i++){var node=$linkNode[i],nodeType=node.nodeType;(1===nodeType||9===nodeType)&&$linkNode.eq(i).data("$scope",scope)}return cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,$node,childScope,i,ii,n,childBoundTranscludeFn,nodeListLength=nodeList.length,stableNodeList=Array(nodeListLength);for(i=0;nodeListLength>i;i++)stableNodeList[i]=nodeList[i];for(i=0,n=0,ii=linkFns.length;ii>i;n++)node=stableNodeList[n],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],$node=jqLite(node),nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),$node.data("$scope",childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,parentBoundTranscludeFn)}for(var linkFns=[],attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,i=0;nodeList.length>i;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&safeAddClass(jqLite(nodeList[i]),"ng-scope"),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),linkFns.push(nodeLinkFn,childLinkFn),linkFnFound=linkFnFound||nodeLinkFn||childLinkFn,previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){var boundTranscludeFn=function(transcludedScope,cloneFn,controllers){var scopeCreated=!1;transcludedScope||(transcludedScope=scope.$new(),transcludedScope.$$transcluded=!0,scopeCreated=!0);var clone=transcludeFn(transcludedScope,cloneFn,controllers,previousBoundTranscludeFn);return scopeCreated&&clone.on("$destroy",function(){transcludedScope.$destroy()}),clone};return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var nodeType=node.nodeType,attrsMap=attrs.$attr,match,className;switch(nodeType){case 1:addDirective(directives,directiveNormalize(nodeName_(node).toLowerCase()),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;if(attr=nAttrs[j],!msie||msie>=8||attr.specified){name=attr.name,ngAttrName=directiveNormalize(name),NG_ATTR_BINDING.test(ngAttrName)&&(name=snake_case(ngAttrName.substr(6),"-"));var directiveNName=ngAttrName.replace(/(Start|End)$/,"");ngAttrName===directiveNName+"Start"&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,attrs[nName]=value=trim(attr.value),getBooleanAttrName(node,nName)&&(attrs[nName]=!0),addAttrInterpolateDirective(node,directives,value,nName),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}}if(className=node.className,isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case 3:addTextInterpolateDirective(directives,node.nodeValue);break;case 8:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){var startNode=node;do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);1==node.nodeType&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(directiveName,require,$element,elementControllers){var value,retrievalMethod="data",optional=!1;if(isString(require)){for(;"^"==(value=require.charAt(0))||"?"==value;)require=require.substr(1),"^"==value&&(retrievalMethod="inheritedData"),optional=optional||"?"==value;if(value=null,elementControllers&&"data"===retrievalMethod&&(value=elementControllers[require]),value=value||$element[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",require,directiveName);return value}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(directiveName,require,$element,elementControllers))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn){var transcludeControllers;return 2>arguments.length&&(cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers)}var attrs,$element,i,ii,linkFn,controller,isolateScope,elementControllers={},transcludeFn;if(attrs=compileNode===linkNode?templateAttrs:shallowCopy(templateAttrs,new Attributes(jqLite(linkNode),templateAttrs.$attr)),$element=attrs.$$element,newIsolateScopeDirective){var LOCAL_REGEXP=/^\s*([@=&])(\??)\s*(\w*)\s*$/,$linkNode=jqLite(linkNode);isolateScope=scope.$new(!0),!templateDirective||templateDirective!==newIsolateScopeDirective&&templateDirective!==newIsolateScopeDirective.$$originalDirective?$linkNode.data("$isolateScopeNoTemplate",isolateScope):$linkNode.data("$isolateScope",isolateScope),safeAddClass($linkNode,"ng-isolate-scope"),forEach(newIsolateScopeDirective.scope,function(definition,scopeName){var match=definition.match(LOCAL_REGEXP)||[],attrName=match[3]||scopeName,optional="?"==match[2],mode=match[1],lastValue,parentGet,parentSet,compare;switch(isolateScope.$$isolateBindings[scopeName]=mode+attrName,mode){case"@":attrs.$observe(attrName,function(value){isolateScope[scopeName]=value}),attrs.$$observers[attrName].$$scope=scope,attrs[attrName]&&(isolateScope[scopeName]=$interpolate(attrs[attrName])(scope));break;case"=":if(optional&&!attrs[attrName])return;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b},parentSet=parentGet.assign||function(){throw lastValue=isolateScope[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],newIsolateScopeDirective.name)},lastValue=isolateScope[scopeName]=parentGet(scope),isolateScope.$watch(function parentValueWatch(){var parentValue=parentGet(scope);return compare(parentValue,isolateScope[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=isolateScope[scopeName]):isolateScope[scopeName]=parentValue),lastValue=parentValue},null,parentGet.literal);break;case"&":parentGet=$parse(attrs[attrName]),isolateScope[scopeName]=function(locals){return parentGet(scope,locals)};break;default:throw $compileMinErr("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",newIsolateScopeDirective.name,scopeName,definition)}})}for(transcludeFn=boundTranscludeFn&&controllersBoundTransclude,controllerDirectives&&forEach(controllerDirectives,function(directive){var locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn},controllerInstance;controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),controllerInstance=$controller(controller,locals),elementControllers[directive.name]=controllerInstance,hasElementTranscludeDirective||$element.data("$"+directive.name+"Controller",controllerInstance),directive.controllerAs&&(locals.$scope[directive.controllerAs]=controllerInstance)}),i=0,ii=preLinkFns.length;ii>i;i++)try{linkFn=preLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)try{linkFn=postLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}previousCompileContext=previousCompileContext||{};for(var terminalPriority=-Number.MAX_VALUE,newScopeDirective,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),directive,directiveName,$template,replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,linkFn,directiveValue,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(newScopeDirective=newScopeDirective||directive,directive.templateUrl||(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode),isObject(directiveValue)&&(newIsolateScopeDirective=directive))),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=groupScan(compileNode,attrStart,attrEnd),$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,jqLite(sliceArgs($template)),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:jqLite(trim(directiveValue)),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));newIsolateScopeDirective&&markDirectivesAsIsolate(templateDirectives),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectivesAsIsolate(directives){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:!0})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var linkQueue=[],afterTemplateNodeLinkFn,afterTemplateChildLinkFn,beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=extend({},origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl;return $compileNode.empty(),$http.get($sce.getTrustedResourceUrl(templateUrl),{cache:$templateCache}).success(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:jqLite(trim(content)),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectivesAsIsolate(templateDirectives),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}linkQueue=null}).error(function(response,code,headers,config){throw $compileMinErr("tpload","Failed to load template: {0}",config.url)}),function delayedNodeLinkFn(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;linkQueue?(linkQueue.push(scope),linkQueue.push(node),linkQueue.push(rootElement),linkQueue.push(childBoundTranscludeFn)):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",previousDirective.name,directive.name,what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function textInterpolateCompileFn(templateNode){var parent=templateNode.parent(),hasCompileParent=parent.length;return hasCompileParent&&safeAddClass(templateNode.parent(),"ng-binding"),function textInterpolateLinkFn(scope,node){var parent=node.parent(),bindings=parent.data("$binding")||[];bindings.push(interpolateFn),parent.data("$binding",bindings),hasCompileParent||safeAddClass(parent,"ng-binding"),scope.$watch(interpolateFn,function interpolateFnWatchAction(value){node[0].nodeValue=value})}}})}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"FORM"==tag&&"action"==attrNormalizedName||"IMG"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:undefined}function addAttrInterpolateDirective(node,directives,value,name){var interpolateFn=$interpolate(value,!0);if(interpolateFn){if("multiple"===name&&"SELECT"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function attrInterpolatePreLinkFn(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");interpolateFn=$interpolate(attr[name],!0,getTrustedContext(node,name)),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function interpolateFnWatchAction(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode,i,ii;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1;break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),newNode[jqLite.expando]=firstElementToRemove[jqLite.expando];for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}var Attributes=function(element,attr){this.$$element=element,this.$attr=attr||{}};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses),toRemove=tokenDifference(oldClasses,newClasses);0===toAdd.length?$animate.removeClass(this.$$element,toRemove):0===toRemove.length?$animate.addClass(this.$$element,toAdd):$animate.setClass(this.$$element,toAdd,toRemove)},$set:function(key,value,writeAttr,attrName){var booleanKey=getBooleanAttrName(this.$$element[0],key),normalizedVal,nodeName;booleanKey&&(this.$$element.prop(key,value),attrName=booleanKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),("A"===nodeName&&"href"===key||"IMG"===nodeName&&"src"===key)&&(this[key]=value=$$sanitizeUri(value,"src"===key)),writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[key],function(fn){try{fn(value)
}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers={}),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||fn(attrs[key])}),fn}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function denormalizeTemplate(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function nodesetLinkingFn(scope,nodeList,rootElement,boundTranscludeFn){}function directiveLinkingFn(nodesetLinkingFn,scope,node,rootElement,boundTranscludeFn){}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;tokens1.length>i;i++){for(var token=tokens1[i],j=0;tokens2.length>j;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function $ControllerProvider(){var controllers={},CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.$get=["$injector","$window",function($injector,$window){return function(expression,locals){var instance,match,constructor,identifier;if(isString(expression)&&(match=expression.match(CNTRL_REG),constructor=match[1],identifier=match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||getter($window,constructor,!0),assertArgFn(expression,constructor,!0)),instance=$injector.instantiate(expression,locals),identifier){if(!locals||"object"!=typeof locals.$scope)throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",constructor||expression.name,identifier);locals.$scope[identifier]=instance}return instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(exception,cause){$log.error.apply($log,arguments)}}]}function parseHeaders(headers){var parsed={},key,val,i;return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]?parsed[key]+=", "+val:parsed[key]=val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){return headersObj||(headersObj=parseHeaders(headers)),name?headersObj[lowercase(name)]||null:headersObj}}function transformData(data,headers,fns){return isFunction(fns)?fns(data,headers):(forEach(fns,function(fn){data=fn(data,headers)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var JSON_START=/^\s*(\[|\{[^\{])/,JSON_END=/[\}\]]\s*$/,PROTECTION_PREFIX=/^\)\]\}',?\n/,CONTENT_TYPE_APPLICATION_JSON={"Content-Type":"application/json;charset=utf-8"},defaults=this.defaults={transformResponse:[function(data){return isString(data)&&(data=data.replace(PROTECTION_PREFIX,""),JSON_START.test(data)&&JSON_END.test(data)&&(data=fromJson(data))),data}],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},interceptorFactories=this.interceptors=[],responseInterceptorFactories=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response,{data:transformData(response.data,response.headers,config.transformResponse)});return isSuccess(response.status)?resp:$q.reject(resp)}function mergeHeaders(config){function execHeaders(headers){var headerContent;forEach(headers,function(headerFn,header){isFunction(headerFn)&&(headerContent=headerFn(),null!=headerContent?headers[header]=headerContent:delete headers[header])})}var defHeaders=defaults.headers,reqHeaders=extend({},config.headers),defHeaderName,lowercaseDefHeaderName,reqHeaderName;defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]),execHeaders(defHeaders),execHeaders(reqHeaders);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return reqHeaders}var config={method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse},headers=mergeHeaders(requestConfig);extend(config,requestConfig),config.headers=headers,config.method=uppercase(config.method);var serverRequest=function(config){headers=config.headers;var reqData=transformData(config.data,headersGetter(headers),config.transformRequest);return isUndefined(config.data)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData,headers).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(names){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(name){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData,reqHeaders){function done(status,response,headersString,statusText){cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),resolvePromise(response,status,headersString,statusText),$rootScope.$$phase||$rootScope.$apply()}function resolvePromise(response,status,headers,statusText){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function removePendingReq(){var idx=indexOf($http.pendingRequests,config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var deferred=$q.defer(),promise=deferred.promise,cache,cachedResp,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),(config.cache||defaults.cache)&&config.cache!==!1&&"GET"==config.method&&(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache)if(cachedResp=cache.get(url),isDefined(cachedResp)){if(cachedResp.then)return cachedResp.then(removePendingReq,removePendingReq),cachedResp;isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK")}else cache.put(url,promise);if(isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$browser.cookies()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType)}return promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)||(value=[value]),forEach(value,function(v){isObject(v)&&(v=toJson(v)),parts.push(encodeUriQuery(key)+"="+encodeUriQuery(v))}))}),parts.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+parts.join("&")),url}var defaultCache=$cacheFactory("$http"),reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),forEach(responseInterceptorFactories,function(interceptorFactory,index){var responseFn=isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory);reversedInterceptors.splice(index,0,{response:function(response){return responseFn($q.when(response))},responseError:function(response){return responseFn($q.reject(response))}})}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put"),$http.defaults=defaults,$http}]}function createXhr(method){if(8>=msie&&(!method.match(/^(get|post|head|put|delete|options)$/i)||!window.XMLHttpRequest))return new window.ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new window.XMLHttpRequest;throw minErr("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),8>=msie&&(script.onreadystatechange=function(){isString(script.readyState)&&/loaded|complete/.test(script.readyState)&&(script.onreadystatechange=null,callback({type:"load"}))}),rawDocument.body.appendChild(script),callback}var ABORTED=-1;return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){status=ABORTED,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){timeoutId&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),status=1223===status?204:status,statusText=statusText||"",callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}var status;if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=noop})}else{var xhr=createXhr(method);if(xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onreadystatechange=function(){if(xhr&&4==xhr.readyState){var responseHeaders=null,response=null;status!==ABORTED&&(responseHeaders=xhr.getAllResponseHeaders(),response="response"in xhr?xhr.response:xhr.responseText),completeRequest(callback,status||xhr.status,response,responseHeaders,xhr.statusText||"")}},withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else timeout&&timeout.then&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function $interpolate(text,mustHaveExpression,trustedContext){for(var startIndex,endIndex,index=0,parts=[],length=text.length,hasInterpolation=!1,fn,exp,concat=[];length>index;)-1!=(startIndex=text.indexOf(startSymbol,index))&&-1!=(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))?(index!=startIndex&&parts.push(text.substring(index,startIndex)),parts.push(fn=$parse(exp=text.substring(startIndex+startSymbolLength,endIndex))),fn.exp=exp,index=endIndex+endSymbolLength,hasInterpolation=!0):(index!=length&&parts.push(text.substring(index)),index=length);if((length=parts.length)||(parts.push(""),length=1),trustedContext&&parts.length>1)throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text);return!mustHaveExpression||hasInterpolation?(concat.length=length,fn=function(context){try{for(var i=0,ii=length,part;ii>i;i++){if("function"==typeof(part=parts[i]))if(part=part(context),part=trustedContext?$sce.getTrusted(trustedContext,part):$sce.valueOf(part),null==part)part="";else switch(typeof part){case"string":break;case"number":part=""+part;break;default:part=toJson(part)}concat[i]=part}return concat.join("")}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,""+err);$exceptionHandler(newErr)}},fn.exp=text,fn.parts=parts,fn):undefined}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length;return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q",function($rootScope,$window,$q){function interval(fn,delay,count,invokeApply){var setInterval=$window.setInterval,clearInterval=$window.clearInterval,deferred=$q.defer(),promise=deferred.promise,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply;return count=isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=setInterval(function tick(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"",posSuf:"",negPre:"(",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"}}}}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj,appBase){var parsedUrl=urlResolve(absoluteUrl,appBase);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=int(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj,appBase){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl,appBase);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):undefined}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"";var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this,appBase),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$rewrite=function(url){var appUrl,prevAppUrl;return(appUrl=beginsWith(appBase,url))!==undefined?(prevAppUrl=appUrl,(appUrl=beginsWith(basePrefix,appUrl))!==undefined?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):(appUrl=beginsWith(appBaseNoFile,url))!==undefined?appBaseNoFile+appUrl:appBaseNoFile==url+"/"?appBaseNoFile:undefined}}function LocationHashbangUrl(appBase,hashPrefix){var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var windowsFilePathExp=/^\/[A-Z]:(\/.*)/,firstPathSegmentMatch;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url),withoutHashUrl="#"==withoutBaseUrl.charAt(0)?beginsWith(hashPrefix,withoutBaseUrl):this.$$html5?withoutBaseUrl:"";if(!isString(withoutHashUrl))throw $locationMinErr("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',url,hashPrefix);parseAppUrl(withoutHashUrl,this,appBase),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$rewrite=function(url){return stripHash(appBase)==stripHash(url)?url:undefined}}function LocationHashbangInHtml5Url(appBase,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments);var appBaseNoFile=stripFile(appBase);this.$$rewrite=function(url){var appUrl;return appBase==stripHash(url)?url:(appUrl=beginsWith(appBaseNoFile,url))?appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"?appBaseNoFile:undefined},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode=!1;this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isDefined(mode)?(html5Mode=mode,this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function($rootScope,$browser,$sniffer,$rootElement){function afterLocationChange(oldUrl){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl)}var $location,LocationMode,baseHref=$browser.baseHref(),initialUrl=$browser.url(),appBase;html5Mode?(appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url):(appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl),$location=new LocationMode(appBase,"#"+hashPrefix),$location.$$parse($location.$$rewrite(initialUrl)),$rootElement.on("click",function(event){if(!event.ctrlKey&&!event.metaKey&&2!=event.which){for(var elm=jqLite(event.target);"a"!==lowercase(elm[0].nodeName);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href");if(isObject(absHref)&&"[object SVGAnimatedString]"==""+absHref&&(absHref=urlResolve(absHref.animVal).href),LocationMode===LocationHashbangInHtml5Url){var href=elm.attr("href")||elm.attr("xlink:href");if(0>href.indexOf("://")){var prefix="#"+hashPrefix;if("/"==href[0])absHref=appBase+prefix+href;else if("#"==href[0])absHref=appBase+prefix+($location.path()||"/")+href;else{for(var stack=$location.path().split("/"),parts=href.split("/"),i=0;parts.length>i;i++)"."!=parts[i]&&(".."==parts[i]?stack.pop():parts[i].length&&stack.push(parts[i]));absHref=appBase+prefix+stack.join("/")}}}var rewrittenUrl=$location.$$rewrite(absHref);absHref&&!elm.attr("target")&&rewrittenUrl&&!event.isDefaultPrevented()&&(event.preventDefault(),rewrittenUrl!=$browser.url()&&($location.$$parse(rewrittenUrl),$rootScope.$apply(),window.angular["ff-684208-preventDefault"]=!0))}}),$location.absUrl()!=initialUrl&&$browser.url($location.absUrl(),!0),$browser.onUrlChange(function(newUrl){$location.absUrl()!=newUrl&&($rootScope.$evalAsync(function(){var oldUrl=$location.absUrl();$location.$$parse(newUrl),$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl).defaultPrevented?($location.$$parse(oldUrl),$browser.url(oldUrl)):afterLocationChange(oldUrl)}),$rootScope.$$phase||$rootScope.$digest())});var changeCounter=0;return $rootScope.$watch(function $locationWatch(){var oldUrl=$browser.url(),currentReplace=$location.$$replace;return changeCounter&&oldUrl==$location.absUrl()||(changeCounter++,$rootScope.$evalAsync(function(){$rootScope.$broadcast("$locationChangeStart",$location.absUrl(),oldUrl).defaultPrevented?$location.$$parse(oldUrl):($browser.url($location.absUrl(),currentReplace),afterLocationChange(oldUrl))})),$location.$$replace=!1,changeCounter}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("constructor"===name)throw $parseMinErr("isecfld",'Referencing "constructor" field in Angular expressions is disallowed! Expression: {0}',fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.document&&obj.location&&obj.alert&&obj.setInterval)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function setter(obj,path,setValue,fullExp,options){options=options||{};for(var element=path.split("."),key,i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=obj[key];propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj,obj.then&&options.unwrapPromises&&(promiseWarning(fullExp),"$$v"in obj||function(promise){promise.then(function(val){promise.$$v=val})}(obj),obj.$$v===undefined&&(obj.$$v={}),obj=obj.$$v)}return key=ensureSafeMemberName(element.shift(),fullExp),obj[key]=setValue,setValue}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp,options){return ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp),options.unwrapPromises?function cspSafePromiseEnabledGetter(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope,promise;return null==pathVal?pathVal:(pathVal=pathVal[key0],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key1?null==pathVal?undefined:(pathVal=pathVal[key1],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key2?null==pathVal?undefined:(pathVal=pathVal[key2],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key3?null==pathVal?undefined:(pathVal=pathVal[key3],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key4?null==pathVal?undefined:(pathVal=pathVal[key4],pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),pathVal):pathVal):pathVal):pathVal):pathVal)}:function cspSafeGetter(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=pathVal[key0],key1?null==pathVal?undefined:(pathVal=pathVal[key1],key2?null==pathVal?undefined:(pathVal=pathVal[key2],key3?null==pathVal?undefined:(pathVal=pathVal[key3],key4?null==pathVal?undefined:pathVal=pathVal[key4]:pathVal):pathVal):pathVal):pathVal)}}function simpleGetterFn1(key0,fullExp){return ensureSafeMemberName(key0,fullExp),function simpleGetterFn1(scope,locals){return null==scope?undefined:(locals&&locals.hasOwnProperty(key0)?locals:scope)[key0]}}function simpleGetterFn2(key0,key1,fullExp){return ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),function simpleGetterFn2(scope,locals){return null==scope?undefined:(scope=(locals&&locals.hasOwnProperty(key0)?locals:scope)[key0],null==scope?undefined:scope[key1])}}function getterFn(path,options,fullExp){if(getterFnCache.hasOwnProperty(path))return getterFnCache[path];var pathKeys=path.split("."),pathKeysLength=pathKeys.length,fn;if(options.unwrapPromises||1!==pathKeysLength)if(options.unwrapPromises||2!==pathKeysLength)if(options.csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp,options):function(scope,locals){var i=0,val;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp,options)(scope,locals),locals=undefined,scope=val;while(pathKeysLength>i);return val};else{var code="var p;\n";forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp),code+="if(s == null) return undefined;\ns="+(index?"s":'((k&&k.hasOwnProperty("'+key+'"))?k:s)')+'["'+key+'"]'+";\n"+(options.unwrapPromises?'if (s && s.then) {\n pw("'+fullExp.replace(/(["\r\n])/g,"\\$1")+'");\n'+' if (!("$$v" in s)) {\n'+" p=s;\n"+" p.$$v = undefined;\n"+" p.then(function(v) {p.$$v=v;});\n"+"}\n"+" s=s.$$v\n"+"}\n":"")}),code+="return s;";var evaledFnGetter=Function("s","k","pw",code);evaledFnGetter.toString=valueFn(code),fn=options.unwrapPromises?function(scope,locals){return evaledFnGetter(scope,locals,promiseWarning)}:evaledFnGetter}else fn=simpleGetterFn2(pathKeys[0],pathKeys[1],fullExp);else fn=simpleGetterFn1(pathKeys[0],fullExp);return"hasOwnProperty"!==path&&(getterFnCache[path]=fn),fn}function $ParseProvider(){var cache={},$parseOptions={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(value){return isDefined(value)?($parseOptions.unwrapPromises=!!value,this):$parseOptions.unwrapPromises},this.logPromiseWarnings=function(value){return isDefined(value)?($parseOptions.logPromiseWarnings=value,this):$parseOptions.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function($filter,$sniffer,$log){return $parseOptions.csp=$sniffer.csp,promiseWarning=function promiseWarningFn(fullExp){$parseOptions.logPromiseWarnings&&!promiseWarningCache.hasOwnProperty(fullExp)&&(promiseWarningCache[fullExp]=!0,$log.warn("[$parse] Promise found in the expression `"+fullExp+"`. "+"Automatic unwrapping of promises in Angular expressions is deprecated."))},function(exp){var parsedExpression;switch(typeof exp){case"string":if(cache.hasOwnProperty(exp))return cache[exp];var lexer=new Lexer($parseOptions),parser=new Parser(lexer,$filter,$parseOptions);return parsedExpression=parser.parse(exp),"hasOwnProperty"!==exp&&(cache[exp]=parsedExpression),parsedExpression;case"function":return exp;default:return noop}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function defaultCallback(value){return value}function defaultErrback(reason){return reject(reason)}function all(promises){var deferred=defer(),counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,ref(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var defer=function(){var pending=[],value,deferred;return deferred={resolve:function(val){if(pending){var callbacks=pending;
pending=undefined,value=ref(val),callbacks.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],value.then(callback[0],callback[1],callback[2])})}},reject:function(reason){deferred.resolve(createInternalRejectedPromise(reason))},notify:function(progress){if(pending){var callbacks=pending;pending.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],callback[2](progress)})}},promise:{then:function(callback,errback,progressback){var result=defer(),wrappedCallback=function(value){try{result.resolve((isFunction(callback)?callback:defaultCallback)(value))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedErrback=function(reason){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedProgressback=function(progress){try{result.notify((isFunction(progressback)?progressback:defaultCallback)(progress))}catch(e){exceptionHandler(e)}};return pending?pending.push([wrappedCallback,wrappedErrback,wrappedProgressback]):value.then(wrappedCallback,wrappedErrback,wrappedProgressback),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback){function makePromise(value,resolved){var result=defer();return resolved?result.resolve(value):result.reject(value),result.promise}function handleCallback(value,isResolved){var callbackOutput=null;try{callbackOutput=(callback||defaultCallback)()}catch(e){return makePromise(e,!1)}return callbackOutput&&isFunction(callbackOutput.then)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)}return this.then(function(value){return handleCallback(value,!0)},function(error){return handleCallback(error,!1)})}}}},ref=function(value){return value&&isFunction(value.then)?value:{then:function(callback){var result=defer();return nextTick(function(){result.resolve(callback(value))}),result.promise}}},reject=function(reason){var result=defer();return result.reject(reason),result.promise},createInternalRejectedPromise=function(reason){return{then:function(callback,errback){var result=defer();return nextTick(function(){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}}),result.promise}}},when=function(value,callback,errback,progressback){var result=defer(),done,wrappedCallback=function(value){try{return(isFunction(callback)?callback:defaultCallback)(value)}catch(e){return exceptionHandler(e),reject(e)}},wrappedErrback=function(reason){try{return(isFunction(errback)?errback:defaultErrback)(reason)}catch(e){return exceptionHandler(e),reject(e)}},wrappedProgressback=function(progress){try{return(isFunction(progressback)?progressback:defaultCallback)(progress)}catch(e){exceptionHandler(e)}};return nextTick(function(){ref(value).then(function(value){done||(done=!0,result.resolve(ref(value).then(wrappedCallback,wrappedErrback,wrappedProgressback)))},function(reason){done||(done=!0,result.resolve(wrappedErrback(reason)))},function(progress){done||result.notify(wrappedProgressback(progress))})}),result.promise};return{defer:defer,reject:reject,when:when,all:all}}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame||$window.mozRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.mozCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function compileToFn(exp,name){var fn=$parse(exp);return assertArgFn(fn,name),fn}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}Scope.prototype={constructor:Scope,$new:function(isolate){var ChildScope,child;return isolate?(child=new Scope,child.$root=this.$root,child.$$asyncQueue=this.$$asyncQueue,child.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=nextUid(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),child=new this.$$childScopeClass),child["this"]=child,child.$parent=this,child.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=child,this.$$childTail=child):this.$$childHead=this.$$childTail=child,child},$watch:function(watchExp,listener,objectEquality){var scope=this,get=compileToFn(watchExp,"watch"),array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};if(lastDirtyWatch=null,!isFunction(listener)){var listenFn=compileToFn(listener||noop,"listener");watcher.fn=function(newVal,oldVal,scope){listenFn(scope)}}if("string"==typeof watchExp&&get.constant){var originalFn=watcher.fn;watcher.fn=function(newVal,oldVal,scope){originalFn.call(this,newVal,oldVal,scope),arrayRemove(array,watcher)}}return array||(array=scope.$$watchers=[]),array.unshift(watcher),function deregisterWatch(){arrayRemove(array,watcher),lastDirtyWatch=null}},$watchCollection:function(obj,listener){function $watchCollectionWatch(){newValue=objGetter(self);var newLength,key;if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++){var bothNaN=oldValue[i]!==oldValue[i]&&newValue[i]!==newValue[i];bothNaN||oldValue[i]===newValue[i]||(changeDetected++,oldValue[i]=newValue[i])}}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)newValue.hasOwnProperty(key)&&(newLength++,oldValue.hasOwnProperty(key)?oldValue[key]!==newValue[key]&&(changeDetected++,oldValue[key]=newValue[key]):(oldLength++,oldValue[key]=newValue[key],changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)oldValue.hasOwnProperty(key)&&!newValue.hasOwnProperty(key)&&(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=Array(newValue.length);for(var i=0;newValue.length>i;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}var self=this,newValue,oldValue,veryOldValue,trackVeryOldValue=listener.length>1,changeDetected=0,objGetter=$parse(obj),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch($watchCollectionWatch,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,asyncQueue=this.$$asyncQueue,postDigestQueue=this.$$postDigestQueue,length,dirty,ttl=TTL,next,current,target=this,watchLog=[],logIdx,logMsg,asyncTask;beginPhase("$digest"),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression)}catch(e){clearPhase(),$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if((value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),logMsg=isFunction(watch.exp)?"fn: "+(watch.exp.name||""+watch.exp):watch.exp,logMsg+="; newVal: "+toJson(value)+"; oldVal: "+toJson(last),watchLog[logIdx].push(logMsg))}catch(e){clearPhase(),$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,toJson(watchLog))}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==$rootScope&&(forEach(this.$$listenerCount,bind(null,decrementListenerCount,this)),parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=noop,this.$on=this.$watch=function(){return noop})}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr){$rootScope.$$phase||$rootScope.$$asyncQueue.length||$browser.defer(function(){$rootScope.$$asyncQueue.length&&$rootScope.$digest()}),this.$$asyncQueue.push({scope:this,expression:expr})},$$postDigest:function(fn){this.$$postDigestQueue.push(fn)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){namedListeners[indexOf(namedListeners,listener)]=null,decrementListenerCount(self,1,name)}},$emit:function(name,args){var empty=[],namedListeners,scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1),i,length;do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event;scope=scope.$parent}while(scope);return event},$broadcast:function(name,args){for(var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1),listeners,i,length;current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event}};var $rootScope=new Scope;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*(https?|ftp|file):|data:image\//;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function sanitizeUri(uri,isImage){var regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist,normalizedVal;return msie&&!(msie>=8)||(normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex))?uri:"unsafe:"+normalizedVal}}}function escapeForRegexp(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),RegExp("^"+matcher+"$")}if(isRegExp(matcher))return RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var parsedUrl=urlResolve(""+url),i,n,allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function TrustedValueHolderType(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function sceValueOf(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function sceToString(){return""+this.$$unwrapTrustedValue()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||trustedValue===undefined||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||maybeTrusted===undefined||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",""+maybeTrusted)}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function htmlSanitizer(html){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sniffer","$sceDelegate",function($parse,$sniffer,$sceDelegate){if(enabled&&$sniffer.msie&&8>$sniffer.msieDocumentMode)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function sceParseAs(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:function sceParseAsTrusted(self,locals){return sce.getTrusted(type,parsed(self,locals))}};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var eventSupport={},android=int((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},documentMode=document.documentMode,vendorPrefix,vendorRegex=/^(Moz|webkit|O|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1,match;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(document.body.style.webkitTransition),animations=isString(document.body.style.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hashchange:"onhashchange"in $window&&(!documentMode||documentMode>7),hasEvent:function(event){if("input"==event&&9==msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android,msie:msie,msieDocumentMode:documentMode}}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function($rootScope,$browser,$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var deferred=$q.defer(),promise=deferred.promise,skipApply=isDefined(invokeApply)&&!invokeApply,timeoutId;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url,base){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArray(array))return array;var comparatorType=typeof comparator,predicates=[];predicates.check=function(value){for(var j=0;predicates.length>j;j++)if(!predicates[j](value))return!1;return!0},"function"!==comparatorType&&(comparator="boolean"===comparatorType&&comparator?function(obj,text){return angular.equals(obj,text)}:function(obj,text){if(obj&&text&&"object"==typeof obj&&"object"==typeof text){for(var objKey in obj)if("$"!==objKey.charAt(0)&&hasOwnProperty.call(obj,objKey)&&comparator(obj[objKey],text[objKey]))return!0;return!1}return text=(""+text).toLowerCase(),(""+obj).toLowerCase().indexOf(text)>-1});var search=function(obj,text){if("string"==typeof text&&"!"===text.charAt(0))return!search(obj,text.substr(1));switch(typeof obj){case"boolean":case"number":case"string":return comparator(obj,text);case"object":switch(typeof text){case"object":return comparator(obj,text);default:for(var objKey in obj)if("$"!==objKey.charAt(0)&&search(obj[objKey],text))return!0}return!1;case"array":for(var i=0;obj.length>i;i++)if(search(obj[i],text))return!0;return!1;default:return!1}};switch(typeof expression){case"boolean":case"number":case"string":expression={$:expression};case"object":for(var key in expression)(function(path){expression[path]!==undefined&&predicates.push(function(value){return search("$"==path?value:value&&value[path],expression[path])})})(key);break;case"function":predicates.push(expression);break;default:return array}for(var filtered=[],j=0;array.length>j;j++){var value=array[j];predicates.check(value)&&filtered.push(value)}return filtered}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,2).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(null==number||!isFinite(number)||isObject(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?numStr="0":(formatedText=numStr,hasExponent=!0)}if(hasExponent)fractionSize>0&&number>-1&&1>number&&(formatedText=number.toFixed(fractionSize));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac));var pow=Math.pow(10,fractionSize+1);number=Math.floor(number*pow+5)/pow;var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var i,pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group)for(pos=whole.length-lgroup,i=0;pos>i;i++)0===(pos-i)%group&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(i=pos;whole.length>i;i++)0===(whole.length-i)%lgroup&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fractionSize>fraction.length;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return parts.push(isNegative?pattern.negPre:pattern.posPre),parts.push(formatedText),parts.push(isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;digits>num.length;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function ampmGetter(date,formats){return 12>date.getHours()?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),dateSetter.call(date,int(match[1]),int(match[2])-1,int(match[3]));var h=int(match[4]||0)-tzHour,m=int(match[5]||0)-tzMin,s=int(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format){var text="",parts=[],fn,match;if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);return forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object){return toJson(object,!0)}}function limitToFilter(){return function(input,limit){if(!isArray(input)&&!isString(input))return input;if(limit=1/0===Math.abs(Number(limit))?Number(limit):int(limit),isString(input))return limit?limit>=0?input.slice(0,limit):input.slice(limit,input.length):"";var out=[],i,n;for(limit>input.length?limit=input.length:-input.length>limit&&(limit=-input.length),limit>0?(i=0,n=limit):(i=input.length+limit,n=input.length);n>i;i++)out.push(input[i]);return out}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;sortPredicate.length>i;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return toBoolean(descending)?function(a,b){return comp(b,a)}:comp}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1==t2?("string"==t1&&(v1=v1.toLowerCase(),v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}if(!isArray(array))return array;if(!sortPredicate)return array;sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],sortPredicate=map(sortPredicate,function(predicate){var descending=!1,get=predicate||identity;if(isString(predicate)&&(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),get=$parse(predicate),get.constant)){var key=get();return reverseComparator(function(a,b){return compare(a[key],b[key])},descending)}return reverseComparator(function(a,b){return compare(get(a),get(b))},descending)});for(var arrayCopy=[],i=0;array.length>i;i++)arrayCopy.push(array[i]);return arrayCopy.sort(reverseComparator(comparator,reverseOrder))}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function FormController(element,attrs,$scope,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.removeClass(element,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey),$animate.addClass(element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}var form=this,parentForm=element.parent().controller("form")||nullFormCtrl,invalidCount=0,errors=form.$error={},controls=[];form.$name=attrs.name||attrs.ngForm,form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,parentForm.$addControl(form),element.addClass(PRISTINE_CLASS),toggleValidCss(!0),form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control)},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(errors,function(queue,validationToken){form.$setValidity(validationToken,!0,control)}),arrayRemove(controls,control)},form.$setValidity=function(validationToken,isValid,control){var queue=errors[validationToken];if(isValid)queue&&(arrayRemove(queue,control),queue.length||(invalidCount--,invalidCount||(toggleValidCss(isValid),form.$valid=!0,form.$invalid=!1),errors[validationToken]=!1,toggleValidCss(!0,validationToken),parentForm.$setValidity(validationToken,!0,form)));
else{if(invalidCount||toggleValidCss(isValid),queue){if(includes(queue,control))return}else errors[validationToken]=queue=[],invalidCount++,toggleValidCss(!1,validationToken),parentForm.$setValidity(validationToken,!1,form);queue.push(control),form.$valid=!1,form.$invalid=!0}},form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()},form.$setPristine=function(){$animate.removeClass(element,DIRTY_CLASS),$animate.addClass(element,PRISTINE_CLASS),form.$dirty=!1,form.$pristine=!0,forEach(controls,function(control){control.$setPristine()})}}function validate(ctrl,validatorName,validity,value){return ctrl.$setValidity(validatorName,validity),validity?value:undefined}function addNativeHtml5Validators(ctrl,validatorName,element){var validity=element.prop("validity");if(isObject(validity)){var validator=function(value){return ctrl.$error[validatorName]||!(validity.badInput||validity.customError||validity.typeMismatch)||validity.valueMissing?value:(ctrl.$setValidity(validatorName,!1),undefined)};ctrl.$parsers.push(validator)}}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){var validity=element.prop("validity"),placeholder=element[0].placeholder,noevent={};if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(data){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(ev){if(!composing){var value=element.val();if(msie&&"input"===(ev||noevent).type&&element[0].placeholder!==placeholder)return placeholder=element[0].placeholder,undefined;toBoolean(attr.ngTrim||"T")&&(value=trim(value)),(ctrl.$viewValue!==value||validity&&""===value&&!validity.valueMissing)&&(scope.$$phase?ctrl.$setViewValue(value):scope.$apply(function(){ctrl.$setViewValue(value)}))}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(){timeout||(timeout=$browser.defer(function(){listener(),timeout=null}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener()}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),ctrl.$render=function(){element.val(ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)};var pattern=attr.ngPattern,patternValidator,match;if(pattern){var validateRegex=function(regexp,value){return validate(ctrl,"pattern",ctrl.$isEmpty(value)||regexp.test(value),value)};match=pattern.match(/^\/(.*)\/([gim]*)$/),match?(pattern=RegExp(match[1],match[2]),patternValidator=function(value){return validateRegex(pattern,value)}):patternValidator=function(value){var patternObj=scope.$eval(pattern);if(!patternObj||!patternObj.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",pattern,patternObj,startingTag(element));return validateRegex(patternObj,value)},ctrl.$formatters.push(patternValidator),ctrl.$parsers.push(patternValidator)}if(attr.ngMinlength){var minlength=int(attr.ngMinlength),minLengthValidator=function(value){return validate(ctrl,"minlength",ctrl.$isEmpty(value)||value.length>=minlength,value)};ctrl.$parsers.push(minLengthValidator),ctrl.$formatters.push(minLengthValidator)}if(attr.ngMaxlength){var maxlength=int(attr.ngMaxlength),maxLengthValidator=function(value){return validate(ctrl,"maxlength",ctrl.$isEmpty(value)||maxlength>=value.length,value)};ctrl.$parsers.push(maxLengthValidator),ctrl.$formatters.push(maxLengthValidator)}}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(textInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$parsers.push(function(value){var empty=ctrl.$isEmpty(value);return empty||NUMBER_REGEXP.test(value)?(ctrl.$setValidity("number",!0),""===value?null:empty?value:parseFloat(value)):(ctrl.$setValidity("number",!1),undefined)}),addNativeHtml5Validators(ctrl,"number",element),ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?"":""+value}),attr.min){var minValidator=function(value){var min=parseFloat(attr.min);return validate(ctrl,"min",ctrl.$isEmpty(value)||value>=min,value)};ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}if(attr.max){var maxValidator=function(value){var max=parseFloat(attr.max);return validate(ctrl,"max",ctrl.$isEmpty(value)||max>=value,value)};ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}ctrl.$formatters.push(function(value){return validate(ctrl,"number",ctrl.$isEmpty(value)||isNumber(value),value)})}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var urlValidator=function(value){return validate(ctrl,"url",ctrl.$isEmpty(value)||URL_REGEXP.test(value),value)};ctrl.$formatters.push(urlValidator),ctrl.$parsers.push(urlValidator)}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var emailValidator=function(value){return validate(ctrl,"email",ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value),value)};ctrl.$formatters.push(emailValidator),ctrl.$parsers.push(emailValidator)}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid()),element.on("click",function(){element[0].checked&&scope.$apply(function(){ctrl.$setViewValue(attr.value)})}),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function checkboxInputType(scope,element,attr,ctrl){var trueValue=attr.ngTrueValue,falseValue=attr.ngFalseValue;isString(trueValue)||(trueValue=!0),isString(falseValue)||(falseValue=!1),element.on("click",function(){scope.$apply(function(){ctrl.$setViewValue(element[0].checked)})}),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value!==trueValue},ctrl.$formatters.push(function(value){return value===trueValue}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;tokens1.length>i;i++){for(var token=tokens1[i],j=0;tokens2.length>j;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){if(isArray(classVal))return classVal;if(isString(classVal))return classVal.split(" ");if(isObject(classVal)){var classes=[],i=0;return forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes}return classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||{},classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toRemove=digestClassCounts(toRemove,-1),toAdd=digestClassCounts(toAdd,1),0===toAdd.length?$animate.removeClass(element,toRemove):0===toRemove.length?$animate.addClass(element,toAdd):$animate.setClass(element,toAdd,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(value){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}var lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,slice=[].slice,push=[].push,toString=Object.prototype.toString,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),angularModule,nodeName_,uid=["0","0","0"];msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1])),noop.$inject=[],identity.$inject=[];var isArray=function(){return isFunction(Array.isArray)?Array.isArray:function(value){return"[object Array]"===toString.call(value)}}(),trim=function(){return String.prototype.trim?function(value){return isString(value)?value.trim():value}:function(value){return isString(value)?value.replace(/^\s\s*/,"").replace(/\s\s*$/,""):value}}();nodeName_=9>msie?function(element){return element=element.nodeName?element:element[0],element.scopeName&&"HTML"!=element.scopeName?uppercase(element.scopeName+":"+element.nodeName):element.nodeName}:function(element){return element.nodeName?element.nodeName:element[0].nodeName};var SNAKE_CASE_REGEXP=/[A-Z]/g,version={full:"1.2.18",major:1,minor:2,dot:18,codeName:"ear-extendability"},jqCache=JQLite.cache={},jqName=JQLite.expando="ng"+(new Date).getTime(),jqId=1,addEventListenerFn=window.document.addEventListener?function(element,type,fn){element.addEventListener(type,fn,!1)}:function(element,type,fn){element.attachEvent("on"+type,fn)},removeEventListenerFn=window.document.removeEventListener?function(element,type,fn){element.removeEventListener(type,fn,!1)}:function(element,type,fn){element.detachEvent("on"+type,fn)},jqData=JQLite._data=function(node){return this.cache[node[this.expando]]||{}},SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return index>=0?jqLite(this[index]):jqLite(this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[uppercase(value)]=!0}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite(element).data("$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite(element).data("$isolateScope")||jqLite(element).data("$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){if(name=camelCase(name),!isDefined(value)){var val;return 8>=msie&&(val=element.currentStyle&&element.currentStyle[name],""===val&&(val="auto")),val=val||element.style[name],8>=msie&&(val=""===val?undefined:val),val}element.style[name]=value},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?(element[name]=value,undefined):element[name]},text:function(){function getText(element,value){var textProp=NODE_TYPE_TEXT_PROPERTY[element.nodeType];return isUndefined(value)?textProp?element[textProp]:"":(element[textProp]=value,undefined)}var NODE_TYPE_TEXT_PROPERTY=[];return 9>msie?(NODE_TYPE_TEXT_PROPERTY[1]="innerText",NODE_TYPE_TEXT_PROPERTY[3]="nodeValue"):NODE_TYPE_TEXT_PROPERTY[1]=NODE_TYPE_TEXT_PROPERTY[3]="textContent",getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if("SELECT"===nodeName_(element)&&element.multiple){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){if(isUndefined(value))return element.innerHTML;for(var i=0,childNodes=element.childNodes;childNodes.length>i;i++)jqLiteDealoc(childNodes[i]);element.innerHTML=value},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)===undefined){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=value===undefined?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,dealoc:jqLiteDealoc,on:function onFn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");events||jqLiteExpandoStore(element,"events",events={}),handle||jqLiteExpandoStore(element,"handle",handle=createEventHandler(element,events)),forEach(type.split(" "),function(type){var eventFns=events[type];if(!eventFns){if("mouseenter"==type||"mouseleave"==type){var contains=document.body.contains||document.body.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};events[type]=[];var eventmap={mouseleave:"mouseout",mouseenter:"mouseover"};onFn(element,eventmap[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!contains(target,related))&&handle(event,type)})}else addEventListenerFn(element,type,handle),events[type]=[];eventFns=events[type]}eventFns.push(fn)})},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){1===element.nodeType&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){forEach(new JQLite(node),function(child){(1===element.nodeType||11===element.nodeType)&&element.appendChild(child)})},prepend:function(element,node){if(1===element.nodeType){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode)[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:function(element){jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)},after:function(element,newElement){var index=element,parent=element.parentNode;forEach(new JQLite(newElement),function(node){parent.insertBefore(node,index.nextSibling),index=node})},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&11!==parent.nodeType?parent:null},next:function(element){if(element.nextElementSibling)return element.nextElementSibling;for(var elm=element.nextSibling;null!=elm&&1!==elm.nodeType;)elm=elm.nextSibling;return elm},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,eventName,eventData){var eventFns=(jqLiteExpandoStore(element,"events")||{})[eventName];eventData=eventData||[];var event=[{preventDefault:noop,stopPropagation:noop}];forEach(eventFns,function(fn){fn.apply(element,event.concat(eventData))})}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0;this.length>i;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key)]=value},get:function(key){return this[hashKey(key)]},remove:function(key){var value=this[key=hashKey(key)];return delete this[key],value}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector"),$animateMinErr=minErr("$animate"),$AnimateProvider=["$provide",function($provide){this.$$selectors={},this.register=function(name,factory){var key=name+"-animation";if(name&&"."!=name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);this.$$selectors[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){return 1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function($timeout,$$asyncCallback){function async(fn){fn&&$$asyncCallback(fn)}return{enter:function(element,parent,after,done){after?after.after(element):(parent&&parent[0]||(parent=after.parent()),parent.append(element)),async(done)},leave:function(element,done){element.remove(),async(done)},move:function(element,parent,after,done){this.enter(element,parent,after,done)},addClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteAddClass(element,className)}),async(done)},removeClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteRemoveClass(element,className)}),async(done)},setClass:function(element,add,remove,done){forEach(element,function(element){jqLiteAddClass(element,add),jqLiteRemoveClass(element,remove)}),async(done)},enabled:noop}}]}],$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,$interpolateMinErr=minErr("$interpolate"),PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location");LocationHashbangInHtml5Url.prototype=LocationHashbangUrl.prototype=LocationHtml5Url.prototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url,replace){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return match[1]&&this.path(decodeURIComponent(match[1])),(match[2]||match[1])&&this.search(match[3]||""),this.hash(match[5]||"",replace),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return"/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search))this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",identity),replace:function(){return this.$$replace=!0,this}};var $parseMinErr=minErr("$parse"),promiseWarningCache={},promiseWarning,OPERATORS={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:noop,"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"^":function(self,locals,a,b){return a(self,locals)^b(self,locals)},"=":noop,"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"&":function(self,locals,a,b){return a(self,locals)&b(self,locals)},"|":function(self,locals,a,b){return b(self,locals)(self,locals,a(self,locals))},"!":function(self,locals,a){return!a(self,locals)}},ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.ch=undefined,this.lastCh=":",this.tokens=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var ch2=this.ch+this.peek(),ch3=ch2+this.peek(2),fn=OPERATORS[this.ch],fn2=OPERATORS[ch2],fn3=OPERATORS[ch3];fn3?(this.tokens.push({index:this.index,text:ch3,fn:fn3}),this.index+=3):fn2?(this.tokens.push({index:this.index,text:ch2,fn:fn2}),this.index+=2):fn?(this.tokens.push({index:this.index,text:this.ch,fn:fn}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(chars){return-1!==chars.indexOf(this.ch)},was:function(chars){return-1!==chars.indexOf(this.lastCh)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||""===ch||""===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}number=1*number,this.tokens.push({index:start,text:number,literal:!0,constant:!0,fn:function(){return number}})},readIdent:function(){for(var parser=this,ident="",start=this.index,lastDot,peekIndex,methodName,ch;this.index<this.text.length&&(ch=this.text.charAt(this.index),"."===ch||this.isIdent(ch)||this.isNumber(ch));)"."===ch&&(lastDot=this.index),ident+=ch,this.index++;if(lastDot)for(peekIndex=this.index;this.text.length>peekIndex;){if(ch=this.text.charAt(peekIndex),"("===ch){methodName=ident.substr(lastDot-start+1),ident=ident.substr(0,lastDot-start),this.index=peekIndex;break}if(!this.isWhitespace(ch))break;peekIndex++}var token={index:start,text:ident};if(OPERATORS.hasOwnProperty(ident))token.fn=OPERATORS[ident],token.literal=!0,token.constant=!0;else{var getter=getterFn(ident,this.options,this.text);token.fn=extend(function(self,locals){return getter(self,locals)},{assign:function(self,value){return setter(self,ident,value,parser.text,parser.options)}})}this.tokens.push(token),methodName&&(this.tokens.push({index:lastDot,text:"."}),this.tokens.push({index:lastDot+1,text:methodName}))},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep?rep:ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,this.tokens.push({index:start,text:rawString,string:string,literal:!0,constant:!0,fn:function(){return string}}),undefined;string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options};Parser.ZERO=extend(function(){return 0},{constant:!0}),Parser.prototype={constructor:Parser,parse:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value},primary:function(){var primary;if(this.expect("("))primary=this.filterChain(),this.consume(")");else if(this.expect("["))primary=this.arrayDeclaration();else if(this.expect("{"))primary=this.object();else{var token=this.expect();primary=token.fn,primary||this.throwError("not a primary expression",token),primary.literal=!!token.literal,primary.constant=!!token.constant}for(var next,context;next=this.expect("(","[",".");)"("===next.text?(primary=this.functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=this.objectIndex(primary)):"."===next.text?(context=primary,primary=this.fieldAccess(primary)):this.throwError("IMPOSSIBLE");return primary},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){if(this.tokens.length>0){var token=this.tokens[0],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},consume:function(e1){this.expect(e1)||this.throwError("is unexpected, expecting ["+e1+"]",this.peek())},unaryFn:function(fn,right){return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant})},ternaryFn:function(left,middle,right){return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})},binaryFn:function(left,fn,right){return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant})},statements:function(){for(var statements=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&statements.push(this.filterChain()),!this.expect(";"))return 1===statements.length?statements[0]:function(self,locals){for(var value,i=0;statements.length>i;i++){var statement=statements[i];statement&&(value=statement(self,locals))}return value}},filterChain:function(){for(var left=this.expression(),token;;){if(!(token=this.expect("|")))return left;left=this.binaryFn(left,token.fn,this.filter())}},filter:function(){for(var token=this.expect(),fn=this.$filter(token.text),argsFn=[];;){if(!(token=this.expect(":"))){var fnInvoke=function(self,locals,input){for(var args=[input],i=0;argsFn.length>i;i++)args.push(argsFn[i](self,locals));return fn.apply(self,args)};return function(){return fnInvoke}}argsFn.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var left=this.ternary(),right,token;return(token=this.expect("="))?(left.assign||this.throwError("implies assignment but ["+this.text.substring(0,token.index)+"] can not be assigned to",token),right=this.ternary(),function(scope,locals){return left.assign(scope,right(scope,locals),locals)}):left},ternary:function(){var left=this.logicalOR(),middle,token;return(token=this.expect("?"))?(middle=this.ternary(),(token=this.expect(":"))?this.ternaryFn(left,middle,this.ternary()):(this.throwError("expected :",token),undefined)):left},logicalOR:function(){for(var left=this.logicalAND(),token;;){if(!(token=this.expect("||")))return left;
left=this.binaryFn(left,token.fn,this.logicalAND())}},logicalAND:function(){var left=this.equality(),token;return(token=this.expect("&&"))&&(left=this.binaryFn(left,token.fn,this.logicalAND())),left},equality:function(){var left=this.relational(),token;return(token=this.expect("==","!=","===","!=="))&&(left=this.binaryFn(left,token.fn,this.equality())),left},relational:function(){var left=this.additive(),token;return(token=this.expect("<",">","<=",">="))&&(left=this.binaryFn(left,token.fn,this.relational())),left},additive:function(){for(var left=this.multiplicative(),token;token=this.expect("+","-");)left=this.binaryFn(left,token.fn,this.multiplicative());return left},multiplicative:function(){for(var left=this.unary(),token;token=this.expect("*","/","%");)left=this.binaryFn(left,token.fn,this.unary());return left},unary:function(){var token;return this.expect("+")?this.primary():(token=this.expect("-"))?this.binaryFn(Parser.ZERO,token.fn,this.unary()):(token=this.expect("!"))?this.unaryFn(token.fn,this.unary()):this.primary()},fieldAccess:function(object){var parser=this,field=this.expect().text,getter=getterFn(field,this.options,this.text);return extend(function(scope,locals,self){return getter(self||object(scope,locals))},{assign:function(scope,value,locals){return setter(object(scope,locals),field,value,parser.text,parser.options)}})},objectIndex:function(obj){var parser=this,indexFn=this.expression();return this.consume("]"),extend(function(self,locals){var o=obj(self,locals),i=indexFn(self,locals),v,p;return o?(v=ensureSafeObject(o[i],parser.text),v&&v.then&&parser.options.unwrapPromises&&(p=v,"$$v"in v||(p.$$v=undefined,p.then(function(val){p.$$v=val})),v=v.$$v),v):undefined},{assign:function(self,value,locals){var key=indexFn(self,locals),safe=ensureSafeObject(obj(self,locals),parser.text);return safe[key]=value}})},functionCall:function(fn,contextGetter){var argsFn=[];if(")"!==this.peekToken().text)do argsFn.push(this.expression());while(this.expect(","));this.consume(")");var parser=this;return function(scope,locals){for(var args=[],context=contextGetter?contextGetter(scope,locals):scope,i=0;argsFn.length>i;i++)args.push(argsFn[i](scope,locals));var fnPtr=fn(scope,locals,context)||noop;ensureSafeObject(context,parser.text),ensureSafeObject(fnPtr,parser.text);var v=fnPtr.apply?fnPtr.apply(context,args):fnPtr(args[0],args[1],args[2],args[3],args[4]);return ensureSafeObject(v,parser.text)}},arrayDeclaration:function(){var elementFns=[],allConstant=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var elementFn=this.expression();elementFns.push(elementFn),elementFn.constant||(allConstant=!1)}while(this.expect(","));return this.consume("]"),extend(function(self,locals){for(var array=[],i=0;elementFns.length>i;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:allConstant})},object:function(){var keyValues=[],allConstant=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var token=this.expect(),key=token.string||token.text;this.consume(":");var value=this.expression();keyValues.push({key:key,value:value}),value.constant||(allConstant=!1)}while(this.expect(","));return this.consume("}"),extend(function(self,locals){for(var object={},i=0;keyValues.length>i;i++){var keyValue=keyValues[i];object[keyValue.key]=keyValue.value(self,locals)}return object},{literal:!0,constant:allConstant})}};var getterFnCache={},$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href,!0);$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return 8>=msie&&(attr.href||attr.name||attr.$set("href",""),element.append(document.createComment("IE fix"))),attr.href||attr.xlinkHref||attr.name?undefined:function(scope,element){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:100,link:function(scope,element,attr){scope.$watch(attr[normalized],function ngBooleanAttrWatchAction(value){attr.$set(attrName,!!value)})}}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){value&&(attr.$set(name,value),msie&&propName&&element.prop(propName,attr[name]))})}}}});var nullFormCtrl={$addControl:noop,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop};FormController.$inject=["$element","$attrs","$scope","$animate"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:isNgForm?"EAC":"E",controller:FormController,compile:function(){return{pre:function(scope,formElement,attr,controller){if(!attr.action){var preventDefaultListener=function(event){event.preventDefault?event.preventDefault():event.returnValue=!1};addEventListenerFn(formElement[0],"submit",preventDefaultListener),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",preventDefaultListener)},0,!1)})}var parentFormCtrl=formElement.parent().controller("form"),alias=attr.name||attr.ngForm;alias&&setter(scope,alias,controller,alias),parentFormCtrl&&formElement.on("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&setter(scope,alias,undefined,alias),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,inputType={text:textInputType,number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer",function($browser,$sniffer){return{restrict:"E",require:"?ngModel",link:function(scope,element,attr,ctrl){ctrl&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrl,$sniffer,$browser)}}}],VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.removeClass($element,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey),$animate.addClass($element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=$attr.name;var ngModelGet=$parse($attr.ngModel),ngModelSet=ngModelGet.assign;if(!ngModelSet)throw minErr("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element));this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var parentForm=$element.inheritedData("$formController")||nullFormCtrl,invalidCount=0,$error=this.$error={};$element.addClass(PRISTINE_CLASS),toggleValidCss(!0),this.$setValidity=function(validationErrorKey,isValid){$error[validationErrorKey]!==!isValid&&(isValid?($error[validationErrorKey]&&invalidCount--,invalidCount||(toggleValidCss(!0),this.$valid=!0,this.$invalid=!1)):(toggleValidCss(!1),this.$invalid=!0,this.$valid=!1,invalidCount++),$error[validationErrorKey]=!isValid,toggleValidCss(isValid,validationErrorKey),parentForm.$setValidity(validationErrorKey,isValid,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setViewValue=function(value){this.$viewValue=value,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),parentForm.$setDirty()),forEach(this.$parsers,function(fn){value=fn(value)}),this.$modelValue!==value&&(this.$modelValue=value,ngModelSet($scope,value),forEach(this.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}}))};var ctrl=this;$scope.$watch(function ngModelWatch(){var value=ngModelGet($scope);if(ctrl.$modelValue!==value){var formatters=ctrl.$formatters,idx=formatters.length;for(ctrl.$modelValue=value;idx--;)value=formatters[idx](value);ctrl.$viewValue!==value&&(ctrl.$viewValue=value,ctrl.$render())}return value})}],ngModelDirective=function(){return{require:["ngModel","^?form"],controller:NgModelController,link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;formCtrl.$addControl(modelCtrl),scope.$on("$destroy",function(){formCtrl.$removeControl(modelCtrl)})}}},ngChangeDirective=valueFn({require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),requiredDirective=function(){return{require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){attr.required=!0;var validator=function(value){return attr.required&&ctrl.$isEmpty(value)?(ctrl.$setValidity("required",!1),undefined):(ctrl.$setValidity("required",!0),value)};ctrl.$formatters.push(validator),ctrl.$parsers.unshift(validator),attr.$observe("required",function(){validator(ctrl.$viewValue)})}}}},ngListDirective=function(){return{require:"ngModel",link:function(scope,element,attr,ctrl){var match=/\/(.*)\//.exec(attr.ngList),separator=match&&RegExp(match[1])||attr.ngList||",",parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trim(value))}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(", "):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function ngValueConstantLink(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function ngValueLink(scope,elm,attr){scope.$watch(attr.ngValue,function valueWatchAction(value){attr.$set("value",value)})}}}},ngBindDirective=ngDirective({compile:function(templateElement){return templateElement.addClass("ng-binding"),function(scope,element,attr){element.data("$binding",attr.ngBind),scope.$watch(attr.ngBind,function ngBindWatchAction(value){element.text(value==undefined?"":value)})}}}),ngBindTemplateDirective=["$interpolate",function($interpolate){return function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));element.addClass("ng-binding").data("$binding",interpolateFn),attr.$observe("ngBindTemplate",function(value){element.text(value)})}}],ngBindHtmlDirective=["$sce","$parse",function($sce,$parse){return function(scope,element,attr){function getStringValue(){return""+(parsed(scope)||"")}element.addClass("ng-binding").data("$binding",attr.ngBindHtml);var parsed=$parse(attr.ngBindHtml);scope.$watch(getStringValue,function ngBindHtmlWatchAction(value){element.html($sce.getTrustedHtml(parsed(scope))||"")})}}],ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{scope:!0,controller:"@",priority:500}}],ngEventDirectives={};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(name){var directiveName=directiveNormalize("ng-"+name);ngEventDirectives[directiveName]=["$parse",function($parse){return{compile:function($element,attr){var fn=$parse(attr[directiveName]);return function ngEventHandler(scope,element){element.on(lowercase(name),function(event){scope.$apply(function(){fn(scope,{$event:event})})})}}}}]});var ngIfDirective=["$animate",function($animate){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function ngIfWatchAction(value){toBoolean(value)?childScope||(childScope=$scope.$new(),$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)})):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockElements(block.clone),$animate.leave(previousElements,function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$http","$templateCache","$anchorScroll","$animate","$sce",function($http,$templateCache,$anchorScroll,$animate,$sce){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var changeCounter=0,currentScope,previousElement,currentElement,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement,function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch($sce.parseAsResourceUrl(srcExp),function ngIncludeWatchAction(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element,afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&cleanupLastIncludeContent()}),scope.$emit("$includeContentRequested")):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){$element.html(ctrl.template),$compile($element.contents())(scope)}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g;return{restrict:"EA",link:function(scope,element,attr){var numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),isWhen=/^when(Minus)?(.+)$/;forEach(attr,function(expression,attributeName){isWhen.test(attributeName)&&(whens[lowercase(attributeName.replace("when","").replace("Minus","-"))]=element.attr(attr.$attr[attributeName]))}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,startSymbol+numberExp+"-"+offset+endSymbol))}),scope.$watch(function ngPluralizeWatch(){var value=parseFloat(scope.$eval(numberExp));return isNaN(value)?"":(value in whens||(value=$locale.pluralCat(value-offset)),whensExpFns[value](scope,element,!0))},function ngPluralizeWatchAction(newVal){element.text(newVal)})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){function getBlockStart(block){return block.clone[0]}function getBlockEnd(block){return block.clone[block.clone.length-1]}var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var expression=$attr.ngRepeat,match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),trackByExp,trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,lhs,rhs,valueIdentifier,keyIdentifier,hashFnLocals={$id:hashKey};if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);if(lhs=match[1],rhs=match[2],trackByExp=match[3],trackByExp?(trackByExpGetter=$parse(trackByExp),trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)}):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),match=lhs.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);valueIdentifier=match[3]||match[1],keyIdentifier=match[2];var lastBlockMap={};$scope.$watchCollection(rhs,function ngRepeatAction(collection){var index,length,previousNode=$element[0],nextNode,nextBlockMap={},arrayLength,childScope,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder=[],elementsToRemove;if(isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(key in collection)collection.hasOwnProperty(key)&&"$"!=key.charAt(0)&&collectionKeys.push(key);collectionKeys.sort()}for(arrayLength=collectionKeys.length,length=nextBlockOrder.length=collectionKeys.length,index=0;length>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),assertNotHasOwnProperty(trackById,"`track by` id"),lastBlockMap.hasOwnProperty(trackById))block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap.hasOwnProperty(trackById))throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}",expression,trackById);nextBlockOrder[index]={id:trackById},nextBlockMap[trackById]=!1}for(key in lastBlockMap)lastBlockMap.hasOwnProperty(key)&&(block=lastBlockMap[key],elementsToRemove=getBlockElements(block.clone),$animate.leave(elementsToRemove),forEach(elementsToRemove,function(element){element[NG_REMOVED]=!0}),block.scope.$destroy());for(index=0,length=collectionKeys.length;length>index;index++){if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],nextBlockOrder[index-1]&&(previousNode=getBlockEnd(nextBlockOrder[index-1])),block.scope){childScope=block.scope,nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockElements(block.clone),null,jqLite(previousNode)),previousNode=getBlockEnd(block)}else childScope=$scope.$new();childScope[valueIdentifier]=value,keyIdentifier&&(childScope[keyIdentifier]=key),childScope.$index=index,childScope.$first=0===index,childScope.$last=index===arrayLength-1,childScope.$middle=!(childScope.$first||childScope.$last),childScope.$odd=!(childScope.$even=0===(1&index)),block.scope||$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngRepeat: "+expression+" "),$animate.enter(clone,null,jqLite(previousNode)),previousNode=clone,block.scope=childScope,block.clone=clone,nextBlockMap[block.id]=block})}lastBlockMap=nextBlockMap})}}}],ngShowDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngShow,function ngShowWatchAction(value){$animate[toBoolean(value)?"removeClass":"addClass"](element,"ng-hide")})}}],ngHideDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngHide,function ngHideWatchAction(value){$animate[toBoolean(value)?"addClass":"removeClass"](element,"ng-hide")})}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function ngStyleWatchAction(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function ngSwitchController(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousElements=[],selectedScopes=[];scope.$watch(watchExpr,function ngSwitchWatchAction(value){var i,ii;for(i=0,ii=previousElements.length;ii>i;++i)previousElements[i].remove();for(previousElements.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=selectedElements[i];selectedScopes[i].$destroy(),previousElements[i]=selected,$animate.leave(selected,function(){previousElements.splice(i,1)})}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&(scope.$eval(attr.change),forEach(selectedTranscludes,function(selectedTransclude){var selectedScope=scope.$new();selectedScopes.push(selectedScope),selectedTransclude.transclude(selectedScope,function(caseElement){var anchor=selectedTransclude.element;selectedElements.push(caseElement),$animate.enter(caseElement,anchor.parent(),anchor)})}))})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsMinErr=minErr("ngOptions"),ngOptionsDirective=valueFn({terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,nullModelCtrl={$setViewValue:noop};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var self=this,optionsMap={},ngModelCtrl=nullModelCtrl,nullOption,unknownOption;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value){assertNotHasOwnProperty(value,'"option value"'),optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove())},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue==value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function setupAsSingle(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.on("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function setupAsMultiple(scope,selectElement,ctrl){var lastView;ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function selectMultipleWatch(){equals(lastView,ctrl.$viewValue)||(lastView=shallowCopy(ctrl.$viewValue),ctrl.$render())}),selectElement.on("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function setupAsOptions(scope,selectElement,ctrl){function render(){var optionGroups={"":[]},optionGroupNames=[""],optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,modelValue=ctrl.$modelValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,key,groupLength,length,groupIndex,index,locals={},selected,selectedSet=!1,lastElement,element,label;if(multiple)if(trackFn&&isArray(modelValue)){selectedSet=new HashMap([]);for(var trackIndex=0;modelValue.length>trackIndex;trackIndex++)locals[valueName]=modelValue[trackIndex],selectedSet.put(trackFn(scope,locals),modelValue[trackIndex])}else selectedSet=new HashMap(modelValue);for(index=0;length=keys.length,length>index;index++){if(key=index,keyName){if(key=keys[index],"$"===key.charAt(0))continue;locals[keyName]=key}if(locals[valueName]=values[key],optionGroupName=groupByFn(scope,locals)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),multiple)selected=isDefined(selectedSet.remove(trackFn?trackFn(scope,locals):valueFn(scope,locals)));else{if(trackFn){var modelCast={};modelCast[valueName]=modelValue,selected=trackFn(scope,modelCast)===trackFn(scope,locals)}else selected=modelValue===valueFn(scope,locals);selectedSet=selectedSet||selected}label=displayFn(scope,locals),label=isDefined(label)?label:"",optionGroup.push({id:trackFn?trackFn(scope,locals):keyName?keys[index]:index,label:label,selected:selected})}for(multiple||(nullOption||null===modelValue?optionGroups[""].unshift({id:"",label:"",selected:!selectedSet}):selectedSet||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],optionGroup=optionGroups[optionGroupName],groupIndex>=optionGroupsCache.length?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&lastElement.text(existingOption.label=option.label),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),existingOption.selected!==option.selected&&lastElement.prop("selected",existingOption.selected=option.selected)):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).attr("selected",option.selected).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)existingOptions.pop().element.remove()}for(;optionGroupsCache.length>groupIndex;)optionGroupsCache.pop()[0].element.remove()}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),track=match[8],trackFn=track?$parse(match[8]):null,optionGroupsCache=[[{element:selectElement,label:""}]];nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.empty(),selectElement.on("change",function(){scope.$apply(function(){var optionGroup,collection=valuesFn(scope)||[],locals={},key,value,optionElement,index,groupIndex,length,groupLength,trackIndex;if(multiple){for(value=[],groupIndex=0,groupLength=optionGroupsCache.length;groupLength>groupIndex;groupIndex++)for(optionGroup=optionGroupsCache[groupIndex],index=1,length=optionGroup.length;length>index;index++)if((optionElement=optionGroup[index].element)[0].selected){if(key=optionElement.val(),keyName&&(locals[keyName]=key),trackFn)for(trackIndex=0;collection.length>trackIndex&&(locals[valueName]=collection[trackIndex],trackFn(scope,locals)!=key);trackIndex++);else locals[valueName]=collection[key];
value.push(valueFn(scope,locals))}}else{if(key=selectElement.val(),"?"==key)value=undefined;else if(""===key)value=null;else if(trackFn){for(trackIndex=0;collection.length>trackIndex;trackIndex++)if(locals[valueName]=collection[trackIndex],trackFn(scope,locals)==key){value=valueFn(scope,locals);break}}else locals[valueName]=collection[key],keyName&&(locals[keyName]=key),value=valueFn(scope,locals);optionGroupsCache[0].length>1&&optionGroupsCache[0][1].id!==key&&(optionGroupsCache[0][1].selected=!1)}ctrl.$setViewValue(value)})}),ctrl.$render=render,scope.$watch(render)}if(ctrls[1]){for(var selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,emptyOption,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=nullOption=children.eq(i);break}selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}),optionsExp?setupAsOptions(scope,element,ngModelCtrl):multiple?setupAsMultiple(scope,element,ngModelCtrl):setupAsSingle(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound?element.prop("selected",!1):selectCtrl=nullSelectCtrl,interpolateFn?scope.$watch(interpolateFn,function interpolateWatchAction(newVal,oldVal){attr.$set("value",newVal),newVal!==oldVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal)}):selectCtrl.addOption(attr.value),element.on("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!0});return window.angular.bootstrap?(console.log("WARNING: Tried to load angular more than once."),undefined):(bindJQuery(),publishExternalAPI(angular),jqLite(document).ready(function(){angularInit(document,bootstrap)}),undefined)})(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>');
                (function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw Error("jQuery requires a window with a document");return factory(w)}:factory(global)})("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>=0!==not})}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function completed(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Math.random()}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$1").toLowerCase(),data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}data_user.set(elem,key,data)}else data=void 0;return data}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;l>i;i++)data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(data_priv.hasData(src)&&(pdataOld=data_priv.access(src),pdataCur=data_priv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}data_user.hasData(src)&&(udataOld=data_user.access(src),udataCur=jQuery.extend({},udataOld),data_user.set(dest,udataCur))}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=iframe[0].contentDocument,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name]),computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?(delete this.get,void 0):(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=data_priv.get(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName)))):(hidden=isHidden(elem),"none"===display&&hidden||data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),checkDisplay="none"===display?data_priv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display,"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0;if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=data_priv.access(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&elem.defaultView}var arr=[],slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},document=window.document,version="2.1.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray,isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)>=0},isPlainObject:function(obj){return"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj)?!1:obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(1===code.indexOf("use strict")?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:Date.now,support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},strundefined="undefined",MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rtrim=RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=RegExp(pseudos),ridentifier=RegExp("^"+identifier+"$"),matchExpr={ID:RegExp("^#("+characterEncoding+")"),CLASS:RegExp("^\\.("+characterEncoding+")"),TAG:RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:RegExp("^"+attributes),PSEUDO:RegExp("^"+pseudos),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:RegExp("^(?:"+booleans+")$","i"),needsContext:RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;
return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(55296|high>>10,56320|1023&high)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",function(){setDocument()},!1):parent.attachEvent&&parent.attachEvent("onunload",function(){setDocument()})),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){return div.innerHTML="<div class='a'></div><div class='a i'></div>",div.firstChild.className="i",2===div.getElementsByClassName("i").length}),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return typeof context.getElementsByClassName!==strundefined&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select msallowclip=''><option selected=''></option></select>",div.querySelectorAll("[msallowclip^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||!documentIsHTML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||0===diff%first&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(6>elem.nodeType)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;length>++i;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&elem.parentNode&&(this.length=1,this[0]=elem),this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?rootjQuery.ready!==void 0?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},sibling:function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched}}),jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;l>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(11>cur.nodeType&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.unique(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})})(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}},progressValues,progressContexts,resolveContexts;if(length>1)for(progressValues=Array(length),progressContexts=Array(length),resolveContexts=Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){(wait===!0?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready"))))}}),jQuery.ready.promise=function(obj){return readyList||(readyList=jQuery.Deferred(),"complete"===document.readyState?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(obj)},jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;len>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};jQuery.acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType},Data.uid=1,Data.accepts=jQuery.acceptData,Data.prototype={key:function(owner){if(!Data.accepts(owner))return 0;var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock},Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock,jQuery.extend(owner,descriptor)}}return this.cache[unlock]||(this.cache[unlock]={}),unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if("string"==typeof data)cache[data]=value;else if(jQuery.isEmptyObject(cache))jQuery.extend(this.cache[unlock],data);else for(prop in data)cache[prop]=data[prop];return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return void 0===key?cache:cache[key]},access:function(owner,key,value){var stored;return void 0===key||key&&"string"==typeof key&&void 0===value?(stored=this.get(owner,key),void 0!==stored?stored:this.get(owner,jQuery.camelCase(key))):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(void 0===key)this.cache[unlock]={};else{jQuery.isArray(key)?name=key.concat(key.map(jQuery.camelCase)):(camel=jQuery.camelCase(key),key in cache?name=[key,camel]:(name=camel,name=name in cache?[name]:name.match(rnotwhite)||[])),i=name.length;for(;i--;)delete cache[name[i]]}},hasData:function(owner){return!jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){owner[this.expando]&&delete this.cache[owner[this.expando]]}};var data_priv=new Data,data_user=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem)},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=data_user.get(elem),1===elem.nodeType&&!data_priv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));data_priv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){data_user.set(this,key)}):access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&void 0===value){if(data=data_user.get(elem,key),void 0!==data)return data;if(data=data_user.get(elem,camelKey),void 0!==data)return data;if(data=dataAttr(elem,camelKey,void 0),void 0!==data)return data
}else this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value),-1!==key.indexOf("-")&&void 0!==data&&data_user.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=data_priv.get(elem,type),data&&(!queue||jQuery.isArray(data)?queue=data_priv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),setter>arguments.length?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=data_priv.get(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},rcheckableType=/^(?:checkbox|radio)$/i;(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue})();var strundefined="undefined";support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||elem.addEventListener&&elem.addEventListener(type,eventHandle,!1)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,data_priv.remove(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=0>type.indexOf(":")&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&special._default.apply(eventPath.pop(),data)!==!1||!jQuery.acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!==this;cur=cur.parentNode||this)if(cur.disabled!==!0||"click"!==event.type){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return handlers.length>delegateCount&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=document),3===event.target.nodeType&&(event.target=event.target.parentNode),fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==safeActiveElement()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&jQuery.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),this[jQuery.expando]=!0,void 0):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),data_priv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;attaches?data_priv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),data_priv.remove(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;l>i;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;l>i;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},buildFragment:function(elems,context,scripts,selection){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment},cleanData:function(elems){for(var data,elem,type,key,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++){if(jQuery.acceptData(elem)&&(key=elem[data_priv.expando],key&&(data=data_priv.cache[key]))){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);data_priv.cache[key]&&delete data_priv.cache[key]}delete data_user.cache[elem[data_user.expando]]}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=value)})},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval(node.textContent.replace(rcleanScript,"")))}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={},rmargin=/^margin/,rnumnonpx=RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)};(function(){function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",div.innerHTML="",docElem.appendChild(container);var divStyle=window.getComputedStyle(div,null);pixelPositionVal="1%"!==divStyle.top,boxSizingReliableVal="4px"===divStyle.width,docElem.removeChild(container)}var pixelPositionVal,boxSizingReliableVal,docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",container.appendChild(div),window.getComputedStyle&&jQuery.extend(support,{pixelPosition:function(){return computePixelPositionAndBoxSizingReliable(),pixelPositionVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computePixelPositionAndBoxSizingReliable(),boxSizingReliableVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));return marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",docElem.appendChild(container),ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight),docElem.removeChild(container),ret}}))})(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=RegExp("^("+pnum+")(.*)$","i"),rrelNum=RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value?hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name]:(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(style[name]=value)),void 0)}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.pos=eased=this.options.duration?jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)
},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||data_priv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();timers.length>i;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):(jQuery.removeAttr(elem,name),void 0))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)&&(elem[propName]=!1),elem.removeAttribute(name)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed="string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)0>cur.indexOf(" "+clazz+" ")&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=0===arguments.length||"string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(type===strundefined||"boolean"===type)&&(this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||value===!1?"":data_priv.get(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(option.value,values)>=0)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=void 0}return(!xml||xml.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+data),xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapAll(html.call(this,i))}):(this[0]&&(wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this)},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return 0>=elem.offsetWidth&&0>=elem.offsetHeight},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();window.ActiveXObject&&jQuery(window).on("unload",function(){for(var key in xhrCallbacks)xhrCallbacks[key]()}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback;return support.cors||xhrSupported&&!options.crossDomain?{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(delete xhrCallbacks[id],callback=xhr.onload=xhr.onerror=null,"abort"===type?xhr.abort():"error"===type?complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"string"==typeof xhr.responseText?{text:xhr.responseText}:void 0,xhr.getAllResponseHeaders()))}},xhr.onload=callback(),xhr.onerror=callback("error"),callback=xhrCallbacks[id]=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}:void 0}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:!0,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,type,response,self=this,off=url.indexOf(" ");return off>=0&&(selector=jQuery.trim(url.slice(off)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}):box},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?win[prop]:elem[method]:(win?win.scrollTo(top?window.pageXOffset:val,top?val:window.pageYOffset):elem[method]=val,void 0)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery});
                function ReconnectingWebSocket(url,protocols){function connect(reconnectAttempt){ws=new WebSocket(url,protocols),self.onconnecting(),(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",url);var localWs=ws,timeout=setTimeout(function(){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",url),timedOut=!0,localWs.close(),timedOut=!1},self.timeoutInterval);ws.onopen=function(event){clearTimeout(timeout),(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onopen",url),self.readyState=WebSocket.OPEN,reconnectAttempt=!1,self.onopen(event)},ws.onclose=function(event){clearTimeout(timeout),ws=null,forcedClose?(self.readyState=WebSocket.CLOSED,self.onclose(event)):(self.readyState=WebSocket.CONNECTING,self.onconnecting(),reconnectAttempt||timedOut||((self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onclose",url),self.onclose(event)),setTimeout(function(){connect(!0)},self.reconnectInterval))},ws.onmessage=function(event){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",url,event.data),self.onmessage(event)},ws.onerror=function(event){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onerror",url,event),self.onerror(event)}}protocols=protocols||[],this.debug=!1,this.reconnectInterval=1e3,this.timeoutInterval=2e3;var self=this,ws,forcedClose=!1,timedOut=!1;this.url=url,this.protocols=protocols,this.readyState=WebSocket.CONNECTING,this.URL=url,this.onopen=function(event){},this.onclose=function(event){},this.onconnecting=function(event){},this.onmessage=function(event){},this.onerror=function(event){},connect(url),this.send=function(data){if(ws)return(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","send",url,data),ws.send(data);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(){ws&&(forcedClose=!0,ws.close())},this.refresh=function(){ws&&ws.close()}}ReconnectingWebSocket.debugAll=!1;
                function Realtime(){this.ENDPOINT="wss://realtime.rally1.rallydev.com/_websocket",this.getSubscribeMessage=function(){var projectUuid=Rally.environment.getContext().getProject()._refObjectUUID;return console.log("project",Rally.environment.getContext().getProject()),console.log("ProjectUuid",projectUuid),JSON.stringify({uri:"/_subscribe","request-method":"post",body:{topic:projectUuid}})},this.getSubscribeMessageByUuid=function(projectUuid){return JSON.stringify({uri:"/_subscribe","request-method":"post",body:{topic:projectUuid}})},this.getStateFieldValue=function(data,name){var field=_.find(_.values(data.data.state),{name:name});return field&&field.value},this.getExtCompatibleRecordData=function(data,Model,useOldValue){var values=_.values(data.data.state).concat(_.values(data.data.changes)),recordData=_.reduce(values,function(rd,v){return rd[v.name]=useOldValue?v.old_value:v.value,rd},{});return recordData._type=Model.typePath,recordData},this.getTypeFromScope=function(data){if(data&&data.data&&data.data.scope){var match=data.data.scope.match(/([^\/]*)$/);if(match){var typeString=match.pop(),typeMap={"user-story":"UserStory"};return typeMap[typeString]||typeString}}},this.buildRecord=function(data,callback){var recordType=this.getStateFieldValue(data,"object_type")||this.getTypeFromScope(data);if(!recordType)return console.log("failed to get the type of artifact that changed",data),void 0;var me=this;Rally.data.WsapiModelFactory.getModel({type:recordType,success:function(Model){var record=new Model(me.getExtCompatibleRecordData(data,Model,"Recycled"===data.data.action));callback(record)}})},this.getChangedFields=function(data){return _.pluck(_.values(data.data.changes),"name")},this.getMessageToPublish=function(data){if(data&&data.data&&data.data.action){var action=data.data.action;console.log("action: ",action);var actionMap={Updated:Rally.Message.objectUpdate,Created:Rally.Message.objectCreate,Recycled:Rally.Message.objectDestroy};return actionMap[action]}},this.getArgsForMessage=function(message,record,changedFields,cmp){return message===Rally.Message.objectUpdate||message===Rally.Message.objectCreate?[message,record,changedFields,cmp]:[message,record,cmp,[]]},this.publishObjectChanged=function(data,cmp){var message=this.getMessageToPublish(data),me=this;message&&this.buildRecord(data,function(record){var changedFields=me.getChangedFields(data),args=me.getArgsForMessage(message,record,changedFields,cmp),mb=Rally.environment.getMessageBus();mb.publish.apply(mb,args)})},this.connect=function(){console.log("realtime: connecting");var connection=new ReconnectingWebSocket(this.ENDPOINT),me=this;return connection.onopen=function(){console.log("realtime: connected"),connection.send(me.getSubscribeMessage())},connection.onerror=function(e){console.log("realtime: error",arguments)},connection},this.connectTo=function(uuid){console.log("realtime: connecting");var connection=new ReconnectingWebSocket(this.ENDPOINT),me=this;return connection.onopen=function(){console.log("realtime: connected"),connection.send(me.getSubscribeMessageByUuid(uuid))},connection.onerror=function(e){console.log("realtime: error",arguments)},connection}}
                $(document).ready(function(){$(".unselected").click(function(){$(this).parent().find(".selected").removeClass("selected").addClass("unselected"),$(this).removeClass("unselected").addClass("selected"),console.log($(this).text()),"History"===$(this).text()?($("#historyLog").show(),$("#realtimeLog").hide()):($("#realtimeLog").show(),$("#historyLog").hide()),$(".unselected").click(function(){$(this).parent().find(".selected").removeClass("selected").addClass("unselected"),$(this).removeClass("unselected").addClass("selected"),"History"===$(this).text()?($("#historyLog").show(),$("#realtimeLog").hide()):($("#realtimeLog").show(),$("#historyLog").hide())})})});
                window.me=window.me||{},function(){function domReady(){if(!isReady){if(!document.body)return setTimeout(domReady,13);document.removeEventListener?document.removeEventListener("DOMContentLoaded",domReady,!1):window.removeEventListener("load",domReady,!1),isReady=!0;for(var fn=0;readyList.length>fn;fn++)readyList[fn].call(window,[]);readyList.length=0}}function bindReady(){return readyBound?void 0:(readyBound=!0,"complete"===document.readyState?domReady():(document.addEventListener&&document.addEventListener("DOMContentLoaded",domReady,!1),window.addEventListener("load",domReady,!1),void 0))}function _init_ME(){me_initialized||(me.device._check(),me.save._init(),me.loader.setNocache(document.location.href.match(/\?nocache/)||!1),me.timer.init(),me.mapReader=new me.TMXMapReader,me.state.init(),me.pool.init(),me.device.isMobile===!1&&me.input._enableKeyboardEvent(),me.levelDirector.reset(),me_initialized=!0)}me.mod="melonJS",me.version="1.0.1","function"==typeof define&&define.amd&&define("me",[],function(){return me}),me.sys={fps:60,interpolation:!1,scale:null,scalingInterpolation:!1,gravity:void 0,stopOnAudioError:!0,pauseOnBlur:!0,resumeOnFocus:!0,stopOnBlur:!1,preRender:!1,checkVersion:function(first,second){second=second||me.version;for(var a=first.split("."),b=second.split("."),len=Math.min(a.length,b.length),result=0,i=0;len>i&&!(result=+a[i]-+b[i]);i++);return result?result:a.length-b.length}};var me_initialized=!1,readyBound=!1,isReady=!1,readyList=[];window.onReady=function(fn){return bindReady(),isReady?fn.call(window,[]):readyList.push(function(){return fn.call(window,[])}),this},me.skipAutoInit!==!0?window.onReady(function(){_init_ME()}):me.init=function(){_init_ME(),domReady()};var initializing=!1,fnTest=/var xyz/.test(function(){var xyz})?/\bparent\b/:/[\D|\d]*/;Object.defineProperty||(Object.defineProperty=function(obj,prop,desc){if(!obj.__defineGetter__)throw"melonJS: Object.defineProperty not supported";desc.get&&obj.__defineGetter__(prop,desc.get),desc.set&&obj.__defineSetter__(prop,desc.set)});var deepcopy=function(obj){if(null==obj||"object"!=typeof obj)return obj;var copy;if(obj instanceof Array){copy=[],Object.setPrototypeOf(copy,Object.getPrototypeOf(obj));for(var i=0,l=obj.length;l>i;i++)copy[i]=deepcopy(obj[i]);return copy}if(obj instanceof Date)return copy=new Date,copy.setTime(obj.getTime()),copy;copy={},Object.setPrototypeOf(copy,Object.getPrototypeOf(obj));for(var prop in obj)obj.hasOwnProperty(prop)&&(copy[prop]=deepcopy(obj[prop]));return copy};if(Object.extend=function(prop){function addSuper(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);return this.parent=tmp,ret}}function Class(){if(!initializing){for(var prop in this)"object"==typeof this[prop]&&(this[prop]=deepcopy(this[prop]));this.init&&this.init.apply(this,arguments)}return this}var parent=this.prototype;initializing=!0;var proto=new this;initializing=!1;for(var name in prop)prop.hasOwnProperty(name)&&(proto[name]="function"==typeof prop[name]&&"function"==typeof parent[name]&&fnTest.test(prop[name])?addSuper(name,prop[name]):prop[name]);return Class.prototype=proto,Class.constructor=Class,Class.extend=Object.extend,Class},"function"!=typeof Object.create&&(Object.create=function(o){var Fn=function(){};return Fn.prototype=o,new Fn}),!Function.prototype.bind){var Empty=function(){};Function.prototype.bind=function bind(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=Array.prototype.slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(Array.prototype.slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(Array.prototype.slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound}}if(window.throttle||(window.throttle=function(delay,no_trailing,callback){var last=window.performance.now(),deferTimer;return"boolean"!=typeof no_trailing&&(no_trailing=!1),function(){var now=window.performance.now(),elasped=now-last,args=arguments;return delay>elasped?(no_trailing===!1&&(clearTimeout(deferTimer),deferTimer=setTimeout(function(){return last=now,callback.apply(null,args)},elasped)),void 0):(last=now,callback.apply(null,args))}}),Date.now===void 0&&(Date.now=function(){return(new Date).getTime()}),window.performance===void 0&&(window.performance={}),!window.performance.now){var timeOffset=Date.now();window.performance.timing&&window.performance.timing.navigationStart&&(timeOffset=window.performance.timing.navigationStart),window.performance.now=function(){return Date.now()-timeOffset}}"undefined"==typeof console&&(console={log:function(){},info:function(){},error:function(){alert(Array.prototype.slice.call(arguments).join(", "))}}),Function.prototype.defer=function(){return setTimeout(this.bind.apply(this,arguments),.01)},Object.getPrototypeOf=Object.getPrototypeOf||function(obj){return obj.__proto__},Object.setPrototypeOf=Object.setPrototypeOf||function(obj,prototype){return obj.__proto__=prototype,obj},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),String.prototype.isNumeric=function(){return null!==this&&!isNaN(this)&&""!==this.trim()},String.prototype.isBoolean=function(){return null!==this&&("true"===this.trim()||"false"===this.trim())},String.prototype.contains||(String.prototype.contains=function(str,startIndex){return-1!==String.prototype.indexOf.call(this,str,startIndex)}),String.prototype.toHex=function(){for(var res="",c=0;this.length>c;)res+=this.charCodeAt(c++).toString(16);return res},Number.prototype.clamp=function(low,high){return low>this?low:this>high?high:+this},Number.prototype.random=function(min,max){return~~(Math.random()*(max-min+1))+min},Number.prototype.round=function(){var num=2>arguments.length?this:arguments[0],powres=Math.pow(10,arguments[1]||arguments[0]||0);return Math.round(num*powres)/powres},Number.prototype.toHex=function(){return"0123456789ABCDEF".charAt(this-this%16>>4)+"0123456789ABCDEF".charAt(this%16)},Number.prototype.sign=function(){return 0>this?-1:this>0?1:0},Number.prototype.degToRad=function(angle){return(angle||this)/180*Math.PI},Number.prototype.radToDeg=function(angle){return(angle||this)*(180/Math.PI)},Array.prototype.remove=function(obj){var i=Array.prototype.indexOf.call(this,obj);return-1!==i&&Array.prototype.splice.call(this,i,1),this},Array.prototype.forEach||(Array.prototype.forEach=function(callback,scope){for(var i=0,j=this.length;j--;i++)callback.call(scope||this,this[i],i,this)}),Array.isArray||(Array.isArray=function(vArg){var isArray;return isArray=vArg instanceof Array}),Object.defineProperty(me,"initialized",{get:function get(){return me_initialized}}),me.game=function(){var api={},frameBuffer=null,initialized=!1,isDirty=!0,frameCounter=0,frameRate=1;return api.viewport=null,api.collisionMap=null,api.currentLevel=null,api.world=null,api.mergeGroup=!0,api.sortOn="z",api.renderer=null,api.NO_OBJECT=0,api.ENEMY_OBJECT=1,api.COLLECTABLE_OBJECT=2,api.ACTION_OBJECT=3,api.onLevelLoaded=null,api.init=function(width,height){initialized||(width=width||me.video.getWidth(),height=height||me.video.getHeight(),api.viewport=new me.Viewport(0,0,width,height),api.world=new me.ObjectContainer(0,0,width,height),api.world.name="rootContainer",frameBuffer=me.video.getSystemContext(),me.event.publish(me.event.GAME_INIT),me.input._translatePointerEvents(),isDirty=!0,api.currentLevel={pos:{x:0,y:0}},api.defaultCollisionMap=new me.CollisionTiledLayer(0,0),initialized=!0)},api.reset=function(){api.world.destroy(),api.viewport&&api.viewport.reset(),api.currentLevel={pos:{x:0,y:0}},api.collisionMap=api.defaultCollisionMap,frameBuffer.setTransform(1,0,0,1,0,0),frameCounter=0,frameRate=Math.round(60/me.sys.fps)},api.getParentContainer=function(child){return child.ancestor},api.repaint=function(){isDirty=!0},api.update=function(time){0===++frameCounter%frameRate&&(frameCounter=0,me.timer.update(time),isDirty=api.world.update(me.timer.getDelta())||isDirty,isDirty=api.viewport.update(me.timer.getDelta())||isDirty)},api.draw=function(){if(isDirty){var translateX=api.viewport.pos.x+~~api.viewport.offset.x,translateY=api.viewport.pos.y+~~api.viewport.offset.y;api.world.transform.translate(-translateX,-translateY),api.viewport.screenX=translateX-api.currentLevel.pos.x,api.viewport.screenY=translateY-api.currentLevel.pos.y,api.world.draw(frameBuffer,api.viewport),api.world.transform.translate(translateX,translateY),api.viewport.draw(frameBuffer)}isDirty=!1,me.video.blitSurface()},api}()}(),function(){var capitalize=function(str){return str.substring(0,1).toUpperCase()+str.substring(1,str.length)};me.agent=function(){var api={},vendors=["ms","MS","moz","webkit","o"];return api.prefixed=function(name,obj){if(obj=obj||window,name in obj)return obj[name];var uc_name=capitalize(name),result;return vendors.some(function(vendor){var name=vendor+uc_name;return result=name in obj?obj[name]:void 0}),result},api.setPrefixed=function(name,value,obj){if(obj=obj||window,name in obj)return obj[name]=value,void 0;var uc_name=capitalize(name);vendors.some(function(vendor){var name=vendor+uc_name;return name in obj?(obj[name]=value,!0):!1})},api}()}(),function(){me.device=function(){function onDeviceMotion(e){e.reading?(obj.accelerationX=e.reading.accelerationX,obj.accelerationY=e.reading.accelerationY,obj.accelerationZ=e.reading.accelerationZ):(obj.accelerationX=e.accelerationIncludingGravity.x,obj.accelerationY=e.accelerationIncludingGravity.y,obj.accelerationZ=e.accelerationIncludingGravity.z)}function onDeviceRotate(e){obj.gamma=e.gamma,obj.beta=e.beta,obj.alpha=e.alpha}var obj={},accelInitialized=!1,deviceOrientationInitialized=!1,devicePixelRatio=null;return obj._check=function(){me.device._detectDevice(),me.device.pointerEnabled=me.agent.prefixed("pointerEnabled",navigator),navigator.maxTouchPoints=me.agent.prefixed("maxTouchPoints",navigator)||0,window.gesture=me.agent.prefixed("gesture"),me.device.touch="createTouch"in document||"ontouchstart"in window||navigator.isCocoonJS||navigator.maxTouchPoints>0,me.device.hasAccelerometer=window.DeviceMotionEvent!==void 0||window.Windows!==void 0&&"function"==typeof Windows.Devices.Sensors.Accelerometer,this.hasPointerLockSupport=me.agent.prefixed("pointerLockElement",document),this.hasPointerLockSupport&&(document.exitPointerLock=me.agent.prefixed("exitPointerLock",document)),window.DeviceOrientationEvent&&(me.device.hasDeviceOrientation=!0),this.hasFullscreenSupport=me.agent.prefixed("fullscreenEnabled",document)||document.mozFullScreenEnabled,document.exitFullscreen=me.agent.prefixed("cancelFullScreen",document)||me.agent.prefixed("exitFullscreen",document),navigator.vibrate=me.agent.prefixed("vibrate",navigator);try{obj.localStorage=!!window.localStorage}catch(e){obj.localStorage=!1}window.addEventListener("blur",function(){me.sys.stopOnBlur&&me.state.stop(!0),me.sys.pauseOnBlur&&me.state.pause(!0)},!1),window.addEventListener("focus",function(){me.sys.stopOnBlur&&me.state.restart(!0),me.sys.resumeOnFocus&&me.state.resume(!0)},!1);var hidden,visibilityChange;document.hidden!==void 0?(hidden="hidden",visibilityChange="visibilitychange"):document.mozHidden!==void 0?(hidden="mozHidden",visibilityChange="mozvisibilitychange"):document.msHidden!==void 0?(hidden="msHidden",visibilityChange="msvisibilitychange"):document.webkitHidden!==void 0&&(hidden="webkitHidden",visibilityChange="webkitvisibilitychange"),"string"==typeof visibilityChange&&document.addEventListener(visibilityChange,function(){document[hidden]?(me.sys.stopOnBlur&&me.state.stop(!0),me.sys.pauseOnBlur&&me.state.pause(!0)):(me.sys.stopOnBlur&&me.state.restart(!0),me.sys.resumeOnFocus&&me.state.resume(!0))},!1)},obj._detectDevice=function(){me.device.isMobile=me.device.ua.match(/Android|iPhone|iPad|iPod|BlackBerry|Windows Phone|Mobi/i)||!1,me.device.iOS=me.device.ua.match(/iPhone|iPad|iPod/i)||!1,me.device.android=me.device.ua.match(/android/i)||!1,me.device.android2=me.device.ua.match(/android 2/i)||!1,me.device.wp=me.device.ua.match(/Windows Phone/i)||!1},obj.ua=navigator.userAgent,obj.localStorage=!1,obj.hasAccelerometer=!1,obj.hasDeviceOrientation=!1,obj.hasFullscreenSupport=!1,obj.hasPointerLockSupport=!1,obj.nativeBase64="function"==typeof window.atob,obj.touch=!1,obj.isMobile=!1,obj.iOS=!1,obj.android=!1,obj.android2=!1,obj.wp=!1,obj.orientation=0,obj.accelerationX=0,obj.accelerationY=0,obj.accelerationZ=0,obj.gamma=0,obj.beta=0,obj.alpha=0,obj.requestFullscreen=function(element){this.hasFullscreenSupport&&(element=element||me.video.getWrapper(),element.requestFullscreen=me.agent.prefixed("requestFullscreen",element)||element.mozRequestFullScreen,element.requestFullscreen())},obj.exitFullscreen=function(){this.hasFullscreenSupport&&document.exitFullscreen()},obj.getPixelRatio=function(){if(null===devicePixelRatio){var _context=me.video.getScreenContext(),_devicePixelRatio=window.devicePixelRatio||1,_backingStoreRatio=me.agent.prefixed("backingStorePixelRatio",_context)||1;devicePixelRatio=_devicePixelRatio/_backingStoreRatio}return devicePixelRatio},obj.getStorage=function(type){switch(type=type||"local"){case"local":return me.save;default:}throw"melonJS : storage type "+type+" not supported"},obj.turnOnPointerLock=function(){if(this.hasPointerLockSupport){var element=me.video.getWrapper();if(me.device.ua.match(/Firefox/i)){var fullscreenchange=function(){(me.agent.prefixed("fullscreenElement",document)||document.mozFullScreenElement)===element&&(document.removeEventListener("fullscreenchange",fullscreenchange),document.removeEventListener("mozfullscreenchange",fullscreenchange),element.requestPointerLock=me.agent.prefixed("requestPointerLock",element),element.requestPointerLock())};document.addEventListener("fullscreenchange",fullscreenchange,!1),document.addEventListener("mozfullscreenchange",fullscreenchange,!1),me.device.requestFullscreen()}else element.requestPointerLock()}},obj.turnOffPointerLock=function(){this.hasPointerLockSupport&&document.exitPointerLock()},obj.watchAccelerometer=function(){if(me.device.hasAccelerometer){if(!accelInitialized){if("undefined"==typeof Windows)window.addEventListener("devicemotion",onDeviceMotion,!1);else{var accelerometer=Windows.Devices.Sensors.Accelerometer.getDefault();if(accelerometer){var minInterval=accelerometer.minimumReportInterval,Interval=minInterval>=16?minInterval:25;accelerometer.reportInterval=Interval,accelerometer.addEventListener("readingchanged",onDeviceMotion,!1)}}accelInitialized=!0}return!0}return!1},obj.unwatchAccelerometer=function(){if(accelInitialized){if("undefined"==typeof Windows)window.removeEventListener("devicemotion",onDeviceMotion,!1);else{var accelerometer=Windows.Device.Sensors.Accelerometer.getDefault();accelerometer.removeEventListener("readingchanged",onDeviceMotion,!1)}accelInitialized=!1}},obj.watchDeviceOrientation=function(){return me.device.hasDeviceOrientation&&!deviceOrientationInitialized&&(window.addEventListener("deviceorientation",onDeviceRotate,!1),deviceOrientationInitialized=!0),!1},obj.unwatchDeviceOrientation=function(){deviceOrientationInitialized&&(window.removeEventListener("deviceorientation",onDeviceRotate,!1),deviceOrientationInitialized=!1)},obj.vibrate=function(pattern){navigator.vibrate&&navigator.vibrate(pattern)},obj}(),Object.defineProperty(me.device,"isFullscreen",{get:function(){if(me.device.hasFullscreenSupport){var el=me.agent.prefixed("fullscreenElement",document)||document.mozFullScreenElement;return el===me.video.getWrapper()}return!1}}),Object.defineProperty(me.device,"sound",{get:function(){return!Howler.noAudio}})}(),function(){me.timer=function(){var api={},framecount=0,framedelta=0,last=0,now=0,delta=0,step=Math.ceil(1e3/me.sys.fps),minstep=1.25*(1e3/me.sys.fps),timers=[],timerId=0,clearTimer=function(timerId){for(var i=0,len=timers.length;len>i;i++)if(timers[i].timerId===timerId){timers.splice(i,1);break}},updateTimers=function(dt){for(var i=0,len=timers.length;len>i;i++){var _timer=timers[i];_timer.pauseable&&me.state.isPaused()||(_timer.elapsed+=dt),_timer.elapsed>=_timer.delay&&(_timer.func.apply(this),_timer.repeat===!0?_timer.elapsed-=_timer.delay:me.timer.clearTimeout(_timer.timerId))}};return api.tick=1,api.fps=0,api.init=function(){api.reset(),now=last=0},api.reset=function(){last=now=window.performance.now(),delta=0,framedelta=0,framecount=0},api.setTimeout=function(func,delay,pauseable){return timers.push({func:func,delay:delay,elapsed:0,repeat:!1,timerId:++timerId,pauseable:pauseable===!0||!0}),timerId},api.setInterval=function(func,delay,pauseable){return timers.push({func:func,delay:delay,elapsed:0,repeat:!0,timerId:++timerId,pauseable:pauseable===!0||!0}),timerId},api.clearTimeout=function(timeoutID){clearTimer.defer(this,timeoutID)},api.clearInterval=function(intervalID){clearTimer.defer(this,intervalID)},api.getTime=function(){return now},api.getDelta=function(){return delta},api.countFPS=function(){framecount++,framedelta+=delta,0===framecount%10&&(this.fps=(~~(1e3*framecount/framedelta)).clamp(0,me.sys.fps),framedelta=0,framecount=0)},api.update=function(time){return last=now,now=time,delta=now-last,api.tick=delta>minstep&&me.sys.interpolation?delta/step:1,updateTimers(delta),delta},api}()}(),function(){me.pool=function(){var api={},entityClass={};return api.init=function(){api.register("me.ObjectEntity",me.ObjectEntity),api.register("me.CollectableEntity",me.CollectableEntity),api.register("me.LevelEntity",me.LevelEntity),api.register("TileObject",me.SpriteObject),api.register("me.Tween",me.Tween,!0),api.register("me.Color",me.Color,!0),api.register("me.Particle",me.Particle,!0)},api.register=function(className,entityObj,pooling){return pooling?(entityClass[className.toLowerCase()]={"class":entityObj,pool:[]},void 0):(entityClass[className.toLowerCase()]={"class":entityObj,pool:void 0},void 0)},api.pull=function(data){var name="string"==typeof data?data.toLowerCase():void 0,args=Array.prototype.slice.call(arguments);if(name&&entityClass[name]){var proto;if(!entityClass[name].pool)return proto=entityClass[name]["class"],args[0]=proto,new(proto.bind.apply(proto,args));var obj,entity=entityClass[name];return proto=entity["class"],entity.pool.length>0?(obj=entity.pool.pop(),"function"==typeof obj.init&&obj.init.apply(obj,args.slice(1)),"function"==typeof obj.onResetEvent&&obj.onResetEvent.apply(obj,args.slice(1))):(args[0]=proto,obj=new(proto.bind.apply(proto,args)),obj.className=name),obj}return name&&console.error("Cannot instantiate entity of type '"+data+"': Class not found!"),null},api.purge=function(){for(var className in entityClass)entityClass.hasOwnProperty(className)&&(entityClass[className].pool=[])},api.push=function(obj){var name=obj.className;void 0!==name&&entityClass[name]&&entityClass[name].pool.push(obj)},api}()}(),function(){me.Vector2d=Object.extend({x:0,y:0,init:function(x,y){this.x=x||0,this.y=y||0},set:function(x,y){return this.x=x,this.y=y,this},setZero:function(){return this.set(0,0)},setV:function(v){return this.x=v.x,this.y=v.y,this},add:function(v){return this.x+=v.x,this.y+=v.y,this},sub:function(v){return this.x-=v.x,this.y-=v.y,this},scale:function(x,y){return this.x*=x,this.y*=y!==void 0?y:x,this},scaleV:function(v){return this.x*=v.x,this.y*=v.y,this},div:function(n){return this.x/=n,this.y/=n,this},abs:function(){return 0>this.x&&(this.x=-this.x),0>this.y&&(this.y=-this.y),this},clamp:function(low,high){return new me.Vector2d(this.x.clamp(low,high),this.y.clamp(low,high))},clampSelf:function(low,high){return this.x=this.x.clamp(low,high),this.y=this.y.clamp(low,high),this},minV:function(v){return this.x=this.x<v.x?this.x:v.x,this.y=this.y<v.y?this.y:v.y,this},maxV:function(v){return this.x=this.x>v.x?this.x:v.x,this.y=this.y>v.y?this.y:v.y,this},floor:function(){return new me.Vector2d(~~this.x,~~this.y)},floorSelf:function(){return this.x=~~this.x,this.y=~~this.y,this},ceil:function(){return new me.Vector2d(Math.ceil(this.x),Math.ceil(this.y))},ceilSelf:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},negate:function(){return new me.Vector2d(-this.x,-this.y)},negateSelf:function(){return this.x=-this.x,this.y=-this.y,this},copy:function(v){return this.x=v.x,this.y=v.y,this},equals:function(v){return this.x===v.x&&this.y===v.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var len=this.length();if(Number.MIN_VALUE>len)return 0;var invL=1/len;return this.x*=invL,this.y*=invL,len},dotProduct:function(v){return this.x*v.x+this.y*v.y},distance:function(v){return Math.sqrt((this.x-v.x)*(this.x-v.x)+(this.y-v.y)*(this.y-v.y))},angle:function(v){return Math.atan2(v.y-this.y,v.x-this.x)},clone:function(){return new me.Vector2d(this.x,this.y)},toString:function(){return"x:"+this.x+",y:"+this.y}})}(),function(){me.Rect=Object.extend({pos:new me.Vector2d,rangeV:new me.Vector2d,width:0,height:0,hWidth:0,hHeight:0,shapeType:"Rectangle",init:function(v,w,h){this.pos.setV(v),this.rangeV.set(0,0),this.width=w,this.height=h,this.hWidth=~~(w/2),this.hHeight=~~(h/2),Object.defineProperty(this,"left",{get:function(){var x=this.pos.x,xv=x+this.rangeV.x;return xv>x?x:xv},configurable:!0}),Object.defineProperty(this,"right",{get:function(){var x=this.pos.x+this.width,xv=x+this.rangeV.x;return x>xv?x:xv},configurable:!0}),Object.defineProperty(this,"top",{get:function(){var y=this.pos.y,yv=y+this.rangeV.y;return yv>y?y:yv},configurable:!0}),Object.defineProperty(this,"bottom",{get:function(){var y=this.pos.y+this.height,yv=y+this.rangeV.y;return y>yv?y:yv},configurable:!0})},setShape:function(v,w,h){return this.pos.setV(v),this.resize(w,h),this},resize:function(w,h){return this.width=w,this.height=h,this.hWidth=~~(w/2),this.hHeight=~~(h/2),this},getBounds:function(rect){return rect!==void 0?rect.setShape(this.pos,this.width,this.height):this.clone()},clone:function(){return new me.Rect(this.pos,this.width,this.height)},translate:function(x,y){return this.pos.x+=x,this.pos.y+=y,this},translateV:function(v){return this.translate(v.x,v.y)},addV:function(v){return this.rangeV.setV(v),this},union:function(r){var x1=Math.min(this.left,r.left),y1=Math.min(this.top,r.top);return this.resize(Math.max(this.right,r.right)-x1,Math.max(this.bottom,r.bottom)-y1),this.pos.set(x1,y1),this},flipX:function(sw){return this.pos.x=sw-this.width-this.pos.x,this},flipY:function(sh){return this.pos.y=sh-this.height-this.pos.y,this},equals:function(r){return this.left===r.left&&this.right===r.right&&this.top===r.top&&this.bottom===r.bottom},overlaps:function(r){return this.left<r.right&&r.left<this.right&&this.top<r.bottom&&r.top<this.bottom},within:function(r){return r.contains(this)},contains:function(r){return r.left>=this.left&&r.right<=this.right&&r.top>=this.top&&r.bottom<=this.bottom},containsPointV:function(v){return this.containsPoint(v.x,v.y)},containsPoint:function(x,y){return x>=this.left&&this.right>=x&&y>=this.top&&this.bottom>=y},collideWithRectangle:function(rect){var p=new me.Vector2d(0,0);if(this.overlaps(rect)){var dx=this.left+this.hWidth-rect.left-rect.hWidth,dy=this.top+this.hHeight-rect.top-rect.hHeight;p.x=rect.hWidth+this.hWidth-(0>dx?-dx:dx),p.y=rect.hHeight+this.hHeight-(0>dy?-dy:dy),p.x<p.y?(p.y=0,p.x=0>dx?-p.x:p.x):(p.x=0,p.y=0>dy?-p.y:p.y)}return p},draw:function(context,color){context.strokeStyle=color||"red",context.strokeRect(this.left,this.top,this.width,this.height)}})}(),function(){me.Ellipse=Object.extend({pos:new me.Vector2d,radius:new me.Vector2d,shapeType:"Ellipse",init:function(v,w,h){this.setShape(v,w,h)},setShape:function(v,w,h){return this.radius.set(w/2,h/2),this.pos.setV(v).add(this.radius),this},translate:function(x,y){return this.pos.x+=x,this.pos.y+=y,this},translateV:function(v){return this.pos.add(v),this},containsPointV:function(v){return this.containsPoint(v.x,v.y)},containsPoint:function(x,y){return x-=this.pos.x,y-=this.pos.y,1>=x*x/(this.radius.x*this.radius.x)+y*y/(this.radius.y*this.radius.y)},getBounds:function(rect){return rect!==void 0?rect.setShape(this.pos.clone().sub(this.radius),2*this.radius.x,2*this.radius.y):new me.Rect(this.pos.clone().sub(this.radius),2*this.radius.x,2*this.radius.y)},clone:function(){return new me.Ellipse(this.pos,2*this.radius.x,2*this.radius.y)},draw:function(context,color){context.save(),context.beginPath(),context.translate(this.pos.x-this.radius.x,this.pos.y-this.radius.y),context.scale(this.radius.x,this.radius.y),context.arc(1,1,1,0,2*Math.PI,!1),context.restore(),context.strokeStyle=color||"red",context.stroke()}})}(),function(){me.PolyShape=Object.extend({pos:new me.Vector2d,points:null,closed:!1,shapeType:"PolyShape",init:function(v,points,closed){this.setShape(v,points,closed)},setShape:function(v,points,closed){return this.pos.setV(v),this.points=points,this.closed=closed===!0,this.getBounds(),this},translate:function(x,y){return this.pos.x+=x,this.pos.y+=y,this},translateV:function(v){return this.pos.add(v),this},containsPointV:function(v){return this.containsPoint(v.x,v.y)},containsPoint:function(x,y){for(var intersects=!1,posx=this.pos.x,posy=this.pos.y,points=this.points,len=points.length,i=0,j=len-1;len>i;j=i++){var iy=points[i].y+posy,ix=points[i].x+posx,jy=points[j].y+posy,jx=points[j].x+posx;iy>y!=jy>y&&(jx-ix)*(y-iy)/(jy-iy)+ix>x&&(intersects=!intersects)}return intersects},getBounds:function(rect){var pos=this.pos.clone(),right=0,bottom=0;return this.points.forEach(function(point){pos.x=Math.min(pos.x,point.x),pos.y=Math.min(pos.y,point.y),right=Math.max(right,point.x),bottom=Math.max(bottom,point.y)}),rect!==void 0?rect.setShape(pos,right-pos.x,bottom-pos.y):new me.Rect(pos,right-pos.x,bottom-pos.y)},clone:function(){var copy=[];return this.points.forEach(function(point){copy.push(new me.Vector2d(point.x,point.y))}),new me.PolyShape(this.pos.clone(),copy,this.closed)},draw:function(context,color){context.save(),context.translate(-this.pos.x,-this.pos.y),context.strokeStyle=color||"red",context.beginPath(),context.moveTo(this.points[0].x,this.points[0].y),this.points.forEach(function(point){context.lineTo(point.x,point.y),context.moveTo(point.x,point.y)}),this.closed===!0&&context.lineTo(this.points[0].x,this.points[0].y),context.stroke(),context.restore()}})}(),function(){me.Matrix2d=Object.extend({a:1,b:0,c:0,d:1,e:0,f:0,init:function(a,b,c,d,e,f){this.set(a||1,b||0,c||0,d||1,e||0,f||0)},identity:function(){return this.set(1,0,0,1,0,0),this},set:function(a,b,c,d,e,f){return this.a=a,this.b=b,this.c=c,this.d=d,this.e=e!==void 0?e:this.e,this.f=f!==void 0?f:this.f,this},multiply:function(a,b,c,d,e,f){var a1=this.a,b1=this.b,c1=this.c,d1=this.d;return this.a=a*a1+b*c1,this.b=a*b1+b*d1,this.c=c*a1+d*c1,this.d=c*b1+d*d1,this.e=e*a1+f*c1+this.e,this.f=e*b1+f*d1+this.f,this},scale:function(sx,sy){return this.a*=sx,this.d*=sy,this.e*=sx,this.f*=sy,this},rotate:function(angle){if(0!==angle){var cos=Math.cos(angle),sin=Math.sin(angle),a=this.a,b=this.b,c=this.c,d=this.d,e=this.e,f=this.f;this.a=a*cos-b*sin,this.b=a*sin+b*cos,this.c=c*cos-d*sin,this.d=c*sin+d*cos,this.e=e*cos-f*sin,this.f=e*sin+f*cos}return this},translate:function(x,y){return this.e+=x,this.f+=y,this},translateV:function(v){return this.translate(v.x,v.y)},isIdentity:function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},clone:function(){return new me.Matrix2d(this.a,this.b,this.c,this.d,this.e,this.f)}})}(),function(){me.Renderable=me.Rect.extend({isRenderable:!0,GUID:void 0,inViewport:!1,alwaysUpdate:!1,updateWhenPaused:!1,isPersistent:!1,floating:!1,z:0,anchorPoint:new me.Vector2d,alpha:1,init:function(pos,width,height){this.parent(pos,width,height),this.anchorPoint.set(.5,.5),this.setOpacity(1)},getOpacity:function(){return this.alpha},setOpacity:function(alpha){"number"==typeof alpha&&(this.alpha=alpha.clamp(0,1),this.alpha!==this.alpha&&(this.alpha=1))},update:function(){return!1},draw:function(context,color){this.parent(context,color)}})}(),function(){me.SpriteObject=me.Renderable.extend({scale:new me.Vector2d,scaleFlag:!1,lastflipX:!1,lastflipY:!1,z:0,offset:new me.Vector2d,angle:0,_sourceAngle:0,image:null,flickering:!1,flickerDuration:0,flickercb:null,flickerState:!1,init:function(x,y,image,spritewidth,spriteheight){this.isSprite=!0,this.parent(new me.Vector2d(x,y),spritewidth||image.width,spriteheight||image.height),this.image=image,this.scale.set(1,1),this.lastflipX=this.lastflipY=!1,this.scaleFlag=!1,this.offset.set(0,0),this.isPersistent=!1,this.flickering=!1},setTransparency:function(col){col="#"===col.charAt(0)?col.substring(1,7):col,this.image=me.video.applyRGBFilter(this.image,"transparent",col.toUpperCase()).canvas},isFlickering:function(){return this.flickering},flicker:function(duration,callback){this.flickerDuration=duration,0>=this.flickerDuration?(this.flickering=!1,this.flickercb=null):this.flickering||(this.flickercb=callback,this.flickering=!0)},flipX:function(flip){flip!==this.lastflipX&&(this.lastflipX=flip,this.scale.x=-this.scale.x,this.scaleFlag=1!==this.scale.x||1!==this.scale.y)},flipY:function(flip){flip!==this.lastflipY&&(this.lastflipY=flip,this.scale.y=-this.scale.y,this.scaleFlag=1!==this.scale.x||1!==this.scale.y)},resize:function(ratioX,ratioY){var x=ratioX,y=ratioY===void 0?ratioX:ratioY;x>0&&(this.scale.x=0>this.scale.x?-x:x),y>0&&(this.scale.y=0>this.scale.y?-y:y),this.scaleFlag=1!==this.scale.x||1!==this.scale.y},resizeV:function(ratio){this.resize(ratio.x,ratio.y)},update:function(dt){return this.flickering?(this.flickerDuration-=dt,0>this.flickerDuration&&(this.flickercb&&this.flickercb(),this.flicker(-1)),!0):!1},draw:function(context){if(!this.flickering||(this.flickerState=!this.flickerState,this.flickerState)){context.save(),context.globalAlpha*=this.getOpacity();var xpos=~~this.pos.x,ypos=~~this.pos.y,w=this.width,h=this.height,angle=this.angle+this._sourceAngle;if(this.scaleFlag||0!==angle){var ax=w*this.anchorPoint.x,ay=h*this.anchorPoint.y;context.translate(xpos+ax,ypos+ay),this.scaleFlag&&context.scale(this.scale.x,this.scale.y),0!==angle&&context.rotate(angle),0!==this._sourceAngle?(w=this.height,h=this.width,xpos=-ay,ypos=-ax):(xpos=-ax,ypos=-ay)}context.drawImage(this.image,this.offset.x,this.offset.y,w,h,xpos,ypos,w,h),context.restore()}},destroy:function(){this.onDestroyEvent.apply(this,arguments)},onDestroyEvent:function(){}}),me.AnimationSheet=me.SpriteObject.extend({spacing:0,margin:0,animationpause:!1,animationspeed:100,init:function(x,y,image,spritewidth,spriteheight,spacing,margin,atlas,atlasIndices){this.anim={},this.resetAnim=null,this.current=null,this.animationspeed=100,this.spacing=spacing||0,this.margin=margin||0,this.parent(x,y,image,spritewidth,spriteheight,spacing,margin),this.textureAtlas=null,this.atlasIndices=null,this.buildLocalAtlas(atlas,atlasIndices),this.addAnimation("default",null),this.setCurrentAnimation("default")},buildLocalAtlas:function(atlas,indices){if(atlas!==void 0)this.textureAtlas=atlas,this.atlasIndices=indices;else{this.textureAtlas=[];for(var spritecount=new me.Vector2d(~~((this.image.width-this.margin)/(this.width+this.spacing)),~~((this.image.height-this.margin)/(this.height+this.spacing))),frame=0,count=spritecount.x*spritecount.y;count>frame;frame++)this.textureAtlas[frame]={name:""+frame,offset:new me.Vector2d(this.margin+(this.spacing+this.width)*(frame%spritecount.x),this.margin+(this.spacing+this.height)*~~(frame/spritecount.x)),width:this.width,height:this.height,hWidth:this.width/2,hHeight:this.height/2,angle:0}}},addAnimation:function(name,index,animationspeed){if(this.anim[name]={name:name,frame:[],idx:0,length:0,animationspeed:animationspeed||this.animationspeed,nextFrame:0},null==index){index=[];
var j=0;this.textureAtlas.forEach(function(){index[j]=j++})}for(var i=0,len=index.length;len>i;i++)if("number"==typeof index[i])this.anim[name].frame[i]=this.textureAtlas[index[i]];else{if(null===this.atlasIndices)throw"melonjs: string parameters for addAnimation  are only allowed for TextureAtlas ";this.anim[name].frame[i]=this.textureAtlas[this.atlasIndices[index[i]]]}this.anim[name].length=this.anim[name].frame.length},setCurrentAnimation:function(name,resetAnim){if(!this.anim[name])throw"melonJS: animation id '"+name+"' not defined";this.current=this.anim[name],this.resetAnim=resetAnim||null,this.setAnimationFrame(this.current.idx),this.current.nextFrame=this.current.animationspeed},isCurrentAnimation:function(name){return this.current.name===name},setAnimationFrame:function(idx){this.current.idx=(idx||0)%this.current.length;var frame=this.current.frame[this.current.idx];this.offset=frame.offset,this.width=frame.width,this.height=frame.height,this.hWidth=frame.hWidth,this.hHeight=frame.hHeight,this._sourceAngle=frame.angle},getCurrentAnimationFrame:function(){return this.current.idx},update:function(dt){if(!this.animationpause&&(this.current.nextFrame-=dt,0>=this.current.nextFrame)){if(this.setAnimationFrame(++this.current.idx),0===this.current.idx&&this.resetAnim)if("string"==typeof this.resetAnim)this.setCurrentAnimation(this.resetAnim);else if("function"==typeof this.resetAnim&&this.resetAnim()===!1)return this.current.idx=this.current.length-1,this.setAnimationFrame(this.current.idx),this.parent(dt),!1;return this.current.nextFrame=this.current.animationspeed,this.parent(dt)||!0}return this.parent(dt)}})}(),function(){var nhPI=-(Math.PI/2);me.TextureAtlas=Object.extend({format:null,texture:null,atlas:null,init:function(atlas,texture){if(atlas&&atlas.meta){if(atlas.meta.app.contains("texturepacker"))if(this.format="texturepacker",texture===void 0){var name=me.utils.getBasename(atlas.meta.image);if(this.texture=me.loader.getImage(name),null===this.texture)throw"melonjs: Atlas texture '"+name+"' not found"}else this.texture=texture;if(atlas.meta.app.contains("ShoeBox")){if(!atlas.meta.exporter||!atlas.meta.exporter.contains("melonJS"))throw"melonjs: ShoeBox requires the JSON exporter : https://github.com/melonjs/melonJS/tree/master/media/shoebox_JSON_export.sbx";this.format="ShoeBox",this.texture=texture}this.atlas=this.initFromTexturePacker(atlas)}if(null===this.atlas)throw"melonjs: texture atlas format not supported"},initFromTexturePacker:function(data){var atlas={};return data.frames.forEach(function(frame){frame.hasOwnProperty("filename")&&(atlas[frame.filename]={frame:new me.Rect(new me.Vector2d(frame.frame.x,frame.frame.y),frame.frame.w,frame.frame.h),source:new me.Rect(new me.Vector2d(frame.spriteSourceSize.x,frame.spriteSourceSize.y),frame.spriteSourceSize.w,frame.spriteSourceSize.h),rotated:frame.rotated===!0,trimmed:frame.trimmed===!0})}),atlas},getTexture:function(){return this.texture},getRegion:function(name){var region=this.atlas[name];return region?{name:name,pos:region.source.pos.clone(),offset:region.frame.pos.clone(),width:region.frame.width,height:region.frame.height,hWidth:region.frame.width/2,hHeight:region.frame.height/2,angle:region.rotated===!0?nhPI:0}:null},createSpriteFromName:function(name){var region=this.getRegion(name);if(region){var sprite=new me.SpriteObject(0,0,this.getTexture(),region.width,region.height);return sprite.offset.setV(region.offset),sprite._sourceAngle=region.angle,sprite}throw"melonjs: TextureAtlas - region for "+name+" not found"},createAnimationFromName:function(names){for(var tpAtlas=[],indices={},i=0;names.length>i;++i)if(tpAtlas[i]=this.getRegion(names[i]),indices[names[i]]=i,null==tpAtlas[i])throw"melonjs: TextureAtlas - region for "+names[i]+" not found";return new me.AnimationSheet(0,0,this.texture,0,0,0,0,tpAtlas,indices)}})}(),function(){var MIN=Math.min,MAX=Math.max;me.Viewport=me.Renderable.extend({AXIS:{NONE:0,HORIZONTAL:1,VERTICAL:2,BOTH:3},bounds:null,deadzone:null,target:null,follow_axis:0,_shake:null,_fadeIn:null,_fadeOut:null,screenX:0,screenY:0,init:function(minX,minY,maxX,maxY){this.parent(new me.Vector2d(minX,minY),maxX-minX,maxY-minY),this.bounds=new me.Rect(new me.Vector2d(-1/0,-1/0),1/0,1/0),this.offset=new me.Vector2d,this.target=null,this.follow_axis=this.AXIS.NONE,this._shake={intensity:0,duration:0,axis:this.AXIS.BOTH,onComplete:null},this._fadeOut={color:null,duration:0,tween:null},this._fadeIn={color:null,duration:0,tween:null},this.setDeadzone(this.width/6,this.height/6)},_followH:function(target){var _x=this.pos.x;return target.x-this.pos.x>this.deadzone.right?this.pos.x=~~MIN(target.x-this.deadzone.right,this.bounds.width-this.width):target.x-this.pos.x<this.deadzone.pos.x&&(this.pos.x=~~MAX(target.x-this.deadzone.pos.x,this.bounds.pos.x)),_x!==this.pos.x},_followV:function(target){var _y=this.pos.y;return target.y-this.pos.y>this.deadzone.bottom?this.pos.y=~~MIN(target.y-this.deadzone.bottom,this.bounds.height-this.height):target.y-this.pos.y<this.deadzone.pos.y&&(this.pos.y=~~MAX(target.y-this.deadzone.pos.y,this.bounds.pos.y)),_y!==this.pos.y},reset:function(x,y){this.pos.x=x||0,this.pos.y=y||0,this.target=null,this.follow_axis=null},setDeadzone:function(w,h){null===this.deadzone&&(this.deadzone=new me.Rect(new me.Vector2d,0,0)),this.deadzone.pos.set(~~((this.width-w)/2),~~((this.height-h)/2-.25*h)),this.deadzone.resize(w,h),this.updateTarget()},setBounds:function(x,y,w,h){this.bounds.pos.set(x,y),this.bounds.resize(w,h)},follow:function(target,axis){if(target instanceof me.ObjectEntity)this.target=target.pos;else{if(!(target instanceof me.Vector2d))throw"melonJS: invalid target for viewport.follow";this.target=target}this.follow_axis=axis===void 0?this.AXIS.BOTH:axis,this.updateTarget()},move:function(x,y){this.moveTo(~~(this.pos.x+x),~~(this.pos.y+y))},moveTo:function(x,y){this.pos.x=(~~x).clamp(this.bounds.pos.x,this.bounds.width-this.width),this.pos.y=(~~y).clamp(this.bounds.pos.y,this.bounds.height-this.height),me.event.publish(me.event.VIEWPORT_ONCHANGE,[this.pos])},updateTarget:function(){var updated=!1;if(this.target)switch(this.follow_axis){case this.AXIS.NONE:break;case this.AXIS.HORIZONTAL:updated=this._followH(this.target);break;case this.AXIS.VERTICAL:updated=this._followV(this.target);break;case this.AXIS.BOTH:updated=this._followH(this.target),updated=this._followV(this.target)||updated;break;default:}return updated},update:function(dt){var updated=this.updateTarget();return this._shake.duration>0&&(this._shake.duration-=dt,0>=this._shake.duration?(this._shake.duration=0,this.offset.setZero(),"function"==typeof this._shake.onComplete&&this._shake.onComplete()):((this._shake.axis===this.AXIS.BOTH||this._shake.axis===this.AXIS.HORIZONTAL)&&(this.offset.x=(Math.random()-.5)*this._shake.intensity),(this._shake.axis===this.AXIS.BOTH||this._shake.axis===this.AXIS.VERTICAL)&&(this.offset.y=(Math.random()-.5)*this._shake.intensity)),updated=!0),updated===!0&&me.event.publish(me.event.VIEWPORT_ONCHANGE,[this.pos]),(null!=this._fadeIn.tween||null!=this._fadeOut.tween)&&(updated=!0),updated},shake:function(intensity,duration,axis,onComplete){this._shake.duration>0||(this._shake={intensity:intensity,duration:duration,axis:axis||this.AXIS.BOTH,onComplete:onComplete})},fadeOut:function(color,duration,onComplete){this._fadeOut.color=me.pool.pull("me.Color").parseHex(color),this._fadeOut.color.alpha=1,this._fadeOut.duration=duration||1e3,this._fadeOut.tween=me.pool.pull("me.Tween",this._fadeOut.color).to({alpha:0},this._fadeOut.duration).onComplete(onComplete||null),this._fadeOut.tween.start()},fadeIn:function(color,duration,onComplete){this._fadeIn.color=me.pool.pull("me.Color").parseHex(color),this._fadeIn.color.alpha=0,this._fadeIn.duration=duration||1e3,this._fadeIn.tween=me.pool.pull("me.Tween",this._fadeIn.color).to({alpha:1},this._fadeIn.duration).onComplete(onComplete||null),this._fadeIn.tween.start()},getWidth:function(){return this.width},getHeight:function(){return this.height},focusOn:function(target){var bounds=target.getBounds();this.moveTo(target.pos.x+bounds.pos.x+bounds.hWidth,target.pos.y+bounds.pos.y+bounds.hHeight)},isVisible:function(rect){return rect.overlaps(this)},localToWorld:function(x,y,v){return v=v||new me.Vector2d,v.set(x,y).add(this.pos).sub(me.game.currentLevel.pos)},worldToLocal:function(x,y,v){return v=v||new me.Vector2d,v.set(x,y).sub(this.pos).add(me.game.currentLevel.pos)},draw:function(context){this._fadeIn.tween&&(me.video.clearSurface(context,this._fadeIn.color.toRGBA()),1===this._fadeIn.color.alpha&&(this._fadeIn.tween=null,me.pool.push(this._fadeIn.color),this._fadeIn.color=null)),this._fadeOut.tween&&(me.video.clearSurface(context,this._fadeOut.color.toRGBA()),0===this._fadeOut.color.alpha&&(this._fadeOut.tween=null,me.pool.push(this._fadeOut.color),this._fadeOut.color=null))}})}(),function(){me.GUI_Object=me.SpriteObject.extend({holdTimeout:null,holdThreshold:250,isHoldable:!1,isClickable:!0,updated:!1,released:!0,init:function(x,y,settings){this.parent(x,y,"string"==typeof settings.image?me.loader.getImage(settings.image):settings.image,settings.spritewidth,settings.spriteheight),this.floating=!0,me.input.registerPointerEvent("pointerdown",this,this.clicked.bind(this)),me.input.registerPointerEvent("pointerup",this,this.release.bind(this))},update:function(){return this.updated?(this.released||(this.updated=!1),!0):!1},clicked:function(event){return this.isClickable?(this.updated=!0,this.isHoldable&&(null!==this.holdTimeout&&me.timer.clearTimeout(this.holdTimeout),this.holdTimeout=me.timer.setTimeout(this.hold.bind(this),this.holdThreshold,!1),this.released=!1),this.onClick(event)):void 0},onClick:function(){return!1},release:function(event){return this.released=!0,me.timer.clearTimeout(this.holdTimeout),this.onRelease(event)},onRelease:function(){return!1},hold:function(){me.timer.clearTimeout(this.holdTimeout),this.released||this.onHold()},onHold:function(){},onDestroyEvent:function(){me.input.releasePointerEvent("pointerdown",this),me.input.releasePointerEvent("pointerup",this),me.timer.clearTimeout(this.holdTimeout)}})}(),function(){var deferredRemove=function(child,keepalive){child.ancestor&&child.ancestor.removeChildNow(child,keepalive)},globalTranslation=new me.Rect(new me.Vector2d,0,0),globalFloatingCounter=0;me.ObjectContainer=me.Renderable.extend({sortOn:"z",autoSort:!0,pendingSort:null,children:null,bounds:null,collidable:!0,transform:new me.Matrix2d,init:function(x,y,width,height){this.parent(new me.Vector2d(x||0,y||0),width||1/0,height||1/0),this.bounds=new me.Rect(new me.Vector2d(0,0),0,0),this.children=[],this.sortOn=me.game.sortOn,this.autoSort=!0,this.transform.identity()},addChild:function(child,zIndex){child.ancestor!==void 0?child.ancestor.removeChildNow(child):child.isRenderable&&(child.GUID=me.utils.createGUID()),"number"==typeof zIndex&&(child.z=zIndex),child.z===void 0&&(child.z=this.children.length),child.ancestor=this,this.children.push(child),this.autoSort===!0&&this.sort()},addChildAt:function(child,index){if(!(index>=0&&this.children.length>index))throw"melonJS (me.ObjectContainer): Index ("+index+") Out Of Bounds for addChildAt()";child.ancestor!==void 0?child.ancestor.removeChildNow(child):child.isRenderable&&(child.GUID=me.utils.createGUID()),child.ancestor=this,this.children.splice(index,0,child)},swapChildren:function(child,child2){var index=this.getChildIndex(child),index2=this.getChildIndex(child2);if(-1===index||-1===index2)throw"melonJS (me.ObjectContainer): "+child+" Both the supplied childs must be a child of the caller "+this;var _z=child.z;child.z=child2.z,child2.z=_z,this.children[index]=child2,this.children[index2]=child},getChildAt:function(index){if(index>=0&&this.children.length>index)return this.children[index];throw"melonJS (me.ObjectContainer): Index ("+index+") Out Of Bounds for getChildAt()"},getChildIndex:function(child){return this.children.indexOf(child)},hasChild:function(child){return this===child.ancestor},getChildByProp:function(prop,value){function compare(obj,prop){"string"==typeof obj[prop]?obj[prop].match(_regExp)&&objList.push(obj):obj[prop]===value&&objList.push(obj)}for(var objList=[],_regExp=RegExp(value,"i"),i=this.children.length,obj;i--,obj=this.children[i];)obj instanceof me.ObjectContainer?(compare(obj,prop),objList=objList.concat(obj.getChildByProp(prop,value))):compare(obj,prop);return objList},getChildByName:function(name){return this.getChildByProp("name",name)},getChildByGUID:function(guid){var obj=this.getChildByProp("GUID",guid);return obj.length>0?obj[0]:null},getBounds:function(rect){var _bounds=rect!==void 0?rect:this.bounds;_bounds.pos.set(1/0,1/0),_bounds.resize(-1/0,-1/0);for(var childBounds,i=this.children.length,child;i--,child=this.children[i];)child.isRenderable&&(childBounds=child.getBounds(),null!==childBounds&&_bounds.union(childBounds));return _bounds},removeChild:function(child,keepalive){child.ancestor&&deferredRemove.defer(this,child,keepalive)},removeChildNow:function(child,keepalive){if(!this.hasChild(child))throw"melonJS (me.ObjectContainer): "+child+" The supplied child must be a child of the caller "+this;child.ancestor=void 0,keepalive||("function"==typeof child.destroy&&child.destroy(),me.pool.push(child)),this.children.splice(this.getChildIndex(child),1)},setChildsProperty:function(prop,val,recursive){for(var i=this.children.length,obj;i--,obj=this.children[i];)recursive===!0&&obj instanceof me.ObjectContainer&&obj.setChildsProperty(prop,val,recursive),obj[prop]=val},moveUp:function(child){var childIndex=this.getChildIndex(child);childIndex-1>=0&&this.swapChildren(child,this.getChildAt(childIndex-1))},moveDown:function(child){var childIndex=this.getChildIndex(child);this.children.length>childIndex+1&&this.swapChildren(child,this.getChildAt(childIndex+1))},moveToTop:function(child){var childIndex=this.getChildIndex(child);childIndex>0&&(this.children.splice(0,0,this.children.splice(childIndex,1)[0]),child.z=this.children[1].z+1)},moveToBottom:function(child){var childIndex=this.getChildIndex(child);this.children.length-1>childIndex&&(this.children.splice(this.children.length-1,0,this.children.splice(childIndex,1)[0]),child.z=this.children[this.children.length-2].z-1)},collide:function(objA,multiple){return this.collideType(objA,null,multiple)},collideType:function(objA,type,multiple){var res,mres;multiple=multiple===!0?!0:!1,multiple===!0&&(mres=[]);for(var i=this.children.length,obj;i--,obj=this.children[i];)if((obj.inViewport||obj.alwaysUpdate)&&obj.collidable)if(obj instanceof me.ObjectContainer){if(res=obj.collideType(objA,type,multiple),multiple)mres.concat(res);else if(res)return res}else if(obj!==objA&&(!type||obj.type===type)&&(this._boundsA=obj.getBounds(this._boundsA).translateV(obj.pos),this._boundsB=objA.getBounds(this._boundsB).translateV(objA.pos),res=this._boundsA["collideWith"+this._boundsB.shapeType].call(this._boundsA,this._boundsB),0!==res.x||0!==res.y)){if(obj.onCollision.call(obj,res,objA),res.type=obj.type,res.obj=obj,!multiple)return res;mres.push(res)}return multiple?mres:null},sort:function(recursive){if(null===this.pendingSort){if(recursive===!0)for(var i=this.children.length,obj;i--,obj=this.children[i];)obj instanceof me.ObjectContainer&&obj.sort(recursive);this.pendingSort=function(self){self.children.sort(self["_sort"+self.sortOn.toUpperCase()]),self.pendingSort=null,me.game.repaint()}.defer(this,this)}},_sortZ:function(a,b){return b.z-a.z},_sortX:function(a,b){var result=b.z-a.z;return result?result:(b.pos&&b.pos.x)-(a.pos&&a.pos.x)||0},_sortY:function(a,b){var result=b.z-a.z;return result?result:(b.pos&&b.pos.y)-(a.pos&&a.pos.y)||0},destroy:function(){this.pendingSort&&(clearTimeout(this.pendingSort),this.pendingSort=null);for(var i=this.children.length,obj;i--,obj=this.children[i];)obj.isPersistent||this.removeChildNow(obj);this.transform.identity()},update:function(dt){for(var isDirty=!1,isFloating=!1,isPaused=me.state.isPaused(),isTranslated,x,y,viewport=me.game.viewport,i=this.children.length,obj;i--,obj=this.children[i];)(!isPaused||obj.updateWhenPaused)&&(obj.isRenderable?(isFloating=globalFloatingCounter>0||obj.floating,isFloating&&globalFloatingCounter++,isTranslated=!isFloating,isTranslated&&(x=obj.pos.x,y=obj.pos.y,globalTranslation.translateV(obj.pos),globalTranslation.resize(obj.width,obj.height)),obj.inViewport=isFloating||viewport.isVisible(globalTranslation),isDirty|=(obj.inViewport||obj.alwaysUpdate)&&obj.update(dt),isTranslated&&globalTranslation.translate(-x,-y),globalFloatingCounter>0&&globalFloatingCounter--):isDirty|=obj.update(dt));return isDirty},draw:function(context,rect){var viewport=me.game.viewport,isFloating=!1;this.drawCount=0,context.save(),context.transform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.e,this.transform.f),context.globalAlpha*=this.getOpacity(),context.translate(this.pos.x,this.pos.y);for(var i=this.children.length,obj;i--,obj=this.children[i];)isFloating=obj.floating,(obj.inViewport||isFloating)&&obj.isRenderable&&(isFloating===!0&&(context.save(),context.translate(viewport.screenX-this.pos.x,viewport.screenY-this.pos.y)),obj.draw(context,rect),isFloating===!0&&context.restore(),this.drawCount++);context.restore()}})}(),function(){me.ObjectSettings={name:null,image:null,transparent_color:null,spritewidth:null,spriteheight:null,type:0,collidable:!0},me.ObjectEntity=me.Renderable.extend({type:0,collidable:!0,shapes:[],shapeIndex:0,renderable:null,lastflipX:!1,lastflipY:!1,init:function(x,y,settings){if("number"!=typeof settings.width||"number"!=typeof settings.height)throw"melonjs: height and width properties are mandatory when passing settings parameters to an object entity";if(this.parent(this.pos.set(x,y),settings.width,settings.height),settings.image){var image="object"==typeof settings.image?settings.image:me.loader.getImage(settings.image);this.renderable=new me.AnimationSheet(0,0,image,~~(settings.spritewidth||settings.width),~~(settings.spriteheight||settings.height),~~settings.spacing,~~settings.margin),settings.transparent_color&&this.renderable.setTransparency(settings.transparent_color)}this.name=settings.name?settings.name.toLowerCase():"",this.vel===void 0&&(this.vel=new me.Vector2d),this.vel.set(0,0),this.accel===void 0&&(this.accel=new me.Vector2d),this.accel.set(0,0),this.friction===void 0&&(this.friction=new me.Vector2d),this.friction.set(0,0),this.maxVel===void 0&&(this.maxVel=new me.Vector2d),this.maxVel.set(1e3,1e3),this.gravity=me.sys.gravity!==void 0?me.sys.gravity:.98,this.alive=!0,this.falling=!1,this.jumping=!0,this.slopeY=0,this.onslope=!1,this.onladder=!1,this.disableTopLadderCollision=!1,this.collidable=settings.collidable!==void 0?settings.collidable:!0,this.type=settings.type||0,this.lastflipX=this.lastflipY=!1,this.collisionMap=me.game.collisionMap,this.canBreakTile=!1,this.onTileBreak=null,"function"==typeof settings.getShape&&(this.addShape(settings.getShape()),"PolyShape"===this.getShape().shapeType&&(this._bounds=this.getBounds(),this.resize(this._bounds.width,this._bounds.height)))},addShape:function(shape){this.shapes.push(shape)},getShape:function(){return this.shapes[this.shapeIndex]},setShape:function(index){if(this.shapes[index]!==void 0)return this.shapeIndex=index,void 0;throw"melonJS (me.Entity): Shape ("+index+") not defined"},onCollision:function(){this.collidable&&this.type===me.game.COLLECTABLE_OBJECT&&me.game.world.removeChild(this)},setVelocity:function(x,y){this.accel.x=0!==x?x:this.accel.x,this.accel.y=0!==y?y:this.accel.y,this.setMaxVelocity(x,y)},setMaxVelocity:function(x,y){this.maxVel.x=x,this.maxVel.y=y},setFriction:function(x,y){this.friction.x=x||0,this.friction.y=y||0},flipX:function(flip){flip!==this.lastflipX&&(this.lastflipX=flip,this.renderable&&this.renderable.flipX&&this.renderable.flipX(flip),this.shapes.length&&"function"==typeof this.getShape().flipX&&this.getShape().flipX(this.width))},flipY:function(flip){flip!==this.lastflipY&&(this.lastflipY=flip,this.renderable&&this.renderable.flipY&&this.renderable.flipY(flip),this.shapes.length&&"function"==typeof this.getShape().flipY&&this.getShape().flipY(this.height))},distanceTo:function(e){var dx=this.pos.x+this.hWidth-(e.pos.x+e.hWidth),dy=this.pos.y+this.hHeight-(e.pos.y+e.hHeight);return Math.sqrt(dx*dx+dy*dy)},distanceToPoint:function(v){var dx=this.pos.x+this.hWidth-v.x,dy=this.pos.y+this.hHeight-v.y;return Math.sqrt(dx*dx+dy*dy)},angleTo:function(e){var ax=e.pos.x+e.hWidth-(this.pos.x+this.hWidth),ay=e.pos.y+e.hHeight-(this.pos.y+this.hHeight);return Math.atan2(ay,ax)},angleToPoint:function(v){var ax=v.x-(this.pos.x+this.hWidth),ay=v.y-(this.pos.y+this.hHeight);return Math.atan2(ay,ax)},checkSlope:function(rect,tile,left){rect.pos.y=tile.pos.y-rect.height,this.slopeY=left?tile.height-(rect.right+this.vel.x-tile.pos.x):rect.left+this.vel.x-tile.pos.x,this.vel.y=0,rect.pos.y+=this.slopeY.clamp(0,tile.height)},computeVelocity:function(vel){this.gravity&&(vel.y+=this.onladder?0:this.gravity*me.timer.tick,this.falling=vel.y>0,this.jumping=this.falling?!1:this.jumping),this.friction.x&&(vel.x=me.utils.applyFriction(vel.x,this.friction.x)),this.friction.y&&(vel.y=me.utils.applyFriction(vel.y,this.friction.y)),0!==vel.y&&(vel.y=vel.y.clamp(-this.maxVel.y,this.maxVel.y)),0!==vel.x&&(vel.x=vel.x.clamp(-this.maxVel.x,this.maxVel.x))},updateMovement:function(){this.computeVelocity(this.vel);var collision;if(this.collidable){this._bounds=this.getBounds(this._bounds),this.__offsetX=this._bounds.pos.x,this.__offsetY=this._bounds.pos.y,this._bounds.translateV(this.pos),collision=this.collisionMap.checkCollision(this._bounds,this.vel),this.onslope=collision.yprop.isSlope||collision.xprop.isSlope,this.onladder=!1;var prop=collision.yprop,tile=collision.ytile;collision.y&&(this.onladder=prop.isLadder||prop.isTopLadder,collision.y>0?prop.isSolid||prop.isPlatform&&this._bounds.bottom-1<=tile.pos.y||prop.isTopLadder&&!this.disableTopLadderCollision?(this._bounds.pos.y=~~this._bounds.pos.y,this.vel.y=this.falling?tile.pos.y-this._bounds.bottom:0,this.falling=!1):prop.isSlope&&!this.jumping?(this.checkSlope(this._bounds,tile,prop.isLeftSlope),this.falling=!1):prop.isBreakable&&(this.canBreakTile?(me.game.currentLevel.clearTile(tile.col,tile.row),this.onTileBreak&&this.onTileBreak()):(this._bounds.pos.y=~~this._bounds.pos.y,this.vel.y=this.falling?tile.pos.y-this._bounds.bottom:0,this.falling=!1)):0>collision.y&&(prop.isPlatform||prop.isLadder||prop.isTopLadder||(this.gravity&&(this.falling=!0),this.vel.y=0))),prop=collision.xprop,tile=collision.xtile,collision.x&&(this.onladder=prop.isLadder||prop.isTopLadder,prop.isSlope&&!this.jumping?(this.checkSlope(this._bounds,tile,prop.isLeftSlope),this.falling=!1):prop.isPlatform||prop.isLadder||prop.isTopLadder||(prop.isBreakable&&this.canBreakTile?(me.game.currentLevel.clearTile(tile.col,tile.row),this.onTileBreak&&this.onTileBreak()):this.vel.x=0)),this.pos.set(this._bounds.pos.x-this.__offsetX,this._bounds.pos.y-this.__offsetY)}return this.pos.add(this.vel),collision},update:function(dt){return this.renderable?this.renderable.update(dt):!1},getBounds:function(rect){return this.shapes.length||this.addShape(this.parent().translate(-this.pos.x,-this.pos.y)),this.getShape().getBounds(rect)},draw:function(context){if(this.renderable){var bounds=this;this.shapes.length&&"PolyShape"===this.getShape().shapeType&&(bounds=this.getBounds(this._bounds).translateV(this.pos));var x=~~(bounds.pos.x+this.anchorPoint.x*(bounds.width-this.renderable.width)),y=~~(bounds.pos.y+this.anchorPoint.y*(bounds.height-this.renderable.height));context.translate(x,y),this.renderable.draw(context),context.translate(-x,-y)}},destroy:function(){this.renderable&&(this.renderable.destroy.apply(this.renderable,arguments),this.renderable=null),this.onDestroyEvent.apply(this,arguments),this.shapes=[],this.shapeIndex=0},onDestroyEvent:function(){}}),me.CollectableEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.type=me.game.COLLECTABLE_OBJECT}}),me.LevelEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.nextlevel=settings.to,this.fade=settings.fade,this.duration=settings.duration,this.fading=!1,this.gotolevel=settings.to},onFadeComplete:function(){me.levelDirector.loadLevel(this.gotolevel),me.game.viewport.fadeOut(this.fade,this.duration)},goTo:function(level){this.gotolevel=level||this.nextlevel,this.fade&&this.duration?this.fading||(this.fading=!0,me.game.viewport.fadeIn(this.fade,this.duration,this.onFadeComplete.bind(this))):me.levelDirector.loadLevel(this.gotolevel)},onCollision:function(){this.goTo()}})}(),function(){me.ScreenObject=Object.extend({init:function(){},reset:function(){me.game.reset(),this.onResetEvent.apply(this,arguments)},destroy:function(){this.onDestroyEvent.apply(this,arguments)},onResetEvent:function(){},onDestroyEvent:function(){}}),function(){var lastTime=0,requestAnimationFrame=me.agent.prefixed("requestAnimationFrame"),cancelAnimationFrame=me.agent.prefixed("cancelAnimationFrame")||me.agent.prefixed("cancelRequestAnimationFrame");requestAnimationFrame&&cancelAnimationFrame||(requestAnimationFrame=function(callback){var currTime=window.performance.now(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id},cancelAnimationFrame=function(id){window.clearTimeout(id)}),window.requestAnimationFrame=requestAnimationFrame,window.cancelAnimationFrame=cancelAnimationFrame}(),me.state=function(){function _startRunLoop(){-1===_animFrameId&&-1!==_state&&(me.timer.reset(),_animFrameId=window.requestAnimationFrame(_renderFrame))}function _resumeRunLoop(){_isPaused&&-1!==_state&&(me.timer.reset(),_isPaused=!1)}function _pauseRunLoop(){_isPaused=!0}function _renderFrame(time){me.game.update(time),me.game.draw(),-1!==_animFrameId&&(_animFrameId=window.requestAnimationFrame(_renderFrame))}function _stopRunLoop(){window.cancelAnimationFrame(_animFrameId),_animFrameId=-1}function _switchState(state){_stopRunLoop(),_screenObject[_state]&&_screenObject[_state].screen.destroy(),_screenObject[state]&&(_state=state,_screenObject[_state].screen.reset.apply(_screenObject[_state].screen,_extraArgs),_startRunLoop(),_onSwitchComplete&&_onSwitchComplete(),me.game.repaint())}var obj={},_state=-1,_animFrameId=-1,_isPaused=!1,_screenObject={},_fade={color:"",duration:0},_onSwitchComplete=null,_extraArgs=null,_pauseTime=0;return obj.LOADING=0,obj.MENU=1,obj.READY=2,obj.PLAY=3,obj.GAMEOVER=4,obj.GAME_END=5,obj.SCORE=6,obj.CREDITS=7,obj.SETTINGS=8,obj.USER=100,obj.onPause=null,obj.onResume=null,obj.onStop=null,obj.onRestart=null,obj.init=function(){obj.set(obj.LOADING,new me.DefaultLoadingScreen)},obj.stop=function(music){_state!==obj.LOADING&&obj.isRunning()&&(_stopRunLoop(),music===!0&&me.audio.pauseTrack(),_pauseTime=window.performance.now(),me.event.publish(me.event.STATE_STOP),"function"==typeof obj.onStop&&obj.onStop())},obj.pause=function(music){_state===obj.LOADING||obj.isPaused()||(_pauseRunLoop(),music===!0&&me.audio.pauseTrack(),_pauseTime=window.performance.now(),me.event.publish(me.event.STATE_PAUSE),"function"==typeof obj.onPause&&obj.onPause())},obj.restart=function(music){obj.isRunning()||(_startRunLoop(),music===!0&&me.audio.resumeTrack(),_pauseTime=window.performance.now()-_pauseTime,me.game.repaint(),me.event.publish(me.event.STATE_RESTART,[_pauseTime]),"function"==typeof obj.onRestart&&obj.onRestart())},obj.resume=function(music){obj.isPaused()&&(_resumeRunLoop(),music===!0&&me.audio.resumeTrack(),_pauseTime=window.performance.now()-_pauseTime,me.event.publish(me.event.STATE_RESUME,[_pauseTime]),"function"==typeof obj.onResume&&obj.onResume())},obj.isRunning=function(){return-1!==_animFrameId},obj.isPaused=function(){return _isPaused},obj.set=function(state,so){_screenObject[state]={},_screenObject[state].screen=so,_screenObject[state].transition=!0},obj.current=function(){return _screenObject[_state].screen},obj.transition=function(effect,color,duration){"fade"===effect&&(_fade.color=color,_fade.duration=duration)},obj.setTransition=function(state,enable){_screenObject[state].transition=enable},obj.change=function(state){if(_screenObject[state]===void 0)throw"melonJS : Undefined ScreenObject for state '"+state+"'";_extraArgs=null,arguments.length>1&&(_extraArgs=Array.prototype.slice.call(arguments,1)),_fade.duration&&_screenObject[state].transition?(_onSwitchComplete=function(){me.game.viewport.fadeOut(_fade.color,_fade.duration)},me.game.viewport.fadeIn(_fade.color,_fade.duration,function(){_switchState.defer(this,state)})):_switchState.defer(this,state)},obj.isCurrent=function(state){return _state===state},obj}()}(),function(){var ProgressBar=me.Renderable.extend({invalidate:!1,barHeight:4,progress:0,onProgressUpdate:function(progress){this.progress=Math.floor(progress*this.width),this.invalidate=!0},update:function(){return this.invalidate===!0?(this.invalidate=!1,!0):!1},draw:function(context){context.fillStyle="black",context.fillRect(0,this.height/2-this.barHeight/2,this.width,this.barHeight),context.fillStyle="#55aa00",context.fillRect(2,this.height/2-this.barHeight/2,this.progress,this.barHeight)}}),IconLogo=me.Renderable.extend({init:function(x,y){this.parent(new me.Vector2d(x,y),100,85)},draw:function(context){context.save(),context.translate(this.pos.x,this.pos.y),context.beginPath(),context.moveTo(.7,48.9),context.bezierCurveTo(10.8,68.9,38.4,75.8,62.2,64.5),context.bezierCurveTo(86.1,53.1,97.2,27.7,87,7.7),context.lineTo(87,7.7),context.bezierCurveTo(89.9,15.4,73.9,30.2,50.5,41.4),context.bezierCurveTo(27.1,52.5,5.2,55.8,.7,48.9),context.lineTo(.7,48.9),context.lineTo(.7,48.9),context.closePath(),context.fillStyle="rgb(255, 255, 255)",context.fill(),context.beginPath(),context.moveTo(84,7),context.bezierCurveTo(87.6,14.7,72.5,30.2,50.2,41.6),context.bezierCurveTo(27.9,53,6.9,55.9,3.2,48.2),context.bezierCurveTo(-.5,40.4,14.6,24.9,36.9,13.5),context.bezierCurveTo(59.2,2.2,80.3,-.8,84,7),context.lineTo(84,7),context.closePath(),context.lineWidth=5.3,context.strokeStyle="rgb(255, 255, 255)",context.lineJoin="miter",context.miterLimit=4,context.stroke(),context.restore()}}),TextLogo=me.Renderable.extend({init:function(w,h){this.parent(new me.Vector2d,w,h),this.logo1=new me.Font("century gothic",32,"white","middle"),this.logo2=new me.Font("century gothic",32,"#55aa00","middle"),this.logo2.bold(),this.logo1.textBaseline=this.logo2.textBaseline="alphabetic"},draw:function(context){var logo1_width=this.logo1.measureText(context,"melon").width,xpos=(this.width-logo1_width-this.logo2.measureText(context,"JS").width)/2,ypos=this.height/2+this.logo2.measureText(context,"melon").height;this.logo1.draw(context,"melon",xpos,ypos),xpos+=logo1_width,this.logo2.draw(context,"JS",xpos,ypos)}});me.DefaultLoadingScreen=me.ScreenObject.extend({onResetEvent:function(){me.game.reset(),me.game.world.addChild(new me.ColorLayer("background","#202020",0));var progressBar=new ProgressBar(new me.Vector2d,me.video.getWidth(),me.video.getHeight());this.handle=me.event.subscribe(me.event.LOADER_PROGRESS,progressBar.onProgressUpdate.bind(progressBar)),me.game.world.addChild(progressBar,1);var icon=new IconLogo((me.video.getWidth()-100)/2,me.video.getHeight()/2-progressBar.barHeight/2-90);me.game.world.addChild(icon,1),me.game.world.addChild(new TextLogo(me.video.getWidth(),me.video.getHeight()),1)},onDestroyEvent:function(){this.handle&&(me.event.unsubscribe(this.handle),this.handle=null)}})}(),function(){me.loader=function(){function checkLoadStatus(){loadCount===resourceCount?obj.onload?(clearTimeout(timerId),setTimeout(function(){obj.onload(),me.event.publish(me.event.LOADER_COMPLETE)},300)):console.error("no load callback defined"):timerId=setTimeout(checkLoadStatus,100)}function preloadImage(img,onload,onerror){imgList[img.name]=new Image,imgList[img.name].onload=onload,imgList[img.name].onerror=onerror,imgList[img.name].src=img.src+obj.nocache
}function preloadTMX(tmxData,onload,onerror){function addToTMXList(data,format){tmxList[tmxData.name]={data:data,isTMX:"tmx"===tmxData.type,format:format}}if("tmx"===tmxData.type&&me.levelDirector.addTMXLevel(tmxData.name),tmxData.data)return addToTMXList(tmxData.data,tmxData.format),onload(),void 0;var xmlhttp=new XMLHttpRequest,format=me.utils.getFileExtension(tmxData.src).toLowerCase();xmlhttp.overrideMimeType&&("json"===format?xmlhttp.overrideMimeType("application/json"):xmlhttp.overrideMimeType("text/xml")),xmlhttp.open("GET",tmxData.src+obj.nocache,!0),xmlhttp.ontimeout=onerror,xmlhttp.onreadystatechange=function(){if(4===xmlhttp.readyState)if(200===xmlhttp.status||0===xmlhttp.status&&xmlhttp.responseText){var result=null;switch(format){case"xml":case"tmx":result=me.device.ua.match(/msie/i)||!xmlhttp.responseXML?(new DOMParser).parseFromString(xmlhttp.responseText,"text/xml"):xmlhttp.responseXML,result=me.TMXUtils.parse(result).map,format="json";break;case"json":result=JSON.parse(xmlhttp.responseText);break;default:throw"melonJS: TMX file format "+format+"not supported !"}addToTMXList(result,format),onload()}else onerror()},xmlhttp.send(null)}function preloadJSON(data,onload,onerror){var xmlhttp=new XMLHttpRequest;xmlhttp.overrideMimeType&&xmlhttp.overrideMimeType("application/json"),xmlhttp.open("GET",data.src+obj.nocache,!0),xmlhttp.ontimeout=onerror,xmlhttp.onreadystatechange=function(){4===xmlhttp.readyState&&(200===xmlhttp.status||0===xmlhttp.status&&xmlhttp.responseText?(jsonList[data.name]=JSON.parse(xmlhttp.responseText),onload()):onerror())},xmlhttp.send(null)}function preloadBinary(data,onload,onerror){var httpReq=new XMLHttpRequest;httpReq.open("GET",data.src+obj.nocache,!0),httpReq.responseType="arraybuffer",httpReq.onerror=onerror,httpReq.onload=function(){var arrayBuffer=httpReq.response;if(arrayBuffer){for(var byteArray=new Uint8Array(arrayBuffer),buffer=[],i=0;byteArray.byteLength>i;i++)buffer[i]=String.fromCharCode(byteArray[i]);binList[data.name]=buffer.join(""),onload()}},httpReq.send()}var obj={},imgList={},tmxList={},binList={},jsonList={},resourceCount=0,loadCount=0,timerId=0;return obj.nocache="",obj.onload=void 0,obj.onProgress=void 0,obj.onResourceLoaded=function(res){loadCount++;var progress=obj.getLoadProgress();obj.onProgress&&obj.onProgress(progress,res),me.event.publish(me.event.LOADER_PROGRESS,[progress,res])},obj.onLoadingError=function(res){throw"melonJS: Failed loading resource "+res.src},obj.setNocache=function(enable){obj.nocache=enable?"?"+parseInt(1e7*Math.random(),10):""},obj.preload=function(res){for(var i=0;res.length>i;i++)resourceCount+=obj.load(res[i],obj.onResourceLoaded.bind(obj,res[i]),obj.onLoadingError.bind(obj,res[i]));checkLoadStatus()},obj.load=function(res,onload,onerror){switch(res.name=res.name.toLowerCase(),res.type){case"binary":return preloadBinary.call(this,res,onload,onerror),1;case"image":return preloadImage.call(this,res,onload,onerror),1;case"json":return preloadJSON.call(this,res,onload,onerror),1;case"tmx":case"tsx":return preloadTMX.call(this,res,onload,onerror),1;case"audio":return me.audio.load(res,onload,onerror),1;default:throw"melonJS: me.loader.load : unknown or invalid resource type : "+res.type}return 0},obj.unload=function(res){switch(res.name=res.name.toLowerCase(),res.type){case"binary":return res.name in binList?(delete binList[res.name],!0):!1;case"image":return res.name in imgList?("function"==typeof imgList[res.name].dispose&&imgList[res.name].dispose(),delete imgList[res.name],!0):!1;case"json":return res.name in jsonList?(delete jsonList[res.name],!0):!1;case"tmx":case"tsx":return res.name in tmxList?(delete tmxList[res.name],!0):!1;case"audio":return me.audio.unload(res.name);default:throw"melonJS: me.loader.unload : unknown or invalid resource type : "+res.type}},obj.unloadAll=function(){var name;for(name in binList)binList.hasOwnProperty(name)&&obj.unload({name:name,type:"binary"});for(name in imgList)imgList.hasOwnProperty(name)&&obj.unload({name:name,type:"image"});for(name in tmxList)tmxList.hasOwnProperty(name)&&obj.unload({name:name,type:"tmx"});for(name in jsonList)jsonList.hasOwnProperty(name)&&obj.unload({name:name,type:"json"});me.audio.unloadAll()},obj.getTMX=function(elt){return elt=""+elt,elt=elt.toLowerCase(),elt in tmxList?tmxList[elt].data:null},obj.getBinary=function(elt){return elt=""+elt,elt=elt.toLowerCase(),elt in binList?binList[elt]:null},obj.getImage=function(elt){return elt=""+elt,elt=elt.toLowerCase(),elt in imgList?imgList[elt]:null},obj.getJSON=function(elt){return elt=""+elt,elt=elt.toLowerCase(),elt in jsonList?jsonList[elt]:null},obj.getLoadProgress=function(){return loadCount/resourceCount},obj}()}(),function(){me.Font=me.Renderable.extend({font:"Arial",fontSize:new me.Vector2d,fillStyle:"#000000",strokeStyle:"#000000",lineWidth:1,textAlign:"left",textBaseline:"top",lineHeight:1,init:function(font,size,fillStyle,textAlign){this.setFont(font,size,fillStyle,textAlign),this.parent(this.pos,0,this.fontSize.y)},bold:function(){this.font="bold "+this.font},italic:function(){this.font="italic "+this.font},setFont:function(font,size,fillStyle,textAlign){var font_names=font.split(",").map(function(value){return value=value.trim(),/(^".*"$)|(^'.*'$)/.test(value)?value:'"'+value+'"'});this.fontSize.y=parseInt(size,10),this.height=this.fontSize.y,"number"==typeof size&&(size+="px"),this.font=size+" "+font_names.join(","),this.fillStyle=fillStyle,textAlign&&(this.textAlign=textAlign)},measureText:function(context,text){context.font=this.font,context.fillStyle=this.fillStyle,context.textAlign=this.textAlign,context.textBaseline=this.textBaseline,this.height=this.width=0;for(var strings=(""+text).split("\n"),i=0;strings.length>i;i++)this.width=Math.max(context.measureText(strings[i].trimRight()).width,this.width),this.height+=this.fontSize.y*this.lineHeight;return{width:this.width,height:this.height}},draw:function(context,text,x,y){this.pos.set(x,y),context.font=this.font,context.fillStyle=this.fillStyle,context.textAlign=this.textAlign,context.textBaseline=this.textBaseline;for(var strings=(""+text).split("\n"),i=0;strings.length>i;i++)context.fillText(strings[i].trimRight(),~~x,~~y),y+=this.fontSize.y*this.lineHeight},drawStroke:function(context,text,x,y){this.pos.set(x,y),context.font=this.font,context.fillStyle=this.fillStyle,context.strokeStyle=this.strokeStyle,context.lineWidth=this.lineWidth,context.textAlign=this.textAlign,context.textBaseline=this.textBaseline;for(var strings=(""+text).split("\n"),i=0;strings.length>i;i++){var _string=strings[i].trimRight();context.strokeText(_string,~~x,~~y),context.fillText(_string,~~x,~~y),y+=this.fontSize.y*this.lineHeight}}})}(),function(){me.BitmapFont=me.Font.extend({sSize:new me.Vector2d,firstChar:32,charCount:0,init:function(font,size,scale,firstChar){this.parent(font,null,null),this.firstChar=firstChar||32,this.loadFontMetrics(font,size),this.textAlign="left",this.textBaseline="top",scale&&this.resize(scale)},loadFontMetrics:function(font,size){this.font=me.loader.getImage(font),this.fontSize.x=size.x||size,this.fontSize.y=size.y||this.font.height,this.sSize.copy(this.fontSize),this.height=this.sSize.y,this.charCount=~~(this.font.width/this.fontSize.x)},set:function(textAlign,scale){this.textAlign=textAlign,scale&&this.resize(scale)},resize:function(scale){this.sSize.setV(this.fontSize),this.sSize.x*=scale,this.sSize.y*=scale,this.height=this.sSize.y},measureText:function(context,text){var strings=(""+text).split("\n");this.height=this.width=0;for(var i=0;strings.length>i;i++)this.width=Math.max(strings[i].trimRight().length*this.sSize.x,this.width),this.height+=this.sSize.y*this.lineHeight;return{width:this.width,height:this.height}},draw:function(context,text,x,y){var strings=(""+text).split("\n"),lX=x,height=this.sSize.y*this.lineHeight,_alpha=context.globalAlpha;context.globalAlpha*=this.getOpacity(),this.pos.set(x,y);for(var i=0;strings.length>i;i++){x=lX;var string=strings[i].trimRight(),width=string.length*this.sSize.x;switch(this.textAlign){case"right":x-=width;break;case"center":x-=.5*width;break;default:}switch(this.textBaseline){case"middle":y-=.5*height;break;case"ideographic":case"alphabetic":case"bottom":y-=height;break;default:}for(var c=0,len=string.length;len>c;c++){var idx=string.charCodeAt(c)-this.firstChar;idx>=0&&context.drawImage(this.font,this.fontSize.x*(idx%this.charCount),this.fontSize.y*~~(idx/this.charCount),this.fontSize.x,this.fontSize.y,~~x,~~y,this.sSize.x,this.sSize.y),x+=this.sSize.x}y+=height}context.globalAlpha=_alpha}})}(),function(){me.audio=function(){function soundLoadError(sound_id,onerror_cb){if(retry_counter++>3){var errmsg="melonJS: failed loading "+sound_id;if(me.sys.stopOnAudioError!==!1)throw errmsg;me.audio.disable(),onerror_cb&&onerror_cb(),console.log(errmsg+", disabling audio")}else audioTracks[sound_id].load()}function setTrackInstance(id){current_track_instance=id}var obj={},audioTracks={},callbacks={},current_track_id=null,current_track_instance=null,retry_counter=0;return obj.init=function(audioFormat){if(!me.initialized)throw"melonJS: me.audio.init() called before engine initialization.";audioFormat="string"==typeof audioFormat?audioFormat:"mp3",this.audioFormats=audioFormat.split(",")},obj.enable=function(){this.unmuteAll()},obj.disable=function(){this.muteAll()},obj.load=function(sound,onload_cb,onerror_cb){var urls=[];if(this.audioFormats===void 0||0===this.audioFormats.length)throw"melonJS: target audio extension(s) should be set through me.audio.init() before calling the preloader.";for(var i=0;this.audioFormats.length>i;i++)urls.push(sound.src+sound.name+"."+this.audioFormats[i]+me.loader.nocache);var soundclip=new Howl({urls:urls,volume:Howler.volume(),onend:function(soundId){callbacks[soundId]&&(callbacks[soundId](),callbacks[soundId]=null)},onloaderror:function(){soundLoadError.call(me.audio,sound.name,onerror_cb)},onload:function(){retry_counter=0,onload_cb&&onload_cb()}});return audioTracks[sound.name]=soundclip,1},obj.play=function(sound_id,loop,callback,volume){var sound=audioTracks[sound_id.toLowerCase()];return sound&&sound!==void 0?(sound.loop(loop||!1),sound.volume("number"==typeof volume?volume.clamp(0,1):Howler.volume()),sound.play(null,callback),sound):void 0},obj.stop=function(sound_id,instance_id){var sound=audioTracks[sound_id.toLowerCase()];sound&&sound!==void 0&&sound.stop(instance_id)},obj.pause=function(sound_id,instance_id){var sound=audioTracks[sound_id.toLowerCase()];sound&&sound!==void 0&&sound.pause(instance_id)},obj.playTrack=function(sound_id,volume){return current_track_id=sound_id.toLowerCase(),me.audio.play(current_track_id,!0,navigator.isCocoonJS&&!Howler.usingWebAudio?setTrackInstance:void 0,volume)},obj.stopTrack=function(){null!==current_track_id&&(audioTracks[current_track_id].stop(navigator.isCocoonJS&&!Howler.usingWebAudio?current_track_instance:void 0),current_track_id=null)},obj.pauseTrack=function(){null!==current_track_id&&audioTracks[current_track_id].pause(navigator.isCocoonJS&&!Howler.usingWebAudio?current_track_instance:void 0)},obj.resumeTrack=function(){null!==current_track_id&&audioTracks[current_track_id].play(null,navigator.isCocoonJS&&!Howler.usingWebAudio?setTrackInstance:void 0)},obj.getCurrentTrack=function(){return current_track_id},obj.setVolume=function(volume){Howler.volume(volume)},obj.getVolume=function(){return Howler.volume()},obj.mute=function(sound_id,mute){mute=mute===void 0?!0:!!mute;var sound=audioTracks[sound_id.toLowerCase()];sound&&sound!==void 0&&sound.mute(!0)},obj.unmute=function(sound_id){obj.mute(sound_id,!1)},obj.muteAll=function(){Howler.mute()},obj.unmuteAll=function(){Howler.unmute()},obj.unload=function(sound_id){return sound_id=sound_id.toLowerCase(),sound_id in audioTracks?(audioTracks[sound_id].unload(),delete audioTracks[sound_id],!0):!1},obj.unloadAll=function(){for(var sound_id in audioTracks)audioTracks.hasOwnProperty(sound_id)&&obj.unload(sound_id)},obj}()}(),function(){me.video=function(){var api={},canvas=null,context2D=null,backBufferCanvas=null,backBufferContext2D=null,wrapper=null,deferResizeId=-1,double_buffering=!1,game_width_zoom=0,game_height_zoom=0,auto_scale=!1,maintainAspectRatio=!0,maxWidth=1/0,maxHeight=1/0;return api.init=function(wrapperid,game_width,game_height,doublebuffering,scale,aspectRatio){if(!me.initialized)throw"melonJS: me.video.init() called before engine initialization.";if(double_buffering=doublebuffering||!1,auto_scale="auto"===scale||!1,maintainAspectRatio=aspectRatio!==void 0?aspectRatio:!0,scale="auto"!==scale?parseFloat(scale||1):1,me.sys.scale=new me.Vector2d(scale,scale),(auto_scale||1!==scale)&&(double_buffering=!0),game_width_zoom=game_width*me.sys.scale.x,game_height_zoom=game_height*me.sys.scale.y,window.addEventListener("resize",throttle(100,!1,function(event){me.event.publish(me.event.WINDOW_ONRESIZE,[event])}),!1),window.addEventListener("orientationchange",function(event){me.event.publish(me.event.WINDOW_ONORIENTATION_CHANGE,[event])},!1),me.event.subscribe(me.event.WINDOW_ONRESIZE,me.video.onresize.bind(me.video)),me.event.subscribe(me.event.WINDOW_ONORIENTATION_CHANGE,me.video.onresize.bind(me.video)),canvas=api.createCanvas(game_width_zoom,game_height_zoom,!0),wrapperid&&(wrapper=document.getElementById(wrapperid)),wrapper||(wrapper=document.body),wrapper.appendChild(canvas),!canvas.getContext)return!1;if(context2D=api.getContext2d(canvas),me.device.getPixelRatio()>1&&(canvas.style.width=canvas.width/me.device.getPixelRatio()+"px",canvas.style.height=canvas.height/me.device.getPixelRatio()+"px"),double_buffering?(backBufferCanvas=api.createCanvas(game_width,game_height,!1),backBufferContext2D=api.getContext2d(backBufferCanvas)):(backBufferCanvas=canvas,backBufferContext2D=context2D),window.getComputedStyle){var style=window.getComputedStyle(canvas,null);me.video.setMaxSize(parseInt(style.maxWidth,10),parseInt(style.maxHeight,10))}return me.video.onresize(null),me.game.init(),!0},api.getWrapper=function(){return wrapper},api.getWidth=function(){return backBufferCanvas.width},api.getPos=function(c){return c=c||canvas,c.getBoundingClientRect?c.getBoundingClientRect():{left:0,top:0}},api.getHeight=function(){return backBufferCanvas.height},api.setMaxSize=function(w,h){maxWidth=w||1/0,maxHeight=h||1/0},api.createCanvas=function(width,height,screencanvas){if(0===width||0===height)throw Error("melonJS: width or height was zero, Canvas could not be initialized !");var _canvas=document.createElement("canvas");return screencanvas===!0&&navigator.isCocoonJS&&me.device.android2!==!0&&(_canvas.screencanvas=!0),_canvas.width=width||backBufferCanvas.width,_canvas.height=height||backBufferCanvas.height,_canvas},api.getContext2d=function(canvas){var _context;return _context=navigator.isCocoonJS?canvas.getContext("2d",{antialias:me.sys.scalingInterpolation}):canvas.getContext("2d"),_context.canvas||(_context.canvas=canvas),me.video.setImageSmoothing(_context,me.sys.scalingInterpolation),_context},api.getScreenCanvas=function(){return canvas},api.getScreenContext=function(){return context2D},api.getSystemCanvas=function(){return backBufferCanvas},api.getSystemContext=function(){return backBufferContext2D},api.onresize=function(){var scaleX=1,scaleY=1;if(me.device.orientation=window.orientation!==void 0?window.orientation:window.outerWidth>window.outerHeight?90:0,auto_scale){var parent=me.video.getScreenCanvas().parentNode,_max_width=Math.min(maxWidth,parent.width||window.innerWidth),_max_height=Math.min(maxHeight,parent.height||window.innerHeight);if(maintainAspectRatio){var designRatio=me.video.getWidth()/me.video.getHeight(),screenRatio=_max_width/_max_height;scaleX=scaleY=designRatio>screenRatio?_max_width/me.video.getWidth():_max_height/me.video.getHeight()}else scaleX=_max_width/me.video.getWidth(),scaleY=_max_height/me.video.getHeight();if(scaleX*=me.device.getPixelRatio(),scaleY*=me.device.getPixelRatio(),1!==scaleX||1!==scaleY)return deferResizeId>=0&&clearTimeout(deferResizeId),deferResizeId=me.video.updateDisplaySize.defer(this,scaleX,scaleY),void 0}me.input._offset=me.video.getPos()},api.updateDisplaySize=function(scaleX,scaleY){me.sys.scale.set(scaleX,scaleY),canvas.width=game_width_zoom=backBufferCanvas.width*scaleX,canvas.height=game_height_zoom=backBufferCanvas.height*scaleY,me.device.getPixelRatio()>1&&(canvas.style.width=canvas.width/me.device.getPixelRatio()+"px",canvas.style.height=canvas.height/me.device.getPixelRatio()+"px"),me.video.setImageSmoothing(context2D,me.sys.scalingInterpolation),me.input._offset=me.video.getPos(),api.blitSurface(),deferResizeId=-1},api.clearSurface=function(context,col){var _canvas=context.canvas;context.save(),context.setTransform(1,0,0,1,0,0),context.fillStyle=col,context.fillRect(0,0,_canvas.width,_canvas.height),context.restore()},api.setImageSmoothing=function(context,enable){me.agent.setPrefixed("imageSmoothingEnabled",enable===!0,context)},api.setAlpha=function(context,enable){context.globalCompositeOperation=enable?"source-over":"copy"},api.blitSurface=function(){api.blitSurface=double_buffering?function(){context2D.drawImage(backBufferCanvas,0,0,backBufferCanvas.width,backBufferCanvas.height,0,0,game_width_zoom,game_height_zoom)}:function(){},api.blitSurface()},api.applyRGBFilter=function(object,effect,option){var _context=api.getContext2d(api.createCanvas(object.width,object.height,!1)),imgpix=me.utils.getPixels(object),pix=imgpix.data,i,n;switch(effect){case"b&w":for(i=0,n=pix.length;n>i;i+=4){var grayscale=3*pix[i]+4*pix[i+1]+pix[i+2]>>>3;pix[i]=grayscale,pix[i+1]=grayscale,pix[i+2]=grayscale}break;case"brightness":var brightness=Math.abs(option).clamp(0,1);for(i=0,n=pix.length;n>i;i+=4)pix[i]*=brightness,pix[i+1]*=brightness,pix[i+2]*=brightness;break;case"transparent":var refColor=me.pool.pull("me.Color").parseHex(option),pixel=me.pool.pull("me.Color");for(i=0,n=pix.length;n>i;i+=4)pixel.setColor(pix[i],pix[i+1],pix[i+2]),pixel.equals(refColor)&&(pix[i+3]=0);me.pool.push(refColor),me.pool.push(pixel);break;default:return null}return _context.putImageData(imgpix,0,0),_context},api}()}(),function(){me.input=function(){var obj={};return obj._preventDefault=function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,!1},obj.preventDefault=!0,obj}()}(),function(){var obj=me.input;obj._KeyBinding={};var keyStatus={},keyLock={},keyLocked={},keyRefs={},preventDefaultForKeys={},keyboardInitialized=!1;obj._enableKeyboardEvent=function(){keyboardInitialized||(window.addEventListener("keydown",obj._keydown,!1),window.addEventListener("keyup",obj._keyup,!1),keyboardInitialized=!0)},obj._keydown=function(e,keyCode,mouseButton){keyCode=keyCode||e.keyCode||e.which;var action=obj._KeyBinding[keyCode];if(me.event.publish(me.event.KEYDOWN,[action,keyCode,action?!keyLocked[action]:!0]),action){if(!keyLocked[action]){var trigger=mouseButton?mouseButton:keyCode;keyRefs[action][trigger]||(keyStatus[action]++,keyRefs[action][trigger]=!0)}return preventDefaultForKeys[keyCode]?obj._preventDefault(e):!0}return!0},obj._keyup=function(e,keyCode,mouseButton){keyCode=keyCode||e.keyCode||e.which;var action=obj._KeyBinding[keyCode];if(me.event.publish(me.event.KEYUP,[action,keyCode]),action){var trigger=mouseButton?mouseButton:keyCode;return keyRefs[action][trigger]=void 0,keyStatus[action]>0&&keyStatus[action]--,keyLocked[action]=!1,preventDefaultForKeys[keyCode]?obj._preventDefault(e):!0}return!0},obj.KEY={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,WINDOW_KEY:91,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWAND_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222},obj.isKeyPressed=function(action){return keyStatus[action]&&!keyLocked[action]?(keyLock[action]&&(keyLocked[action]=!0),!0):!1},obj.keyStatus=function(action){return keyStatus[action]>0},obj.triggerKeyEvent=function(keycode,status){status?obj._keydown({},keycode):obj._keyup({},keycode)},obj.bindKey=function(keycode,action,lock,preventDefault){obj._enableKeyboardEvent(),"boolean"!=typeof preventDefault&&(preventDefault=obj.preventDefault),obj._KeyBinding[keycode]=action,preventDefaultForKeys[keycode]=preventDefault,keyStatus[action]=0,keyLock[action]=lock?lock:!1,keyLocked[action]=!1,keyRefs[action]={}},obj.unlockKey=function(action){keyLocked[action]=!1},obj.unbindKey=function(keycode){var keybinding=obj._KeyBinding[keycode];keyStatus[keybinding]=0,keyLock[keybinding]=!1,keyRefs[keybinding]={},obj._KeyBinding[keycode]=null,preventDefaultForKeys[keycode]=null}}(),function(){function registerEventListener(eventList,callback){for(var x=2;eventList.length>x;++x)eventList[x]!==void 0&&me.video.getScreenCanvas().addEventListener(eventList[x],callback,!1)}function enablePointerEvent(){pointerInitialized||(changedTouches.push({x:0,y:0}),obj.mouse.pos=new me.Vector2d(0,0),obj._offset=me.video.getPos(),window.addEventListener("scroll",throttle(100,!1,function(e){obj._offset=me.video.getPos(),me.event.publish(me.event.WINDOW_ONSCROLL,[e])}),!1),activeEventList=navigator.pointerEnabled?pointerEventList:navigator.msPointerEnabled?MSPointerEventList:me.device.touch?touchEventList:mouseEventList,registerEventListener(activeEventList,onPointerEvent),wheeltype="onwheel"in document.createElement("div")?"wheel":"mousewheel",window.addEventListener(wheeltype,onMouseWheel,!1),obj.throttlingInterval===void 0&&(obj.throttlingInterval=Math.floor(1e3/me.sys.fps)),17>obj.throttlingInterval?me.video.getScreenCanvas().addEventListener(activeEventList[POINTER_MOVE],onMoveEvent,!1):me.video.getScreenCanvas().addEventListener(activeEventList[POINTER_MOVE],throttle(obj.throttlingInterval,!1,function(e){onMoveEvent(e)}),!1),pointerInitialized=!0)}function dispatchEvent(e){var handled=!1,handlers=evtHandlers[e.type];if(handlers||(handlers=activeEventList.indexOf(e.type)===POINTER_CANCEL?evtHandlers[activeEventList[POINTER_UP]]:evtHandlers[e.type]),handlers){me.game.viewport.localToWorld(0,0,viewportOffset);for(var t=0,l=changedTouches.length;l>t;t++){if(e.timeStamp!==void 0){if(lastTimeStamp>e.timeStamp)continue;lastTimeStamp=e.timeStamp}me.device.pointerEnabled||(e.pointerId=changedTouches[t].id),e.gameScreenX=changedTouches[t].x,e.gameScreenY=changedTouches[t].y,e.gameWorldX=e.gameScreenX+viewportOffset.x,e.gameWorldY=e.gameScreenY+viewportOffset.y;for(var i=handlers.length,handler;i--,handler=handlers[i];)if(handler.floating===!0?(e.gameX=e.gameScreenX,e.gameY=e.gameScreenY):(e.gameX=e.gameWorldX,e.gameY=e.gameWorldY),handler.bounds.containsPoint(e.gameX-handler.rect.pos.x,e.gameY-handler.rect.pos.y)&&handler.cb(e)===!1){handled=!0;break}}}return handled}function updateCoordFromEvent(event){var local;if(changedTouches.length=0,event.touches)for(var i=0,l=event.changedTouches.length;l>i;i++){var t=event.changedTouches[i];local=obj.globalToLocal(t.clientX,t.clientY),local.id=t.identifier,changedTouches.push(local)}else local=obj.globalToLocal(event.clientX,event.clientY),local.id=event.pointerId||1,changedTouches.push(local);event.isPrimary!==!1&&obj.mouse.pos.set(changedTouches[0].x,changedTouches[0].y)}function onMouseWheel(e){if(e.target===me.video.getScreenCanvas()){var _event={deltaMode:1,type:"mousewheel",deltaX:e.deltaX,deltaY:e.deltaY,deltaZ:e.deltaZ};if("mousewheel"===wheeltype&&(_event.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(_event.deltaX=-1/40*e.wheelDeltaX)),dispatchEvent(_event))return obj._preventDefault(e)}return!0}function onMoveEvent(e){return updateCoordFromEvent(e),dispatchEvent(e)?obj._preventDefault(e):!0}function onPointerEvent(e){if(updateCoordFromEvent(e),dispatchEvent(e))return obj._preventDefault(e);var button=e.button||0,keycode=obj.mouse.bind[button];return keycode?e.type===activeEventList[POINTER_DOWN]?obj._keydown(e,keycode,button+1):obj._keyup(e,keycode,button+1):!0}var obj=me.input,evtHandlers={},pointerInitialized=!1,wheeltype="mousewheel",lastTimeStamp=0,activeEventList=null,pointerEventList=["mousewheel","pointermove","pointerdown","pointerup","pointercancel",void 0,void 0],MSPointerEventList=["mousewheel","MSPointerMove","MSPointerDown","MSPointerUp","MSPointerCancel",void 0,void 0],mouseEventList=["mousewheel","mousemove","mousedown","mouseup",void 0,void 0,void 0],touchEventList=[void 0,"touchmove","touchstart","touchend","touchcancel",void 0,void 0],POINTER_MOVE=1,POINTER_DOWN=2,POINTER_UP=3,POINTER_CANCEL=4,viewportOffset=new me.Vector2d,changedTouches=[];obj._offset=null,obj.mouse={pos:null,LEFT:0,MIDDLE:1,RIGHT:2,bind:[0,0,0]},obj.throttlingInterval=void 0,obj.globalToLocal=function(x,y){var offset=obj._offset,pixelRatio=me.device.getPixelRatio();x-=offset.left,y-=offset.top;var scale=me.sys.scale;return(1!==scale.x||1!==scale.y)&&(x/=scale.x,y/=scale.y),new me.Vector2d(x*pixelRatio,y*pixelRatio)},obj.bindPointer=function(){var button=2>arguments.length?obj.mouse.LEFT:arguments[0],keyCode=2>arguments.length?arguments[0]:arguments[1];if(enablePointerEvent(),!obj._KeyBinding[keyCode])throw"melonJS : no action defined for keycode "+keyCode;obj.mouse.bind[button]=keyCode},obj.unbindPointer=function(button){obj.mouse.bind[button===void 0?me.input.mouse.LEFT:button]=null},obj.registerPointerEvent=function(eventType,rect,callback,floating){if(enablePointerEvent(),-1===pointerEventList.indexOf(eventType))throw"melonJS : invalid event type : "+eventType;pointerEventList!==activeEventList&&(eventType=activeEventList[pointerEventList.indexOf(eventType)]),evtHandlers[eventType]||(evtHandlers[eventType]=[]);var _float=rect.floating===!0?!0:!1;floating&&(_float=floating===!0?!0:!1);var bounds=rect.getBounds();rect.getShape===void 0&&bounds.translate(-rect.pos.x,-rect.pos.y),evtHandlers[eventType].push({rect:rect,bounds:bounds,cb:callback,floating:_float})},obj.releasePointerEvent=function(eventType,rect){if(-1===pointerEventList.indexOf(eventType))throw"melonJS : invalid event type : "+eventType;pointerEventList!==activeEventList&&(eventType=activeEventList[pointerEventList.indexOf(eventType)]),evtHandlers[eventType]||(evtHandlers[eventType]=[]);var handlers=evtHandlers[eventType];if(handlers)for(var i=handlers.length,handler;i--,handler=handlers[i];)handler.rect===rect&&(handler.rect=handler.bounds=handler.cb=handler.floating=null,evtHandlers[eventType].splice(i,1))},obj._translatePointerEvents=function(){obj.registerPointerEvent("pointermove",me.game.viewport,function(e){return me.event.publish(me.event.MOUSEMOVE,[e]),!1})}}(),function(){var Base64=function(){var singleton={},_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return singleton.decode=function(input){if(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,""),me.device.nativeBase64)return window.atob(input);for(var output=[],chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0;input.length>i;)enc1=_keyStr.indexOf(input.charAt(i++)),enc2=_keyStr.indexOf(input.charAt(i++)),enc3=_keyStr.indexOf(input.charAt(i++)),enc4=_keyStr.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,output.push(String.fromCharCode(chr1)),64!==enc3&&output.push(String.fromCharCode(chr2)),64!==enc4&&output.push(String.fromCharCode(chr3));return output=output.join("")},singleton}();me.utils=function(){var api={},GUID_base="",GUID_index=0,removepath=/^.*(\\|\/|\:)/,removeext=/\.[^\.]*$/;return api.decodeBase64=function(input){return Base64.decode(input)},api.decodeBase64AsArray=function(input,bytes){bytes=bytes||1;var dec=Base64.decode(input),i,j,len,ar;for(ar="function"==typeof window.Uint32Array?new Uint32Array(dec.length/bytes):[],i=0,len=dec.length/bytes;len>i;i++)for(ar[i]=0,j=bytes-1;j>=0;--j)ar[i]+=dec.charCodeAt(i*bytes+j)<<(j<<3);return ar},api.decompress=function(){throw"melonJS: GZIP/ZLIB compressed TMX Tile Map not supported!"},api.decodeCSV=function(input,limit){input=input.trim().split("\n");for(var result=[],i=0;input.length>i;i++)for(var entries=input[i].split(",",limit),e=0;entries.length>e;e++)result.push(+entries[e]);return result},api.getBasename=function(path){return path.replace(removepath,"").replace(removeext,"")},api.getFileExtension=function(path){return path.substring(path.lastIndexOf(".")+1,path.length)},api.getPixels=function(arg){if(arg instanceof HTMLImageElement){var _context=me.video.getContext2d(me.video.createCanvas(arg.width,arg.height));return _context.drawImage(arg,0,0),_context.getImageData(0,0,arg.width,arg.height)}return arg.getContext("2d").getImageData(0,0,arg.width,arg.height)},api.resetGUID=function(base){GUID_base=(""+base).toUpperCase().toHex(),GUID_index=0},api.createGUID=function(){return GUID_base+"-"+GUID_index++},api.applyFriction=function(v,f){return 0>v+f?v+f*me.timer.tick:v-f>0?v-f*me.timer.tick:0},api}()}(),function(){var cssToRGB={black:[0,0,0],silver:[192,192,129],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],orange:[255,165,0],aliceblue:[240,248,245],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,35],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],"darkgray[*]":[169,169,169],darkgreen:[0,100,0],"darkgrey[*]":[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]};
me.Color=Object.extend({r:0,g:0,b:0,alpha:1,init:function(r,g,b,a){return this.onResetEvent(r,g,b,a)},onResetEvent:function(r,g,b,a){return this.setColor(r,g,b,a)},setColor:function(r,g,b,a){return this.r=Math.floor(r||0).clamp(0,255),this.g=Math.floor(g||0).clamp(0,255),this.b=Math.floor(b||0).clamp(0,255),this.alpha=a===void 0?1:a.clamp(0,1),this},clone:function(){return me.pool.pull("me.Color",this.r,this.g,this.b,this.alpha)},add:function(color){return this.setColor(this.r+color.r,this.g+color.g,this.b+color.b,(this.alpha+color.alpha)/2)},darken:function(scale){return scale=scale.clamp(0,1),this.setColor(this.r*scale,this.g*scale,this.b*scale,this.alpha)},lighten:function(scale){return scale=scale.clamp(0,1),this.setColor(this.r+(255-this.r)*scale,this.g+(255-this.g)*scale,this.b+(255-this.b)*scale,this.alpha)},random:function(){return this.setColor(256*Math.random(),256*Math.random(),256*Math.random(),this.alpha)},equals:function(color){return this.r===color.r&&this.g===color.g&&this.b===color.b&&this.alpha===color.alpha},parseCSS:function(cssColor){return cssColor in cssToRGB?this.setColor.apply(this,cssToRGB[cssColor]):this.parseRGB(cssColor)},parseRGB:function(rgbColor){var start;if("rgba"===rgbColor.substring(0,4))start=5;else{if("rgb"!==rgbColor.substring(0,3))return this.parseHex(rgbColor);start=4}var color=rgbColor.slice(start,-1).split(/\s*,\s*/);return this.setColor.apply(this,color)},parseHex:function(hexColor){"#"===hexColor.charAt(0)&&(hexColor=hexColor.substring(1,hexColor.length));var r,g,b;return 6>hexColor.length?(r=parseInt(hexColor.charAt(0)+hexColor.charAt(0),16),g=parseInt(hexColor.charAt(1)+hexColor.charAt(1),16),b=parseInt(hexColor.charAt(2)+hexColor.charAt(2),16)):(r=parseInt(hexColor.substring(0,2),16),g=parseInt(hexColor.substring(2,4),16),b=parseInt(hexColor.substring(4,6),16)),this.setColor(r,g,b)},toHex:function(){return"#"+this.r.toHex()+this.g.toHex()+this.b.toHex()},toRGB:function(){return"rgb("+this.r+","+this.g+","+this.b+")"},toRGBA:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.alpha+")"}})}(),function(){me.save=function(){function isReserved(key){return"add"===key||"remove"===key}var data={},api={_init:function(){if(me.device.localStorage===!0){var keys=JSON.parse(localStorage.getItem("me.save"))||[];keys.forEach(function(key){data[key]=JSON.parse(localStorage.getItem("me.save."+key))})}},add:function(props){Object.keys(props).forEach(function(key){isReserved(key)||(function(prop){Object.defineProperty(api,prop,{configurable:!0,enumerable:!0,get:function(){return data[prop]},set:function(value){data[prop]=value,me.device.localStorage===!0&&localStorage.setItem("me.save."+prop,JSON.stringify(value))}})}(key),key in data||(api[key]=props[key]))}),me.device.localStorage===!0&&localStorage.setItem("me.save",JSON.stringify(Object.keys(data)))},remove:function(key){isReserved(key)||data[key]!==void 0&&(delete data[key],me.device.localStorage===!0&&(localStorage.removeItem("me.save."+key),localStorage.setItem("me.save",JSON.stringify(Object.keys(data)))))}};return api}()}(),function(){me.COLLISION_LAYER="collision",me.TMX_TAG_MAP="map",me.TMX_TAG_NAME="name",me.TMX_TAG_VALUE="value",me.TMX_TAG_VERSION="version",me.TMX_TAG_ORIENTATION="orientation",me.TMX_TAG_WIDTH="width",me.TMX_TAG_HEIGHT="height",me.TMX_TAG_TYPE="type",me.TMX_TAG_OPACITY="opacity",me.TMX_TAG_TRANS="trans",me.TMX_TAG_TILEWIDTH="tilewidth",me.TMX_TAG_TILEHEIGHT="tileheight",me.TMX_TAG_TILEOFFSET="tileoffset",me.TMX_TAG_FIRSTGID="firstgid",me.TMX_TAG_GID="gid",me.TMX_TAG_TILE="tile",me.TMX_TAG_ID="id",me.TMX_TAG_DATA="data",me.TMX_TAG_COMPRESSION="compression",me.TMX_TAG_GZIP="gzip",me.TMX_TAG_ZLIB="zlib",me.TMX_TAG_ENCODING="encoding",me.TMX_TAG_ATTR_BASE64="base64",me.TMX_TAG_CSV="csv",me.TMX_TAG_SPACING="spacing",me.TMX_TAG_MARGIN="margin",me.TMX_TAG_PROPERTIES="properties",me.TMX_TAG_PROPERTY="property",me.TMX_TAG_IMAGE="image",me.TMX_TAG_SOURCE="source",me.TMX_TAG_VISIBLE="visible",me.TMX_TAG_TILESET="tileset",me.TMX_TAG_LAYER="layer",me.TMX_TAG_TILE_LAYER="tilelayer",me.TMX_TAG_IMAGE_LAYER="imagelayer",me.TMX_TAG_OBJECTGROUP="objectgroup",me.TMX_TAG_OBJECT="object",me.TMX_TAG_X="x",me.TMX_TAG_Y="y",me.TMX_TAG_WIDTH="width",me.TMX_TAG_HEIGHT="height",me.TMX_TAG_POLYGON="polygon",me.TMX_TAG_POLYLINE="polyline",me.TMX_TAG_ELLIPSE="ellipse",me.TMX_TAG_POINTS="points",me.TMX_BACKGROUND_COLOR="backgroundcolor"}(),function(){me.TMXUtils=function(){function setTMXValue(value){if(!value||value.isBoolean())value=value?"true"===value:!0;else if(value.isNumeric())value=Number(value);else if(value.match(/^json:/i)){var match=value.split(/^json:/i)[1];try{value=JSON.parse(match)}catch(e){throw"Unable to parse JSON: "+match}}return value}var api={},parseAttributes=function(obj,elt){if(elt.attributes&&elt.attributes.length>0)for(var j=0;elt.attributes.length>j;j++){var attribute=elt.attributes.item(j);attribute.name!==void 0?obj[attribute.name]=setTMXValue(attribute.value):obj[attribute.nodeName]=setTMXValue(attribute.nodeValue)}};return api.parse=function(xml,draworder){var obj={},cacheValue="";if(draworder=draworder||1,1===xml.nodeType&&parseAttributes(obj,xml),xml.hasChildNodes()){for(var i=0;xml.childNodes.length>i;i++){var item=xml.childNodes.item(i),nodeName=item.nodeName;if(obj[nodeName]===void 0)if(3===item.nodeType){var value=item.nodeValue.trim();value&&value.length>0&&(cacheValue+=value)}else 1===item.nodeType&&(obj[nodeName]=me.TMXUtils.parse(item,draworder),obj[nodeName]._draworder=draworder++);else Array.isArray(obj[nodeName])===!1&&(obj[nodeName]=[obj[nodeName]]),obj[nodeName].push(me.TMXUtils.parse(item,draworder)),obj[nodeName][obj[nodeName].length-1]._draworder=draworder++}cacheValue.length>0&&(obj.value=cacheValue,cacheValue="")}return obj},api.applyTMXProperties=function(obj,data){var properties=data[me.TMX_TAG_PROPERTIES];if(properties!==void 0)if(properties.property!==void 0){var property=properties.property;Array.isArray(property)===!0?property.forEach(function(prop){obj[prop.name]=prop.value}):obj[property.name]=property.value}else for(var name in properties)properties.hasOwnProperty(name)&&(obj[name]=setTMXValue(properties[name]))},api}()}(),function(){me.TMXObjectGroup=Object.extend({name:null,width:0,height:0,z:0,objects:[],init:function(name,tmxObjGroup,tilesets,z){var self=this;this.name=name,this.width=tmxObjGroup[me.TMX_TAG_WIDTH],this.height=tmxObjGroup[me.TMX_TAG_HEIGHT],this.z=z,this.objects=[];var visible=tmxObjGroup[me.TMX_TAG_VISIBLE]!==void 0?tmxObjGroup[me.TMX_TAG_VISIBLE]:!0;this.opacity=visible===!0?parseFloat(tmxObjGroup[me.TMX_TAG_OPACITY]||1).clamp(0,1):0,me.TMXUtils.applyTMXProperties(this,tmxObjGroup);var _objects=tmxObjGroup.objects||tmxObjGroup.object;Array.isArray(_objects)===!0?_objects.forEach(function(tmxObj){self.objects.push(new me.TMXObject(tmxObj,tilesets,z))}):self.objects.push(new me.TMXObject(_objects,tilesets,z))},destroy:function(){this.objects=null},getObjectCount:function(){return this.objects.length},getObjectByIndex:function(idx){return this.objects[idx]}}),me.TMXObject=Object.extend({name:null,x:0,y:0,width:0,height:0,z:0,gid:void 0,type:void 0,isPolygon:!1,isPolyline:!1,points:void 0,init:function(tmxObj,tilesets,z){if(this.name=tmxObj[me.TMX_TAG_NAME],this.x=parseInt(tmxObj[me.TMX_TAG_X],10),this.y=parseInt(tmxObj[me.TMX_TAG_Y],10),this.z=parseInt(z,10),this.width=parseInt(tmxObj[me.TMX_TAG_WIDTH]||0,10),this.height=parseInt(tmxObj[me.TMX_TAG_HEIGHT]||0,10),this.gid=parseInt(tmxObj[me.TMX_TAG_GID],10)||null,this.type=tmxObj[me.TMX_TAG_TYPE],this.isEllipse=!1,this.isPolygon=!1,this.isPolyline=!1,this.gid)this.setImage(this.gid,tilesets);else if(tmxObj[me.TMX_TAG_ELLIPSE]!==void 0)this.isEllipse=!0;else{var points=tmxObj[me.TMX_TAG_POLYGON];if(points!==void 0?this.isPolygon=!0:(points=tmxObj[me.TMX_TAG_POLYLINE],points!==void 0&&(this.isPolyline=!0)),points!==void 0)if(this.points=[],points.points!==void 0){points=points.points.split(" ");for(var i=0,v;points.length>i;i++)v=points[i].split(","),this.points.push(new me.Vector2d(+v[0],+v[1]))}else{var self=this;points.forEach(function(point){self.points.push(new me.Vector2d(parseInt(point.x,10),parseInt(point.y,10)))})}}me.game.renderer.adjustPosition(this),me.TMXUtils.applyTMXProperties(this,tmxObj)},setImage:function(gid,tilesets){var tileset=tilesets.getTilesetByGid(this.gid);this.width=tileset.tilewidth,this.height=tileset.tileheight,this.spritewidth=this.width;var tmxTile=new me.Tile(this.x,this.y,tileset.tilewidth,tileset.tileheight,this.gid);this.image=tileset.getTileImage(tmxTile),this.name===void 0&&(this.name="TileObject")},getShape:function(){return this.isEllipse===!0?new me.Ellipse(new me.Vector2d(0,0),this.width,this.height):this.isPolygon===!0||this.isPolyline===!0?new me.PolyShape(new me.Vector2d(0,0),this.points,this.isPolygon):new me.Rect(new me.Vector2d(0,0),this.width,this.height)},getObjectPropertyByName:function(name){return this[name]}})}(),function(){var FlippedHorizontallyFlag=2147483648,FlippedVerticallyFlag=1073741824,FlippedAntiDiagonallyFlag=536870912;me.Tile=me.Rect.extend({tileId:null,tileset:null,transform:null,init:function(x,y,w,h,gid){this.parent(new me.Vector2d(x*w,y*h),w,h),this.col=x,this.row=y,this.tileId=gid,this.flipX=0!==(this.tileId&FlippedHorizontallyFlag),this.flipY=0!==(this.tileId&FlippedVerticallyFlag),this.flipAD=0!==(this.tileId&FlippedAntiDiagonallyFlag),this.flipped=this.flipX||this.flipY||this.flipAD,this.flipped===!0&&this.createTransform(),this.tileId&=~(FlippedHorizontallyFlag|FlippedVerticallyFlag|FlippedAntiDiagonallyFlag)},createTransform:function(){null===this.transform&&(this.transform=new me.Matrix2d),this.transform.identity(),this.flipAD&&(this.transform.set(0,1,1,0),this.transform.translate(0,this.height-this.width)),this.flipX&&(this.transform.a*=-1,this.transform.c*=-1,this.transform.translate(this.flipAD?this.height:this.width,0)),this.flipY&&(this.transform.b*=-1,this.transform.d*=-1,this.transform.translate(0,this.flipAD?this.width:this.height))}}),me.TMXTileset=Object.extend({type:{SOLID:"solid",PLATFORM:"platform",L_SLOPE:"lslope",R_SLOPE:"rslope",LADDER:"ladder",TOPLADDER:"topladder",BREAKABLE:"breakable"},TileProperties:[],tileXOffset:[],tileYOffset:[],init:function(tileset){this.firstgid=this.lastgid=tileset[me.TMX_TAG_FIRSTGID];var src=tileset[me.TMX_TAG_SOURCE];if(src&&"tsx"===me.utils.getFileExtension(src).toLowerCase()&&(src=me.utils.getBasename(src),tileset=me.loader.getTMX(src),!tileset))throw"melonJS:"+src+" TSX tileset not found";this.name=tileset[me.TMX_TAG_NAME],this.tilewidth=parseInt(tileset[me.TMX_TAG_TILEWIDTH],10),this.tileheight=parseInt(tileset[me.TMX_TAG_TILEHEIGHT],10),this.spacing=parseInt(tileset[me.TMX_TAG_SPACING]||0,10),this.margin=parseInt(tileset[me.TMX_TAG_MARGIN]||0,10),this.tileoffset=new me.Vector2d(0,0);var offset=tileset[me.TMX_TAG_TILEOFFSET];offset&&(this.tileoffset.x=parseInt(offset[me.TMX_TAG_X],10),this.tileoffset.y=parseInt(offset[me.TMX_TAG_Y],10));var tileInfo=tileset.tileproperties;if(tileInfo)for(var i in tileInfo)tileInfo.hasOwnProperty(i)&&this.setTileProperty(parseInt(i,10)+this.firstgid,tileInfo[i]);else if(tileset[me.TMX_TAG_TILE]){tileInfo=tileset[me.TMX_TAG_TILE],Array.isArray(tileInfo)||(tileInfo=[tileInfo]);for(var j=0;tileInfo.length>j;j++){var tileID=tileInfo[j][me.TMX_TAG_ID]+this.firstgid,prop={};me.TMXUtils.applyTMXProperties(prop,tileInfo[j]),this.setTileProperty(tileID,prop)}}var imagesrc="string"==typeof tileset[me.TMX_TAG_IMAGE]?tileset[me.TMX_TAG_IMAGE]:tileset[me.TMX_TAG_IMAGE].source;if(imagesrc=me.utils.getBasename(imagesrc),this.image=imagesrc?me.loader.getImage(imagesrc):null,this.image){this.hTileCount=~~((this.image.width-this.margin)/(this.tilewidth+this.spacing)),this.vTileCount=~~((this.image.height-this.margin)/(this.tileheight+this.spacing)),this.lastgid=this.firstgid+(this.hTileCount*this.vTileCount-1||0);var transparency=tileset[me.TMX_TAG_TRANS]||tileset[me.TMX_TAG_IMAGE][me.TMX_TAG_TRANS];transparency!==void 0&&(this.image=me.video.applyRGBFilter(this.image,"transparent",transparency.toUpperCase()).canvas)}else console.log("melonJS: '"+imagesrc+"' file for tileset '"+this.name+"' not found!")},setTileProperty:function(gid,prop){prop.isSolid=prop.type?prop.type.toLowerCase()===this.type.SOLID:!1,prop.isPlatform=prop.type?prop.type.toLowerCase()===this.type.PLATFORM:!1,prop.isLeftSlope=prop.type?prop.type.toLowerCase()===this.type.L_SLOPE:!1,prop.isRightSlope=prop.type?prop.type.toLowerCase()===this.type.R_SLOPE:!1,prop.isBreakable=prop.type?prop.type.toLowerCase()===this.type.BREAKABLE:!1,prop.isLadder=prop.type?prop.type.toLowerCase()===this.type.LADDER:!1,prop.isTopLadder=prop.type?prop.type.toLowerCase()===this.type.TOPLADDER:!1,prop.isSlope=prop.isLeftSlope||prop.isRightSlope,prop.isCollidable=!!prop.type,this.TileProperties[gid]=prop},contains:function(gid){return gid>=this.firstgid&&this.lastgid>=gid},getTileImage:function(tmxTile){var _context=me.video.getContext2d(me.video.createCanvas(this.tilewidth,this.tileheight));return this.drawTile(_context,0,0,tmxTile),_context.canvas},getTileProperties:function(tileId){return this.TileProperties[tileId]},isTileCollidable:function(tileId){return this.TileProperties[tileId].isCollidable},getTileOffsetX:function(tileId){var offset=this.tileXOffset[tileId];return offset===void 0&&(offset=this.tileXOffset[tileId]=this.margin+(this.spacing+this.tilewidth)*(tileId%this.hTileCount)),offset},getTileOffsetY:function(tileId){var offset=this.tileYOffset[tileId];return offset===void 0&&(offset=this.tileYOffset[tileId]=this.margin+(this.spacing+this.tileheight)*~~(tileId/this.hTileCount)),offset},drawTile:function(context,dx,dy,tmxTile){if(tmxTile.flipped){context.save();var transform=tmxTile.transform;context.transform(transform.a,transform.b,transform.c,transform.d,transform.e+dx,transform.f+dy),dx=dy=0}var tileid=tmxTile.tileId-this.firstgid;context.drawImage(this.image,this.getTileOffsetX(tileid),this.getTileOffsetY(tileid),this.tilewidth,this.tileheight,dx,dy,this.tilewidth,this.tileheight),tmxTile.flipped&&context.restore()}}),me.TMXTilesetGroup=Object.extend({init:function(){this.tilesets=[]},add:function(tileset){this.tilesets.push(tileset)},getTilesetByIndex:function(i){return this.tilesets[i]},getTilesetByGid:function(gid){for(var invalidRange=-1,i=0,len=this.tilesets.length;len>i;i++){if(this.tilesets[i].contains(gid))return this.tilesets[i];this.tilesets[i].firstgid===this.tilesets[i].lastgid&&gid>=this.tilesets[i].firstgid&&(invalidRange=i)}if(-1!==invalidRange)return this.tilesets[invalidRange];throw"no matching tileset found for gid "+gid}})}(),function(){me.TMXOrthogonalRenderer=Object.extend({init:function(cols,rows,tilewidth,tileheight){this.cols=cols,this.rows=rows,this.tilewidth=tilewidth,this.tileheight=tileheight},canRender:function(layer){return"orthogonal"===layer.orientation&&this.cols===layer.cols&&this.rows===layer.rows&&this.tilewidth===layer.tilewidth&&this.tileheight===layer.tileheight},pixelToTileCoords:function(x,y){return new me.Vector2d(x/this.tilewidth,y/this.tileheight)},tileToPixelCoords:function(x,y){return new me.Vector2d(x*this.tilewidth,y*this.tileheight)},adjustPosition:function(obj){"number"==typeof obj.gid&&(obj.y-=obj.height)},drawTile:function(context,x,y,tmxTile,tileset){tileset.drawTile(context,tileset.tileoffset.x+x*this.tilewidth,tileset.tileoffset.y+(y+1)*this.tileheight-tileset.tileheight,tmxTile)},drawTileLayer:function(context,layer,rect){var start=this.pixelToTileCoords(rect.pos.x,rect.pos.y).floorSelf(),end=this.pixelToTileCoords(rect.pos.x+rect.width+this.tilewidth,rect.pos.y+rect.height+this.tileheight).ceilSelf();end.x=end.x>this.cols?this.cols:end.x,end.y=end.y>this.rows?this.rows:end.y;for(var y=start.y;end.y>y;y++)for(var x=start.x;end.x>x;x++){var tmxTile=layer.layerData[x][y];tmxTile&&this.drawTile(context,x,y,tmxTile,tmxTile.tileset)}}}),me.TMXIsometricRenderer=Object.extend({init:function(cols,rows,tilewidth,tileheight){this.cols=cols,this.rows=rows,this.tilewidth=tilewidth,this.tileheight=tileheight,this.hTilewidth=tilewidth/2,this.hTileheight=tileheight/2,this.originX=this.rows*this.hTilewidth},canRender:function(layer){return"isometric"===layer.orientation&&this.cols===layer.cols&&this.rows===layer.rows&&this.tilewidth===layer.tilewidth&&this.tileheight===layer.tileheight},pixelToTileCoords:function(x,y){x-=this.originX;var tileY=y/this.tileheight,tileX=x/this.tilewidth;return new me.Vector2d(tileY+tileX,tileY-tileX)},tileToPixelCoords:function(x,y){return new me.Vector2d((x-y)*this.hTilewidth+this.originX,(x+y)*this.hTileheight)},adjustPosition:function(obj){var tilex=obj.x/this.hTilewidth,tiley=obj.y/this.tileheight,isoPos=this.tileToPixelCoords(tilex,tiley);isoPos.x-=obj.width/2,isoPos.y-=obj.height,obj.x=isoPos.x,obj.y=isoPos.y},drawTile:function(context,x,y,tmxTile,tileset){tileset.drawTile(context,(this.cols-1)*tileset.tilewidth+(x-y)*tileset.tilewidth>>1,-tileset.tilewidth+(x+y)*tileset.tileheight>>2,tmxTile)},drawTileLayer:function(context,layer,rect){var tileset=layer.tileset,offset=tileset.tileoffset,rowItr=this.pixelToTileCoords(rect.pos.x-tileset.tilewidth,rect.pos.y-tileset.tileheight).floorSelf(),TileEnd=this.pixelToTileCoords(rect.pos.x+rect.width+tileset.tilewidth,rect.pos.y+rect.height+tileset.tileheight).ceilSelf(),rectEnd=this.tileToPixelCoords(TileEnd.x,TileEnd.y),startPos=this.tileToPixelCoords(rowItr.x,rowItr.y);startPos.x-=this.hTilewidth,startPos.y+=this.tileheight;var inUpperHalf=startPos.y-rect.pos.y>this.hTileheight,inLeftHalf=rect.pos.x-startPos.x<this.hTilewidth;inUpperHalf&&(inLeftHalf?(rowItr.x--,startPos.x-=this.hTilewidth):(rowItr.y--,startPos.x+=this.hTilewidth),startPos.y-=this.hTileheight);for(var shifted=inUpperHalf^inLeftHalf,columnItr=rowItr.clone(),y=startPos.y;y-this.tileheight<rectEnd.y;y+=this.hTileheight){columnItr.setV(rowItr);for(var x=startPos.x;rectEnd.x>x;x+=this.tilewidth){if(columnItr.x>=0&&columnItr.y>=0&&columnItr.x<this.cols&&columnItr.y<this.rows){var tmxTile=layer.layerData[columnItr.x][columnItr.y];tmxTile&&(tileset=tmxTile.tileset,offset=tileset.tileoffset,tileset.drawTile(context,offset.x+x,offset.y+y-tileset.tileheight,tmxTile))}columnItr.x++,columnItr.y--}shifted?(rowItr.y++,startPos.x-=this.hTilewidth,shifted=!1):(rowItr.x++,startPos.x+=this.hTilewidth,shifted=!0)}}})}(),function(){me.ColorLayer=me.Renderable.extend({init:function(name,color,z){this.parent(new me.Vector2d(0,0),1/0,1/0),this.name=name,this.color=color,this.z=z},draw:function(context,rect){var _alpha=context.globalAlpha;context.globalAlpha*=this.getOpacity(),context.fillStyle=this.color,context.fillRect(rect.left,rect.top,rect.width,rect.height),context.globalAlpha=_alpha}}),me.ImageLayer=me.Renderable.extend({init:function(name,width,height,imagesrc,z,ratio){if(this.name=name,this.image=imagesrc?me.loader.getImage(me.utils.getBasename(imagesrc)):null,!this.image)throw"melonJS: '"+imagesrc+"' file for Image Layer '"+this.name+"' not found!";this.imagewidth=this.image.width,this.imageheight=this.image.height;var viewport=me.game.viewport;width=width?Math.min(viewport.width,width):viewport.width,height=height?Math.min(viewport.height,height):viewport.height,this.parent(new me.Vector2d(0,0),width,height),this.z=z,this.ratio=new me.Vector2d(1,1),ratio!==void 0&&("number"==typeof ratio?this.ratio.set(ratio,ratio):this.ratio.setV(ratio)),this.lastpos=viewport.pos.clone(),this.floating=!0,this._repeat="repeat",this.repeatX=!0,this.repeatY=!0,Object.defineProperty(this,"repeat",{get:function get(){return this._repeat},set:function set(val){switch(this._repeat=val,this._repeat){case"no-repeat":this.repeatX=!1,this.repeatY=!1;break;case"repeat-x":this.repeatX=!0,this.repeatY=!1;break;case"repeat-y":this.repeatX=!1,this.repeatY=!0;break;default:this.repeatX=!0,this.repeatY=!0}}}),this.anchorPoint.set(0,0),this.handle=me.event.subscribe(me.event.VIEWPORT_ONCHANGE,this.updateLayer.bind(this))},updateLayer:function(vpos){(0!==this.ratio.x||0!==this.ratio.y)&&(this.repeatX||this.repeatY?(this.pos.x+=(vpos.x-this.lastpos.x)*this.ratio.x%this.imagewidth,this.pos.x=(this.imagewidth+this.pos.x)%this.imagewidth,this.pos.y+=(vpos.y-this.lastpos.y)*this.ratio.y%this.imageheight,this.pos.y=(this.imageheight+this.pos.y)%this.imageheight):(this.pos.x+=(vpos.x-this.lastpos.x)*this.ratio.x,this.pos.y+=(vpos.y-this.lastpos.y)*this.ratio.y),this.lastpos.setV(vpos))},draw:function(context,rect){var viewport=me.game.viewport,shouldTranslate=0!==this.anchorPoint.y||0!==this.anchorPoint.x,translateX=~~(this.anchorPoint.x*(viewport.width-this.imagewidth)),translateY=~~(this.anchorPoint.y*(viewport.height-this.imageheight));shouldTranslate&&context.translate(translateX,translateY),context.globalAlpha*=this.getOpacity();var sw,sh;if(0===this.ratio.x&&0===this.ratio.y)sw=Math.min(rect.width,this.imagewidth),sh=Math.min(rect.height,this.imageheight),context.drawImage(this.image,rect.left,rect.top,sw,sh,rect.left,rect.top,sw,sh);else{var sx=~~this.pos.x,sy=~~this.pos.y,dx=0,dy=0;for(sw=Math.min(this.imagewidth-sx,this.width),sh=Math.min(this.imageheight-sy,this.height);;){do context.drawImage(this.image,sx,sy,sw,sh,dx,dy,sw,sh),sy=0,dy+=sh,sh=Math.min(this.imageheight,this.height-dy);while(this.repeatY&&this.height>dy);if(dx+=sw,!this.repeatX||dx>=this.width)break;sx=0,sw=Math.min(this.imagewidth,this.width-dx),sy=~~this.pos.y,dy=0,sh=Math.min(this.imageheight-~~this.pos.y,this.height)}}shouldTranslate&&context.translate(-translateX,-translateY)},destroy:function(){this.handle&&(me.event.unsubscribe(this.handle),this.handle=null),this.image=null,this.lastpos=null}}),me.CollisionTiledLayer=me.Renderable.extend({init:function(width,height){this.parent(new me.Vector2d(0,0),width,height),this.isCollisionMap=!0},checkCollision:function(obj,pv){var x=0>pv.x?obj.left+pv.x:obj.right+pv.x,y=0>pv.y?obj.top+pv.y:obj.bottom+pv.y,res={x:0,y:0,xprop:{},yprop:{}};return(0>=x||x>=this.width)&&(res.x=pv.x),(0>=y||y>=this.height)&&(res.y=pv.y),res}}),me.TMXLayer=me.Renderable.extend({layerData:null,init:function(tilewidth,tileheight,orientation,tilesets,zOrder){this.parent(new me.Vector2d(0,0),0,0),this.tilewidth=tilewidth,this.tileheight=tileheight,this.orientation=orientation,this.tilesets=tilesets,this.tileset=this.tilesets?this.tilesets.getTilesetByIndex(0):null,this.z=zOrder},initFromJSON:function(layer){this.name=layer[me.TMX_TAG_NAME],this.cols=parseInt(layer[me.TMX_TAG_WIDTH],10),this.rows=parseInt(layer[me.TMX_TAG_HEIGHT],10);var visible=layer[me.TMX_TAG_VISIBLE]!==void 0?layer[me.TMX_TAG_VISIBLE]:!0;this.setOpacity(visible?parseFloat(layer[me.TMX_TAG_OPACITY]):0),this.width=this.cols*this.tilewidth,this.height=this.rows*this.tileheight,me.TMXUtils.applyTMXProperties(this,layer),this.preRender===void 0&&(this.preRender=me.sys.preRender),this.isCollisionMap=this.name.toLowerCase().contains(me.COLLISION_LAYER),this.isCollisionMap===!0&&this.setOpacity(0),this.preRender===!0&&(this.layerCanvas=me.video.createCanvas(this.cols*this.tilewidth,this.rows*this.tileheight),this.layerSurface=me.video.getContext2d(this.layerCanvas))},destroy:function(){this.preRender&&(this.layerCanvas=null,this.layerSurface=null),this.renderer=null,this.layerData=null,this.tileset=null,this.tilesets=null},setRenderer:function(renderer){this.renderer=renderer},initArray:function(w,h){this.layerData=[];for(var x=0;w>x;x++){this.layerData[x]=[];for(var y=0;h>y;y++)this.layerData[x][y]=null}},getTileId:function(x,y){var tile=this.getTile(x,y);return tile?tile.tileId:null},getTile:function(x,y){return this.layerData[~~(x/this.tilewidth)][~~(y/this.tileheight)]},setTile:function(x,y,tileId){var tile=new me.Tile(x,y,this.tilewidth,this.tileheight,tileId);return tile.tileset=this.tileset.contains(tile.tileId)?this.tileset:this.tileset=this.tilesets.getTilesetByGid(tile.tileId),this.layerData[x][y]=tile,tile},clearTile:function(x,y){this.layerData[x][y]=null,this.preRender&&this.layerSurface.clearRect(x*this.tilewidth,y*this.tileheight,this.tilewidth,this.tileheight)},checkCollision:function(obj,pv){var x=0>pv.x?~~(obj.left+pv.x):Math.ceil(obj.right-1+pv.x),y=0>pv.y?~~(obj.top+pv.y):Math.ceil(obj.bottom-1+pv.y),res={x:0,xtile:void 0,xprop:{},y:0,ytile:void 0,yprop:{}};return 0>=x||x>=this.width?res.x=pv.x:0!==pv.x&&(res.xtile=this.getTile(x,Math.ceil(obj.bottom-1)),res.xtile&&this.tileset.isTileCollidable(res.xtile.tileId)?(res.x=pv.x,res.xprop=this.tileset.getTileProperties(res.xtile.tileId)):(res.xtile=this.getTile(x,~~obj.top),res.xtile&&this.tileset.isTileCollidable(res.xtile.tileId)&&(res.x=pv.x,res.xprop=this.tileset.getTileProperties(res.xtile.tileId)))),res.ytile=this.getTile(0>pv.x?~~obj.left:Math.ceil(obj.right-1),y),res.ytile&&this.tileset.isTileCollidable(res.ytile.tileId)?(res.y=pv.y||1,res.yprop=this.tileset.getTileProperties(res.ytile.tileId)):(res.ytile=this.getTile(0>pv.x?Math.ceil(obj.right-1):~~obj.left,y),res.ytile&&this.tileset.isTileCollidable(res.ytile.tileId)&&(res.y=pv.y||1,res.yprop=this.tileset.getTileProperties(res.ytile.tileId))),res},draw:function(context,rect){if(this.preRender){var width=Math.min(rect.width,this.width),height=Math.min(rect.height,this.height);this.layerSurface.globalAlpha=context.globalAlpha*this.getOpacity(),this.layerSurface.globalAlpha>0&&context.drawImage(this.layerCanvas,rect.pos.x,rect.pos.y,width,height,rect.pos.x,rect.pos.y,width,height)}else{var _alpha=context.globalAlpha;context.globalAlpha*=this.getOpacity(),context.globalAlpha>0&&this.renderer.drawTileLayer(context,this,rect),context.globalAlpha=_alpha}}})}(),function(){me.TMXTileMap=me.Renderable.extend({init:function(levelId){this.levelId=levelId,this.z=0,this.name=null,this.cols=0,this.rows=0,this.tilewidth=0,this.tileheight=0,this.tilesets=null,this.mapLayers=[],this.objectGroups=[],this.version="",this.orientation="",this.tilesets=null,this.initialized=!1,this.parent(new me.Vector2d,0,0)},getObjectGroupByName:function(name){var objectGroup=null;name=name.trim().toLowerCase();for(var i=this.objectGroups.length;i--;)if(this.objectGroups[i].name.toLowerCase().contains(name)){objectGroup=this.objectGroups[i];break}return objectGroup},getObjectGroups:function(){return this.objectGroups},getLayers:function(){return this.mapLayers},getLayerByName:function(name){var layer=null;name=name.trim().toLowerCase();for(var i=this.mapLayers.length;i--;)if(this.mapLayers[i].name.toLowerCase().contains(name)){layer=this.mapLayers[i];break}return name.toLowerCase().contains(me.COLLISION_LAYER)&&null==layer&&(layer=new me.CollisionTiledLayer(me.game.currentLevel.width,me.game.currentLevel.height)),layer},clearTile:function(x,y){for(var i=this.mapLayers.length;i--;)this.mapLayers[i]instanceof me.TMXLayer&&this.mapLayers[i].clearTile(x,y)},destroy:function(){var i;if(this.initialized===!0){for(i=this.mapLayers.length;i--;)this.mapLayers[i]=null;for(i=this.objectGroups.length;i--;)this.objectGroups[i].destroy(),this.objectGroups[i]=null;this.tilesets=null,this.mapLayers.length=0,this.objectGroups.length=0,this.pos.set(0,0),this.initialized=!1}}})}(),function(){me.TMXMapReader=Object.extend({JSONReader:null,readMap:function(map){if(!map.initialized){if(null===this.JSONReader&&(this.JSONReader=new JSONMapReader),this.JSONReader.readJSONMap(map,me.loader.getTMX(map.levelId)),map.width<me.game.viewport.width||map.height<me.game.viewport.height){var shiftX=~~((me.game.viewport.width-map.width)/2),shiftY=~~((me.game.viewport.height-map.height)/2);map.pos.add({x:shiftX>0?shiftX:0,y:shiftY>0?shiftY:0})}map.initialized=!0}},getNewDefaultRenderer:function(obj){switch(obj.orientation){case"orthogonal":return new me.TMXOrthogonalRenderer(obj.cols,obj.rows,obj.tilewidth,obj.tileheight);case"isometric":return new me.TMXIsometricRenderer(obj.cols,obj.rows,obj.tilewidth,obj.tileheight);default:throw"melonJS: "+obj.orientation+" type TMX Tile Map not supported!"}},setLayerData:function(layer,rawdata,encoding,compression){layer.initArray(layer.cols,layer.rows);var data=Array.isArray(rawdata)===!0?rawdata:rawdata.value;switch(encoding){case"json":data=rawdata;break;case me.TMX_TAG_CSV:case me.TMX_TAG_ATTR_BASE64:encoding===me.TMX_TAG_CSV?data=me.utils.decodeCSV(data,layer.cols):(data=me.utils.decodeBase64AsArray(data,4),null!==compression&&(data=me.utils.decompress(data,compression)));break;default:throw"melonJS: TMX Tile Map "+encoding+" encoding not supported!"}for(var idx=0,y=0;layer.rows>y;y++)for(var x=0;layer.cols>x;x++){var gid=null==encoding?this.TMXParser.getIntAttribute(data[idx++],me.TMX_TAG_GID):data[idx++];if(0!==gid){var tile=layer.setTile(x,y,gid);layer.preRender&&layer.renderer.drawTile(layer.layerSurface,x,y,tile,tile.tileset)}}}});var JSONMapReader=me.TMXMapReader.extend({readJSONMap:function(map,data){if(!data)throw"melonJS:"+map.levelId+" TMX map not found";var zOrder=0,self=this;map.version=data[me.TMX_TAG_VERSION],map.orientation=data[me.TMX_TAG_ORIENTATION],map.cols=parseInt(data[me.TMX_TAG_WIDTH],10),map.rows=parseInt(data[me.TMX_TAG_HEIGHT],10),map.tilewidth=parseInt(data[me.TMX_TAG_TILEWIDTH],10),map.tileheight=parseInt(data[me.TMX_TAG_TILEHEIGHT],10),map.width=map.cols*map.tilewidth,map.height=map.rows*map.tileheight,map.backgroundcolor=data[me.TMX_BACKGROUND_COLOR],map.z=zOrder++,me.TMXUtils.applyTMXProperties(map,data),map.backgroundcolor&&map.mapLayers.push(new me.ColorLayer("background_color",map.backgroundcolor,zOrder++)),map.background_image&&map.mapLayers.push(new me.ImageLayer("background_image",map.width,map.height,map.background_image,zOrder++)),null!==me.game.renderer&&me.game.renderer.canRender(map)||(me.game.renderer=this.getNewDefaultRenderer(map)),map.tilesets||(map.tilesets=new me.TMXTilesetGroup);var tilesets=data.tilesets||data.tileset;if(Array.isArray(tilesets)===!0?tilesets.forEach(function(tileset){map.tilesets.add(self.readTileset(tileset))}):map.tilesets.add(self.readTileset(tilesets)),data.layers!==void 0)data.layers.forEach(function(layer){switch(layer.type){case me.TMX_TAG_IMAGE_LAYER:map.mapLayers.push(self.readImageLayer(map,layer,zOrder++));break;case me.TMX_TAG_TILE_LAYER:map.mapLayers.push(self.readLayer(map,layer,zOrder++));break;case me.TMX_TAG_OBJECTGROUP:map.objectGroups.push(self.readObjectGroup(map,layer,zOrder++));break;default:}});else if(data.layer!==void 0){var layers=data.layer;if(Array.isArray(layers)===!0?layers.forEach(function(layer){map.mapLayers.push(self.readLayer(map,layer,layer._draworder))}):map.mapLayers.push(self.readLayer(map,layers,layers._draworder)),data[me.TMX_TAG_OBJECTGROUP]!==void 0){var groups=data[me.TMX_TAG_OBJECTGROUP];Array.isArray(groups)===!0?groups.forEach(function(group){map.objectGroups.push(self.readObjectGroup(map,group,group._draworder))}):map.objectGroups.push(self.readObjectGroup(map,groups,groups._draworder))}if(data[me.TMX_TAG_IMAGE_LAYER]!==void 0){var imageLayers=data[me.TMX_TAG_IMAGE_LAYER];Array.isArray(imageLayers)===!0?imageLayers.forEach(function(imageLayer){map.mapLayers.push(self.readImageLayer(map,imageLayer,imageLayer._draworder))}):map.mapLayers.push(self.readImageLayer(map,imageLayers,imageLayers._draworder))}}},readLayer:function(map,data,z){var layer=new me.TMXLayer(map.tilewidth,map.tileheight,map.orientation,map.tilesets,z);layer.initFromJSON(data),me.game.renderer.canRender(layer)?layer.setRenderer(me.game.renderer):layer.setRenderer(me.mapReader.getNewDefaultRenderer(layer));var encoding=Array.isArray(data[me.TMX_TAG_DATA])?data[me.TMX_TAG_ENCODING]:data[me.TMX_TAG_DATA][me.TMX_TAG_ENCODING];return this.setLayerData(layer,data[me.TMX_TAG_DATA],encoding||"json",null),layer},readImageLayer:function(map,data,z){var iln=data[me.TMX_TAG_NAME],ilw=parseInt(data[me.TMX_TAG_WIDTH],10),ilh=parseInt(data[me.TMX_TAG_HEIGHT],10),ilsrc="string"!=typeof data[me.TMX_TAG_IMAGE]?data[me.TMX_TAG_IMAGE].source:data[me.TMX_TAG_IMAGE],imageLayer=new me.ImageLayer(iln,ilw*map.tilewidth,ilh*map.tileheight,ilsrc,z),visible=data[me.TMX_TAG_VISIBLE]!==void 0?data[me.TMX_TAG_VISIBLE]:!0;return imageLayer.setOpacity(visible===!0?parseFloat(data[me.TMX_TAG_OPACITY]||1).clamp(0,1):0),me.TMXUtils.applyTMXProperties(imageLayer,data),"number"==typeof imageLayer.ratio&&(imageLayer.ratio=new me.Vector2d(parseFloat(imageLayer.ratio),parseFloat(imageLayer.ratio))),imageLayer
},readTileset:function(data){return new me.TMXTileset(data)},readObjectGroup:function(map,data,z){return new me.TMXObjectGroup(data[me.TMX_TAG_NAME],data,map.tilesets,z)}})}(),function(){me.levelDirector=function(){var obj={},levels={},levelIdx=[],currentLevelIdx=0,loadTMXLevel=function(level,container){container.autoSort=!1,me.game.currentLevel=level,me.game.collisionMap=me.game.currentLevel.getLayerByName("collision"),me.game.collisionMap&&me.game.collisionMap.isCollisionMap||console.error("WARNING : no collision map detected");for(var layers=level.getLayers(),i=layers.length;i--;)container.addChild(layers[i]);me.game.viewport.setBounds(0,0,Math.max(level.width,me.game.viewport.width),Math.max(level.height,me.game.viewport.height));for(var targetContainer=container,objectGroups=level.getObjectGroups(),g=0;objectGroups.length>g;g++){var group=objectGroups[g];me.game.mergeGroup===!1&&(targetContainer=new me.ObjectContainer,targetContainer.name=group.name,targetContainer.z=group.z,targetContainer.setOpacity(group.opacity),targetContainer.autoSort=!1);for(var o=0;group.objects.length>o;o++){var settings=group.objects[o],obj=me.pool.pull(settings.name,settings.x,settings.y,"TileObject"===settings.name?settings.image:settings);obj&&(obj.z=group.z,me.game.mergeGroup===!0&&obj.isRenderable===!0&&(obj.setOpacity(obj.getOpacity()*group.opacity),obj.renderable instanceof me.Renderable&&obj.renderable.setOpacity(obj.renderable.getOpacity()*group.opacity)),targetContainer.addChild(obj))}me.game.mergeGroup===!1&&(container.addChild(targetContainer),targetContainer.autoSort=!0)}container.sort(!0),container.autoSort=!0,me.game.world.transform.translateV(me.game.currentLevel.pos),me.game.onLevelLoaded&&me.game.onLevelLoaded.call(me.game.onLevelLoaded,level.name),me.event.publish(me.event.LEVEL_LOADED,[level.name])};return obj.reset=function(){},obj.addLevel=function(){throw"melonJS: no level loader defined"},obj.addTMXLevel=function(levelId,callback){return null!=levels[levelId]?!1:(levels[levelId]=new me.TMXTileMap(levelId),levels[levelId].name=levelId,levelIdx.push(levelId),callback&&callback(),!0)},obj.loadLevel=function(levelId){if(levelId=(""+levelId).toLowerCase(),levels[levelId]===void 0)throw"melonJS: level "+levelId+" not found";if(!(levels[levelId]instanceof me.TMXTileMap))throw"melonJS: no level loader defined";var wasRunning=me.state.isRunning();return wasRunning&&me.state.stop(),me.game.reset(),me.utils.resetGUID(levelId),levels[obj.getCurrentLevelId()]&&levels[obj.getCurrentLevelId()].destroy(),me.mapReader.readMap(levels[levelId]),currentLevelIdx=levelIdx.indexOf(levelId),loadTMXLevel(levels[levelId],me.game.world),wasRunning&&me.state.restart.defer(this),!0},obj.getCurrentLevelId=function(){return levelIdx[currentLevelIdx]},obj.reloadLevel=function(){return obj.loadLevel(obj.getCurrentLevelId())},obj.nextLevel=function(){return levelIdx.length>currentLevelIdx+1?obj.loadLevel(levelIdx[currentLevelIdx+1]):!1},obj.previousLevel=function(){return currentLevelIdx-1>=0?obj.loadLevel(levelIdx[currentLevelIdx-1]):!1},obj.levelCount=function(){return levelIdx.length},obj}()}(),function(){me.Tween=function(object){var _object=object,_valuesStart={},_valuesEnd={},_valuesStartRepeat={},_duration=1e3,_repeat=0,_yoyo=!1,_reversed=!1,_delayTime=0,_startTime=null,_easingFunction=me.Tween.Easing.Linear.None,_interpolationFunction=me.Tween.Interpolation.Linear,_chainedTweens=[],_onStartCallback=null,_onStartCallbackFired=!1,_onUpdateCallback=null,_onCompleteCallback=null;for(var field in object)_valuesStart[field]=parseFloat(object[field],10);this.onResetEvent=function(object){_object=object,_valuesStart={},_valuesEnd={},_valuesStartRepeat={},_easingFunction=me.Tween.Easing.Linear.None,_interpolationFunction=me.Tween.Interpolation.Linear,_yoyo=!1,_reversed=!1,_duration=1e3,_delayTime=0,_onStartCallback=null,_onStartCallbackFired=!1,_onUpdateCallback=null,_onCompleteCallback=null},this.to=function(properties,duration){return void 0!==duration&&(_duration=duration),_valuesEnd=properties,this},this.start=function(time){_onStartCallbackFired=!1,me.game.world.addChild(this),_startTime=(time===void 0?me.timer.getTime():time)+_delayTime;for(var property in _valuesEnd){if(_valuesEnd[property]instanceof Array){if(0===_valuesEnd[property].length)continue;_valuesEnd[property]=[_object[property]].concat(_valuesEnd[property])}_valuesStart[property]=_object[property],_valuesStart[property]instanceof Array==!1&&(_valuesStart[property]*=1),_valuesStartRepeat[property]=_valuesStart[property]||0}return this},this.stop=function(){return me.game.world.hasChild(this)&&me.game.world.removeChildNow(this),this},this.delay=function(amount){return _delayTime=amount,this},me.event.subscribe(me.event.STATE_RESUME,function onResume(elapsed){_startTime&&(_startTime+=elapsed)}),this.repeat=function(times){return _repeat=times,this},this.yoyo=function(yoyo){return _yoyo=yoyo,this},this.easing=function(easing){if("function"!=typeof easing)throw"melonJS: invalid easing function for me.Tween.easing()";return _easingFunction=easing,this},this.interpolation=function(interpolation){return _interpolationFunction=interpolation,this},this.chain=function(){return _chainedTweens=arguments,this},this.onStart=function(callback){return _onStartCallback=callback,this},this.onUpdate=function(callback){return _onUpdateCallback=callback,this},this.onComplete=function(callback){return _onCompleteCallback=callback,this},this.update=function(dt){var time=me.timer.getTime(),property;if(_startTime>time)return!0;_onStartCallbackFired===!1&&(null!==_onStartCallback&&_onStartCallback.call(_object),_onStartCallbackFired=!0);var elapsed=(time-_startTime)/_duration;elapsed=elapsed>1?1:elapsed;var value=_easingFunction(elapsed);for(property in _valuesEnd){var start=_valuesStart[property]||0,end=_valuesEnd[property];end instanceof Array?_object[property]=_interpolationFunction(end,value):("string"==typeof end&&(end=start+parseFloat(end,10)),"number"==typeof end&&(_object[property]=start+(end-start)*value))}if(null!==_onUpdateCallback&&_onUpdateCallback.call(_object,value),1===elapsed){if(_repeat>0){isFinite(_repeat)&&_repeat--;for(property in _valuesStartRepeat){if("string"==typeof _valuesEnd[property]&&(_valuesStartRepeat[property]=_valuesStartRepeat[property]+parseFloat(_valuesEnd[property],10)),_yoyo){var tmp=_valuesStartRepeat[property];_valuesStartRepeat[property]=_valuesEnd[property],_valuesEnd[property]=tmp,_reversed=!_reversed}_valuesStart[property]=_valuesStartRepeat[property]}return _startTime=time+_delayTime,!0}me.game.world.removeChildNow(this),null!==_onCompleteCallback&&_onCompleteCallback.call(_object);for(var i=0,numChainedTweens=_chainedTweens.length;numChainedTweens>i;i++)_chainedTweens[i].start(time);return!1}return!0}},me.Tween.Easing={Linear:{None:function(k){return k}},Quadratic:{In:function(k){return k*k},Out:function(k){return k*(2-k)},InOut:function(k){return 1>(k*=2)?.5*k*k:-.5*(--k*(k-2)-1)}},Cubic:{In:function(k){return k*k*k},Out:function(k){return--k*k*k+1},InOut:function(k){return 1>(k*=2)?.5*k*k*k:.5*((k-=2)*k*k+2)}},Quartic:{In:function(k){return k*k*k*k},Out:function(k){return 1- --k*k*k*k},InOut:function(k){return 1>(k*=2)?.5*k*k*k*k:-.5*((k-=2)*k*k*k-2)}},Quintic:{In:function(k){return k*k*k*k*k},Out:function(k){return--k*k*k*k*k+1},InOut:function(k){return 1>(k*=2)?.5*k*k*k*k*k:.5*((k-=2)*k*k*k*k+2)}},Sinusoidal:{In:function(k){return 1-Math.cos(k*Math.PI/2)},Out:function(k){return Math.sin(k*Math.PI/2)},InOut:function(k){return.5*(1-Math.cos(Math.PI*k))}},Exponential:{In:function(k){return 0===k?0:Math.pow(1024,k-1)},Out:function(k){return 1===k?1:1-Math.pow(2,-10*k)},InOut:function(k){return 0===k?0:1===k?1:1>(k*=2)?.5*Math.pow(1024,k-1):.5*(-Math.pow(2,-10*(k-1))+2)}},Circular:{In:function(k){return 1-Math.sqrt(1-k*k)},Out:function(k){return Math.sqrt(1- --k*k)},InOut:function(k){return 1>(k*=2)?-.5*(Math.sqrt(1-k*k)-1):.5*(Math.sqrt(1-(k-=2)*k)+1)}},Elastic:{In:function(k){var s,a=.1,p=.4;return 0===k?0:1===k?1:(!a||1>a?(a=1,s=p/4):s=p*Math.asin(1/a)/(2*Math.PI),-(a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*2*Math.PI/p)))},Out:function(k){var s,a=.1,p=.4;return 0===k?0:1===k?1:(!a||1>a?(a=1,s=p/4):s=p*Math.asin(1/a)/(2*Math.PI),a*Math.pow(2,-10*k)*Math.sin((k-s)*2*Math.PI/p)+1)},InOut:function(k){var s,a=.1,p=.4;return 0===k?0:1===k?1:(!a||1>a?(a=1,s=p/4):s=p*Math.asin(1/a)/(2*Math.PI),1>(k*=2)?-.5*a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*2*Math.PI/p):.5*a*Math.pow(2,-10*(k-=1))*Math.sin((k-s)*2*Math.PI/p)+1)}},Back:{In:function(k){var s=1.70158;return k*k*((s+1)*k-s)},Out:function(k){var s=1.70158;return--k*k*((s+1)*k+s)+1},InOut:function(k){var s=2.5949095;return 1>(k*=2)?.5*k*k*((s+1)*k-s):.5*((k-=2)*k*((s+1)*k+s)+2)}},Bounce:{In:function(k){return 1-me.Tween.Easing.Bounce.Out(1-k)},Out:function(k){return 1/2.75>k?7.5625*k*k:2/2.75>k?7.5625*(k-=1.5/2.75)*k+.75:2.5/2.75>k?7.5625*(k-=2.25/2.75)*k+.9375:7.5625*(k-=2.625/2.75)*k+.984375},InOut:function(k){return.5>k?.5*me.Tween.Easing.Bounce.In(2*k):.5*me.Tween.Easing.Bounce.Out(2*k-1)+.5}}},me.Tween.Interpolation={Linear:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f),fn=me.Tween.Interpolation.Utils.Linear;return 0>k?fn(v[0],v[1],f):k>1?fn(v[m],v[m-1],m-f):fn(v[i],v[i+1>m?m:i+1],f-i)},Bezier:function(v,k){var b=0,n=v.length-1,pw=Math.pow,bn=me.Tween.Interpolation.Utils.Bernstein,i;for(i=0;n>=i;i++)b+=pw(1-k,n-i)*pw(k,i)*v[i]*bn(n,i);return b},CatmullRom:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f),fn=me.Tween.Interpolation.Utils.CatmullRom;return v[0]===v[m]?(0>k&&(i=Math.floor(f=m*(1+k))),fn(v[(i-1+m)%m],v[i],v[(i+1)%m],v[(i+2)%m],f-i)):0>k?v[0]-(fn(v[0],v[0],v[1],v[1],-f)-v[0]):k>1?v[m]-(fn(v[m],v[m],v[m-1],v[m-1],f-m)-v[m]):fn(v[i?i-1:0],v[i],v[i+1>m?m:i+1],v[i+2>m?m:i+2],f-i)},Utils:{Linear:function(p0,p1,t){return(p1-p0)*t+p0},Bernstein:function(n,i){var fc=me.Tween.Interpolation.Utils.Factorial;return fc(n)/fc(i)/fc(n-i)},Factorial:function(){var a=[1];return function(n){var s=1,i;if(a[n])return a[n];for(i=n;i>1;i--)s*=i;return a[n]=s}}(),CatmullRom:function(p0,p1,p2,p3,t){var v0=.5*(p2-p0),v1=.5*(p3-p1),t2=t*t,t3=t*t2;return(2*p1-2*p2+v0+v1)*t3+(-3*p1+3*p2-2*v0-v1)*t2+v0*t+p1}}}}(),function(){me.event=function(){var obj={},cache={};return obj.STATE_PAUSE="me.state.onPause",obj.STATE_RESUME="me.state.onResume",obj.STATE_STOP="me.state.onStop",obj.STATE_RESTART="me.state.onRestart",obj.GAME_INIT="me.game.onInit",obj.LEVEL_LOADED="me.game.onLevelLoaded",obj.LOADER_COMPLETE="me.loader.onload",obj.LOADER_PROGRESS="me.loader.onProgress",obj.KEYDOWN="me.input.keydown",obj.KEYUP="me.input.keyup",obj.MOUSEMOVE="me.game.pointermove",obj.DRAGSTART="me.game.dragstart",obj.DRAGEND="me.game.dragend",obj.WINDOW_ONRESIZE="window.onresize",obj.WINDOW_ONORIENTATION_CHANGE="window.orientationchange",obj.WINDOW_ONSCROLL="window.onscroll",obj.VIEWPORT_ONCHANGE="viewport.onchange",obj.publish=function(channel,args){for(var subs=cache[channel],len=subs?subs.length:0;len--;)subs[len].apply(window,args||[])},obj.subscribe=function(channel,callback){return cache[channel]||(cache[channel]=[]),cache[channel].push(callback),[channel,callback]},obj.unsubscribe=function(handle,callback){var subs=cache[callback?handle:handle[0]],len=subs?subs.length:0;for(callback=callback||handle[1];len--;)subs[len]===callback&&subs.splice(len,1)},obj}()}(),function(){var cache={},ctx=null,usingWebAudio=!0,noAudio=!1;try{"undefined"!=typeof AudioContext?ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?ctx=new webkitAudioContext:usingWebAudio=!1}catch(e){usingWebAudio=!1}if(!usingWebAudio)if("undefined"!=typeof Audio)try{new Audio}catch(e){noAudio=!0}else noAudio=!0;if(usingWebAudio){var masterGain=ctx.createGain===void 0?ctx.createGainNode():ctx.createGain();masterGain.gain.value=1,masterGain.connect(ctx.destination)}var HowlerGlobal=function(){this._volume=1,this._muted=!1,this.usingWebAudio=usingWebAudio,this.noAudio=noAudio,this._howls=[]};HowlerGlobal.prototype={volume:function(vol){var self=this;if(vol=parseFloat(vol),vol>=0&&1>=vol){self._volume=vol,usingWebAudio&&(masterGain.gain.value=vol);for(var key in self._howls)if(self._howls.hasOwnProperty(key)&&self._howls[key]._webAudio===!1)for(var i=0;self._howls[key]._audioNode.length>i;i++)self._howls[key]._audioNode[i].volume=self._howls[key]._volume*self._volume;return self}return usingWebAudio?masterGain.gain.value:self._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(muted){var self=this;self._muted=muted,usingWebAudio&&(masterGain.gain.value=muted?0:self._volume);for(var key in self._howls)if(self._howls.hasOwnProperty(key)&&self._howls[key]._webAudio===!1)for(var i=0;self._howls[key]._audioNode.length>i;i++)self._howls[key]._audioNode[i].muted=muted}};var Howler=new HowlerGlobal,audioTest=null;if(!noAudio){audioTest=new Audio;var codecs={mp3:!!audioTest.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!audioTest.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!audioTest.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!audioTest.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),m4a:!!(audioTest.canPlayType("audio/x-m4a;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(audioTest.canPlayType("audio/x-mp4;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!audioTest.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")}}var Howl=function(o){var self=this;self._autoplay=o.autoplay||!1,self._buffer=o.buffer||!1,self._duration=o.duration||0,self._format=o.format||null,self._loop=o.loop||!1,self._loaded=!1,self._sprite=o.sprite||{},self._src=o.src||"",self._pos3d=o.pos3d||[0,0,-.5],self._volume=void 0!==o.volume?o.volume:1,self._urls=o.urls||[],self._rate=o.rate||1,self._model=o.model||null,self._onload=[o.onload||function(){}],self._onloaderror=[o.onloaderror||function(){}],self._onend=[o.onend||function(){}],self._onpause=[o.onpause||function(){}],self._onplay=[o.onplay||function(){}],self._onendTimer=[],self._webAudio=usingWebAudio&&!self._buffer,self._audioNode=[],self._webAudio&&self._setupAudioNode(),Howler._howls.push(self),self.load()};if(Howl.prototype={load:function(){var self=this,url=null;if(noAudio)return self.on("loaderror"),void 0;for(var i=0;self._urls.length>i;i++){var ext,urlItem;if(self._format)ext=self._format;else{if(urlItem=self._urls[i].toLowerCase().split("?")[0],ext=urlItem.match(/.+\.([^?]+)(\?|$)/),ext=ext&&ext.length>=2?ext:urlItem.match(/data\:audio\/([^?]+);/),!ext)return self.on("loaderror"),void 0;ext=ext[1]}if(codecs[ext]){url=self._urls[i];break}}if(!url)return self.on("loaderror"),void 0;if(self._src=url,self._webAudio)loadBuffer(self,url);else{var newNode=new Audio;newNode.addEventListener("error",function(){newNode.error&&4===newNode.error.code&&(HowlerGlobal.noAudio=!0),self.on("loaderror",{type:newNode.error?newNode.error.code:0})},!1),self._audioNode.push(newNode),newNode.src=url,newNode._pos=0,newNode.preload="auto",newNode.volume=Howler._muted?0:self._volume*Howler.volume(),cache[url]=self;var listener=function(){self._duration=Math.ceil(10*newNode.duration)/10,0===Object.getOwnPropertyNames(self._sprite).length&&(self._sprite={_default:[0,1e3*self._duration]}),self._loaded||(self._loaded=!0,self.on("load")),self._autoplay&&self.play(),newNode.removeEventListener("canplaythrough",listener,!1)};newNode.addEventListener("canplaythrough",listener,!1),newNode.load()}return self},urls:function(urls){var self=this;return urls?(self.stop(),self._urls="string"==typeof urls?[urls]:urls,self._loaded=!1,self.load(),self):self._urls},play:function(sprite,callback){var self=this;return"function"==typeof sprite&&(callback=sprite),sprite&&"function"!=typeof sprite||(sprite="_default"),self._loaded?self._sprite[sprite]?(self._inactiveNode(function(node){node._sprite=sprite;var pos=node._pos>0?node._pos:self._sprite[sprite][0]/1e3,duration=self._sprite[sprite][1]/1e3-node._pos,loop=!(!self._loop&&!self._sprite[sprite][2]),soundId="string"==typeof callback?callback:Math.round(Date.now()*Math.random())+"",timerId;if(function(){var data={id:soundId,sprite:sprite,loop:loop};timerId=setTimeout(function(){!self._webAudio&&loop&&self.stop(data.id).play(sprite,data.id),self._webAudio&&!loop&&(self._nodeById(data.id).paused=!0,self._nodeById(data.id)._pos=0),self._webAudio||loop||self.stop(data.id),self.on("end",soundId)},1e3*duration),self._onendTimer.push({timer:timerId,id:data.id})}(),self._webAudio){var loopStart=self._sprite[sprite][0]/1e3,loopEnd=self._sprite[sprite][1]/1e3;node.id=soundId,node.paused=!1,refreshBuffer(self,[loop,loopStart,loopEnd],soundId),self._playStart=ctx.currentTime,node.gain.value=self._volume,node.bufferSource.start===void 0?node.bufferSource.noteGrainOn(0,pos,duration):node.bufferSource.start(0,pos,duration)}else{if(4!==node.readyState&&(node.readyState||!navigator.isCocoonJS))return self._clearEndTimer(soundId),function(){var sound=self,playSprite=sprite,fn=callback,newNode=node,listener=function(){sound.play(playSprite,fn),newNode.removeEventListener("canplaythrough",listener,!1)};newNode.addEventListener("canplaythrough",listener,!1)}(),self;node.readyState=4,node.id=soundId,node.currentTime=pos,node.muted=Howler._muted||node.muted,node.volume=self._volume*Howler.volume(),setTimeout(function(){node.play()},0)}return self.on("play"),"function"==typeof callback&&callback(soundId),self}),self):("function"==typeof callback&&callback(),self):(self.on("load",function(){self.play(sprite,callback)}),self)},pause:function(id){var self=this;if(!self._loaded)return self.on("play",function(){self.pause(id)}),self;self._clearEndTimer(id);var activeNode=id?self._nodeById(id):self._activeNode();if(activeNode)if(activeNode._pos=self.pos(null,id),self._webAudio){if(!activeNode.bufferSource||activeNode.paused)return self;activeNode.paused=!0,activeNode.bufferSource.stop===void 0?activeNode.bufferSource.noteOff(0):activeNode.bufferSource.stop(0)}else activeNode.pause();return self.on("pause"),self},stop:function(id){var self=this;if(!self._loaded)return self.on("play",function(){self.stop(id)}),self;self._clearEndTimer(id);var activeNode=id?self._nodeById(id):self._activeNode();if(activeNode)if(activeNode._pos=0,self._webAudio){if(!activeNode.bufferSource||activeNode.paused)return self;activeNode.paused=!0,activeNode.bufferSource.stop===void 0?activeNode.bufferSource.noteOff(0):activeNode.bufferSource.stop(0)}else isNaN(activeNode.duration)||(activeNode.pause(),activeNode.currentTime=0);return self},mute:function(id){var self=this;if(!self._loaded)return self.on("play",function(){self.mute(id)}),self;var activeNode=id?self._nodeById(id):self._activeNode();return activeNode&&(self._webAudio?activeNode.gain.value=0:activeNode.muted=!0),self},unmute:function(id){var self=this;if(!self._loaded)return self.on("play",function(){self.unmute(id)}),self;var activeNode=id?self._nodeById(id):self._activeNode();return activeNode&&(self._webAudio?activeNode.gain.value=self._volume:activeNode.muted=!1),self},volume:function(vol,id){var self=this;if(vol=parseFloat(vol),vol>=0&&1>=vol){if(self._volume=vol,!self._loaded)return self.on("play",function(){self.volume(vol,id)}),self;var activeNode=id?self._nodeById(id):self._activeNode();return activeNode&&(self._webAudio?activeNode.gain.value=vol:activeNode.volume=vol*Howler.volume()),self}return self._volume},loop:function(loop){var self=this;return"boolean"==typeof loop?(self._loop=loop,self):self._loop},sprite:function(sprite){var self=this;return"object"==typeof sprite?(self._sprite=sprite,self):self._sprite},pos:function(pos,id){var self=this;if(!self._loaded)return self.on("load",function(){self.pos(pos)}),"number"==typeof pos?self:self._pos||0;pos=parseFloat(pos);var activeNode=id?self._nodeById(id):self._activeNode();if(activeNode)return pos>=0?(self.pause(id),activeNode._pos=pos,self.play(activeNode._sprite,id),self):self._webAudio?activeNode._pos+(ctx.currentTime-self._playStart):activeNode.currentTime;if(pos>=0)return self;for(var i=0;self._audioNode.length>i;i++)if(self._audioNode[i].paused&&4===self._audioNode[i].readyState)return self._webAudio?self._audioNode[i]._pos:self._audioNode[i].currentTime},pos3d:function(x,y,z,id){var self=this;if(y=void 0!==y&&y?y:0,z=void 0!==z&&z?z:-.5,!self._loaded)return self.on("play",function(){self.pos3d(x,y,z,id)}),self;if(!(x>=0||0>x))return self._pos3d;if(self._webAudio){var activeNode=id?self._nodeById(id):self._activeNode();activeNode&&(self._pos3d=[x,y,z],activeNode.panner.setPosition(x,y,z),activeNode.panner.panningModel=self._model||"HRTF")}return self},fade:function(from,to,len,callback,id){var self=this,diff=Math.abs(from-to),dir=from>to?"down":"up",steps=diff/.01,stepTime=len/steps;if(!self._loaded)return self.on("load",function(){self.fade(from,to,len,callback,id)}),self;self.volume(from,id);for(var i=1;steps>=i;i++)(function(){var change=self._volume+("up"===dir?.01:-.01)*i,vol=Math.round(1e3*change)/1e3,toVol=to;setTimeout(function(){self.volume(vol,id),vol===toVol&&callback&&callback()},stepTime*i)})()},fadeIn:function(to,len,callback){return this.volume(0).play().fade(0,to,len,callback)},fadeOut:function(to,len,callback,id){var self=this;return self.fade(self._volume,to,len,function(){callback&&callback(),self.pause(id),self.on("end")},id)},_nodeById:function(id){for(var self=this,node=self._audioNode[0],i=0;self._audioNode.length>i;i++)if(self._audioNode[i].id===id){node=self._audioNode[i];break}return node},_activeNode:function(){for(var self=this,node=null,i=0;self._audioNode.length>i;i++)if(!self._audioNode[i].paused){node=self._audioNode[i];break}return self._drainPool(),node},_inactiveNode:function(callback){for(var self=this,node=null,i=0;self._audioNode.length>i;i++)if(self._audioNode[i].paused&&4===self._audioNode[i].readyState){callback(self._audioNode[i]),node=!0;break}if(self._drainPool(),!node){var newNode;self._webAudio?(newNode=self._setupAudioNode(),callback(newNode)):(self.load(),newNode=self._audioNode[self._audioNode.length-1],newNode.addEventListener(navigator.isCocoonJS?"canplaythrough":"loadedmetadata",function(){callback(newNode)}))}},_drainPool:function(){var self=this,inactive=0,i;for(i=0;self._audioNode.length>i;i++)self._audioNode[i].paused&&inactive++;for(i=self._audioNode.length-1;i>=0&&!(5>=inactive);i--)self._audioNode[i].paused&&(self._webAudio&&self._audioNode[i].disconnect(0),inactive--,self._audioNode.splice(i,1))},_clearEndTimer:function(soundId){for(var self=this,index=0,i=0;self._onendTimer.length>i;i++)if(self._onendTimer[i].id===soundId){index=i;break}var timer=self._onendTimer[index];timer&&(clearTimeout(timer.timer),self._onendTimer.splice(index,1))},_setupAudioNode:function(){var self=this,node=self._audioNode,index=self._audioNode.length;return node[index]=ctx.createGain===void 0?ctx.createGainNode():ctx.createGain(),node[index].gain.value=self._volume,node[index].paused=!0,node[index]._pos=0,node[index].readyState=4,node[index].connect(masterGain),node[index].panner=ctx.createPanner(),node[index].panner.panningModel=self._model||"equalpower",node[index].panner.setPosition(self._pos3d[0],self._pos3d[1],self._pos3d[2]),node[index].panner.connect(node[index]),node[index]},on:function(event,fn){var self=this,events=self["_on"+event];if("function"==typeof fn)events.push(fn);else for(var i=0;events.length>i;i++)fn?events[i].call(self,fn):events[i].call(self);return self},off:function(event,fn){for(var self=this,events=self["_on"+event],fnString=""+fn,i=0;events.length>i;i++)if(fnString===""+events[i]){events.splice(i,1);break}return self},unload:function(){for(var self=this,nodes=self._audioNode,i=0;self._audioNode.length>i;i++)nodes[i].paused||self.stop(nodes[i].id),self._webAudio?nodes[i].disconnect(0):nodes[i].src="";for(i=0;self._onendTimer.length>i;i++)clearTimeout(self._onendTimer[i].timer);var index=Howler._howls.indexOf(self);null!==index&&index>=0&&Howler._howls.splice(index,1),delete cache[self._src],self=null}},usingWebAudio)var loadBuffer=function(obj,url){if(url in cache)obj._duration=cache[url].duration,loadSound(obj);else{var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="arraybuffer",xhr.onload=function(){ctx.decodeAudioData(xhr.response,function(buffer){buffer&&(cache[url]=buffer,loadSound(obj,buffer))},function(err){obj.on("loaderror")})},xhr.onerror=function(){obj._webAudio&&(obj._buffer=!0,obj._webAudio=!1,obj._audioNode=[],delete obj._gainNode,obj.load())};try{xhr.send()}catch(e){xhr.onerror()}}},loadSound=function(obj,buffer){obj._duration=buffer?buffer.duration:obj._duration,0===Object.getOwnPropertyNames(obj._sprite).length&&(obj._sprite={_default:[0,1e3*obj._duration]}),obj._loaded||(obj._loaded=!0,obj.on("load")),obj._autoplay&&obj.play()},refreshBuffer=function(obj,loop,id){var node=obj._nodeById(id);node.bufferSource=ctx.createBufferSource(),node.bufferSource.buffer=cache[obj._src],node.bufferSource.connect(node.panner),node.bufferSource.loop=loop[0],loop[0]&&(node.bufferSource.loopStart=loop[1],node.bufferSource.loopEnd=loop[1]+loop[2]),node.bufferSource.playbackRate.value=obj._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:Howler,Howl:Howl}}),"undefined"!=typeof exports&&(exports.Howler=Howler,exports.Howl=Howl),"undefined"!=typeof window&&(window.Howler=Howler,window.Howl=Howl)}(),function(){me.plugin=function(){var singleton={};return singleton.Base=Object.extend({version:void 0,init:function(){}}),singleton.patch=function(proto,name,fn){if(proto.prototype!==void 0&&(proto=proto.prototype),"function"==typeof proto[name]){var _parent=proto[name];proto[name]=function(name,fn){return function(){var tmp=this.parent;this.parent=_parent;var ret=fn.apply(this,arguments);return this.parent=tmp,ret}}(name,fn)}else console.error(name+" is not an existing function")},singleton.register=function(plugin,name){if(me.plugin[name]&&console.error("plugin "+name+" already registered"),plugin.prototype.version===void 0)throw"melonJS: Plugin version not defined!";if(me.sys.checkVersion(plugin.prototype.version)>0)throw"melonJS: Plugin version mismatch, expected: "+plugin.prototype.version+", got: "+me.version;var _args=[];if(arguments.length>2&&(_args=Array.prototype.slice.call(arguments,1)),_args[0]=plugin,me.plugin[name]=new(plugin.bind.apply(plugin,_args)),!(me.plugin[name]instanceof me.plugin.Base))throw"melonJS: Plugin should extend the me.plugin.Base Class !"},singleton}()}(),me.DraggableEntity=function(Entity,Input,Event,Vector){"use strict";return Entity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.dragging=!1,this.dragId=null,this.grabOffset=new Vector(0,0),this.onPointerEvent=Input.registerPointerEvent,this.removePointerEvent=Input.releasePointerEvent,this.initEvents()},initEvents:function(){var self=this;this.mouseDown=function(e){this.translatePointerEvent(e,Event.DRAGSTART)},this.mouseUp=function(e){this.translatePointerEvent(e,Event.DRAGEND)},this.onPointerEvent("pointerdown",this,this.mouseDown.bind(this)),this.onPointerEvent("pointerup",this,this.mouseUp.bind(this)),Event.subscribe(Event.MOUSEMOVE,this.dragMove.bind(this)),Event.subscribe(Event.DRAGSTART,function(e,draggable){draggable===self&&self.dragStart(e)}),Event.subscribe(Event.DRAGEND,function(e,draggable){draggable===self&&self.dragEnd(e)})},translatePointerEvent:function(e,translation){Event.publish(translation,[e,this])},dragStart:function(e){return this.dragging===!1?(this.dragging=!0,this.dragId=e.pointerId,this.grabOffset.set(e.gameX,e.gameY),this.grabOffset.sub(this.pos),!1):void 0},dragMove:function(e){this.dragging===!0&&this.dragId===e.pointerId&&(this.pos.set(e.gameX,e.gameY),this.pos.sub(this.grabOffset))},dragEnd:function(){return this.dragging===!0?(this.pointerId=void 0,this.dragging=!1,!1):void 0},destroy:function(){Event.unsubscribe(Event.MOUSEMOVE,this.dragMove),Event.unsubscribe(Event.DRAGSTART,this.dragStart),Event.unsubscribe(Event.DRAGEND,this.dragEnd),this.removePointerEvent("pointerdown",this),this.removePointerEvent("pointerup",this)}})}(me.ObjectEntity,me.input,me.event,me.Vector2d),me.DroptargetEntity=function(Entity,Event){"use strict";return Entity.extend({CHECKMETHOD_OVERLAP:"overlaps",CHECKMETHOD_CONTAINS:"contains",checkMethod:null,init:function(x,y,settings){this.parent(x,y,settings),Event.subscribe(Event.DRAGEND,this.checkOnMe.bind(this)),this.checkMethod=this[this.CHECKMETHOD_OVERLAP]},setCheckMethod:function(checkMethod){this[checkMethod]!==void 0&&(this.checkMethod=this[checkMethod])},checkOnMe:function(e,draggableEntity){draggableEntity&&this.checkMethod(draggableEntity.getBounds().translateV(draggableEntity.pos))&&this.drop(draggableEntity)},drop:function(){},destroy:function(){Event.unsubscribe(Event.DRAGEND,this.checkOnMe)}})}(me.ObjectEntity,me.event),function(){var pixel=function(){var canvas=me.video.createCanvas(1,1),context=me.video.getContext2d(canvas);return context.fillStyle="#fff",context.fillRect(0,0,1,1),canvas}();me.ParticleEmitterSettings={width:0,height:0,image:pixel,totalParticles:50,angle:Math.PI/2,angleVariation:0,minLife:1e3,maxLife:3e3,speed:2,speedVariation:1,minRotation:0,maxRotation:0,minStartScale:1,maxStartScale:1,minEndScale:0,maxEndScale:0,gravity:0,wind:0,followTrajectory:!1,textureAdditive:!1,onlyInViewport:!0,floating:!1,maxParticles:10,frequency:100,duration:1/0,framesToSkip:0},me.ParticleEmitter=me.Rect.extend({_stream:!1,_frequencyTimer:0,_durationTimer:0,_enabled:!1,isRenderable:!1,init:function(x,y,settings){this.parent(new me.Vector2d(x,y),1/0,1/0),this.autoSort=!1,this.container=new me.ParticleContainer(this),Object.defineProperty(this,"z",{get:function(){return this.container.z},set:function(value){this.container.z=value},enumerable:!0,configurable:!0}),Object.defineProperty(this,"floating",{get:function(){return this.container.floating},set:function(value){this.container.floating=value},enumerable:!0,configurable:!0}),this.reset(settings)},destroy:function(){this.reset()},getRandomPoint:function(){var vector=this.pos.clone();return vector.x+=Number.prototype.random(0,this.width),vector.y+=Number.prototype.random(0,this.height),vector},reset:function(settings){settings=settings||{};var defaults=me.ParticleEmitterSettings,width="number"==typeof settings.width?settings.width:defaults.width,height="number"==typeof settings.height?settings.height:defaults.height;this.resize(width,height),this.image=settings.image||defaults.image,this.totalParticles="number"==typeof settings.totalParticles?settings.totalParticles:defaults.totalParticles,this.angle="number"==typeof settings.angle?settings.angle:defaults.angle,this.angleVariation="number"==typeof settings.angleVariation?settings.angleVariation:defaults.angleVariation,this.minLife="number"==typeof settings.minLife?settings.minLife:defaults.minLife,this.maxLife="number"==typeof settings.maxLife?settings.maxLife:defaults.maxLife,this.speed="number"==typeof settings.speed?settings.speed:defaults.speed,this.speedVariation="number"==typeof settings.speedVariation?settings.speedVariation:defaults.speedVariation,this.minRotation="number"==typeof settings.minRotation?settings.minRotation:defaults.minRotation,this.maxRotation="number"==typeof settings.maxRotation?settings.maxRotation:defaults.maxRotation,this.minStartScale="number"==typeof settings.minStartScale?settings.minStartScale:defaults.minStartScale,this.maxStartScale="number"==typeof settings.maxStartScale?settings.maxStartScale:defaults.maxStartScale,this.minEndScale="number"==typeof settings.minEndScale?settings.minEndScale:defaults.minEndScale,this.maxEndScale="number"==typeof settings.maxEndScale?settings.maxEndScale:defaults.maxEndScale,this.gravity="number"==typeof settings.gravity?settings.gravity:defaults.gravity,this.wind="number"==typeof settings.wind?settings.wind:defaults.wind,this.followTrajectory="boolean"==typeof settings.followTrajectory?settings.followTrajectory:defaults.followTrajectory,this.textureAdditive="boolean"==typeof settings.textureAdditive?settings.textureAdditive:defaults.textureAdditive,this.onlyInViewport="boolean"==typeof settings.onlyInViewport?settings.onlyInViewport:defaults.onlyInViewport,this.floating="boolean"==typeof settings.floating?settings.floating:defaults.floating,this.maxParticles="number"==typeof settings.maxParticles?settings.maxParticles:defaults.maxParticles,this.frequency="number"==typeof settings.frequency?settings.frequency:defaults.frequency,this.duration="number"==typeof settings.duration?settings.duration:defaults.duration,this.framesToSkip="number"==typeof settings.framesToSkip?settings.framesToSkip:defaults.framesToSkip,this.container.destroy()
},addParticles:function(count){for(var i=0;~~count>i;i++){var particle=me.pool.pull("me.Particle",this);particle.isRenderable=!1,this.container.addChild(particle)}},isRunning:function(){return this._enabled&&this._stream},streamParticles:function(duration){this._enabled=!0,this._stream=!0,this.frequency=Math.max(this.frequency,1),this._durationTimer="number"==typeof duration?duration:this.duration},stopStream:function(){this._enabled=!1},burstParticles:function(total){this._enabled=!0,this._stream=!1,this.addParticles("number"==typeof total?total:this.totalParticles),this._enabled=!1},update:function(dt){if(this._enabled&&this._stream){if(1/0!==this._durationTimer&&(this._durationTimer-=dt,0>=this._durationTimer))return this.stopStream(),!1;this._frequencyTimer+=dt;var particlesCount=this.container.children.length;this.totalParticles>particlesCount&&this._frequencyTimer>=this.frequency&&(particlesCount+this.maxParticles<=this.totalParticles?this.addParticles(this.maxParticles):this.addParticles(this.totalParticles-particlesCount),this._frequencyTimer=0)}return!0}})}(),function(){me.ParticleContainer=me.ObjectContainer.extend({init:function(emitter){this.parent(),this.autoSort=!1,this._updateCount=0,this._dt=0,this._emitter=emitter},update:function(dt){if(++this._updateCount>this._emitter.framesToSkip&&(this._updateCount=0),this._updateCount>0)return this._dt+=dt,!1;dt+=this._dt,this._dt=0;for(var viewport=me.game.viewport,i=this.children.length-1;i>=0;--i){var particle=this.children[i];particle.isRenderable=!0,particle.inViewport=this.floating||particle.pos.x<viewport.pos.x+viewport.width&&viewport.pos.x<particle.pos.x+particle.width&&particle.pos.y<viewport.pos.y+viewport.height&&viewport.pos.y<particle.pos.y+particle.height,particle.update(dt)||this.removeChildNow(particle)}return!0},draw:function(context,rect){if(this.children.length>0){var gco;this._emitter.textureAdditive&&(gco=context.globalCompositeOperation,context.globalCompositeOperation="lighter"),this.parent(context,rect),this._emitter.textureAdditive&&(context.globalCompositeOperation=gco)}}})}(),function(){me.Particle=me.Renderable.extend({init:function(emitter){this.parent(emitter.getRandomPoint(),emitter.image.width,emitter.image.height),this.alwaysUpdate=!0,this.image=emitter.image;var angle=emitter.angle+(emitter.angleVariation>0?(2*Math.random()-1)*emitter.angleVariation:0),speed=emitter.speed+(emitter.speedVariation>0?(2*Math.random()-1)*emitter.speedVariation:0);this.vel=new me.Vector2d(speed*Math.cos(angle),-speed*Math.sin(angle)),this.life=Number.prototype.random(emitter.minLife,emitter.maxLife),this.startLife=this.life,this.startScale=Number.prototype.random(emitter.minStartScale,emitter.maxStartScale).clamp(emitter.minStartScale,emitter.maxStartScale),this.endScale=Number.prototype.random(emitter.minEndScale,emitter.maxEndScale).clamp(emitter.minEndScale,emitter.maxEndScale),this.gravity=emitter.gravity,this.wind=emitter.wind,this.followTrajectory=emitter.followTrajectory,this.onlyInViewport=emitter.onlyInViewport,this.z=emitter.z,this._deltaInv=me.sys.fps/1e3,this.transform=new me.Matrix2d,emitter.followTrajectory||(this.angle=Number.prototype.random(emitter.minRotation,emitter.maxRotation))},update:function(dt){var skew=dt*this._deltaInv;this.life=this.life>dt?this.life-dt:0;var ageRatio=this.life/this.startLife,scale=this.startScale;this.startScale>this.endScale?(scale*=ageRatio,scale=this.endScale>scale?this.endScale:scale):this.startScale<this.endScale&&(scale/=ageRatio,scale=scale>this.endScale?this.endScale:scale),this.alpha=ageRatio,this.vel.x+=this.wind*skew,this.vel.y+=this.gravity*skew;var angle=this.followTrajectory?Math.atan2(this.vel.y,this.vel.x):this.angle;return this.transform.set(scale,0,0,scale,0,0).rotate(angle),this.pos.x+=this.vel.x*skew,this.pos.y+=this.vel.y*skew,(this.inViewport||!this.onlyInViewport)&&this.life>0},draw:function(context){context.save(),context.globalAlpha*=this.alpha;var transform=this.transform;context.transform(transform.a,transform.b,transform.c,transform.d,~~this.pos.x,~~this.pos.y);var w=this.width,h=this.height;context.drawImage(this.image,0,0,w,h,-w/2,-h/2,w,h),context.restore()}})}(window);
                (function($){me.debug=me.debug||{},debugPanel=me.plugin.Base.extend({GUID:null,area:{},rect:null,z:1/0,visible:!1,frameUpdateTime:0,frameDrawTime:0,version:"1.0.1",init:function(showKey,hideKey){this.parent(),this.rect=new me.Rect(new me.Vector2d(0,0),me.video.getWidth(),35),this.GUID="debug-"+me.utils.createGUID(),this.name="me.debugPanel",this.isPersistent=!0,this.floating=!0,this.isRenderable=!0,this.alwaysUpdate=!0;var s=10;this.mod=1,500>me.game.viewport.width&&(s=7,this.mod=.7),this.font=new me.Font("courier",s,"white"),this.area.renderHitBox=new me.Rect(new me.Vector2d(160,5),15,15),this.area.renderVelocity=new me.Rect(new me.Vector2d(165,18),15,15),this.area.renderDirty=new me.Rect(new me.Vector2d(270,5),15,15),this.area.renderCollisionMap=new me.Rect(new me.Vector2d(270,18),15,15),this.help_str="(s)how/(h)ide",this.help_str_len=this.font.measureText(me.video.getSystemContext(),this.help_str).width,this.fps_str_len=this.font.measureText(me.video.getSystemContext(),"00/00 fps").width,this.memoryPositionX=2.2*this.font.measureText(me.video.getSystemContext(),"Draw   : ").width+310*this.mod,this.help_str="(s)how/(h)ide",this.help_str_len=this.font.measureText(me.video.getSystemContext(),this.help_str).width,this.fps_str_len=this.font.measureText(me.video.getSystemContext(),"00/00 fps").width,me.debug.displayFPS=!0,me.input.bindKey(showKey||me.input.KEY.S,"show",!1,!1),me.input.bindKey(hideKey||me.input.KEY.H,"hide",!1,!1);var self=this;this.keyHandler=me.event.subscribe(me.event.KEYDOWN,function(action,keyCode,edge){"show"===action?self.show():"hide"===action&&self.hide()}),this.levelHandler=me.event.subscribe(me.event.LEVEL_LOADED,function(){var layer=me.game.currentLevel.getLayerByName("collision");layer&&layer.setOpacity(me.debug.renderCollisionMap===!0?1:0)}),this.samples=[],this.patchSystemFn(),this.show()},patchSystemFn:function(){me.debug.renderHitBox=me.debug.renderHitBox||!1,me.debug.renderVelocity=me.debug.renderVelocity||!1,me.debug.renderCollisionMap=me.debug.renderCollisionMap||!1;var _this=this;me.plugin.patch(me.timer,"update",function(time){this.parent(time),me.timer.countFPS()}),me.plugin.patch(me.game,"update",function(time){var frameUpdateStartTime=window.performance.now();this.parent(time),_this.frameUpdateTime=window.performance.now()-frameUpdateStartTime}),me.plugin.patch(me.game,"draw",function(){var frameDrawStartTime=window.performance.now();this.parent(),_this.frameDrawTime=window.performance.now()-frameDrawStartTime}),me.plugin.patch(me.SpriteObject,"draw",function(context){this.parent(context),me.debug.renderHitBox&&(context.strokeStyle="green",context.strokeRect(this.left,this.top,this.width,this.height))}),me.plugin.patch(me.ObjectEntity,"draw",function(context){if(this.parent(context),me.debug.renderHitBox&&this.shapes.length){var translateX=this.pos.x,translateY=this.pos.y;context.translate(translateX,translateY),this.getShape().draw(context,"red"),"Rectangle"!==this.getShape().shapeType&&this.getShape().getBounds().draw(context,"red"),context.translate(-translateX,-translateY)}if(me.debug.renderVelocity){var x=~~(this.pos.x+this.hWidth),y=~~(this.pos.y+this.hHeight);context.strokeStyle="blue",context.lineWidth=1,context.beginPath(),context.moveTo(x,y),context.lineTo(x+~~(this.vel.x*this.hWidth),y+~~(this.vel.y*this.hHeight)),context.stroke()}})},show:function(){this.visible||(me.input.registerPointerEvent("pointerdown",this.rect,this.onClick.bind(this),!0),me.game.world.addChild(this,1/0),this.visible=!0)},hide:function(){this.visible&&(me.input.releasePointerEvent("pointerdown",this.rect),me.game.world.removeChild(this),this.visible=!1)},update:function(){return me.input.isKeyPressed("show")?this.show():me.input.isKeyPressed("hide")&&this.hide(),!0},getBounds:function(){return this.rect},onClick:function(e){if(this.area.renderHitBox.containsPoint(e.gameX,e.gameY))me.debug.renderHitBox=!me.debug.renderHitBox;else if(this.area.renderCollisionMap.containsPoint(e.gameX,e.gameY)){var layer=me.game.currentLevel.getLayerByName("collision");layer&&(0===layer.getOpacity()?(layer.setOpacity(1),me.debug.renderCollisionMap=!0):(layer.setOpacity(0),me.debug.renderCollisionMap=!1))}else this.area.renderVelocity.containsPoint(e.gameX,e.gameY)&&(me.debug.renderVelocity=!me.debug.renderVelocity);me.game.repaint()},drawMemoryGraph:function(context,endX){if(window.performance&&window.performance.memory){var usedHeap=Number.prototype.round(window.performance.memory.usedJSHeapSize/1048576,2),totalHeap=Number.prototype.round(window.performance.memory.totalJSHeapSize/1048576,2),len=endX-this.memoryPositionX;this.samples.shift(),this.samples[len]=25*(usedHeap/totalHeap);for(var x=len;x>=0;x--){var where=endX-(len-x);context.beginPath(),context.strokeStyle="lightblue",context.moveTo(where,30*this.mod),context.lineTo(where,(30-(this.samples[x]||0))*this.mod),context.stroke()}this.font.draw(context,"Heap : "+usedHeap+"/"+totalHeap+" MB",this.memoryPositionX,5*this.mod)}else this.font.draw(context,"Heap : ??/?? MB",this.memoryPositionX,5*this.mod)},draw:function(context){context.save(),context.globalAlpha=.5,context.fillStyle="black",context.fillRect(this.rect.left,this.rect.top,this.rect.width,this.rect.height),context.globalAlpha=1,this.font.draw(context,"#objects : "+me.game.world.children.length,5*this.mod,5*this.mod),this.font.draw(context,"#draws   : "+me.game.world.drawCount,5*this.mod,18*this.mod),this.font.draw(context,"?hitbox   ["+(me.debug.renderHitBox?"x":" ")+"]",100*this.mod,5*this.mod),this.font.draw(context,"?velocity ["+(me.debug.renderVelocity?"x":" ")+"]",100*this.mod,18*this.mod),this.font.draw(context,"?dirtyRect  [ ]",200*this.mod,5*this.mod),this.font.draw(context,"?col. layer ["+(me.debug.renderCollisionMap?"x":" ")+"]",200*this.mod,18*this.mod),this.font.draw(context,"Update : "+this.frameUpdateTime.toFixed(2)+" ms",310*this.mod,5*this.mod),this.font.draw(context,"Draw   : "+this.frameDrawTime.toFixed(2)+" ms",310*this.mod,18*this.mod);var endX=this.rect.width-25;this.drawMemoryGraph(context,endX-this.help_str_len),this.font.draw(context,this.help_str,endX-this.help_str_len,18*this.mod);var fps_str=""+me.timer.fps+"/"+me.sys.fps+" fps";this.font.draw(context,fps_str,this.rect.width-this.fps_str_len-5,5*this.mod),context.restore()},onDestroyEvent:function(){this.hide(),me.input.unbindKey(me.input.KEY.S),me.input.unbindKey(me.input.KEY.H),me.event.unsubscribe(this.keyHandler),me.event.unsubscribe(this.levelHandler)}})})(window);
                var game={WINDOW_WIDTH:960,WINDOW_HEIGHT:640,ENEMY_ENTITY_SMALL:96,ENEMY_ENTITY_MEDIUM:97,ENEMY_ENTITY_LARGE:98,ENEMY_ENTITY_SUPER:99,PLAYER:88,BULLET:77,EXPLOSION:66,canShoot:!0,FIRE_PROBABILITY:2e3,data:{score:{}},onload:function(){return me.video.init("screen",game.WINDOW_WIDTH,game.WINDOW_HEIGHT,!0,"auto")?("#debug"===document.location.hash&&window.onReady(function(){me.plugin.register.defer(this,debugPanel,"debug")}),me.audio.init("mp3,ogg"),me.loader.onload=this.loaded.bind(this),me.loader.preload(game.resources),me.state.change(me.state.LOADING),void 0):(alert("Your browser does not support HTML5 canvas."),void 0)},loaded:function(){me.state.set(me.state.MENU,new game.TitleScreen),me.state.set(me.state.PLAY,new game.PlayScreen),me.pool.register("mainPlayer",game.PlayerEntity),me.pool.register("bullet",game.BulletEntity),me.pool.register("enemyShip",game.Ship),me.pool.register("explosion",game.ExplosionEntity),me.pool.register("label",game.LabelEntity),me.input.bindKey(me.input.KEY.LEFT,"left"),me.input.bindKey(me.input.KEY.RIGHT,"right"),me.input.bindKey(me.input.KEY.SPACE,"shoot"),$("#completeFeature").click(function(){var destroy=me.game.world.getChildByProp("objectID",game.shootMe);if(1==destroy.length){var players=me.game.world.getChildByProp("type",game.PLAYER);1==players.length&&(destroy[0].setVulnerable(!0),players[0].addTarget(destroy[0]))}$("#completeFeature").hide()}),me.state.change(me.state.MENU),$($(".rally-app")[0]).hide(),$("#root").show(),$("body").removeClass("x-body"),$("html").removeClass("x-viewport"),Ext.getBody().unmask()}};
                game.resources=[{name:"player",type:"image",src:"game/data/img/player_ship.png"},{name:"xlarge",type:"image",src:"game/data/img/shipSuper.png"},{name:"large",type:"image",src:"game/data/img/shipLarge.png"},{name:"medium",type:"image",src:"game/data/img/shipMedium.png"},{name:"small",type:"image",src:"game/data/img/shipSmall.png"},{name:"bullet",type:"image",src:"game/data/img/bullet_sprite.png"},{name:"explosionSmall",type:"image",src:"game/data/img/animations/explosionSmall.png"},{name:"explosionMedium",type:"image",src:"game/data/img/animations/explosionMedium.png"},{name:"explosionLarge",type:"image",src:"game/data/img/animations/explosionLarge.png"},{name:"explosionSuper",type:"image",src:"game/data/img/animations/explosionSuper.png"},{name:"titleScreen",type:"image",src:"game/data/img/titleScreen.png"},{name:"background",type:"image",src:"game/data/img/background.png"},{name:"sprites",type:"image",src:"game/data/sprites.png"},{name:"area51",type:"tmx",src:"game/data/map/area51.tmx"}];
                game.LabelEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.font=new me.Font("Arial",settings.fontSize||8,"white","left"),this.parent=settings.parent},update:function(){this.font.draw(context,this.parent,this.pos.x,this.pos.y)}});
                game.PlayerEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.gravity=0,this.setVelocity(5,0),this.type=game.PLAYER,this.targets=[],this.shootingOffset=10,this.stepNum=0,this.steps=0},update:function(dt){if(0!=this.targets.length){var myPos=this.pos.x+this.shootingOffset,targetPos=this.targets[0].pos.x+this.targets[0].width/2;return Math.abs(myPos-targetPos)>3&&game.canShoot?myPos>targetPos?this.vel.x-=this.accel.x*me.timer.tick:this.vel.x+=this.accel.x*me.timer.tick:game.canShoot?(this.vel.x=0,this.shoot()):this.vel.x=0,this.updateMovement(),!0}this.stepNum++;var step=Math.floor(this.stepNum/(game.WINDOW_WIDTH/11));return 0==step?this.vel.x+=this.accel.x*me.timer.tick:1==step?this.vel.x-=this.accel.x*me.timer.tick:4>step?this.vel.x+=this.accel.x*me.timer.tick:4==step?this.vel.x-=this.accel.x*me.timer.tick:5==step?this.vel.x+=this.accel.x*me.timer.tick:8>step?this.vel.x-=this.accel.x*me.timer.tick:(this.stepNum=0,this.vel.x=0),game.canShoot&&me.input.isKeyPressed("shoot")&&this.shoot(),this.updateMovement(),0!=this.vel.x||0!=this.vel.y?(this.parent(dt),!0):!0},shoot:function(){var x=this.pos.x+this.shootingOffset,shot=me.pool.pull("bullet",x,this.pos.y,{height:16,image:"bullet",name:"shot",spriteheight:16,spritewidth:16,width:16,shootDown:!1});game.canShoot=!1,me.game.world.addChild(shot,Number.POSITIVE_INFINITY)},addTarget:function(target){Ext.Array.push(this.targets,target)},removeTarget:function(target){this.targets.length>0&&this.targets[0].objectID==target.objectID&&this.targets.shift()}});
                game.Ship=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,-settings.height+1,settings),this.gravity=0,this.setVelocity(0,0),this.numSteps=0,this.moveRight=!0,this.collidable=!0,this.objectID=settings.objectID,this.formattedId=settings.formattedId,this.isVulnerable=!1,this.delay=settings.delay,this.goToY=y,this.setupComplete=!1,this.waitFor=settings.waitFor},update:function(){if(this.waitFor--,!this.setupComplete&&0>=this.delay)return this.pos.y++,this.pos.y==this.goToY&&(this.setupComplete=!0),!0;if(!this.setupComplete)return this.delay--,!0;if(this.waitFor>0)return!0;this.waitFor=0;var label=me.pool.pull("label",this.pos.x,this.pos.y,{parent:this.formattedId});if(me.game.world.addChild(label,Number.POSITIVE_INFINITY),!this.isVulnerable&&0==Math.floor(Math.random()*game.FIRE_PROBABILITY)){var x=this.pos.x+this.width/2,shot=me.pool.pull("bullet",x,this.pos.y,{height:16,image:"bullet",name:"shot",spriteheight:16,spritewidth:16,width:16,shootDown:!0});this.shootLeft=!this.shootLeft,me.game.world.addChild(shot,Number.POSITIVE_INFINITY)}0==this.numSteps%3&&(0==this.numSteps%192&&(this.moveRight=!this.moveRight,this.numSteps=0),this.moveRight?this.pos.x-=1:this.pos.x+=1),this.numSteps++},setVulnerable:function(vulnerability){this.isVulnerable=vulnerability},isDestructable:function(){return this.isVulnerable},flashShields:function(){}});
                game.BulletEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.gravity=0,this.setVelocity(0,6),this.type=game.BULLET,this.shootDown=settings.shootDown},update:function(){16>this.pos.y&&(game.canShoot=!0,me.game.world.removeChild(this));var res=me.game.world.collide(this);if(res){var image=null;if(res.obj.type==game.ENEMY_ENTITY_SUPER?image=me.loader.getImage("explosionSuper"):res.obj.type==game.ENEMY_ENTITY_LARGE?image=me.loader.getImage("explosionLarge"):res.obj.type==game.ENEMY_ENTITY_MEDIUM?image=me.loader.getImage("explosionMedium"):res.obj.type==game.ENEMY_ENTITY_SMALL&&(image=me.loader.getImage("explosionSmall")),image&&!this.shootDown&&res.obj.isDestructable()){game.canShoot=!0,me.game.world.removeChild(this);var emitter=new me.ParticleEmitter(res.obj.pos.x+res.obj.width/2,res.obj.pos.y+res.obj.height/2,{image:image,width:4,totalParticles:12,angle:.0856797996433583,angleVariation:3.14159265358979,minLife:400,maxLife:1800,speed:.954545454545454,speedVariation:9.95454545454546,minRotation:1.34231686107927,minStartScale:1.43181818181818,maxParticles:17,frequency:19,duration:400,framesToSkip:1});emitter.name="fire",emitter.z=res.obj.z+1,me.game.world.addChild(emitter),me.game.world.addChild(emitter.container),emitter.streamParticles(),$("#gameLog").append("<li>"+res.obj.name+"</li>");var players=me.game.world.getChildByProp("type",game.PLAYER);1==players.length&&players[0].removeTarget(res.obj),me.game.world.removeChild(res.obj)}else image&&!this.shootDown&&!res.obj.isDestructable();if(res.obj.type==game.PLAYER&&this.shootDown){me.game.world.removeChild(this),image=me.loader.getImage("explosionSmall");var emitter=new me.ParticleEmitter(res.obj.pos.x+res.obj.width/2,res.obj.pos.y+res.obj.height/2,{image:image,width:4,totalParticles:12,angle:.0856797996433583,angleVariation:3.14159265358979,minLife:200,maxLife:400,speed:.5,speedVariation:4,minRotation:1.34231686107927,minStartScale:1.43181818181818,maxParticles:17,frequency:19,duration:200,framesToSkip:1});emitter.name="fire",emitter.z=res.obj.z+1,me.game.world.addChild(emitter),me.game.world.addChild(emitter.container),emitter.streamParticles()}}return this.shootDown?this.vel.y+=this.accel.y*me.timer.tick:this.vel.y-=this.accel.y*me.timer.tick,this.updateMovement(),!0}});
                game.HUD=game.HUD||{},game.HUD.Container=me.ObjectContainer.extend({init:function(){this.parent(),this.isPersistent=!0,this.collidable=!1,this.z=1/0,this.name="HUD";var i=0,container=this;game.data.score={"Team 1":17,"Team 2":13,"Long team name number 3":23},Ext.Object.each(game.data.score,function(key,value){var align="left",x=5,y=5;1==i%3?(align="center",x=game.WINDOW_WIDTH/2):2==i%3?(align="right",x=game.WINDOW_WIDTH-5):0!=i&&(y+=25),container.addChild(new game.HUD.ScoreItem(x,y,key,align)),i++})}}),game.HUD.ScoreItem=me.Renderable.extend({init:function(x,y,key,alignment){this.parent(new me.Vector2d(x,y),10,10),this.font=new me.Font("arcadeClassic",24,"white",alignment),this.score=-1,this.key=key,this.floating=!0},update:function(){return this.score!==game.data.score[this.key]?(this.score=game.data.score[this.key],!0):!1},draw:function(context){this.font.draw(context,this.key+": "+this.score,this.pos.x,this.pos.y)}});
                game.TitleScreen=me.ScreenObject.extend({onResetEvent:function(){me.game.world.addChild(new me.SpriteObject(0,0,me.loader.getImage("titleScreen")),1),me.game.world.addChild(new(me.Renderable.extend({init:function(){this.parent(new me.Vector2d(0,0),me.game.viewport.width,me.game.viewport.height),this.font=new me.Font("arcadeClassic",32,"white","center"),this.scrollertween=new me.Tween(this).to({scrollerpos:-600},3e3).onComplete(this.scrollover.bind(this)).start(),this.scroller="A PORTFOLIO ITEM VISUALIZATION USING SPACE INVADERS",this.scrollerpos=3e3},scrollover:function(){this.scrollerpos=1500,this.scrollertween.to({scrollerpos:-600},1e4).onComplete(this.scrollover.bind(this)).start()},update:function(dt){return!0},draw:function(context){this.font.draw(context,"PRESS ENTER TO PLAY",480,500),this.font.draw(context,this.scroller,this.scrollerpos,440)},onDestroyEvent:function(){this.scrollertween.stop()}})),2),me.input.bindKey(me.input.KEY.ENTER,"enter",!0),me.input.bindPointer(me.input.mouse.LEFT,me.input.KEY.ENTER),this.handler=me.event.subscribe(me.event.KEYDOWN,function(action,keyCode,edge){"enter"===action&&me.state.change(me.state.PLAY)})},onDestroyEvent:function(){me.input.unbindKey(me.input.KEY.ENTER),me.input.unbindPointer(me.input.mouse.LEFT),me.event.unsubscribe(this.handler)}});
                game.PlayScreen=me.ScreenObject.extend({onResetEvent:function(){me.levelDirector.loadLevel("area51"),this.setupShips()},setupShips:function(){var realtime=new Realtime,data,scope=angular.element($("#root")).scope();data=scope.organizedData,console.log(data);var PADDING=32,WIDTH=game.WINDOW_WIDTH-2*PADDING,MAX_FEATURE_ROWS=2,MAX_STORY_ROWS=3,MAX_TASK_ROWS=4,MOTHERSHIP={width:320,height:160},FEATURE_SHIP={width:64,height:64},STORY_SHIP={width:32,height:32},TASK_SHIP={width:16,height:16},TASK_DELAY=0,STORY_DELAY=MAX_TASK_ROWS*TASK_SHIP.height,FEATURE_DELAY=STORY_DELAY+MAX_STORY_ROWS*STORY_SHIP.height,MOTHERSHIP_DELAY=FEATURE_DELAY+MAX_FEATURE_ROWS*FEATURE_SHIP.height,TOTAL_DELAY=STORY_DELAY+FEATURE_DELAY+MOTHERSHIP_DELAY-32;game.data.score=data.teamsPoints;var zAxis=8;game.shootMe=data.initiative.ObjectID;var mothership=me.pool.pull("enemyShip",WIDTH/2-MOTHERSHIP.width/2,PADDING,{height:MOTHERSHIP.height,image:"xlarge",name:"[INITIATIVE] "+data.initiative.Name,spriteheight:MOTHERSHIP.height,spritewidth:MOTHERSHIP.width,width:MOTHERSHIP.width,objectID:data.initiative.ObjectID,z:zAxis,formattedId:data.initiative.FormattedID,type:game.ENEMY_ENTITY_SUPER,delay:MOTHERSHIP_DELAY,waitFor:TOTAL_DELAY});me.game.world.addChild(mothership,zAxis),zAxis++;for(var features=_.toArray(data.features),numFeatures=features.length,featuresPerLine=Math.floor(WIDTH/FEATURE_SHIP.width),featureLines=Math.floor(numFeatures/featuresPerLine)+1,sectionWidth=numFeatures>featuresPerLine?WIDTH/featuresPerLine:WIDTH/numFeatures,maxFeatures=featureLines>MAX_FEATURE_ROWS?MAX_FEATURE_ROWS*featuresPerLine:numFeatures,i=0;maxFeatures>i;i++){var pos=i%featuresPerLine,xPosition=pos*sectionWidth+sectionWidth/2-FEATURE_SHIP.width/2,yPosition=PADDING+MOTHERSHIP.height+Math.floor(i/featuresPerLine)*FEATURE_SHIP.height,featureShip=me.pool.pull("enemyShip",xPosition,yPosition,{height:FEATURE_SHIP.height,image:"large",name:"[FEATURE] - "+features[i].feature.Name,spriteheight:FEATURE_SHIP.height,spritewidth:FEATURE_SHIP.width,width:FEATURE_SHIP.width,objectID:features[i].feature.ObjectID,formattedId:features[i].feature.FormattedID,z:zAxis,type:game.ENEMY_ENTITY_LARGE,delay:FEATURE_DELAY,waitFor:TOTAL_DELAY});if(me.game.world.addChild(featureShip,zAxis++),!(i>=featuresPerLine)){for(var stories=features[i].children,rows=1;featureLines>rows;rows++){var arr=features[rows*featuresPerLine+i];if(!arr)break;arr=arr.children;for(var el=0;arr.length>el;el++)Ext.Array.push(stories,arr[el])}0==numFeatures%featuresPerLine&&(featureLines-=1);for(var numStories=stories.length,storiesPerLine=Math.floor(sectionWidth/STORY_SHIP.width),storyLines=Math.floor(numStories/storiesPerLine)+1,tasks=[],maxStories=storyLines>MAX_STORY_ROWS?MAX_STORY_ROWS*storiesPerLine:numStories,j=0;maxStories>j;j++){var storyX,storyY,storiesOnThisLine=storiesPerLine;Math.floor(j/storiesPerLine+1)==storyLines&&(storiesOnThisLine=numStories%storiesPerLine),storyY=PADDING+MOTHERSHIP.height+FEATURE_SHIP.height*Math.min(featureLines,MAX_FEATURE_ROWS)+Math.floor(j/storiesPerLine)*STORY_SHIP.height,storyX=i*sectionWidth+j%storiesPerLine*(sectionWidth/(storiesOnThisLine+1))+sectionWidth/(storiesOnThisLine+1)-STORY_SHIP.width/2;var storyShip=me.pool.pull("enemyShip",storyX,storyY,{height:STORY_SHIP.height,image:"medium",name:"[STORY/DEFECT] - "+stories[j].artifact.Name,spriteheight:STORY_SHIP.height,spritewidth:STORY_SHIP.width,width:STORY_SHIP.width,objectID:stories[j].artifact.ObjectID,formattedId:stories[j].artifact.FormattedID,z:zAxis,health:2,type:game.ENEMY_ENTITY_MEDIUM,delay:STORY_DELAY,waitFor:TOTAL_DELAY});me.game.world.addChild(storyShip,zAxis++),_.each(stories[j].children,function(oneTask){Ext.Array.push(tasks,oneTask)})}0==numStories%storiesPerLine&&(storyLines-=1);for(var numTasks=tasks.length,tasksPerLine=Math.floor(sectionWidth/TASK_SHIP.width),taskLines=Math.floor(numTasks/tasksPerLine)+1,maxTasks=taskLines>MAX_TASK_ROWS?MAX_TASK_ROWS*tasksPerLine:numTasks,k=0;maxTasks>k;k++){var taskX,taskY,tasksOnThisLine=tasksPerLine;Math.floor(k/tasksPerLine+1)==taskLines&&(tasksOnThisLine=numTasks%tasksPerLine),taskY=PADDING+MOTHERSHIP.height+Math.min(storyLines,MAX_STORY_ROWS)*STORY_SHIP.height+Math.min(featureLines,MAX_FEATURE_ROWS)*FEATURE_SHIP.height+Math.floor(k/tasksPerLine)*TASK_SHIP.height,taskX=i*sectionWidth+k%tasksPerLine*(sectionWidth/(tasksOnThisLine+1))+sectionWidth/(tasksOnThisLine+1)-TASK_SHIP.width/2,game.shootMe=tasks[k].ObjectID;var taskShip=me.pool.pull("enemyShip",taskX,taskY,{height:TASK_SHIP.height,image:"small",name:"[TASK] - "+tasks[k].Name,spriteheight:TASK_SHIP.height,spritewidth:TASK_SHIP.width,width:TASK_SHIP.width,objectID:tasks[k].ObjectID,formattedId:tasks[k].FormattedID,z:zAxis,health:2,type:game.ENEMY_ENTITY_SMALL,delay:TASK_DELAY,waitFor:TOTAL_DELAY});me.game.world.addChild(taskShip,zAxis++)}}}this.HUD=new game.HUD.Container,me.game.world.addChild(this.HUD)},onDestroyEvent:function(){me.game.world.removeChild(this.HUD)}});
                GLOBAL={},Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",items:[{xtype:"rallysolrartifactchooserdialog",id:"portfolioItemPicker",artifactTypes:["portfolioitem/initiative"],autoShow:!0,height:250,title:"Choose an Initiative",storeConfig:{context:{workspace:Rally.util.Ref.getRelativeUri(),project:null}},listeners:{scope:this,artifactchosen:function(picker,selectedRecord){Ext.getBody().mask("Loading"),GLOBAL=selectedRecord.data,angular.bootstrap(document.body,["angularBlastdown"]);var scope=angular.element(document.body).scope();scope.app=App.getContext().map.map,scope.$digest()}}}],launch:function(){App=this,console.log(Rally)}});
                module=angular.module("angularBlastdown",[]),module.controller("dataController",["$scope","RallyDataService","RealtimeService",function($scope,RallyDataService,RealtimeService){$scope.organizedData={},$scope.redraw=!1,$scope.$watch("organizedData",function(){$scope.redraw?console.log("redrawing"):console.log("not drawn yet")}),$scope.RallyDataService=RallyDataService,RallyDataService.getData(!0,function(data){$scope.organizedData=data,$scope.$apply(),game.onload(),$scope.redraw=!0})}]);
                module.factory("RealtimeService",function(){var realtime=new Realtime;return{connect:function(uuids,dataHandler){Ext.Array.each(uuids,function(id){var websocket=realtime.connectTo(id);console.log(realtime),websocket.onmessage=Ext.bind(function(e){var data=JSON.parse(e.data);realtime.publishObjectChanged(data,this),data.type&&(console.log(data.data.action+"",data),Ext.create("Rally.data.wsapi.Store",{model:"PortfolioItem/Initiative",filters:[{property:"_refObjectUUID",operator:"=",value:GLOBAL._refObjectUUID}]}).load({scope:this,callback:function(records,operation,success){console.log("for "+GLOBAL._refObjectUUID+" got",records),callbackData(organizedData)}}),dataHandler())},this)})}}});
                module.service("RallyDataService",function(RealtimeService){var lookbackStore=Ext.create("Rally.data.lookback.SnapshotStore",{fetch:!0,hydrate:["ScheduleState","State","_TypeHierarchy","Project"],findConfig:{_ItemHierarchy:GLOBAL.ObjectID,__At:"current"}});return{getData:function(connect,callbackData){lookbackStore.load({scope:this,callback:function(records,operation,success){aggregateData={initiative:{},features:{},storiesAndDefects:{},parentless:[]};var tasks=[];_.each(records,function(artifact){var types=artifact.raw._TypeHierarchy;switch(types[types.length-1]){case"Defect":aggregateData.storiesAndDefects[artifact.data.ObjectID]={artifact:artifact.raw,children:[]};break;case"HierarchicalRequirement":aggregateData.storiesAndDefects[artifact.data.ObjectID]={artifact:artifact.raw,children:[]};break;case"PortfolioItem/Feature":aggregateData.features[artifact.data.ObjectID]={feature:artifact.raw,children:[]};break;case"Task":Ext.Array.push(tasks,artifact.raw);break;default:}});var organizedData={initiative:angular.element(document.body).scope().initiative,features:[],closedStories:[],teamsPoints:{}},projects=[];_.each(tasks,function(task){var parent=task.WorkProduct;aggregateData.storiesAndDefects[parent]&&Ext.Array.push(aggregateData.storiesAndDefects[parent].children,task)}),_.each(aggregateData.storiesAndDefects,function(object,oid){var parent,types=object.artifact._TypeHierarchy;if(Ext.Array.include(projects,object.artifact.Project),organizedData.teamsPoints[object.artifact.Project]&&"Closed"===object.artifact.State)return Ext.Array.push(organizedData.closedStories,object),organizedData.teamsPoints[object.artifact.Project]+=object.artifact.PlanEstimate,void 0;if(organizedData.teamsPoints[object.artifact.Project])return organizedData.teamsPoints[object.artifact.Project]=object.artifact.PlanEstimate,void 0;if("HierarchicalRequirement"===types[types.length-1])parent=object.artifact.PortfolioItem;else{var requirement=aggregateData.storiesAndDefects[object.artifact.Requirement];requirement&&(parent=requirement.artifact.PortfolioItem)}aggregateData.features[parent]&&Ext.Array.push(aggregateData.features[parent].children,object)}),console.log("projects",projects),connect?Ext.create("Rally.data.WsapiDataStore",{model:"Project",fetch:["Name"],limit:1/0}).load({scope:this,callback:function(records,operation,success){console.log("records",records),console.log(GLOBAL);var i=0;projectUUIDs=[],Ext.Array.each(records,function(record){Ext.Array.indexOf(projects,record.get("ObjectID"))>=0&&Ext.Array.push(projectUUIDs,record.get("_refObjectUUID"))}),organizedData.features=_.toArray(aggregateData.features),organizedData.initiative=GLOBAL,console.log("initiative UUID",GLOBAL._refObjectUUID);var scope=angular.element($("#root")).scope();scope.realtimeConnection=function(){RealtimeService.connect(projectUUIDs,function(){setTimeout(function(){scope.RallyDataService.getData(!1,function(data){scope.organizedData=data,scope.$apply(),console.log("changes - ",data)})},3e4)})},scope.realtimeConnection(),callbackData(organizedData)}}):(organizedData.features=_.toArray(aggregateData.features),organizedData.initiative=GLOBAL,callbackData(organizedData))}})}}});

            Rally.launchApp('CustomApp', {
                name:"angular",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        body{background-color:#000;color:#fff;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;-webkit-user-select:none;user-select:none;-ms-touch-action:none;touch-action:none;margin:0}#screen canvas{margin:auto;display:block;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:optimize-contrast;-ms-interpolation-mode:nearest-neighbor}#screen{width:80%}#screen,#gameLog{float:left}#gameLog{width:20%;height:100%}#shipKey{height:100px;width:80%;margin-right:20%;text-align:center}#gameAndLog{clear:both}.shipContainer{float:left;font-family:arcadeClassic;width:25%;text-align:center}.shipContainer>img{display:block;margin-left:auto;margin-right:auto;width:auto;height:64px}@font-face{font-family:arcadeClassic;src:url(data/font/ARCADECLASSIC.ttf)}.button{font-family:"NotoSans";font-size:.9em;line-height:1.1em}.button.selected{font-family:"NotoSansBold";color:#444;background:#E6E6E6}.button:hover{background:#E6E6E6;color:#444;text-decoration:none}.button{float:left;width:50%;text-align:center}#logToggle{display:block;border-radius:2px;border:1px solid #C0C0C0}#realtimeLog{display:none}
    </style>
    <style type="text/css">
        
    </style>
</head>
<body>
    <div style="display:none;" ng-controller="dataController" id="root">
    <h1>Space Invaders Blast Down for {{organizedData.initiative.Name}}</h1>
<!--     <h2>Features: </h2>
    <ul>
        <li ng-repeat="feature in organizedData.features">{{feature.feature.Name}}</li>
    </ul> -->
    <div id="spaceInvadersContainer">
        <div id="gameAndLog">
            <div id="screen"></div>
            <div id="gameLog">
                <div id="logToggle">
                    <div class="button selected" title="Yes">History</div>
                    <div class="button unselected">Realtime</div>
                </div>

                <h3>Ships Destroyed</h3>
                <ul id="historyLog">
                  <li>History 1</li>
                  <li>History 2</li>
                  <li>History 3</li>
                </ul>
                <ul id="realtimeLog">
                  <li>Realtime 1</li>
                  <li>Realtime 2</li>
                  <li>Realtime 3</li>
                  <li>Realtime 4</li>
                </ul>
            </div>
            <button type="button" id="completeFeature">Complete a feature</button>
        </div>
        <div id="shipKey">
            <fieldset>
                <legend>Legend:</legend>
                <div class="shipContainer">
                    Task
                    <br />
                    <img src="game/data/img/shipSmall.png">
                </div>
                <div class="shipContainer">
                    User Story / Defect
                    <img src="game/data/img/shipMedium.png">
                </div>
                <div class="shipContainer">
                    Feature
                    <br />
                    <img src="game/data/img/shipLarge.png">
                </div>
                <div class="shipContainer">
                    Initiative
                    <br />
                    <img src="game/data/img/shipSuper.png">
                </div>
            </fieldset>
        </div>
    </div>
</div>

</body>
</html>
