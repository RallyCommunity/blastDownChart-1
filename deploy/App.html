<!DOCTYPE html>
<html>
<head>
    <title>Space Invaders</title>

    <script type="text/javascript" src="/apps/2.0rc3/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                (function(undefined){function dfl(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw Error("Implement me")}}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function deprecate(msg,fn){function printMsg(){moment.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}var firstTime=!0;return extend(function(){return firstTime&&(printMsg(),firstTime=!1),fn.apply(this,arguments)},fn)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}function Language(){}function Moment(config){checkOverflow(config),extend(this,config)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._bubble()}function extend(a,b){for(var i in b)b.hasOwnProperty(i)&&(a[i]=b[i]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function cloneMoment(m){var result={},i;for(i in m)m.hasOwnProperty(i)&&momentProperties.hasOwnProperty(i)&&(result[i]=m[i]);return result}function absRound(number){return 0>number?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;targetLength>output.length;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset?!0:updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;len>i;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject)inputObject.hasOwnProperty(prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"}moment[field]=function(format,index){var i,getter,method=moment.fn._lang[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment.fn._lang,m,format||"")},null!=index)return getter(index);for(i=0;count>i;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return 0===year%4&&0!==year%100||0===year%400}function checkOverflow(m){var overflow;m._a&&-2===m._pf.overflow&&(overflow=0>m._a[MONTH]||m._a[MONTH]>11?MONTH:1>m._a[DATE]||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:0>m._a[HOUR]||m._a[HOUR]>23?HOUR:0>m._a[MINUTE]||m._a[MINUTE]>59?MINUTE:0>m._a[SECOND]||m._a[SECOND]>59?SECOND:0>m._a[MILLISECOND]||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(YEAR>overflow||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&0>m._pf.overflow&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length)),m._isValid}function normalizeLanguage(key){return key?key.toLowerCase().replace("_","-"):key}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local()}function loadLang(key,values){return values.abbr=key,languages[key]||(languages[key]=new Language),languages[key].set(values),languages[key]}function unloadLang(key){delete languages[key]}function getLangDefinition(key){var i=0,j,lang,next,split,get=function(k){if(!languages[k]&&hasModule)try{require("./lang/"+k)}catch(e){}return languages[k]};if(!key)return moment.fn._lang;if(!isArray(key)){if(lang=get(key))return lang;key=[key]}for(;key.length>i;){for(split=normalizeLanguage(key[i]).split("-"),j=split.length,next=normalizeLanguage(key[i+1]),next=next?next.split("-"):null;j>0;){if(lang=get(split.slice(0,j).join("-")))return lang;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return moment.fn._lang}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;length>i;i++)array[i]=formatTokenFunctions[array[i]]?formatTokenFunctions[array[i]]:removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.lang()),formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)):m.lang().invalidDate()}function expandFormat(format,lang){function replaceLongDateFormatTokens(input){return lang.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return parseTokenOrdinal;default:return a=RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"))}}function timezoneMinutesFromString(string){string=string||"";var possibleTzMatches=string.match(parseTokenTimezone)||[],tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input),null!=a?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input,10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=timezoneMinutesFromString(input);break;case"dd":case"ddd":case"dddd":a=getLangDefinition(config._l).weekdaysParse(input),null!=a?(config._w=config._w||{},config._w.d=a):config._pf.invalidWeekday=input;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=toInt(input));break;case"gg":case"GG":config._w=config._w||{},config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,lang;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year),week=dfl(w.W,1),weekday=dfl(w.E,1)):(lang=getLangDefinition(config._l),dow=lang._week.dow,doy=lang._week.doy,weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year),week=dfl(w.w,1),null!=w.d?(weekday=w.d,dow>weekday&&++week):weekday=null!=w.e?w.e+dow:dow),temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,input=[],currentDate,yearToUse;if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=dfl(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;3>i&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()+config._tzm)}}function dateFromObject(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601)return parseISO(config),undefined;config._a=[],config._pf.empty=!0;var lang=getLangDefinition(config._l),string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,lang).match(formattingTokens)||[],i=0;tokens.length>i;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),config._isPm&&12>config._a[HOUR]&&(config._a[HOUR]+=12),config._isPm===!1&&12===config._a[HOUR]&&(config._a[HOUR]=0),dateFromConfig(config),checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,config._d=new Date(0/0),undefined;for(i=0;config._f.length>i;i++)currentScore=0,tempConfig=extend({},config),tempConfig._pf=defaultParsingFlags(),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||scoreToBeat>currentScore)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;l>i;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;l>i;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else config._isValid=!1}function makeDateFromString(config){parseISO(config),config._isValid===!1&&(delete config._isValid,moment.createFromInputFallback(config))}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);input===undefined?config._d=new Date:matched?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=input.slice(0),dateFromConfig(config)):isDate(input)?config._d=new Date(+input):"object"==typeof input?dateFromObject(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return 1970>y&&date.setFullYear(y),date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return 1970>y&&date.setUTCFullYear(y),date}function parseWeekday(input,language){if("string"==typeof input)if(isNaN(input)){if(input=language.weekdaysParse(input),"number"!=typeof input)return null}else input=parseInt(input,10);return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1e3),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=relativeTimeThresholds.s>seconds&&["s",seconds]||1===minutes&&["m"]||relativeTimeThresholds.m>minutes&&["mm",minutes]||1===hours&&["h"]||relativeTimeThresholds.h>hours&&["hh",hours]||1===days&&["d"]||relativeTimeThresholds.dd>=days&&["dd",days]||relativeTimeThresholds.dm>=days&&["M"]||relativeTimeThresholds.dy>days&&["MM",round(days/30)]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=milliseconds>0,args[4]=lang,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add("d",daysToDayOfWeek),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var d=makeUTCDate(year,0,1).getUTCDay(),daysToAdd,dayOfYear;return d=0===d?7:d,weekday=null!=weekday?weekday:firstDayOfWeek,daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(firstDayOfWeek>d?7:0),dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1,{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f;return null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=getLangDefinition().preparse(input)),moment.isMoment(input)?(config=cloneMoment(input),config._d=new Date(+input._d)):format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),new Moment(config))}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return moment();for(res=moments[0],i=1;moments.length>i;++i)moments[i][fn](res)&&(res=moments[i]);return res}function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&(value=mom.lang().monthsParse(value),"number"!=typeof value)?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return+this/factor}}function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,globalScope.moment=shouldDeprecate?deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):moment)}for(var moment,VERSION="2.7.0",globalScope="undefined"!=typeof global?global:this,oldGlobalMoment,round=Math.round,i,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,languages={},momentProperties={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_tzm:null,_isUTC:null,_offset:null,_pf:null,_lang:null},hasModule="undefined"!=typeof module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,dd:25,dm:45,dy:345},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);for(formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Language.prototype,{set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[]),i=0;12>i;i++)if(this._monthsParse[i]||(mom=moment.utc([2e3,i]),regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=RegExp(regex.replace(".",""),"i")),this._monthsParse[i].test(monthName))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return"function"==typeof output?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),moment=function(input,format,lang,strict){var c;return"boolean"==typeof lang&&(strict=lang,lang=undefined),c={},c._isAMomentObject=!0,c._i=input,c._f=format,c._l=lang,c._strict=strict,c._isUTC=!1,c._pf=defaultParsingFlags(),makeMoment(c)},moment.suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i)}),moment.min=function(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)},moment.max=function(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)},moment.utc=function(input,format,lang,strict){var c;return"boolean"==typeof lang&&(strict=lang,lang=undefined),c={},c._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=lang,c._i=input,c._f=format,c._strict=strict,c._pf=defaultParsingFlags(),makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var duration=input,match=null,sign,ret,parseIso;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))&&(sign="-"===match[1]?-1:1,parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign},duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}),ret=new Duration(duration),moment.isDuration(input)&&input.hasOwnProperty("_lang")&&(ret._lang=input._lang),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.ISO_8601=function(){},moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.relativeTimeThreshold=function(threshold,limit){return relativeTimeThresholds[threshold]===undefined?!1:(relativeTimeThresholds[threshold]=limit,!0)},moment.lang=function(key,values){var r;return key?(values?loadLang(normalizeLanguage(key),values):null===values?(unloadLang(key),key="en"):languages[key]||getLangDefinition(key),r=moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key),r._abbr):moment.fn._lang._abbr},moment.langData=function(key){return key&&key._lang&&key._lang._abbr&&(key=key._lang._abbr),getLangDefinition(key)},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&obj.hasOwnProperty("_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration},i=lists.length-1;i>=0;--i)makeList(lists[i]);moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(0/0);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return m.year()>0&&9999>=m.year()?formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return this._a?this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0:!1},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this
},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;return dur="string"==typeof input&&"string"==typeof val?moment.duration(isNaN(+val)?+input:+val,isNaN(+val)?val:input):"string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,1),this},subtract:function(input,val){var dur;return dur="string"==typeof input&&"string"==typeof val?moment.duration(isNaN(+val)?+input:+val,isNaN(+val)?val:input):"string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,-1),this},diff:function(input,units,asFloat){var that=makeAs(input,this),zoneDiff=6e4*(this.zone()-that.zone()),diff,output;return units=normalizeUnits(units),"year"===units||"month"===units?(diff=432e5*(this.daysInMonth()+that.daysInMonth()),output=12*(this.year()-that.year())+(this.month()-that.month()),output+=(this-moment(this).startOf("month")-(that-moment(that).startOf("month")))/diff,output-=6e4*(this.zone()-moment(this).startOf("month").zone()-(that.zone()-moment(that).startOf("month").zone()))/diff,"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.lang()),this.add({d:input-day})):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return units=normalizeUnits(units),this.startOf(units).add("isoWeek"===units?"week":units,1).subtract("ms",1)},isAfter:function(input,units){return units=units!==undefined?units:"millisecond",+this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){return units=units!==undefined?units:"millisecond",+this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){return units=units||"ms",+this.clone().startOf(units)===+makeAs(input,this).startOf(units)},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),this>other?this:other}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),other>this?this:other}),zone:function(input,keepTime){var offset=this._offset||0;return null==input?this._isUTC?offset:this._d.getTimezoneOffset():("string"==typeof input&&(input=timezoneMinutesFromString(input)),16>Math.abs(input)&&(input=60*input),this._offset=input,this._isUTC=!0,offset!==input&&(!keepTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(input){return input=input?moment(input).zone():0,0===(this.zone()-input)%60},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add("d",input-dayOfYear)},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==input?year:this.add("y",input-year)},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add("y",input-year)},week:function(input){var week=this.lang().week(this);return null==input?week:this.add("d",7*(input-week))},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add("d",7*(input-week))},weekday:function(input){var weekday=(this.day()+7-this.lang()._week.dow)%7;return null==input?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this._lang._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return units=normalizeUnits(units),this[units]()},set:function(units,value){return units=normalizeUnits(units),"function"==typeof this[units]&&this[units](value),this},lang:function(key){return key===undefined?this._lang:(this._lang=getLangDefinition(key),this)}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),data.days=days%30,months+=absRound(days/30),data.months=months%12,years=absRound(months/12),data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());return withSuffix&&(output=this.lang().pastFuture(difference,output)),this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){return units=normalizeUnits(units),this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang,toIsoString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(0>this.asSeconds()?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"}});for(i in unitMillisecondFactors)unitMillisecondFactors.hasOwnProperty(i)&&(makeDurationAsGetter(i,unitMillisecondFactors[i]),makeDurationGetter(i.toLowerCase()));makeDurationAsGetter("Weeks",6048e5),moment.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},moment.lang("en",{ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define("moment",function(require,exports,module){return module.config&&module.config()&&module.config().noGlobal===!0&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}).call(this);
                (function(T,V,s){"use strict";function v(b){return function(){var a=arguments[0],c,a="["+(b?b+":":"")+a+"] http://errors.angularjs.org/1.2.19/"+(b?b+"/":"")+a;for(c=1;arguments.length>c;c++)a=a+(1==c?"?":"&")+"p"+(c-1)+"="+encodeURIComponent("function"==typeof arguments[c]?(""+arguments[c]).replace(/ \{[\s\S]*$/,""):arguments[c]===void 0?"undefined":"string"!=typeof arguments[c]?JSON.stringify(arguments[c]):arguments[c]);return Error(a)}}function db(b){if(null==b||Ea(b))return!1;var a=b.length;return 1===b.nodeType&&a?!0:y(b)||L(b)||0===a||"number"==typeof a&&a>0&&a-1 in b}function q(b,a,c){var d;if(b)if(O(b))for(d in b)"prototype"==d||"length"==d||"name"==d||b.hasOwnProperty&&!b.hasOwnProperty(d)||a.call(c,b[d],d);else if(b.forEach&&b.forEach!==q)b.forEach(a,c);else if(db(b))for(d=0;b.length>d;d++)a.call(c,b[d],d);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d);return b}function Vb(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(c);return a.sort()}function Tc(b,a,c){for(var d=Vb(b),e=0;d.length>e;e++)a.call(c,b[d[e]],d[e]);return d}function Wb(b){return function(a,c){b(c,a)}}function eb(){for(var b=ka.length,a;b;){if(b--,a=ka[b].charCodeAt(0),57==a)return ka[b]="A",ka.join("");if(90!=a)return ka[b]=String.fromCharCode(a+1),ka.join("");ka[b]="0"}return ka.unshift("0"),ka.join("")}function Xb(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function E(b){var a=b.$$hashKey;return q(arguments,function(a){a!==b&&q(a,function(a,c){b[c]=a})}),Xb(b,a),b}function Z(b){return parseInt(b,10)}function Yb(b,a){return E(new(E(function(){},{prototype:b})),a)}function A(){}function Fa(b){return b}function $(b){return function(){return b}}function D(b){return b===void 0}function B(b){return b!==void 0}function U(b){return null!=b&&"object"==typeof b}function y(b){return"string"==typeof b}function xb(b){return"number"==typeof b}function Oa(b){return"[object Date]"===xa.call(b)}function O(b){return"function"==typeof b}function fb(b){return"[object RegExp]"===xa.call(b)}function Ea(b){return b&&b.document&&b.location&&b.alert&&b.setInterval}function Uc(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function Vc(b,a,c){var d=[];return q(b,function(b,g,f){d.push(a.call(c,b,g,f))}),d}function Pa(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0;b.length>c;c++)if(a===b[c])return c;return-1}function Qa(b,a){var c=Pa(b,a);return c>=0&&b.splice(c,1),a}function Ga(b,a,c,d){if(Ea(b)||b&&b.$evalAsync&&b.$watch)throw Ra("cpws");if(a){if(b===a)throw Ra("cpi");if(c=c||[],d=d||[],U(b)){var e=Pa(c,b);if(-1!==e)return d[e];c.push(b),d.push(a)}if(L(b))for(var g=a.length=0;b.length>g;g++)e=Ga(b[g],null,c,d),U(b[g])&&(c.push(b[g]),d.push(e)),a.push(e);else{var f=a.$$hashKey;q(a,function(b,c){delete a[c]});for(g in b)e=Ga(b[g],null,c,d),U(b[g])&&(c.push(b[g]),d.push(e)),a[g]=e;Xb(a,f)}}else(a=b)&&(L(b)?a=Ga(b,[],c,d):Oa(b)?a=new Date(b.getTime()):fb(b)?a=RegExp(b.source):U(b)&&(a=Ga(b,{},c,d)));return a}function la(b,a){if(L(b)){a=a||[];for(var c=0;b.length>c;c++)a[c]=b[c]}else if(U(b))for(c in a=a||{},b)!yb.call(b,c)||"$"===c.charAt(0)&&"$"===c.charAt(1)||(a[c]=b[c]);return a||b}function ya(b,a){if(b===a)return!0;if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,d;if(c==typeof a&&"object"==c){if(!L(b)){if(Oa(b))return Oa(a)&&b.getTime()==a.getTime();if(fb(b)&&fb(a))return""+b==""+a;if(b&&b.$evalAsync&&b.$watch||a&&a.$evalAsync&&a.$watch||Ea(b)||Ea(a)||L(a))return!1;c={};for(d in b)if("$"!==d.charAt(0)&&!O(b[d])){if(!ya(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c.hasOwnProperty(d)&&"$"!==d.charAt(0)&&a[d]!==s&&!O(a[d]))return!1;return!0}if(!L(a))return!1;if((c=b.length)==a.length){for(d=0;c>d;d++)if(!ya(b[d],a[d]))return!1;return!0}}return!1}function Zb(){return V.securityPolicy&&V.securityPolicy.isActive||V.querySelector&&!(!V.querySelector("[ng-csp]")&&!V.querySelector("[data-ng-csp]"))}function zb(b,a){var c=arguments.length>2?za.call(arguments,2):[];return!O(a)||a instanceof RegExp?a:c.length?function(){return arguments.length?a.apply(b,c.concat(za.call(arguments,0))):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}}function Wc(b,a){var c=a;return"string"==typeof b&&"$"===b.charAt(0)?c=s:Ea(a)?c="$WINDOW":a&&V===a?c="$DOCUMENT":a&&a.$evalAsync&&a.$watch&&(c="$SCOPE"),c}function sa(b,a){return b===void 0?s:JSON.stringify(b,Wc,a?"  ":null)}function $b(b){return y(b)?JSON.parse(b):b}function Sa(b){return"function"==typeof b?b=!0:b&&0!==b.length?(b=I(""+b),b=!("f"==b||"0"==b||"false"==b||"no"==b||"n"==b||"[]"==b)):b=!1,b}function ga(b){b=x(b).clone();try{b.empty()}catch(a){}var c=x("<div>").append(b).html();try{return 3===b[0].nodeType?I(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+I(b)})}catch(d){return I(c)}}function ac(b){try{return decodeURIComponent(b)}catch(a){}}function bc(b){var a={},c,d;return q((b||"").split("&"),function(b){b&&(c=b.split("="),d=ac(c[0]),B(d)&&(b=B(c[1])?ac(c[1]):!0,a[d]?L(a[d])?a[d].push(b):a[d]=[a[d],b]:a[d]=b))}),a}function Ab(b){var a=[];return q(b,function(b,d){L(b)?q(b,function(b){a.push(Aa(d,!0)+(!0===b?"":"="+Aa(b,!0)))}):a.push(Aa(d,!0)+(!0===b?"":"="+Aa(b,!0)))}),a.length?a.join("&"):""}function gb(b){return Aa(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Aa(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,a?"%20":"+")}function Xc(b,a){function c(a){a&&d.push(a)}var d=[b],e,g,f=["ng:app","ng-app","x-ng-app","data-ng-app"],k=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;q(f,function(a){f[a]=!0,c(V.getElementById(a)),a=a.replace(":","\\:"),b.querySelectorAll&&(q(b.querySelectorAll("."+a),c),q(b.querySelectorAll("."+a+"\\:"),c),q(b.querySelectorAll("["+a+"]"),c))}),q(d,function(a){if(!e){var b=k.exec(" "+a.className+" ");b?(e=a,g=(b[2]||"").replace(/\s+/g,",")):q(a.attributes,function(b){!e&&f[b.name]&&(e=a,g=b.value)})}}),e&&a(e,g?[g]:[])}function cc(b,a){var c=function(){if(b=x(b),b.injector()){var c=b[0]===V?"document":ga(b);throw Ra("btstrpd",c)}return a=a||[],a.unshift(["$provide",function(a){a.value("$rootElement",b)}]),a.unshift("ng"),c=dc(a),c.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(a,b,c,d,e){a.$apply(function(){b.data("$injector",d),c(b)(a)})}]),c},d=/^NG_DEFER_BOOTSTRAP!/;return T&&!d.test(T.name)?c():(T.name=T.name.replace(d,""),Ta.resumeBootstrap=function(b){q(b,function(b){a.push(b)}),c()},void 0)}function hb(b,a){return a=a||"_",b.replace(Yc,function(b,d){return(d?a:"")+b.toLowerCase()})}function Bb(b,a,c){if(!b)throw Ra("areq",a||"?",c||"required");return b}function Ua(b,a,c){return c&&L(b)&&(b=b[b.length-1]),Bb(O(b),a,"not a function, got "+(b&&"object"==typeof b?b.constructor.name||"Object":typeof b)),b}function Ba(b,a){if("hasOwnProperty"===b)throw Ra("badname",a)}function ec(b,a,c){if(!a)return b;a=a.split(".");for(var d,e=b,g=a.length,f=0;g>f;f++)d=a[f],b&&(b=(e=b)[d]);return!c&&O(b)?zb(e,b):b}function Cb(b){var a=b[0];if(b=b[b.length-1],a===b)return x(a);var c=[a];do{if(a=a.nextSibling,!a)break;c.push(a)}while(a!==b);return x(c)}function Zc(b){var a=v("$injector"),c=v("ng");return b=b.angular||(b.angular={}),b.$$minErr=b.$$minErr||v,b.module||(b.module=function(){var b={};return function(e,g,f){if("hasOwnProperty"===e)throw c("badname","module");return g&&b.hasOwnProperty(e)&&(b[e]=null),b[e]||(b[e]=function(){function b(a,d,e){return function(){return c[e||"push"]([a,d,arguments]),p}}if(!g)throw a("nomod",e);var c=[],d=[],l=b("$injector","invoke"),p={_invokeQueue:c,_runBlocks:d,requires:g,name:e,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:b("$provide","value"),constant:b("$provide","constant","unshift"),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),config:l,run:function(a){return d.push(a),this}};return f&&l(f),p}())}}())}function $c(b){E(b,{bootstrap:cc,copy:Ga,extend:E,equals:ya,element:x,forEach:q,injector:dc,noop:A,bind:zb,toJson:sa,fromJson:$b,identity:Fa,isUndefined:D,isDefined:B,isString:y,isFunction:O,isObject:U,isNumber:xb,isElement:Uc,isArray:L,version:ad,isDate:Oa,lowercase:I,uppercase:Ha,callbacks:{counter:0},$$minErr:v,$$csp:Zb}),Va=Zc(T);try{Va("ngLocale")}catch(a){Va("ngLocale",[]).provider("$locale",bd)}Va("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:cd}),a.provider("$compile",fc).directive({a:dd,input:gc,textarea:gc,form:ed,script:fd,select:gd,style:hd,option:id,ngBind:jd,ngBindHtml:kd,ngBindTemplate:ld,ngClass:md,ngClassEven:nd,ngClassOdd:od,ngCloak:pd,ngController:qd,ngForm:rd,ngHide:sd,ngIf:td,ngInclude:ud,ngInit:vd,ngNonBindable:wd,ngPluralize:xd,ngRepeat:yd,ngShow:zd,ngStyle:Ad,ngSwitch:Bd,ngSwitchWhen:Cd,ngSwitchDefault:Dd,ngOptions:Ed,ngTransclude:Fd,ngModel:Gd,ngList:Hd,ngChange:Id,required:hc,ngRequired:hc,ngValue:Jd}).directive({ngInclude:Kd}).directive(Db).directive(ic),a.provider({$anchorScroll:Ld,$animate:Md,$browser:Nd,$cacheFactory:Od,$controller:Pd,$document:Qd,$exceptionHandler:Rd,$filter:jc,$interpolate:Sd,$interval:Td,$http:Ud,$httpBackend:Vd,$location:Wd,$log:Xd,$parse:Yd,$rootScope:Zd,$q:$d,$sce:ae,$sceDelegate:be,$sniffer:ce,$templateCache:de,$timeout:ee,$window:fe,$$rAF:ge,$$asyncCallback:he})}])}function Wa(b){return b.replace(ie,function(a,b,d,e){return e?d.toUpperCase():d}).replace(je,"Moz$1")}function Eb(b,a,c,d){function e(b){var e=c&&b?[this.filter(b)]:[this],m=a,h,l,p,n,r,t;if(!d||null!=b)for(;e.length;)for(h=e.shift(),l=0,p=h.length;p>l;l++)for(n=x(h[l]),m?n.triggerHandler("$destroy"):m=!m,r=0,n=(t=n.children()).length;n>r;r++)e.push(Ca(t[r]));return g.apply(this,arguments)}var g=Ca.fn[b],g=g.$original||g;e.$original=g,Ca.fn[b]=e}function S(b){if(b instanceof S)return b;if(y(b)&&(b=aa(b)),!(this instanceof S)){if(y(b)&&"<"!=b.charAt(0))throw Fb("nosel");return new S(b)}if(y(b)){var a=b;b=V;var c;if(c=ke.exec(a))b=[b.createElement(c[1])];else{var d=b,e;if(b=d.createDocumentFragment(),c=[],Gb.test(a)){for(d=b.appendChild(d.createElement("div")),e=(le.exec(a)||["",""])[1].toLowerCase(),e=ea[e]||ea._default,d.innerHTML="<div>&#160;</div>"+e[1]+a.replace(me,"<$1></$2>")+e[2],d.removeChild(d.firstChild),a=e[0];a--;)d=d.lastChild;for(a=0,e=d.childNodes.length;e>a;++a)c.push(d.childNodes[a]);d=b.firstChild,d.textContent=""}else c.push(d.createTextNode(a));b.textContent="",b.innerHTML="",b=c}Hb(this,b),x(V.createDocumentFragment()).append(this)}else Hb(this,b)}function Ib(b){return b.cloneNode(!0)}function Ia(b){kc(b);var a=0;for(b=b.childNodes||[];b.length>a;a++)Ia(b[a])}function lc(b,a,c,d){if(B(d))throw Fb("offargs");var e=ma(b,"events");ma(b,"handle")&&(D(a)?q(e,function(a,c){Xa(b,c,a),delete e[c]}):q(a.split(" "),function(a){D(c)?(Xa(b,a,e[a]),delete e[a]):Qa(e[a]||[],c)}))}function kc(b,a){var c=b.ng339,d=Ya[c];d&&(a?delete Ya[c].data[a]:(d.handle&&(d.events.$destroy&&d.handle({},"$destroy"),lc(b)),delete Ya[c],b.ng339=s))}function ma(b,a,c){var d=b.ng339,d=Ya[d||-1];return B(c)?(d||(b.ng339=d=++ne,d=Ya[d]={}),d[a]=c,void 0):d&&d[a]}function mc(b,a,c){var d=ma(b,"data"),e=B(c),g=!e&&B(a),f=g&&!U(a);if(d||f||ma(b,"data",d={}),e)d[a]=c;else{if(!g)return d;if(f)return d&&d[a];E(d,a)}}function Jb(b,a){return b.getAttribute?(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" ")>-1:!1}function ib(b,a){a&&b.setAttribute&&q(a.split(" "),function(a){b.setAttribute("class",aa((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+aa(a)+" "," ")))})}function jb(b,a){if(a&&b.setAttribute){var c=(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");q(a.split(" "),function(a){a=aa(a),-1===c.indexOf(" "+a+" ")&&(c+=a+" ")}),b.setAttribute("class",aa(c))}}function Hb(b,a){if(a){a=a.nodeName||!B(a.length)||Ea(a)?[a]:a;for(var c=0;a.length>c;c++)b.push(a[c])}}function nc(b,a){return kb(b,"$"+(a||"ngController")+"Controller")}function kb(b,a,c){for(b=x(b),9==b[0].nodeType&&(b=b.find("html")),a=L(a)?a:[a];b.length;){for(var d=b[0],e=0,g=a.length;g>e;e++)if((c=b.data(a[e]))!==s)return c;b=x(d.parentNode||11===d.nodeType&&d.host)}}function oc(b){for(var a=0,c=b.childNodes;c.length>a;a++)Ia(c[a]);for(;b.firstChild;)b.removeChild(b.firstChild)}function pc(b,a){var c=lb[a.toLowerCase()];return c&&qc[b.nodeName]&&c}function oe(b,a){var c=function(c,e){if(c.preventDefault||(c.preventDefault=function(){c.returnValue=!1}),c.stopPropagation||(c.stopPropagation=function(){c.cancelBubble=!0}),c.target||(c.target=c.srcElement||V),D(c.defaultPrevented)){var g=c.preventDefault;c.preventDefault=function(){c.defaultPrevented=!0,g.call(c)},c.defaultPrevented=!1}c.isDefaultPrevented=function(){return c.defaultPrevented||!1===c.returnValue};var f=la(a[e||c.type]||[]);q(f,function(a){a.call(b,c)}),8>=P?(c.preventDefault=null,c.stopPropagation=null,c.isDefaultPrevented=null):(delete c.preventDefault,delete c.stopPropagation,delete c.isDefaultPrevented)};return c.elem=b,c}function Ja(b,a){var c=typeof b,d;return"function"==c||"object"==c&&null!==b?"function"==typeof(d=b.$$hashKey)?d=b.$$hashKey():d===s&&(d=b.$$hashKey=(a||eb)()):d=b,c+":"+d}function Za(b,a){if(a){var c=0;this.nextUid=function(){return++c}}q(b,this.put,this)}function rc(b){var a,c;return"function"==typeof b?(a=b.$inject)||(a=[],b.length&&(c=(""+b).replace(pe,""),c=c.match(qe),q(c[1].split(re),function(b){b.replace(se,function(b,c,d){a.push(d)})})),b.$inject=a):L(b)?(c=b.length-1,Ua(b[c],"fn"),a=b.slice(0,c)):Ua(b,"fn",!0),a}function dc(b){function a(a){return function(b,c){return U(b)?(q(b,Wb(a)),void 0):a(b,c)}}function c(a,b){if(Ba(a,"service"),(O(b)||L(b))&&(b=p.instantiate(b)),!b.$get)throw $a("pget",a);return l[a+k]=b}function d(a,b){return c(a,{$get:b})}function e(a){var b=[],c,d,g,k;return q(a,function(a){if(!h.get(a)){h.put(a,!0);try{if(y(a))for(c=Va(a),b=b.concat(e(c.requires)).concat(c._runBlocks),d=c._invokeQueue,g=0,k=d.length;k>g;g++){var f=d[g],m=p.get(f[0]);m[f[1]].apply(m,f[2])}else O(a)?b.push(p.invoke(a)):L(a)?b.push(p.invoke(a)):Ua(a,"module")}catch(l){throw L(a)&&(a=a[a.length-1]),l.message&&l.stack&&-1==l.stack.indexOf(l.message)&&(l=l.message+"\n"+l.stack),$a("modulerr",a,l.stack||l.message||l)}}}),b}function g(a,b){function c(d){if(a.hasOwnProperty(d)){if(a[d]===f)throw $a("cdep",d+" <- "+m.join(" <- "));return a[d]}try{return m.unshift(d),a[d]=f,a[d]=b(d)}catch(e){throw a[d]===f&&delete a[d],e}finally{m.shift()}}function d(a,b,e){var g=[],k=rc(a),f,m,h;for(m=0,f=k.length;f>m;m++){if(h=k[m],"string"!=typeof h)throw $a("itkn",h);g.push(e&&e.hasOwnProperty(h)?e[h]:c(h))}return L(a)&&(a=a[f]),a.apply(b,g)}return{invoke:d,instantiate:function(a,b){var c=function(){},e;return c.prototype=(L(a)?a[a.length-1]:a).prototype,c=new c,e=d(a,c,b),U(e)||O(e)?e:c},get:c,annotate:rc,has:function(b){return l.hasOwnProperty(b+k)||a.hasOwnProperty(b)}}}var f={},k="Provider",m=[],h=new Za([],!0),l={$provide:{provider:a(c),factory:a(d),service:a(function(a,b){return d(a,["$injector",function(a){return a.instantiate(b)}])}),value:a(function(a,b){return d(a,$(b))}),constant:a(function(a,b){Ba(a,"constant"),l[a]=b,n[a]=b}),decorator:function(a,b){var c=p.get(a+k),d=c.$get;c.$get=function(){var a=r.invoke(d,c);return r.invoke(b,null,{$delegate:a})}}}},p=l.$injector=g(l,function(){throw $a("unpr",m.join(" <- "))}),n={},r=n.$injector=g(n,function(a){return a=p.get(a+k),r.invoke(a.$get,a)});return q(e(b),function(a){r.invoke(a||A)}),r}function Ld(){var b=!0;this.disableAutoScrolling=function(){b=!1},this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;return q(a,function(a){b||"a"!==I(a.nodeName)||(b=a)}),b}function g(){var b=c.hash(),d;b?(d=f.getElementById(b))?d.scrollIntoView():(d=e(f.getElementsByName(b)))?d.scrollIntoView():"top"===b&&a.scrollTo(0,0):a.scrollTo(0,0)}var f=a.document;return b&&d.$watch(function(){return c.hash()},function(){d.$evalAsync(g)}),g}]}function he(){this.$get=["$$rAF","$timeout",function(b,a){return b.supported?function(a){return b(a)}:function(b){return a(b,0,!1)}}]}function te(b,a,c,d){function e(a){try{a.apply(null,za.call(arguments,1))}finally{if(t--,0===t)for(;J.length;)try{J.pop()()}catch(b){c.error(b)}}}function g(a,b){(function ba(){q(w,function(a){a()}),u=b(ba,a)})()}function f(){z=null,K!=k.url()&&(K=k.url(),q(ha,function(a){a(k.url())}))}var k=this,m=a[0],h=b.location,l=b.history,p=b.setTimeout,n=b.clearTimeout,r={};k.isMock=!1;var t=0,J=[];k.$$completeOutstandingRequest=e,k.$$incOutstandingRequestCount=function(){t++},k.notifyWhenNoOutstandingRequests=function(a){q(w,function(a){a()}),0===t?a():J.push(a)};var w=[],u;k.addPollFn=function(a){return D(u)&&g(100,p),w.push(a),a};var K=h.href,Q=a.find("base"),z=null;k.url=function(a,c){return h!==b.location&&(h=b.location),l!==b.history&&(l=b.history),a?K!=a?(K=a,d.history?c?l.replaceState(null,"",a):(l.pushState(null,"",a),Q.attr("href",Q.attr("href"))):(z=a,c?h.replace(a):h.href=a),k):void 0:z||h.href.replace(/%27/g,"'")};var ha=[],N=!1;k.onUrlChange=function(a){return N||(d.history&&x(b).on("popstate",f),d.hashchange?x(b).on("hashchange",f):k.addPollFn(f),N=!0),ha.push(a),a},k.baseHref=function(){var a=Q.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var M={},ca="",C=k.baseHref();k.cookies=function(a,b){var d,e,g,k;if(!a){if(m.cookie!==ca)for(ca=m.cookie,d=ca.split("; "),M={},g=0;d.length>g;g++)e=d[g],k=e.indexOf("="),k>0&&(a=unescape(e.substring(0,k)),M[a]===s&&(M[a]=unescape(e.substring(k+1))));return M}b===s?m.cookie=escape(a)+"=;path="+C+";expires=Thu, 01 Jan 1970 00:00:00 GMT":y(b)&&(d=(m.cookie=escape(a)+"="+escape(b)+";path="+C).length+1,d>4096&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!"))},k.defer=function(a,b){var c;return t++,c=p(function(){delete r[c],e(a)},b||0),r[c]=!0,c},k.defer.cancel=function(a){return r[a]?(delete r[a],n(a),e(A),!0):!1}}function Nd(){this.$get=["$window","$log","$sniffer","$document",function(b,a,c,d){return new te(b,d,a,c)}]}function Od(){this.$get=function(){function b(b,d){function e(a){a!=p&&(n?n==a&&(n=a.n):n=a,g(a.n,a.p),g(a,p),p=a,p.n=null)}function g(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(b in a)throw v("$cacheFactory")("iid",b);var f=0,k=E({},d,{id:b}),m={},h=d&&d.capacity||Number.MAX_VALUE,l={},p=null,n=null;return a[b]={put:function(a,b){if(Number.MAX_VALUE>h){var c=l[a]||(l[a]={key:a});e(c)}return D(b)?void 0:(a in m||f++,m[a]=b,f>h&&this.remove(n.key),b)},get:function(a){if(Number.MAX_VALUE>h){var b=l[a];if(!b)return;e(b)}return m[a]},remove:function(a){if(Number.MAX_VALUE>h){var b=l[a];if(!b)return;b==p&&(p=b.p),b==n&&(n=b.n),g(b.n,b.p),delete l[a]}delete m[a],f--},removeAll:function(){m={},f=0,l={},p=n=null},destroy:function(){l=k=m=null,delete a[b]},info:function(){return E({},k,{size:f})}}}var a={};return b.info=function(){var b={};return q(a,function(a,e){b[e]=a.info()}),b},b.get=function(b){return a[b]},b}}function de(){this.$get=["$cacheFactory",function(b){return b("templates")}]}function fc(b,a){var c={},d="Directive",e=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,g=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,f=/^(on[a-z]+|formaction)$/;this.directive=function m(a,e){return Ba(a,"directive"),y(a)?(Bb(e,"directiveFactory"),c.hasOwnProperty(a)||(c[a]=[],b.factory(a+d,["$injector","$exceptionHandler",function(b,d){var e=[];return q(c[a],function(c,g){try{var f=b.invoke(c);O(f)?f={compile:$(f)}:!f.compile&&f.link&&(f.compile=$(f.link)),f.priority=f.priority||0,f.index=g,f.name=f.name||a,f.require=f.require||f.controller&&f.name,f.restrict=f.restrict||"A",e.push(f)}catch(m){d(m)}}),e}])),c[a].push(e)):q(a,Wb(m)),this},this.aHrefSanitizationWhitelist=function(b){return B(b)?(a.aHrefSanitizationWhitelist(b),this):a.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(b){return B(b)?(a.imgSrcSanitizationWhitelist(b),this):a.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,b,l,p,n,r,t,J,w,u,K,Q){function z(a,b,c,d,e){a instanceof x||(a=x(a)),q(a,function(b,c){3==b.nodeType&&b.nodeValue.match(/\S+/)&&(a[c]=x(b).wrap("<span></span>").parent()[0])});var g=N(a,b,a,c,d,e);return ha(a,"ng-scope"),function(b,c,d,e){Bb(b,"scope");var f=c?Ka.clone.call(a):a;q(d,function(a,b){f.data("$"+b+"Controller",a)}),d=0;for(var m=f.length;m>d;d++){var h=f[d].nodeType;1!==h&&9!==h||f.eq(d).data("$scope",b)}return c&&c(f,b),g&&g(b,f,f,e),f}}function ha(a,b){try{a.addClass(b)}catch(c){}}function N(a,b,c,d,e,g){function f(a,c,d,e){var g,h,l,r,p,n,t;g=c.length;var w=Array(g);for(p=0;g>p;p++)w[p]=c[p];for(t=p=0,n=m.length;n>p;t++)h=w[t],c=m[p++],g=m[p++],l=x(h),c?(c.scope?(r=a.$new(),l.data("$scope",r)):r=a,l=c.transcludeOnThisElement?M(a,c.transclude,e):!c.templateOnThisElement&&e?e:!e&&b?M(a,b):null,c(g,r,h,d,l)):g&&g(a,h.childNodes,s,e)}for(var m=[],h,l,r,p,n=0;a.length>n;n++)h=new Kb,l=ca(a[n],[],h,0===n?d:s,e),(g=l.length?H(l,a[n],h,b,c,null,[],[],g):null)&&g.scope&&ha(x(a[n]),"ng-scope"),h=g&&g.terminal||!(r=a[n].childNodes)||!r.length?null:N(r,g?(g.transcludeOnThisElement||!g.templateOnThisElement)&&g.transclude:b),m.push(g,h),p=p||g||h,g=null;return p?f:null}function M(a,b,c){return function(d,e,g){var f=!1;return d||(d=a.$new(),f=d.$$transcluded=!0),e=b(d,e,g,c),f&&e.on("$destroy",function(){d.$destroy()}),e}}function ca(a,b,c,d,f){var h=c.$attr,m;switch(a.nodeType){case 1:ba(b,na(La(a).toLowerCase()),"E",d,f);for(var l,r,p,n=a.attributes,t=0,w=n&&n.length;w>t;t++){var J=!1,K=!1;if(l=n[t],!P||P>=8||l.specified){m=l.name,r=aa(l.value),l=na(m),(p=W.test(l))&&(m=hb(l.substr(6),"-"));var u=l.replace(/(Start|End)$/,"");l===u+"Start"&&(J=m,K=m.substr(0,m.length-5)+"end",m=m.substr(0,m.length-6)),l=na(m.toLowerCase()),h[l]=m,(p||!c.hasOwnProperty(l))&&(c[l]=r,pc(a,l)&&(c[l]=!0)),S(a,b,r,l),ba(b,l,"A",d,f,J,K)}}if(a=a.className,y(a)&&""!==a)for(;m=g.exec(a);)l=na(m[2]),ba(b,l,"C",d,f)&&(c[l]=aa(m[3])),a=a.substr(m.index+m[0].length);break;case 3:v(b,a.nodeValue);break;case 8:try{(m=e.exec(a.nodeValue))&&(l=na(m[1]),ba(b,l,"M",d,f)&&(c[l]=aa(m[2])))}catch(z){}}return b.sort(D),b}function C(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ia("uterdir",b,c);1==a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--),d.push(a),a=a.nextSibling}while(e>0)}else d.push(a);return x(d)}function G(a,b,c){return function(d,e,g,f,m){return e=C(e[0],b,c),a(d,e,g,f,m)}}function H(a,c,d,e,g,f,m,p,n){function w(a,b,c,d){a&&(c&&(a=G(a,c,d)),a.require=F.require,a.directiveName=oa,(M===F||F.$$isolateScope)&&(a=tc(a,{isolateScope:!0})),m.push(a)),b&&(c&&(b=G(b,c,d)),b.require=F.require,b.directiveName=oa,(M===F||F.$$isolateScope)&&(b=tc(b,{isolateScope:!0})),p.push(b))}function J(a,b,c,d){var e,g="data",f=!1;if(y(b)){for(;"^"==(e=b.charAt(0))||"?"==e;)b=b.substr(1),"^"==e&&(g="inheritedData"),f=f||"?"==e;if(e=null,d&&"data"===g&&(e=d[b]),e=e||c[g]("$"+b+"Controller"),!e&&!f)throw ia("ctreq",b,a)}else L(b)&&(e=[],q(b,function(b){e.push(J(a,b,c,d))}));return e}function K(a,e,g,f,n){function w(a,b){var c;return 2>arguments.length&&(b=a,a=s),Da&&(c=ca),n(a,b,c)}var u,R,z,Q,G,C,ca={},mb;if(u=c===g?d:la(d,new Kb(x(g),d.$attr)),R=u.$$element,M){var ba=/^\s*([@=&])(\??)\s*(\w*)\s*$/;f=x(g),C=e.$new(!0),!H||H!==M&&H!==M.$$originalDirective?f.data("$isolateScopeNoTemplate",C):f.data("$isolateScope",C),ha(f,"ng-isolate-scope"),q(M.scope,function(a,c){var d=a.match(ba)||[],g=d[3]||c,f="?"==d[2],d=d[1],m,l,p,n;switch(C.$$isolateBindings[c]=d+g,d){case"@":u.$observe(g,function(a){C[c]=a}),u.$$observers[g].$$scope=e,u[g]&&(C[c]=b(u[g])(e));break;case"=":if(f&&!u[g])break;l=r(u[g]),n=l.literal?ya:function(a,b){return a===b},p=l.assign||function(){throw m=C[c]=l(e),ia("nonassign",u[g],M.name)},m=C[c]=l(e),C.$watch(function(){var a=l(e);return n(a,C[c])||(n(a,m)?p(e,a=C[c]):C[c]=a),m=a},null,l.literal);break;case"&":l=r(u[g]),C[c]=function(a){return l(e,a)};break;default:throw ia("iscp",M.name,c,a)}})}for(mb=n&&w,N&&q(N,function(a){var b={$scope:a===M||a.$$isolateScope?C:e,$element:R,$attrs:u,$transclude:mb},c;G=a.controller,"@"==G&&(G=u[a.name]),c=t(G,b),ca[a.name]=c,Da||R.data("$"+a.name+"Controller",c),a.controllerAs&&(b.$scope[a.controllerAs]=c)}),f=0,z=m.length;z>f;f++)try{Q=m[f],Q(Q.isolateScope?C:e,R,u,Q.require&&J(Q.directiveName,Q.require,R,ca),mb)}catch(F){l(F,ga(R))}for(f=e,M&&(M.template||null===M.templateUrl)&&(f=C),a&&a(f,g.childNodes,s,n),f=p.length-1;f>=0;f--)try{Q=p[f],Q(Q.isolateScope?C:e,R,u,Q.require&&J(Q.directiveName,Q.require,R,ca),mb)}catch(B){l(B,ga(R))}}n=n||{};for(var u=-Number.MAX_VALUE,Q,N=n.controllerDirectives,M=n.newIsolateScopeDirective,H=n.templateDirective,ba=n.nonTlbTranscludeDirective,D=!1,E=!1,Da=n.hasElementTranscludeDirective,v=d.$$element=x(c),F,oa,X,T=e,S,P=0,pa=a.length;pa>P;P++){F=a[P];var W=F.$$start,Y=F.$$end;if(W&&(v=C(c,W,Y)),X=s,u>F.priority)break;if((X=F.scope)&&(Q=Q||F,F.templateUrl||(I("new/isolated scope",M,F,v),U(X)&&(M=F))),oa=F.name,!F.templateUrl&&F.controller&&(X=F.controller,N=N||{},I("'"+oa+"' controller",N[oa],F,v),N[oa]=F),(X=F.transclude)&&(D=!0,F.$$tlb||(I("transclusion",ba,F,v),ba=F),"element"==X?(Da=!0,u=F.priority,X=C(c,W,Y),v=d.$$element=x(V.createComment(" "+oa+": "+d[oa]+" ")),c=v[0],nb(g,x(za.call(X,0)),c),T=z(X,e,u,f&&f.name,{nonTlbTranscludeDirective:ba})):(X=x(Ib(c)).contents(),v.empty(),T=z(X,e))),F.template)if(E=!0,I("template",H,F,v),H=F,X=O(F.template)?F.template(v,d):F.template,X=Z(X),F.replace){if(f=F,X=Gb.test(X)?x(aa(X)):[],c=X[0],1!=X.length||1!==c.nodeType)throw ia("tplrt",oa,"");nb(g,v,c),pa={$attr:{}},X=ca(c,[],pa);var ue=a.splice(P+1,a.length-(P+1));M&&sc(X),a=a.concat(X).concat(ue),B(d,pa),pa=a.length}else v.html(X);if(F.templateUrl)E=!0,I("template",H,F,v),H=F,F.replace&&(f=F),K=A(a.splice(P,a.length-P),v,d,g,D&&T,m,p,{controllerDirectives:N,newIsolateScopeDirective:M,templateDirective:H,nonTlbTranscludeDirective:ba}),pa=a.length;else if(F.compile)try{S=F.compile(v,d,T),O(S)?w(null,S,W,Y):S&&w(S.pre,S.post,W,Y)}catch($){l($,ga(v))}F.terminal&&(K.terminal=!0,u=Math.max(u,F.priority))}return K.scope=Q&&!0===Q.scope,K.transcludeOnThisElement=D,K.templateOnThisElement=E,K.transclude=T,n.hasElementTranscludeDirective=Da,K}function sc(a){for(var b=0,c=a.length;c>b;b++)a[b]=Yb(a[b],{$$isolateScope:!0})}function ba(b,e,g,f,h,r,p){if(e===h)return null;if(h=null,c.hasOwnProperty(e)){var n;e=a.get(e+d);for(var t=0,w=e.length;w>t;t++)try{n=e[t],(f===s||f>n.priority)&&-1!=n.restrict.indexOf(g)&&(r&&(n=Yb(n,{$$start:r,$$end:p})),b.push(n),h=n)}catch(J){l(J)}}return h}function B(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;q(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))}),q(b,function(b,g){"class"==g?(ha(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):"style"==g?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==g.charAt(0)||a.hasOwnProperty(g)||(a[g]=b,d[g]=c[g])})}function A(a,b,c,d,e,g,f,m){var h=[],l,r,t=b[0],w=a.shift(),J=E({},w,{templateUrl:null,transclude:null,replace:null,$$originalDirective:w}),K=O(w.templateUrl)?w.templateUrl(b,c):w.templateUrl;return b.empty(),p.get(u.getTrustedResourceUrl(K),{cache:n}).success(function(p){var n,u;if(p=Z(p),w.replace){if(p=Gb.test(p)?x(aa(p)):[],n=p[0],1!=p.length||1!==n.nodeType)throw ia("tplrt",w.name,K);p={$attr:{}},nb(d,b,n);var z=ca(n,[],p);U(w.scope)&&sc(z),a=z.concat(a),B(c,p)}else n=t,b.html(p);for(a.unshift(J),l=H(a,n,c,e,b,w,g,f,m),q(d,function(a,c){a==n&&(d[c]=b[0])}),r=N(b[0].childNodes,e);h.length;){p=h.shift(),u=h.shift();var Q=h.shift(),G=h.shift(),z=b[0];if(u!==t){var C=u.className;m.hasElementTranscludeDirective&&w.replace||(z=Ib(n)),nb(Q,x(u),z),ha(x(z),C)}u=l.transcludeOnThisElement?M(p,l.transclude,G):G,l(r,p,z,d,u)}h=null}).error(function(a,b,c,d){throw ia("tpload",d.url)}),function(a,b,c,d,e){a=e,h?(h.push(b),h.push(c),h.push(d),h.push(a)):(l.transcludeOnThisElement&&(a=M(b,l.transclude,e)),l(r,b,c,d,a))}}function D(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function I(a,b,c,d){if(b)throw ia("multidir",b.name,c.name,a,ga(d))}function v(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){var b=a.parent().length;return b&&ha(a.parent(),"ng-binding"),function(a,c){var e=c.parent(),g=e.data("$binding")||[];g.push(d),e.data("$binding",g),b||ha(e,"ng-binding"),a.$watch(d,function(a){c[0].nodeValue=a})}}})}function T(a,b){if("srcdoc"==b)return u.HTML;var c=La(a);return"xlinkHref"==b||"FORM"==c&&"action"==b||"IMG"!=c&&("src"==b||"ngSrc"==b)?u.RESOURCE_URL:void 0}function S(a,c,d,e){var g=b(d,!0);if(g){if("multiple"===e&&"SELECT"===La(a))throw ia("selmulti",ga(a));c.push({priority:100,compile:function(){return{pre:function(c,d,m){if(d=m.$$observers||(m.$$observers={}),f.test(e))throw ia("nodomevents");(g=b(m[e],!0,T(a,e)))&&(m[e]=g(c),(d[e]||(d[e]=[])).$$inter=!0,(m.$$observers&&m.$$observers[e].$$scope||c).$watch(g,function(a,b){"class"===e&&a!=b?m.$updateClass(a,b):m.$set(e,a)}))}}}})}}function nb(a,b,c){var d=b[0],e=b.length,g=d.parentNode,f,m;if(a)for(f=0,m=a.length;m>f;f++)if(a[f]==d){a[f++]=c,m=f+e-1;for(var h=a.length;h>f;f++,m++)h>m?a[f]=a[m]:delete a[f];a.length-=e-1;break}for(g&&g.replaceChild(c,d),a=V.createDocumentFragment(),a.appendChild(d),c[x.expando]=d[x.expando],d=1,e=b.length;e>d;d++)g=b[d],x(g).remove(),a.appendChild(g),delete b[d];b[0]=c,b.length=1}function tc(a,b){return E(function(){return a.apply(null,arguments)},a,b)}var Kb=function(a,b){this.$$element=a,this.$attr=b||{}};Kb.prototype={$normalize:na,$addClass:function(a){a&&a.length>0&&K.addClass(this.$$element,a)},$removeClass:function(a){a&&a.length>0&&K.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=uc(a,b),d=uc(b,a);0===c.length?K.removeClass(this.$$element,d):0===d.length?K.addClass(this.$$element,c):K.setClass(this.$$element,c,d)},$set:function(a,b,c,d){var e=pc(this.$$element[0],a);e&&(this.$$element.prop(a,b),d=e),this[a]=b,d?this.$attr[a]=d:(d=this.$attr[a])||(this.$attr[a]=d=hb(a,"-")),e=La(this.$$element),("A"===e&&"href"===a||"IMG"===e&&"src"===a)&&(this[a]=b=Q(b,"src"===a)),!1!==c&&(null===b||b===s?this.$$element.removeAttr(d):this.$$element.attr(d,b)),(c=this.$$observers)&&q(c[a],function(a){try{a(b)}catch(c){l(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers={}),e=d[a]||(d[a]=[]);return e.push(b),J.$evalAsync(function(){e.$$inter||b(c[a])}),b}};var Da=b.startSymbol(),pa=b.endSymbol(),Z="{{"==Da||"}}"==pa?Fa:function(a){return a.replace(/\{\{/g,Da).replace(/}}/g,pa)},W=/^ngAttr[A-Z]/;return z}]}function na(b){return Wa(b.replace(ve,""))}function uc(b,a){var c="",d=b.split(/\s+/),e=a.split(/\s+/),g=0;a:for(;d.length>g;g++){for(var f=d[g],k=0;e.length>k;k++)if(f==e[k])continue a;c+=(c.length>0?" ":"")+f}return c}function Pd(){var b={},a=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,d){Ba(a,"controller"),U(a)?E(b,a):b[a]=d},this.$get=["$injector","$window",function(c,d){return function(e,g){var f,k,m;if(y(e)&&(f=e.match(a),k=f[1],m=f[3],e=b.hasOwnProperty(k)?b[k]:ec(g.$scope,k,!0)||ec(d,k,!0),Ua(e,k,!0)),f=c.instantiate(e,g),m){if(!g||"object"!=typeof g.$scope)throw v("$controller")("noscp",k||e.name,m);g.$scope[m]=f}return f}}]}function Qd(){this.$get=["$window",function(b){return x(b.document)}]}function Rd(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function vc(b){var a={},c,d,e;return b?(q(b.split("\n"),function(b){e=b.indexOf(":"),c=I(aa(b.substr(0,e))),d=aa(b.substr(e+1)),c&&(a[c]=a[c]?a[c]+(", "+d):d)}),a):a}function wc(b){var a=U(b)?b:s;return function(c){return a||(a=vc(b)),c?a[I(c)]||null:a}}function xc(b,a,c){return O(c)?c(b,a):(q(c,function(c){b=c(b,a)}),b)}function Ud(){var b=/^\s*(\[|\{[^\{])/,a=/[\}\]]\s*$/,c=/^\)\]\}',?\n/,d={"Content-Type":"application/json;charset=utf-8"},e=this.defaults={transformResponse:[function(d){return y(d)&&(d=d.replace(c,""),b.test(d)&&a.test(d)&&(d=$b(d))),d
}],transformRequest:[function(a){return U(a)&&"[object File]"!==xa.call(a)&&"[object Blob]"!==xa.call(a)?sa(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:la(d),put:la(d),patch:la(d)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},g=this.interceptors=[],f=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(a,b,c,d,p,n){function r(a){function b(a){var d=E({},a,{data:xc(a.data,a.headers,c.transformResponse)});return a.status>=200&&300>a.status?d:p.reject(d)}var c={method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse},d=function(a){function b(a){var c;q(a,function(b,d){O(b)&&(c=b(),null!=c?a[d]=c:delete a[d])})}var c=e.headers,d=E({},a.headers),g,f,c=E({},c.common,c[I(a.method)]);b(c),b(d);a:for(g in c){a=I(g);for(f in d)if(I(f)===a)continue a;d[g]=c[g]}return d}(a);E(c,a),c.headers=d,c.method=Ha(c.method);var g=[function(a){d=a.headers;var c=xc(a.data,wc(d),a.transformRequest);return D(a.data)&&q(d,function(a,b){"content-type"===I(b)&&delete d[b]}),D(a.withCredentials)&&!D(e.withCredentials)&&(a.withCredentials=e.withCredentials),t(a,c,d).then(b,b)},s],f=p.when(c);for(q(u,function(a){(a.request||a.requestError)&&g.unshift(a.request,a.requestError),(a.response||a.responseError)&&g.push(a.response,a.responseError)});g.length;){a=g.shift();var m=g.shift(),f=f.then(a,m)}return f.success=function(a){return f.then(function(b){a(b.data,b.status,b.headers,c)}),f},f.error=function(a){return f.then(null,function(b){a(b.data,b.status,b.headers,c)}),f},f}function t(c,g,f){function h(a,b,c,e){G&&(a>=200&&300>a?G.put(x,[a,b,vc(c),e]):G.remove(x)),n(b,a,c,e),d.$$phase||d.$apply()}function n(a,b,d,e){b=Math.max(b,0),(b>=200&&300>b?u.resolve:u.reject)({data:a,status:b,headers:wc(d),config:c,statusText:e})}function t(){var a=Pa(r.pendingRequests,c);-1!==a&&r.pendingRequests.splice(a,1)}var u=p.defer(),q=u.promise,G,H,x=J(c.url,c.params);if(r.pendingRequests.push(c),q.then(t,t),(c.cache||e.cache)&&!1!==c.cache&&"GET"==c.method&&(G=U(c.cache)?c.cache:U(e.cache)?e.cache:w),G)if(H=G.get(x),B(H)){if(H.then)return H.then(t,t),H;L(H)?n(H[1],H[0],la(H[2]),H[3]):n(H,200,{},"OK")}else G.put(x,q);return D(H)&&((H=Lb(c.url)?b.cookies()[c.xsrfCookieName||e.xsrfCookieName]:s)&&(f[c.xsrfHeaderName||e.xsrfHeaderName]=H),a(c.method,x,g,h,f,c.timeout,c.withCredentials,c.responseType)),q}function J(a,b){if(!b)return a;var c=[];return Tc(b,function(a,b){null===a||D(a)||(L(a)||(a=[a]),q(a,function(a){U(a)&&(a=sa(a)),c.push(Aa(b)+"="+Aa(a))}))}),c.length>0&&(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&")),a}var w=c("$http"),u=[];return q(g,function(a){u.unshift(y(a)?n.get(a):n.invoke(a))}),q(f,function(a,b){var c=y(a)?n.get(a):n.invoke(a);u.splice(b,0,{response:function(a){return c(p.when(a))},responseError:function(a){return c(p.reject(a))}})}),r.pendingRequests=[],function(a){q(arguments,function(a){r[a]=function(b,c){return r(E(c||{},{method:a,url:b}))}})}("get","delete","head","jsonp"),function(a){q(arguments,function(a){r[a]=function(b,c,d){return r(E(d||{},{method:a,url:b,data:c}))}})}("post","put"),r.defaults=e,r}]}function we(b){if(8>=P&&(!b.match(/^(get|post|head|put|delete|options)$/i)||!T.XMLHttpRequest))return new T.ActiveXObject("Microsoft.XMLHTTP");if(T.XMLHttpRequest)return new T.XMLHttpRequest;throw v("$httpBackend")("noxhr")}function Vd(){this.$get=["$browser","$window","$document",function(b,a,c){return xe(b,we,b.defer,a.angular.callbacks,c[0])}]}function xe(b,a,c,d,e){function g(a,b,c){var g=e.createElement("script"),f=null;return g.type="text/javascript",g.src=a,g.async=!0,f=function(a){Xa(g,"load",f),Xa(g,"error",f),e.body.removeChild(g),g=null;var k=-1,t="unknown";a&&("load"!==a.type||d[b].called||(a={type:"error"}),t=a.type,k="error"===a.type?404:200),c&&c(k,t)},ob(g,"load",f),ob(g,"error",f),8>=P&&(g.onreadystatechange=function(){y(g.readyState)&&/loaded|complete/.test(g.readyState)&&(g.onreadystatechange=null,f({type:"load"}))}),e.body.appendChild(g),f}var f=-1;return function(e,m,h,l,p,n,r,t){function J(){u=f,Q&&Q(),z&&z.abort()}function w(a,d,e,g,f){N&&c.cancel(N),Q=z=null,0===d&&(d=e?200:"file"==ta(m).protocol?404:0),a(1223===d?204:d,e,g,f||""),b.$$completeOutstandingRequest(A)}var u;if(b.$$incOutstandingRequestCount(),m=m||b.url(),"jsonp"==I(e)){var K="_"+(d.counter++).toString(36);d[K]=function(a){d[K].data=a,d[K].called=!0};var Q=g(m.replace("JSON_CALLBACK","angular.callbacks."+K),K,function(a,b){w(l,a,d[K].data,"",b),d[K]=A})}else{var z=a(e);if(z.open(e,m,!0),q(p,function(a,b){B(a)&&z.setRequestHeader(b,a)}),z.onreadystatechange=function(){if(z&&4==z.readyState){var a=null,b=null,c="";u!==f&&(a=z.getAllResponseHeaders(),b="response"in z?z.response:z.responseText),u===f&&10>P||(c=z.statusText),w(l,u||z.status,b,a,c)}},r&&(z.withCredentials=!0),t)try{z.responseType=t}catch(s){if("json"!==t)throw s}z.send(h||null)}if(n>0)var N=c(J,n);else n&&n.then&&n.then(J)}}function Sd(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b},this.endSymbol=function(b){return b?(a=b,this):a},this.$get=["$parse","$exceptionHandler","$sce",function(c,d,e){function g(g,h,l){for(var p,n,r=0,t=[],J=g.length,w=!1,u=[];J>r;)-1!=(p=g.indexOf(b,r))&&-1!=(n=g.indexOf(a,p+f))?(r!=p&&t.push(g.substring(r,p)),t.push(r=c(w=g.substring(p+f,n))),r.exp=w,r=n+k,w=!0):(r!=J&&t.push(g.substring(r)),r=J);if((J=t.length)||(t.push(""),J=1),l&&t.length>1)throw yc("noconcat",g);return!h||w?(u.length=J,r=function(a){try{for(var b=0,c=J,f;c>b;b++){if("function"==typeof(f=t[b]))if(f=f(a),f=l?e.getTrusted(l,f):e.valueOf(f),null==f)f="";else switch(typeof f){case"string":break;case"number":f=""+f;break;default:f=sa(f)}u[b]=f}return u.join("")}catch(k){a=yc("interr",g,""+k),d(a)}},r.exp=g,r.parts=t,r):void 0}var f=b.length,k=a.length;return g.startSymbol=function(){return b},g.endSymbol=function(){return a},g}]}function Td(){this.$get=["$rootScope","$window","$q",function(b,a,c){function d(d,f,k,m){var h=a.setInterval,l=a.clearInterval,p=c.defer(),n=p.promise,r=0,t=B(m)&&!m;return k=B(k)?k:0,n.then(null,null,d),n.$$intervalId=h(function(){p.notify(r++),k>0&&r>=k&&(p.resolve(r),l(n.$$intervalId),delete e[n.$$intervalId]),t||b.$apply()},f),e[n.$$intervalId]=p,n}var e={};return d.cancel=function(b){return b&&b.$$intervalId in e?(e[b.$$intervalId].reject("canceled"),a.clearInterval(b.$$intervalId),delete e[b.$$intervalId],!0):!1},d}]}function bd(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return 1===b?"one":"other"}}}}function Mb(b){b=b.split("/");for(var a=b.length;a--;)b[a]=gb(b[a]);return b.join("/")}function zc(b,a,c){b=ta(b,c),a.$$protocol=b.protocol,a.$$host=b.hostname,a.$$port=Z(b.port)||ye[b.protocol]||null}function Ac(b,a,c){var d="/"!==b.charAt(0);d&&(b="/"+b),b=ta(b,c),a.$$path=decodeURIComponent(d&&"/"===b.pathname.charAt(0)?b.pathname.substring(1):b.pathname),a.$$search=bc(b.search),a.$$hash=decodeURIComponent(b.hash),a.$$path&&"/"!=a.$$path.charAt(0)&&(a.$$path="/"+a.$$path)}function qa(b,a){return 0===a.indexOf(b)?a.substr(b.length):void 0}function ab(b){var a=b.indexOf("#");return-1==a?b:b.substr(0,a)}function Nb(b){return b.substr(0,ab(b).lastIndexOf("/")+1)}function Bc(b,a){this.$$html5=!0,a=a||"";var c=Nb(b);zc(b,this,b),this.$$parse=function(a){var e=qa(c,a);if(!y(e))throw Ob("ipthprfx",a,c);Ac(e,this,b),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var a=Ab(this.$$search),b=this.$$hash?"#"+gb(this.$$hash):"";this.$$url=Mb(this.$$path)+(a?"?"+a:"")+b,this.$$absUrl=c+this.$$url.substr(1)},this.$$rewrite=function(d){var e;return(e=qa(b,d))!==s?(d=e,(e=qa(a,e))!==s?c+(qa("/",e)||e):b+d):(e=qa(c,d))!==s?c+e:c==d+"/"?c:void 0}}function Pb(b,a){var c=Nb(b);zc(b,this,b),this.$$parse=function(d){var e=qa(b,d)||qa(c,d),e="#"==e.charAt(0)?qa(a,e):this.$$html5?e:"";if(!y(e))throw Ob("ihshprfx",d,a);Ac(e,this,b),d=this.$$path;var g=/^\/[A-Z]:(\/.*)/;0===e.indexOf(b)&&(e=e.replace(b,"")),g.exec(e)||(d=(e=g.exec(d))?e[1]:d),this.$$path=d,this.$$compose()},this.$$compose=function(){var c=Ab(this.$$search),e=this.$$hash?"#"+gb(this.$$hash):"";this.$$url=Mb(this.$$path)+(c?"?"+c:"")+e,this.$$absUrl=b+(this.$$url?a+this.$$url:"")},this.$$rewrite=function(a){return ab(b)==ab(a)?a:void 0}}function Qb(b,a){this.$$html5=!0,Pb.apply(this,arguments);var c=Nb(b);this.$$rewrite=function(d){var e;return b==ab(d)?d:(e=qa(c,d))?b+a+e:c===d+"/"?c:void 0},this.$$compose=function(){var c=Ab(this.$$search),e=this.$$hash?"#"+gb(this.$$hash):"";this.$$url=Mb(this.$$path)+(c?"?"+c:"")+e,this.$$absUrl=b+a+this.$$url}}function pb(b){return function(){return this[b]}}function Cc(b,a){return function(c){return D(c)?this[b]:(this[b]=a(c),this.$$compose(),this)}}function Wd(){var b="",a=!1;this.hashPrefix=function(a){return B(a)?(b=a,this):b},this.html5Mode=function(b){return B(b)?(a=b,this):a},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(c,d,e,g){function f(a){c.$broadcast("$locationChangeSuccess",k.absUrl(),a)}var k,m,h=d.baseHref(),l=d.url(),p;a?(p=l.substring(0,l.indexOf("/",l.indexOf("//")+2))+(h||"/"),m=e.history?Bc:Qb):(p=ab(l),m=Pb),k=new m(p,"#"+b),k.$$parse(k.$$rewrite(l)),g.on("click",function(a){if(!a.ctrlKey&&!a.metaKey&&2!=a.which){for(var e=x(a.target);"a"!==I(e[0].nodeName);)if(e[0]===g[0]||!(e=e.parent())[0])return;var f=e.prop("href");if(U(f)&&"[object SVGAnimatedString]"==""+f&&(f=ta(f.animVal).href),m===Qb){var h=e.attr("href")||e.attr("xlink:href");if(0>h.indexOf("://"))if(f="#"+b,"/"==h[0])f=p+f+h;else if("#"==h[0])f=p+f+(k.path()||"/")+h;else{for(var l=k.path().split("/"),h=h.split("/"),n=0;h.length>n;n++)"."!=h[n]&&(".."==h[n]?l.pop():h[n].length&&l.push(h[n]));f=p+f+l.join("/")}}l=k.$$rewrite(f),f&&!e.attr("target")&&l&&!a.isDefaultPrevented()&&(a.preventDefault(),l!=d.url()&&(k.$$parse(l),c.$apply(),T.angular["ff-684208-preventDefault"]=!0))}}),k.absUrl()!=l&&d.url(k.absUrl(),!0),d.onUrlChange(function(a){k.absUrl()!=a&&(c.$evalAsync(function(){var b=k.absUrl();k.$$parse(a),c.$broadcast("$locationChangeStart",a,b).defaultPrevented?(k.$$parse(b),d.url(b)):f(b)}),c.$$phase||c.$digest())});var n=0;return c.$watch(function(){var a=d.url(),b=k.$$replace;return n&&a==k.absUrl()||(n++,c.$evalAsync(function(){c.$broadcast("$locationChangeStart",k.absUrl(),a).defaultPrevented?k.$$parse(a):(d.url(k.absUrl(),b),f(a))})),k.$$replace=!1,n}),k}]}function Xd(){var b=!0,a=this;this.debugEnabled=function(a){return B(a)?(b=a,this):b},this.$get=["$window",function(c){function d(a){return a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line)),a}function e(a){var b=c.console||{},e=b[a]||b.log||A;a=!1;try{a=!!e.apply}catch(m){}return a?function(){var a=[];return q(arguments,function(b){a.push(d(b))}),e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function da(b,a){if("__defineGetter__"===b||"__defineSetter__"===b||"__lookupGetter__"===b||"__lookupSetter__"===b||"__proto__"===b)throw ja("isecfld",a);return b}function Ma(b,a){if(b){if(b.constructor===b)throw ja("isecfn",a);if(b.document&&b.location&&b.alert&&b.setInterval)throw ja("isecwindow",a);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw ja("isecdom",a);if(b===Object)throw ja("isecobj",a)}return b}function qb(b,a,c,d,e){e=e||{},a=a.split(".");for(var g,f=0;a.length>1;f++){g=da(a.shift(),d);var k=b[g];k||(k={},b[g]=k),b=k,b.then&&e.unwrapPromises&&(ua(d),"$$v"in b||function(a){a.then(function(b){a.$$v=b})}(b),b.$$v===s&&(b.$$v={}),b=b.$$v)}return g=da(a.shift(),d),Ma(b,d),Ma(b[g],d),b[g]=c}function Dc(b,a,c,d,e,g,f){return da(b,g),da(a,g),da(c,g),da(d,g),da(e,g),f.unwrapPromises?function(f,m){var h=m&&m.hasOwnProperty(b)?m:f,l;return null==h?h:((h=h[b])&&h.then&&(ua(g),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v),a?null==h?s:((h=h[a])&&h.then&&(ua(g),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v),c?null==h?s:((h=h[c])&&h.then&&(ua(g),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v),d?null==h?s:((h=h[d])&&h.then&&(ua(g),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v),e?null==h?s:((h=h[e])&&h.then&&(ua(g),"$$v"in h||(l=h,l.$$v=s,l.then(function(a){l.$$v=a})),h=h.$$v),h):h):h):h):h)}:function(g,f){var h=f&&f.hasOwnProperty(b)?f:g;return null==h?h:(h=h[b],a?null==h?s:(h=h[a],c?null==h?s:(h=h[c],d?null==h?s:(h=h[d],e?null==h?s:h=h[e]:h):h):h):h)}}function ze(b,a){return da(b,a),function(a,d){return null==a?s:(d&&d.hasOwnProperty(b)?d:a)[b]}}function Ae(b,a,c){return da(b,c),da(a,c),function(c,e){return null==c?s:(c=(e&&e.hasOwnProperty(b)?e:c)[b],null==c?s:c[a])}}function Ec(b,a,c){if(Rb.hasOwnProperty(b))return Rb[b];var d=b.split("."),e=d.length,g;if(a.unwrapPromises||1!==e)if(a.unwrapPromises||2!==e)if(a.csp)g=6>e?Dc(d[0],d[1],d[2],d[3],d[4],c,a):function(b,g){var f=0,k;do k=Dc(d[f++],d[f++],d[f++],d[f++],d[f++],c,a)(b,g),g=s,b=k;while(e>f);return k};else{var f="var p;\n";q(d,function(b,d){da(b,c),f+="if(s == null) return undefined;\ns="+(d?"s":'((k&&k.hasOwnProperty("'+b+'"))?k:s)')+'["'+b+'"];\n'+(a.unwrapPromises?'if (s && s.then) {\n pw("'+c.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")});var f=f+"return s;",k=Function("s","k","pw",f);k.toString=$(f),g=a.unwrapPromises?function(a,b){return k(a,b,ua)}:k}else g=Ae(d[0],d[1],c);else g=ze(d[0],c);return"hasOwnProperty"!==b&&(Rb[b]=g),g}function Yd(){var b={},a={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(b){return B(b)?(a.unwrapPromises=!!b,this):a.unwrapPromises},this.logPromiseWarnings=function(b){return B(b)?(a.logPromiseWarnings=b,this):a.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function(c,d,e){return a.csp=d.csp,ua=function(b){a.logPromiseWarnings&&!Fc.hasOwnProperty(b)&&(Fc[b]=!0,e.warn("[$parse] Promise found in the expression `"+b+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(d){var e;switch(typeof d){case"string":return b.hasOwnProperty(d)?b[d]:(e=new Sb(a),e=new bb(e,c,a).parse(d),"hasOwnProperty"!==d&&(b[d]=e),e);case"function":return d;default:return A}}}]}function $d(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return Be(function(a){b.$evalAsync(a)},a)}]}function Be(b,a){function c(a){return a}function d(a){return f(a)}var e=function(){var f=[],h,l;return l={resolve:function(a){if(f){var c=f;f=s,h=g(a),c.length&&b(function(){for(var a,b=0,d=c.length;d>b;b++)a=c[b],h.then(a[0],a[1],a[2])})}},reject:function(a){l.resolve(k(a))},notify:function(a){if(f){var c=f;f.length&&b(function(){for(var b,d=0,e=c.length;e>d;d++)b=c[d],b[2](a)})}},promise:{then:function(b,g,k){var l=e(),J=function(d){try{l.resolve((O(b)?b:c)(d))}catch(e){l.reject(e),a(e)}},w=function(b){try{l.resolve((O(g)?g:d)(b))}catch(c){l.reject(c),a(c)}},u=function(b){try{l.notify((O(k)?k:c)(b))}catch(d){a(d)}};return f?f.push([J,w,u]):h.then(J,w,u),l.promise},"catch":function(a){return this.then(null,a)},"finally":function(a){function b(a,c){var d=e();return c?d.resolve(a):d.reject(a),d.promise}function d(e,g){var f=null;try{f=(a||c)()}catch(k){return b(k,!1)}return f&&O(f.then)?f.then(function(){return b(e,g)},function(a){return b(a,!1)}):b(e,g)}return this.then(function(a){return d(a,!0)},function(a){return d(a,!1)})}}}},g=function(a){return a&&O(a.then)?a:{then:function(c){var d=e();return b(function(){d.resolve(c(a))}),d.promise}}},f=function(a){var b=e();return b.reject(a),b.promise},k=function(c){return{then:function(g,f){var k=e();return b(function(){try{k.resolve((O(f)?f:d)(c))}catch(b){k.reject(b),a(b)}}),k.promise}}};return{defer:e,reject:f,when:function(k,h,l,p){var n=e(),r,t=function(b){try{return(O(h)?h:c)(b)}catch(d){return a(d),f(d)}},J=function(b){try{return(O(l)?l:d)(b)}catch(c){return a(c),f(c)}},w=function(b){try{return(O(p)?p:c)(b)}catch(d){a(d)}};return b(function(){g(k).then(function(a){r||(r=!0,n.resolve(g(a).then(t,J,w)))},function(a){r||(r=!0,n.resolve(J(a)))},function(a){r||n.notify(w(a))})}),n.promise},all:function(a){var b=e(),c=0,d=L(a)?[]:{};return q(a,function(a,e){c++,g(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})}),0===c&&b.resolve(d),b.promise}}}function ge(){this.$get=["$window","$timeout",function(b,a){var c=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame,d=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,e=!!c,g=e?function(a){var b=c(a);return function(){d(b)}}:function(b){var c=a(b,16.66,!1);return function(){a.cancel(c)}};return g.supported=e,g}]}function Zd(){var b=10,a=v("$rootScope"),c=null;this.digestTtl=function(a){return arguments.length&&(b=a),b},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(d,e,g,f){function k(){this.$id=eb(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function m(b){if(n.$$phase)throw a("inprog",n.$$phase);n.$$phase=b}function h(a,b){var c=g(a);return Ua(c,b),c}function l(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function p(){}k.prototype={constructor:k,$new:function(a){return a?(a=new k,a.$root=this.$root,a.$$asyncQueue=this.$$asyncQueue,a.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=eb(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),a=new this.$$childScopeClass),a["this"]=a,a.$parent=this,a.$$prevSibling=this.$$childTail,this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=a:this.$$childHead=this.$$childTail=a,a},$watch:function(a,b,d){var e=h(a,"watch"),g=this.$$watchers,f={fn:b,last:p,get:e,exp:a,eq:!!d};if(c=null,!O(b)){var k=h(b||A,"listener");f.fn=function(a,b,c){k(c)}}if("string"==typeof a&&e.constant){var m=f.fn;f.fn=function(a,b,c){m.call(this,a,b,c),Qa(g,f)}}return g||(g=this.$$watchers=[]),g.unshift(f),function(){Qa(g,f),c=null}},$watchCollection:function(a,b){var c=this,d,e,f,k=b.length>1,h=0,m=g(a),l=[],n={},p=!0,q=0;return this.$watch(function(){d=m(c);var a,b;if(U(d))if(db(d))for(e!==l&&(e=l,q=e.length=0,h++),a=d.length,q!==a&&(h++,e.length=q=a),b=0;a>b;b++)e[b]!==e[b]&&d[b]!==d[b]||e[b]===d[b]||(h++,e[b]=d[b]);else{e!==n&&(e=n={},q=0,h++),a=0;for(b in d)d.hasOwnProperty(b)&&(a++,e.hasOwnProperty(b)?e[b]!==d[b]&&(h++,e[b]=d[b]):(q++,e[b]=d[b],h++));if(q>a)for(b in h++,e)e.hasOwnProperty(b)&&!d.hasOwnProperty(b)&&(q--,delete e[b])}else e!==d&&(e=d,h++);return h},function(){if(p?(p=!1,b(d,d,c)):b(d,f,c),k)if(U(d))if(db(d)){f=Array(d.length);for(var a=0;d.length>a;a++)f[a]=d[a]}else for(a in f={},d)yb.call(d,a)&&(f[a]=d[a]);else f=d})},$digest:function(){var d,g,f,k,h=this.$$asyncQueue,l=this.$$postDigestQueue,q,z,s=b,N,M=[],x,C,G;m("$digest"),c=null;do{for(z=!1,N=this;h.length;){try{G=h.shift(),G.scope.$eval(G.expression)}catch(H){n.$$phase=null,e(H)}c=null}a:do{if(k=N.$$watchers)for(q=k.length;q--;)try{if(d=k[q])if((g=d.get(N))===(f=d.last)||(d.eq?ya(g,f):"number"==typeof g&&"number"==typeof f&&isNaN(g)&&isNaN(f))){if(d===c){z=!1;break a}}else z=!0,c=d,d.last=d.eq?Ga(g,null):g,d.fn(g,f===p?g:f,N),5>s&&(x=4-s,M[x]||(M[x]=[]),C=O(d.exp)?"fn: "+(d.exp.name||""+d.exp):d.exp,C+="; newVal: "+sa(g)+"; oldVal: "+sa(f),M[x].push(C))}catch(B){n.$$phase=null,e(B)}if(!(k=N.$$childHead||N!==this&&N.$$nextSibling))for(;N!==this&&!(k=N.$$nextSibling);)N=N.$parent}while(N=k);if((z||h.length)&&!s--)throw n.$$phase=null,a("infdig",b,sa(M))}while(z||h.length);for(n.$$phase=null;l.length;)try{l.shift()()}catch(v){e(v)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==n&&(q(this.$$listenerCount,zb(null,l,this)),a.$$childHead==this&&(a.$$childHead=this.$$nextSibling),a.$$childTail==this&&(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=A,this.$on=this.$watch=function(){return A})}},$eval:function(a,b){return g(a)(this,b)},$evalAsync:function(a){n.$$phase||n.$$asyncQueue.length||f.defer(function(){n.$$asyncQueue.length&&n.$digest()}),this.$$asyncQueue.push({scope:this,expression:a})},$$postDigest:function(a){this.$$postDigestQueue.push(a)},$apply:function(a){try{return m("$apply"),this.$eval(a)}catch(b){e(b)}finally{n.$$phase=null;try{n.$digest()}catch(c){throw e(c),c}}},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]),c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){c[Pa(c,b)]=null,l(e,1,a)}},$emit:function(a,b){var c=[],d,g=this,f=!1,k={name:a,targetScope:g,stopPropagation:function(){f=!0},preventDefault:function(){k.defaultPrevented=!0},defaultPrevented:!1},h=[k].concat(za.call(arguments,1)),m,l;do{for(d=g.$$listeners[a]||c,k.currentScope=g,m=0,l=d.length;l>m;m++)if(d[m])try{d[m].apply(null,h)}catch(n){e(n)}else d.splice(m,1),m--,l--;if(f)break;g=g.$parent}while(g);return k},$broadcast:function(a,b){for(var c=this,d=this,g={name:a,targetScope:this,preventDefault:function(){g.defaultPrevented=!0},defaultPrevented:!1},f=[g].concat(za.call(arguments,1)),k,h;c=d;){for(g.currentScope=c,d=c.$$listeners[a]||[],k=0,h=d.length;h>k;k++)if(d[k])try{d[k].apply(null,f)}catch(m){e(m)}else d.splice(k,1),k--,h--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}return g}};var n=new k;return n}]}function cd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,a=/^\s*(https?|ftp|file):|data:image\//;this.aHrefSanitizationWhitelist=function(a){return B(a)?(b=a,this):b},this.imgSrcSanitizationWhitelist=function(b){return B(b)?(a=b,this):a},this.$get=function(){return function(c,d){var e=d?a:b,g;return P&&!(P>=8)||(g=ta(c).href,""===g||g.match(e))?c:"unsafe:"+g}}}function Ce(b){if("self"===b)return b;if(y(b)){if(b.indexOf("***")>-1)throw va("iwcard",b);return b=b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08").replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),RegExp("^"+b+"$")}if(fb(b))return RegExp("^"+b.source+"$");throw va("imatcher")}function Gc(b){var a=[];return B(b)&&q(b,function(b){a.push(Ce(b))}),a}function be(){this.SCE_CONTEXTS=fa;var b=["self"],a=[];this.resourceUrlWhitelist=function(a){return arguments.length&&(b=Gc(a)),b},this.resourceUrlBlacklist=function(b){return arguments.length&&(a=Gc(b)),a},this.$get=["$injector",function(c){function d(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};return a&&(b.prototype=new a),b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},b.prototype.toString=function(){return""+this.$$unwrapTrustedValue()},b}var e=function(a){throw va("unsafe")};c.has("$sanitize")&&(e=c.get("$sanitize"));var g=d(),f={};return f[fa.HTML]=d(g),f[fa.CSS]=d(g),f[fa.URL]=d(g),f[fa.JS]=d(g),f[fa.RESOURCE_URL]=d(f[fa.URL]),{trustAs:function(a,b){var c=f.hasOwnProperty(a)?f[a]:null;if(!c)throw va("icontext",a,b);if(null===b||b===s||""===b)return b;if("string"!=typeof b)throw va("itype",a);return new c(b)},getTrusted:function(c,d){if(null===d||d===s||""===d)return d;var g=f.hasOwnProperty(c)?f[c]:null;if(g&&d instanceof g)return d.$$unwrapTrustedValue();if(c===fa.RESOURCE_URL){var g=ta(""+d),l,p,n=!1;for(l=0,p=b.length;p>l;l++)if("self"===b[l]?Lb(g):b[l].exec(g.href)){n=!0;break}if(n)for(l=0,p=a.length;p>l;l++)if("self"===a[l]?Lb(g):a[l].exec(g.href)){n=!1;break}if(n)return d;throw va("insecurl",""+d)}if(c===fa.HTML)return e(d);throw va("unsafe")},valueOf:function(a){return a instanceof g?a.$$unwrapTrustedValue():a}}}]}function ae(){var b=!0;this.enabled=function(a){return arguments.length&&(b=!!a),b},this.$get=["$parse","$sniffer","$sceDelegate",function(a,c,d){if(b&&c.msie&&8>c.msieDocumentMode)throw va("iequirks");var e=la(fa);e.isEnabled=function(){return b},e.trustAs=d.trustAs,e.getTrusted=d.getTrusted,e.valueOf=d.valueOf,b||(e.trustAs=e.getTrusted=function(a,b){return b},e.valueOf=Fa),e.parseAs=function(b,c){var d=a(c);return d.literal&&d.constant?d:function(a,c){return e.getTrusted(b,d(a,c))}};var g=e.parseAs,f=e.getTrusted,k=e.trustAs;return q(fa,function(a,b){var c=I(b);e[Wa("parse_as_"+c)]=function(b){return g(a,b)},e[Wa("get_trusted_"+c)]=function(b){return f(a,b)},e[Wa("trust_as_"+c)]=function(b){return k(a,b)}}),e}]}function ce(){this.$get=["$window","$document",function(b,a){var c={},d=Z((/android (\d+)/.exec(I((b.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((b.navigator||{}).userAgent),g=a[0]||{},f=g.documentMode,k,m=/^(Moz|webkit|O|ms)(?=[A-Z])/,h=g.body&&g.body.style,l=!1,p=!1;if(h){for(var n in h)if(l=m.exec(n)){k=l[0],k=k.substr(0,1).toUpperCase()+k.substr(1);break}k||(k="WebkitOpacity"in h&&"webkit"),l=!!("transition"in h||k+"Transition"in h),p=!!("animation"in h||k+"Animation"in h),!d||l&&p||(l=y(g.body.style.webkitTransition),p=y(g.body.style.webkitAnimation))}return{history:!(!b.history||!b.history.pushState||4>d||e),hashchange:"onhashchange"in b&&(!f||f>7),hasEvent:function(a){if("input"==a&&9==P)return!1;if(D(c[a])){var b=g.createElement("div");c[a]="on"+a in b}return c[a]},csp:Zb(),vendorPrefix:k,transitions:l,animations:p,android:d,msie:P,msieDocumentMode:f}}]}function ee(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(b,a,c,d){function e(e,k,m){var h=c.defer(),l=h.promise,p=B(m)&&!m;return k=a.defer(function(){try{h.resolve(e())}catch(a){h.reject(a),d(a)}finally{delete g[l.$$timeoutId]}p||b.$apply()},k),l.$$timeoutId=k,g[k]=h,l}var g={};return e.cancel=function(b){return b&&b.$$timeoutId in g?(g[b.$$timeoutId].reject("canceled"),delete g[b.$$timeoutId],a.defer.cancel(b.$$timeoutId)):!1},e}]}function ta(b,a){var c=b;return P&&(W.setAttribute("href",c),c=W.href),W.setAttribute("href",c),{href:W.href,protocol:W.protocol?W.protocol.replace(/:$/,""):"",host:W.host,search:W.search?W.search.replace(/^\?/,""):"",hash:W.hash?W.hash.replace(/^#/,""):"",hostname:W.hostname,port:W.port,pathname:"/"===W.pathname.charAt(0)?W.pathname:"/"+W.pathname}}function Lb(b){return b=y(b)?ta(b):b,b.protocol===Hc.protocol&&b.host===Hc.host}function fe(){this.$get=$(T)}function jc(b){function a(d,e){if(U(d)){var g={};return q(d,function(b,c){g[c]=a(c,b)}),g}return b.factory(d+c,e)}var c="Filter";this.register=a,this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}],a("currency",Ic),a("date",Jc),a("filter",De),a("json",Ee),a("limitTo",Fe),a("lowercase",Ge),a("number",Kc),a("orderBy",Lc),a("uppercase",He)}function De(){return function(b,a,c){if(!L(b))return b;var d=typeof c,e=[];e.check=function(a){for(var b=0;e.length>b;b++)if(!e[b](a))return!1;return!0},"function"!==d&&(c="boolean"===d&&c?function(a,b){return Ta.equals(a,b)}:function(a,b){if(a&&b&&"object"==typeof a&&"object"==typeof b){for(var d in a)if("$"!==d.charAt(0)&&yb.call(a,d)&&c(a[d],b[d]))return!0;return!1}return b=(""+b).toLowerCase(),(""+a).toLowerCase().indexOf(b)>-1});var g=function(a,b){if("string"==typeof b&&"!"===b.charAt(0))return!g(a,b.substr(1));switch(typeof a){case"boolean":case"number":case"string":return c(a,b);case"object":switch(typeof b){case"object":return c(a,b);default:for(var d in a)if("$"!==d.charAt(0)&&g(a[d],b))return!0}return!1;case"array":for(d=0;a.length>d;d++)if(g(a[d],b))return!0;return!1;default:return!1}};switch(typeof a){case"boolean":case"number":case"string":a={$:a};case"object":for(var f in a)(function(b){a[b]!==void 0&&e.push(function(c){return g("$"==b?c:c&&c[b],a[b])})})(f);break;case"function":e.push(a);break;default:return b}for(d=[],f=0;b.length>f;f++){var k=b[f];e.check(k)&&d.push(k)}return d}}function Ic(b){var a=b.NUMBER_FORMATS;return function(b,d){return D(d)&&(d=a.CURRENCY_SYM),Mc(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,2).replace(/\u00A4/g,d)}}function Kc(b){var a=b.NUMBER_FORMATS;return function(b,d){return Mc(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function Mc(b,a,c,d,e){if(null==b||!isFinite(b)||U(b))return"";var g=0>b;b=Math.abs(b);var f=b+"",k="",m=[],h=!1;if(-1!==f.indexOf("e")){var l=f.match(/([\d\.]+)e(-?)(\d+)/);l&&"-"==l[2]&&l[3]>e+1?(f="0",b=0):(k=f,h=!0)}if(h)e>0&&b>-1&&1>b&&(k=b.toFixed(e));else{f=(f.split(Nc)[1]||"").length,D(e)&&(e=Math.min(Math.max(a.minFrac,f),a.maxFrac)),b=+(""+Math.round(+(""+b+"e"+e))+"e"+-e),b=(""+b).split(Nc),f=b[0],b=b[1]||"";var l=0,p=a.lgSize,n=a.gSize;if(f.length>=p+n)for(l=f.length-p,h=0;l>h;h++)0===(l-h)%n&&0!==h&&(k+=c),k+=f.charAt(h);for(h=l;f.length>h;h++)0===(f.length-h)%p&&0!==h&&(k+=c),k+=f.charAt(h);for(;e>b.length;)b+="0";e&&"0"!==e&&(k+=d+b.substr(0,e))}return m.push(g?a.negPre:a.posPre),m.push(k),m.push(g?a.negSuf:a.posSuf),m.join("")}function Tb(b,a,c){var d="";for(0>b&&(d="-",b=-b),b=""+b;a>b.length;)b="0"+b;return c&&(b=b.substr(b.length-a)),d+b}function Y(b,a,c,d){return c=c||0,function(e){return e=e["get"+b](),(c>0||e>-c)&&(e+=c),0===e&&-12==c&&(e=12),Tb(e,a,d)}}function rb(b,a){return function(c,d){var e=c["get"+b](),g=Ha(a?"SHORT"+b:b);return d[g][e]}}function Jc(b){function a(a){var b;if(b=a.match(c)){a=new Date(0);var g=0,f=0,k=b[8]?a.setUTCFullYear:a.setFullYear,m=b[8]?a.setUTCHours:a.setHours;b[9]&&(g=Z(b[9]+b[10]),f=Z(b[9]+b[11])),k.call(a,Z(b[1]),Z(b[2])-1,Z(b[3])),g=Z(b[4]||0)-g,f=Z(b[5]||0)-f,k=Z(b[6]||0),b=Math.round(1e3*parseFloat("0."+(b[7]||0))),m.call(a,g,f,k,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,e){var g="",f=[],k,m;if(e=e||"mediumDate",e=b.DATETIME_FORMATS[e]||e,y(c)&&(c=Ie.test(c)?Z(c):a(c)),xb(c)&&(c=new Date(c)),!Oa(c))return c;for(;e;)(m=Je.exec(e))?(f=f.concat(za.call(m,1)),e=f.pop()):(f.push(e),e=null);return q(f,function(a){k=Ke[a],g+=k?k(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),g}}function Ee(){return function(b){return sa(b,!0)}}function Fe(){return function(b,a){if(!L(b)&&!y(b))return b;if(a=1/0===Math.abs(Number(a))?Number(a):Z(a),y(b))return a?a>=0?b.slice(0,a):b.slice(a,b.length):"";var c=[],d,e;for(a>b.length?a=b.length:-b.length>a&&(a=-b.length),a>0?(d=0,e=a):(d=b.length+a,e=b.length);e>d;d++)c.push(b[d]);return c}}function Lc(b){return function(a,c,d){function e(a,b){return Sa(b)?function(b,c){return a(c,b)}:a}function g(a,b){var c=typeof a,d=typeof b;return c==d?("string"==c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:b>a?-1:1):d>c?-1:1
}if(!L(a)||!c)return a;c=L(c)?c:[c],c=Vc(c,function(a){var c=!1,d=a||Fa;if(y(a)&&(("+"==a.charAt(0)||"-"==a.charAt(0))&&(c="-"==a.charAt(0),a=a.substring(1)),d=b(a),d.constant)){var f=d();return e(function(a,b){return g(a[f],b[f])},c)}return e(function(a,b){return g(d(a),d(b))},c)});for(var f=[],k=0;a.length>k;k++)f.push(a[k]);return f.sort(e(function(a,b){for(var d=0;c.length>d;d++){var e=c[d](a,b);if(0!==e)return e}return 0},d))}}function wa(b){return O(b)&&(b={link:b}),b.restrict=b.restrict||"AC",$(b)}function Oc(b,a,c,d){function e(a,c){c=c?"-"+hb(c,"-"):"",d.removeClass(b,(a?sb:tb)+c),d.addClass(b,(a?tb:sb)+c)}var g=this,f=b.parent().controller("form")||ub,k=0,m=g.$error={},h=[];g.$name=a.name||a.ngForm,g.$dirty=!1,g.$pristine=!0,g.$valid=!0,g.$invalid=!1,f.$addControl(g),b.addClass(Na),e(!0),g.$addControl=function(a){Ba(a.$name,"input"),h.push(a),a.$name&&(g[a.$name]=a)},g.$removeControl=function(a){a.$name&&g[a.$name]===a&&delete g[a.$name],q(m,function(b,c){g.$setValidity(c,!0,a)}),Qa(h,a)},g.$setValidity=function(a,b,c){var d=m[a];if(b)d&&(Qa(d,c),d.length||(k--,k||(e(b),g.$valid=!0,g.$invalid=!1),m[a]=!1,e(!0,a),f.$setValidity(a,!0,g)));else{if(k||e(b),d){if(-1!=Pa(d,c))return}else m[a]=d=[],k++,e(!1,a),f.$setValidity(a,!1,g);d.push(c),g.$valid=!1,g.$invalid=!0}},g.$setDirty=function(){d.removeClass(b,Na),d.addClass(b,vb),g.$dirty=!0,g.$pristine=!1,f.$setDirty()},g.$setPristine=function(){d.removeClass(b,vb),d.addClass(b,Na),g.$dirty=!1,g.$pristine=!0,q(h,function(a){a.$setPristine()})}}function ra(b,a,c,d){return b.$setValidity(a,c),c?d:s}function Pc(b,a){var c,d;if(a)for(c=0;a.length>c;++c)if(d=a[c],b[d])return!0;return!1}function Le(b,a,c,d,e){U(e)&&(b.$$hasNativeValidators=!0,b.$parsers.push(function(g){return b.$error[a]||Pc(e,d)||!Pc(e,c)?g:(b.$setValidity(a,!1),void 0)}))}function wb(b,a,c,d,e,g){var f=a.prop(Me),k=a[0].placeholder,m={};if(d.$$validityState=f,!e.android){var h=!1;a.on("compositionstart",function(a){h=!0}),a.on("compositionend",function(){h=!1,l()})}var l=function(e){if(!h){var g=a.val();P&&"input"===(e||m).type&&a[0].placeholder!==k?k=a[0].placeholder:(Sa(c.ngTrim||"T")&&(g=aa(g)),e=f&&d.$$hasNativeValidators,(d.$viewValue!==g||""===g&&e)&&(b.$$phase?d.$setViewValue(g):b.$apply(function(){d.$setViewValue(g)})))}};if(e.hasEvent("input"))a.on("input",l);else{var p,n=function(){p||(p=g.defer(function(){l(),p=null}))};a.on("keydown",function(a){a=a.keyCode,91===a||a>15&&19>a||a>=37&&40>=a||n()}),e.hasEvent("paste")&&a.on("paste cut",n)}a.on("change",l),d.$render=function(){a.val(d.$isEmpty(d.$viewValue)?"":d.$viewValue)};var r=c.ngPattern;if(r&&((e=r.match(/^\/(.*)\/([gim]*)$/))?(r=RegExp(e[1],e[2]),e=function(a){return ra(d,"pattern",d.$isEmpty(a)||r.test(a),a)}):e=function(c){var e=b.$eval(r);if(!e||!e.test)throw v("ngPattern")("noregexp",r,e,ga(a));return ra(d,"pattern",d.$isEmpty(c)||e.test(c),c)},d.$formatters.push(e),d.$parsers.push(e)),c.ngMinlength){var t=Z(c.ngMinlength);e=function(a){return ra(d,"minlength",d.$isEmpty(a)||a.length>=t,a)},d.$parsers.push(e),d.$formatters.push(e)}if(c.ngMaxlength){var q=Z(c.ngMaxlength);e=function(a){return ra(d,"maxlength",d.$isEmpty(a)||q>=a.length,a)},d.$parsers.push(e),d.$formatters.push(e)}}function Ub(b,a){return b="ngClass"+b,["$animate",function(c){function d(a,b){var c=[],d=0;a:for(;a.length>d;d++){for(var e=a[d],l=0;b.length>l;l++)if(e==b[l])continue a;c.push(e)}return c}function e(a){if(!L(a)){if(y(a))return a.split(" ");if(U(a)){var b=[];return q(a,function(a,c){a&&(b=b.concat(c.split(" ")))}),b}}return a}return{restrict:"AC",link:function(g,f,k){function m(a,b){var c=f.data("$classCounts")||{},d=[];return q(a,function(a){(b>0||c[a])&&(c[a]=(c[a]||0)+b,c[a]===+(b>0)&&d.push(a))}),f.data("$classCounts",c),d.join(" ")}function h(b){if(!0===a||g.$index%2===a){var h=e(b||[]);if(l){if(!ya(b,l)){var q=e(l),r=d(h,q),h=d(q,h),h=m(h,-1),r=m(r,1);0===r.length?c.removeClass(f,h):0===h.length?c.addClass(f,r):c.setClass(f,r,h)}}else{var r=m(h,1);k.$addClass(r)}}l=la(b)}var l;g.$watch(k[b],h,!0),k.$observe("class",function(a){h(g.$eval(k[b]))}),"ngClass"!==b&&g.$watch("$index",function(c,d){var f=1&c;if(f!==(1&d)){var h=e(g.$eval(k[b]));f===a?(f=m(h,1),k.$addClass(f)):(f=m(h,-1),k.$removeClass(f))}})}}}]}var Me="validity",I=function(b){return y(b)?b.toLowerCase():b},yb=Object.prototype.hasOwnProperty,Ha=function(b){return y(b)?b.toUpperCase():b},P,x,Ca,za=[].slice,Ne=[].push,xa=Object.prototype.toString,Ra=v("ng"),Ta=T.angular||(T.angular={}),Va,La,ka=["0","0","0"];P=Z((/msie (\d+)/.exec(I(navigator.userAgent))||[])[1]),isNaN(P)&&(P=Z((/trident\/.*; rv:(\d+)/.exec(I(navigator.userAgent))||[])[1])),A.$inject=[],Fa.$inject=[];var L=function(){return O(Array.isArray)?Array.isArray:function(b){return"[object Array]"===xa.call(b)}}(),aa=function(){return String.prototype.trim?function(b){return y(b)?b.trim():b}:function(b){return y(b)?b.replace(/^\s\s*/,"").replace(/\s\s*$/,""):b}}();La=9>P?function(b){return b=b.nodeName?b:b[0],b.scopeName&&"HTML"!=b.scopeName?Ha(b.scopeName+":"+b.nodeName):b.nodeName}:function(b){return b.nodeName?b.nodeName:b[0].nodeName};var Yc=/[A-Z]/g,ad={full:"1.2.19",major:1,minor:2,dot:19,codeName:"precognitive-flashbacks"};S.expando="ng339";var Ya=S.cache={},ne=1,ob=T.document.addEventListener?function(b,a,c){b.addEventListener(a,c,!1)}:function(b,a,c){b.attachEvent("on"+a,c)},Xa=T.document.removeEventListener?function(b,a,c){b.removeEventListener(a,c,!1)}:function(b,a,c){b.detachEvent("on"+a,c)};S._data=function(b){return this.cache[b[this.expando]]||{}};var ie=/([\:\-\_]+(.))/g,je=/^moz([A-Z])/,Fb=v("jqLite"),ke=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Gb=/<|&#?\w+;/,le=/<([\w:]+)/,me=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ea={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ea.optgroup=ea.option,ea.tbody=ea.tfoot=ea.colgroup=ea.caption=ea.thead,ea.th=ea.td;var Ka=S.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;"complete"===V.readyState?setTimeout(a):(this.on("DOMContentLoaded",a),S(T).on("load",a))},toString:function(){var b=[];return q(this,function(a){b.push(""+a)}),"["+b.join(", ")+"]"},eq:function(b){return b>=0?x(this[b]):x(this[this.length+b])},length:0,push:Ne,sort:[].sort,splice:[].splice},lb={};q("multiple selected checked disabled readOnly required open".split(" "),function(b){lb[I(b)]=b});var qc={};q("input select option textarea button form details".split(" "),function(b){qc[Ha(b)]=!0}),q({data:mc,inheritedData:kb,scope:function(b){return x(b).data("$scope")||kb(b.parentNode||b,["$isolateScope","$scope"])},isolateScope:function(b){return x(b).data("$isolateScope")||x(b).data("$isolateScopeNoTemplate")},controller:nc,injector:function(b){return kb(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:Jb,css:function(b,a,c){if(a=Wa(a),!B(c)){var d;return 8>=P&&(d=b.currentStyle&&b.currentStyle[a],""===d&&(d="auto")),d=d||b.style[a],8>=P&&(d=""===d?s:d),d}b.style[a]=c},attr:function(b,a,c){var d=I(a);if(lb[d]){if(!B(c))return b[a]||(b.attributes.getNamedItem(a)||A).specified?d:s;c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d))}else if(B(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,2),null===b?s:b},prop:function(b,a,c){return B(c)?(b[a]=c,void 0):b[a]},text:function(){function b(b,d){var e=a[b.nodeType];return D(d)?e?b[e]:"":(b[e]=d,void 0)}var a=[];return 9>P?(a[1]="innerText",a[3]="nodeValue"):a[1]=a[3]="textContent",b.$dv="",b}(),val:function(b,a){if(D(a)){if("SELECT"===La(b)&&b.multiple){var c=[];return q(b.options,function(a){a.selected&&c.push(a.value||a.text)}),0===c.length?null:c}return b.value}b.value=a},html:function(b,a){if(D(a))return b.innerHTML;for(var c=0,d=b.childNodes;d.length>c;c++)Ia(d[c]);b.innerHTML=a},empty:oc},function(b,a){S.prototype[a]=function(a,d){var e,g,f=this.length;if(b!==oc&&(2==b.length&&b!==Jb&&b!==nc?a:d)===s){if(U(a)){for(e=0;f>e;e++)if(b===mc)b(this[e],a);else for(g in a)b(this[e],g,a[g]);return this}for(e=b.$dv,f=e===s?Math.min(f,1):f,g=0;f>g;g++){var k=b(this[g],a,d);e=e?e+k:k}return e}for(e=0;f>e;e++)b(this[e],a,d);return this}}),q({removeData:kc,dealoc:Ia,on:function a(c,d,e,g){if(B(g))throw Fb("onargs");var f=ma(c,"events"),k=ma(c,"handle");f||ma(c,"events",f={}),k||ma(c,"handle",k=oe(c,f)),q(d.split(" "),function(d){var g=f[d];if(!g){if("mouseenter"==d||"mouseleave"==d){var l=V.body.contains||V.body.compareDocumentPosition?function(a,c){var d=9===a.nodeType?a.documentElement:a,e=c&&c.parentNode;return a===e||!(!e||1!==e.nodeType||!(d.contains?d.contains(e):a.compareDocumentPosition&&16&a.compareDocumentPosition(e)))}:function(a,c){if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1};f[d]=[],a(c,{mouseleave:"mouseout",mouseenter:"mouseover"}[d],function(a){var c=a.relatedTarget;c&&(c===this||l(this,c))||k(a,d)})}else ob(c,d,k),f[d]=[];g=f[d]}g.push(e)})},off:lc,one:function(a,c,d){a=x(a),a.on(c,function g(){a.off(c,d),a.off(c,g)}),a.on(c,d)},replaceWith:function(a,c){var d,e=a.parentNode;Ia(a),q(new S(c),function(c){d?e.insertBefore(c,d.nextSibling):e.replaceChild(c,a),d=c})},children:function(a){var c=[];return q(a.childNodes,function(a){1===a.nodeType&&c.push(a)}),c},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,c){q(new S(c),function(c){1!==a.nodeType&&11!==a.nodeType||a.appendChild(c)})},prepend:function(a,c){if(1===a.nodeType){var d=a.firstChild;q(new S(c),function(c){a.insertBefore(c,d)})}},wrap:function(a,c){c=x(c)[0];var d=a.parentNode;d&&d.replaceChild(c,a),c.appendChild(a)},remove:function(a){Ia(a);var c=a.parentNode;c&&c.removeChild(a)},after:function(a,c){var d=a,e=a.parentNode;q(new S(c),function(a){e.insertBefore(a,d.nextSibling),d=a})},addClass:jb,removeClass:ib,toggleClass:function(a,c,d){c&&q(c.split(" "),function(c){var g=d;D(g)&&(g=!Jb(a,c)),(g?jb:ib)(a,c)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(a=a.nextSibling;null!=a&&1!==a.nodeType;)a=a.nextSibling;return a},find:function(a,c){return a.getElementsByTagName?a.getElementsByTagName(c):[]},clone:Ib,triggerHandler:function(a,c,d){c=(ma(a,"events")||{})[c],d=d||[];var e=[{preventDefault:A,stopPropagation:A}];q(c,function(c){c.apply(a,e.concat(d))})}},function(a,c){S.prototype[c]=function(c,e,g){for(var f,k=0;this.length>k;k++)D(f)?(f=a(this[k],c,e,g),B(f)&&(f=x(f))):Hb(f,a(this[k],c,e,g));return B(f)?f:this},S.prototype.bind=S.prototype.on,S.prototype.unbind=S.prototype.off}),Za.prototype={put:function(a,c){this[Ja(a,this.nextUid)]=c},get:function(a){return this[Ja(a,this.nextUid)]},remove:function(a){var c=this[a=Ja(a,this.nextUid)];return delete this[a],c}};var qe=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,re=/,/,se=/^\s*(_?)(\S+?)\1\s*$/,pe=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$a=v("$injector"),Oe=v("$animate"),Md=["$provide",function(a){this.$$selectors={},this.register=function(c,d){var e=c+"-animation";if(c&&"."!=c.charAt(0))throw Oe("notcsel",c);this.$$selectors[c.substr(1)]=e,a.factory(e,d)},this.classNameFilter=function(a){return 1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function(a,d){return{enter:function(a,c,f,k){f?f.after(a):(c&&c[0]||(c=f.parent()),c.append(a)),k&&d(k)},leave:function(a,c){a.remove(),c&&d(c)},move:function(a,c,d,k){this.enter(a,c,d,k)},addClass:function(a,c,f){c=y(c)?c:L(c)?c.join(" "):"",q(a,function(a){jb(a,c)}),f&&d(f)},removeClass:function(a,c,f){c=y(c)?c:L(c)?c.join(" "):"",q(a,function(a){ib(a,c)}),f&&d(f)},setClass:function(a,c,f,k){q(a,function(a){jb(a,c),ib(a,f)}),k&&d(k)},enabled:A}}]}],ia=v("$compile");fc.$inject=["$provide","$$sanitizeUriProvider"];var ve=/^(x[\:\-_]|data[\:\-_])/i,yc=v("$interpolate"),Pe=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,ye={http:80,https:443,ftp:21},Ob=v("$location");Qb.prototype=Pb.prototype=Bc.prototype={$$html5:!1,$$replace:!1,absUrl:pb("$$absUrl"),url:function(a,c){if(D(a))return this.$$url;var d=Pe.exec(a);return d[1]&&this.path(decodeURIComponent(d[1])),(d[2]||d[1])&&this.search(d[3]||""),this.hash(d[5]||"",c),this},protocol:pb("$$protocol"),host:pb("$$host"),port:pb("$$port"),path:Cc("$$path",function(a){return"/"==a.charAt(0)?a:"/"+a}),search:function(a,c){switch(arguments.length){case 0:return this.$$search;case 1:if(y(a))this.$$search=bc(a);else{if(!U(a))throw Ob("isrcharg");this.$$search=a}break;default:D(c)||null===c?delete this.$$search[a]:this.$$search[a]=c}return this.$$compose(),this},hash:Cc("$$hash",Fa),replace:function(){return this.$$replace=!0,this}};var ja=v("$parse"),Fc={},ua,Qe=Function.prototype.call,Re=Function.prototype.apply,Qc=Function.prototype.bind,cb={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:A,"+":function(a,c,d,e){return d=d(a,c),e=e(a,c),B(d)?B(e)?d+e:d:B(e)?e:s},"-":function(a,c,d,e){return d=d(a,c),e=e(a,c),(B(d)?d:0)-(B(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"^":function(a,c,d,e){return d(a,c)^e(a,c)},"=":A,"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"&":function(a,c,d,e){return d(a,c)&e(a,c)},"|":function(a,c,d,e){return e(a,c)(a,c,d(a,c))},"!":function(a,c,d){return!d(a,c)}},Se={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Sb=function(a){this.options=a};Sb.prototype={constructor:Sb,lex:function(a){for(this.text=a,this.index=0,this.ch=s,this.lastCh=":",this.tokens=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}a=this.ch+this.peek();var c=a+this.peek(2),d=cb[this.ch],e=cb[a],g=cb[c];g?(this.tokens.push({index:this.index,text:c,fn:g}),this.index+=3):e?(this.tokens.push({index:this.index,text:a,fn:e}),this.index+=2):d?(this.tokens.push({index:this.index,text:this.ch,fn:d}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(a){return-1!==a.indexOf(this.ch)},was:function(a){return-1!==a.indexOf(this.lastCh)},peek:function(a){return a=a||1,this.index+a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return a>="0"&&"9">=a},isWhitespace:function(a){return" "===a||"\r"===a||"	"===a||"\n"===a||""===a||" "===a},isIdent:function(a){return a>="a"&&"z">=a||a>="A"&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){throw d=d||this.index,c=B(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d,ja("lexerr",a,c,this.text)},readNumber:function(){for(var a="",c=this.index;this.index<this.text.length;){var d=I(this.text.charAt(this.index));if("."==d||this.isNumber(d))a+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))a+=d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==a.charAt(a.length-1))a+=d;else{if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}a*=1,this.tokens.push({index:c,text:a,literal:!0,constant:!0,fn:function(){return a}})},readIdent:function(){for(var a=this,c="",d=this.index,e,g,f,k;this.index<this.text.length&&(k=this.text.charAt(this.index),"."===k||this.isIdent(k)||this.isNumber(k));)"."===k&&(e=this.index),c+=k,this.index++;if(e)for(g=this.index;this.text.length>g;){if(k=this.text.charAt(g),"("===k){f=c.substr(e-d+1),c=c.substr(0,e-d),this.index=g;break}if(!this.isWhitespace(k))break;g++}if(d={index:d,text:c},cb.hasOwnProperty(c))d.fn=cb[c],d.literal=!0,d.constant=!0;else{var m=Ec(c,this.options,this.text);d.fn=E(function(a,c){return m(a,c)},{assign:function(d,e){return qb(d,c,e,a.text,a.options)}})}this.tokens.push(d),f&&(this.tokens.push({index:e,text:"."}),this.tokens.push({index:e+1,text:f}))},readString:function(a){var c=this.index;this.index++;for(var d="",e=a,g=!1;this.index<this.text.length;){var f=this.text.charAt(this.index),e=e+f;if(g)"u"===f?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=4,d+=String.fromCharCode(parseInt(f,16))):d=(g=Se[f])?d+g:d+f,g=!1;else if("\\"===f)g=!0;else{if(f===a)return this.index++,this.tokens.push({index:c,text:e,string:d,literal:!0,constant:!0,fn:function(){return d}}),void 0;d+=f}this.index++}this.throwError("Unterminated quote",c)}};var bb=function(a,c,d){this.lexer=a,this.$filter=c,this.options=d};bb.ZERO=E(function(){return 0},{constant:!0}),bb.prototype={constructor:bb,parse:function(a){return this.text=a,this.tokens=this.lexer.lex(a),a=this.statements(),0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),a.literal=!!a.literal,a.constant=!!a.constant,a},primary:function(){var a;if(this.expect("("))a=this.filterChain(),this.consume(")");else if(this.expect("["))a=this.arrayDeclaration();else if(this.expect("{"))a=this.object();else{var c=this.expect();(a=c.fn)||this.throwError("not a primary expression",c),a.literal=!!c.literal,a.constant=!!c.constant}for(var d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,c){throw ja("syntax",c.text,a,c.index+1,this.text,this.text.substring(c.index))},peekToken:function(){if(0===this.tokens.length)throw ja("ueoe",this.text);return this.tokens[0]},peek:function(a,c,d,e){if(this.tokens.length>0){var g=this.tokens[0],f=g.text;if(f===a||f===c||f===d||f===e||!(a||c||d||e))return g}return!1},expect:function(a,c,d,e){return(a=this.peek(a,c,d,e))?(this.tokens.shift(),a):!1},consume:function(a){this.expect(a)||this.throwError("is unexpected, expecting ["+a+"]",this.peek())},unaryFn:function(a,c){return E(function(d,e){return a(d,e,c)},{constant:c.constant})},ternaryFn:function(a,c,d){return E(function(e,g){return a(e,g)?c(e,g):d(e,g)},{constant:a.constant&&c.constant&&d.constant})},binaryFn:function(a,c,d){return E(function(e,g){return c(e,g,a,d)},{constant:a.constant&&d.constant})},statements:function(){for(var a=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(c,d){for(var e,g=0;a.length>g;g++){var f=a[g];f&&(e=f(c,d))}return e}},filterChain:function(){for(var a=this.expression(),c;;){if(!(c=this.expect("|")))return a;a=this.binaryFn(a,c.fn,this.filter())}},filter:function(){for(var a=this.expect(),c=this.$filter(a.text),d=[];;){if(!(a=this.expect(":"))){var e=function(a,e,k){k=[k];for(var m=0;d.length>m;m++)k.push(d[m](a,e));return c.apply(a,k)};return function(){return e}}d.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary(),c,d;return(d=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,d.index)+"] can not be assigned to",d),c=this.ternary(),function(d,g){return a.assign(d,c(d,g),g)}):a},ternary:function(){var a=this.logicalOR(),c,d;return this.expect("?")?(c=this.ternary(),(d=this.expect(":"))?this.ternaryFn(a,c,this.ternary()):(this.throwError("expected :",d),void 0)):a},logicalOR:function(){for(var a=this.logicalAND(),c;;){if(!(c=this.expect("||")))return a;a=this.binaryFn(a,c.fn,this.logicalAND())}},logicalAND:function(){var a=this.equality(),c;return(c=this.expect("&&"))&&(a=this.binaryFn(a,c.fn,this.logicalAND())),a},equality:function(){var a=this.relational(),c;return(c=this.expect("==","!=","===","!=="))&&(a=this.binaryFn(a,c.fn,this.equality())),a},relational:function(){var a=this.additive(),c;return(c=this.expect("<",">","<=",">="))&&(a=this.binaryFn(a,c.fn,this.relational())),a},additive:function(){for(var a=this.multiplicative(),c;c=this.expect("+","-");)a=this.binaryFn(a,c.fn,this.multiplicative());return a},multiplicative:function(){for(var a=this.unary(),c;c=this.expect("*","/","%");)a=this.binaryFn(a,c.fn,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(bb.ZERO,a.fn,this.unary()):(a=this.expect("!"))?this.unaryFn(a.fn,this.unary()):this.primary()},fieldAccess:function(a){var c=this,d=this.expect().text,e=Ec(d,this.options,this.text);return E(function(c,d,k){return e(k||a(c,d))},{assign:function(e,f,k){return qb(a(e,k),d,f,c.text,c.options)}})},objectIndex:function(a){var c=this,d=this.expression();return this.consume("]"),E(function(e,g){var f=a(e,g),k=d(e,g),m;return da(k,c.text),f?((f=Ma(f[k],c.text))&&f.then&&c.options.unwrapPromises&&(m=f,"$$v"in f||(m.$$v=s,m.then(function(a){m.$$v=a})),f=f.$$v),f):s},{assign:function(e,g,f){var k=d(e,f);return Ma(a(e,f),c.text)[k]=g}})},functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text)do d.push(this.expression());while(this.expect(","));this.consume(")");var e=this;return function(g,f){for(var k=[],m=c?c(g,f):g,h=0;d.length>h;h++)k.push(d[h](g,f));h=a(g,f,m)||A,Ma(m,e.text);var l=e.text;if(h){if(h.constructor===h)throw ja("isecfn",l);if(h===Qe||h===Re||Qc&&h===Qc)throw ja("isecff",l)}return k=h.apply?h.apply(m,k):h(k[0],k[1],k[2],k[3],k[4]),Ma(k,e.text)}},arrayDeclaration:function(){var a=[],c=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var d=this.expression();a.push(d),d.constant||(c=!1)}while(this.expect(","));return this.consume("]"),E(function(c,d){for(var f=[],k=0;a.length>k;k++)f.push(a[k](c,d));return f},{literal:!0,constant:c})},object:function(){var a=[],c=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var d=this.expect(),d=d.string||d.text;this.consume(":");var e=this.expression();a.push({key:d,value:e}),e.constant||(c=!1)}while(this.expect(","));return this.consume("}"),E(function(c,d){for(var e={},m=0;a.length>m;m++){var h=a[m];e[h.key]=h.value(c,d)}return e},{literal:!0,constant:c})}};var Rb={},va=v("$sce"),fa={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},W=V.createElement("a"),Hc=ta(T.location.href,!0);jc.$inject=["$provide"],Ic.$inject=["$locale"],Kc.$inject=["$locale"];var Nc=".",Ke={yyyy:Y("FullYear",4),yy:Y("FullYear",2,0,!0),y:Y("FullYear",1),MMMM:rb("Month"),MMM:rb("Month",!0),MM:Y("Month",2,1),M:Y("Month",1,1),dd:Y("Date",2),d:Y("Date",1),HH:Y("Hours",2),H:Y("Hours",1),hh:Y("Hours",2,-12),h:Y("Hours",1,-12),mm:Y("Minutes",2),m:Y("Minutes",1),ss:Y("Seconds",2),s:Y("Seconds",1),sss:Y("Milliseconds",3),EEEE:rb("Day"),EEE:rb("Day",!0),a:function(a,c){return 12>a.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){return a=-1*a.getTimezoneOffset(),a=(a>=0?"+":"")+(Tb(Math[a>0?"floor":"ceil"](a/60),2)+Tb(Math.abs(a%60),2))}},Je=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,Ie=/^\-?\d+$/;Jc.$inject=["$locale"];var Ge=$(I),He=$(Ha);Lc.$inject=["$parse"];var dd=$({restrict:"E",compile:function(a,c){return 8>=P&&(c.href||c.name||c.$set("href",""),a.append(V.createComment("IE fix"))),c.href||c.xlinkHref||c.name?void 0:function(a,c){var g="[object SVGAnimatedString]"===xa.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(a){c.attr(g)||a.preventDefault()})}}}),Db={};q(lb,function(a,c){if("multiple"!=a){var d=na("ng-"+c);Db[d]=function(){return{priority:100,link:function(a,g,f){a.$watch(f[d],function(a){f.$set(c,!!a)})}}}}}),q(["src","srcset","href"],function(a){var c=na("ng-"+a);Db[c]=function(){return{priority:99,link:function(d,e,g){var f=a,k=a;"href"===a&&"[object SVGAnimatedString]"===xa.call(e.prop("href"))&&(k="xlinkHref",g.$attr[k]="xlink:href",f=null),g.$observe(c,function(a){a&&(g.$set(k,a),P&&f&&e.prop(f,g[k]))})}}}});var ub={$addControl:A,$removeControl:A,$setValidity:A,$setDirty:A,$setPristine:A};Oc.$inject=["$element","$attrs","$scope","$animate"];var Rc=function(a){return["$timeout",function(c){return{name:"form",restrict:a?"EAC":"E",controller:Oc,compile:function(){return{pre:function(a,e,g,f){if(!g.action){var k=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};ob(e[0],"submit",k),e.on("$destroy",function(){c(function(){Xa(e[0],"submit",k)},0,!1)})}var m=e.parent().controller("form"),h=g.name||g.ngForm;h&&qb(a,h,f,h),m&&e.on("$destroy",function(){m.$removeControl(f),h&&qb(a,h,s,h),E(f,ub)})}}}}}]},ed=Rc(),rd=Rc(!0),Te=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Ue=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i,Ve=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Sc={text:wb,number:function(a,c,d,e,g,f){wb(a,c,d,e,g,f),e.$parsers.push(function(a){var c=e.$isEmpty(a);return c||Ve.test(a)?(e.$setValidity("number",!0),""===a?null:c?a:parseFloat(a)):(e.$setValidity("number",!1),s)}),Le(e,"number",We,null,e.$$validityState),e.$formatters.push(function(a){return e.$isEmpty(a)?"":""+a}),d.min&&(a=function(a){var c=parseFloat(d.min);return ra(e,"min",e.$isEmpty(a)||a>=c,a)},e.$parsers.push(a),e.$formatters.push(a)),d.max&&(a=function(a){var c=parseFloat(d.max);return ra(e,"max",e.$isEmpty(a)||c>=a,a)},e.$parsers.push(a),e.$formatters.push(a)),e.$formatters.push(function(a){return ra(e,"number",e.$isEmpty(a)||xb(a),a)})},url:function(a,c,d,e,g,f){wb(a,c,d,e,g,f),a=function(a){return ra(e,"url",e.$isEmpty(a)||Te.test(a),a)},e.$formatters.push(a),e.$parsers.push(a)},email:function(a,c,d,e,g,f){wb(a,c,d,e,g,f),a=function(a){return ra(e,"email",e.$isEmpty(a)||Ue.test(a),a)},e.$formatters.push(a),e.$parsers.push(a)},radio:function(a,c,d,e){D(d.name)&&c.attr("name",eb()),c.on("click",function(){c[0].checked&&a.$apply(function(){e.$setViewValue(d.value)})}),e.$render=function(){c[0].checked=d.value==e.$viewValue},d.$observe("value",e.$render)},checkbox:function(a,c,d,e){var g=d.ngTrueValue,f=d.ngFalseValue;y(g)||(g=!0),y(f)||(f=!1),c.on("click",function(){a.$apply(function(){e.$setViewValue(c[0].checked)})}),e.$render=function(){c[0].checked=e.$viewValue},e.$isEmpty=function(a){return a!==g},e.$formatters.push(function(a){return a===g}),e.$parsers.push(function(a){return a?g:f})},hidden:A,button:A,submit:A,reset:A,file:A},We=["badInput"],gc=["$browser","$sniffer",function(a,c){return{restrict:"E",require:"?ngModel",link:function(d,e,g,f){f&&(Sc[I(g.type)]||Sc.text)(d,e,g,f,c,a)}}}],tb="ng-valid",sb="ng-invalid",Na="ng-pristine",vb="ng-dirty",Xe=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function(a,c,d,e,g,f){function k(a,c){c=c?"-"+hb(c,"-"):"",f.removeClass(e,(a?sb:tb)+c),f.addClass(e,(a?tb:sb)+c)}this.$modelValue=this.$viewValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=d.name;var m=g(d.ngModel),h=m.assign;if(!h)throw v("ngModel")("nonassign",d.ngModel,ga(e));this.$render=A,this.$isEmpty=function(a){return D(a)||""===a||null===a||a!==a};var l=e.inheritedData("$formController")||ub,p=0,n=this.$error={};e.addClass(Na),k(!0),this.$setValidity=function(a,c){n[a]!==!c&&(c?(n[a]&&p--,p||(k(!0),this.$valid=!0,this.$invalid=!1)):(k(!1),this.$invalid=!0,this.$valid=!1,p++),n[a]=!c,k(c,a),l.$setValidity(a,c,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,f.removeClass(e,vb),f.addClass(e,Na)},this.$setViewValue=function(d){this.$viewValue=d,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,f.removeClass(e,Na),f.addClass(e,vb),l.$setDirty()),q(this.$parsers,function(a){d=a(d)}),this.$modelValue!==d&&(this.$modelValue=d,h(a,d),q(this.$viewChangeListeners,function(a){try{a()}catch(d){c(d)}}))};var r=this;a.$watch(function(){var c=m(a);if(r.$modelValue!==c){var d=r.$formatters,e=d.length;for(r.$modelValue=c;e--;)c=d[e](c);r.$viewValue!==c&&(r.$viewValue=c,r.$render())}return c})}],Gd=function(){return{require:["ngModel","^?form"],controller:Xe,link:function(a,c,d,e){var g=e[0],f=e[1]||ub;f.$addControl(g),a.$on("$destroy",function(){f.$removeControl(g)})}}},Id=$({require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),hc=function(){return{require:"?ngModel",link:function(a,c,d,e){if(e){d.required=!0;var g=function(a){return d.required&&e.$isEmpty(a)?(e.$setValidity("required",!1),void 0):(e.$setValidity("required",!0),a)};e.$formatters.push(g),e.$parsers.unshift(g),d.$observe("required",function(){g(e.$viewValue)})}}}},Hd=function(){return{require:"ngModel",link:function(a,c,d,e){var g=(a=/\/(.*)\//.exec(d.ngList))&&RegExp(a[1])||d.ngList||",";e.$parsers.push(function(a){if(!D(a)){var c=[];return a&&q(a.split(g),function(a){a&&c.push(aa(a))}),c}}),e.$formatters.push(function(a){return L(a)?a.join(", "):s}),e.$isEmpty=function(a){return!a||!a.length}}}},Ye=/^(true|false|\d+)$/,Jd=function(){return{priority:100,compile:function(a,c){return Ye.test(c.ngValue)?function(a,c,g){g.$set("value",a.$eval(g.ngValue))}:function(a,c,g){a.$watch(g.ngValue,function(a){g.$set("value",a)})}}}},jd=wa({compile:function(a){return a.addClass("ng-binding"),function(a,d,e){d.data("$binding",e.ngBind),a.$watch(e.ngBind,function(a){d.text(a==s?"":a)})}}}),ld=["$interpolate",function(a){return function(c,d,e){c=a(d.attr(e.$attr.ngBindTemplate)),d.addClass("ng-binding").data("$binding",c),e.$observe("ngBindTemplate",function(a){d.text(a)})}}],kd=["$sce","$parse",function(a,c){return function(d,e,g){e.addClass("ng-binding").data("$binding",g.ngBindHtml);var f=c(g.ngBindHtml);d.$watch(function(){return""+(f(d)||"")},function(c){e.html(a.getTrustedHtml(f(d))||"")})}}],md=Ub("",!0),od=Ub("Odd",0),nd=Ub("Even",1),pd=wa({compile:function(a,c){c.$set("ngCloak",s),a.removeClass("ng-cloak")}}),qd=[function(){return{scope:!0,controller:"@",priority:500}}],ic={};q("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var c=na("ng-"+a);ic[c]=["$parse",function(d){return{compile:function(e,g){var f=d(g[c]);return function(c,d){d.on(I(a),function(a){c.$apply(function(){f(c,{$event:a})})})}}}}]});var td=["$animate",function(a){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,g,f){var k,m,h;c.$watch(e.ngIf,function(g){Sa(g)?m||(m=c.$new(),f(m,function(c){c[c.length++]=V.createComment(" end ngIf: "+e.ngIf+" "),k={clone:c},a.enter(c,d.parent(),d)})):(h&&(h.remove(),h=null),m&&(m.$destroy(),m=null),k&&(h=Cb(k.clone),a.leave(h,function(){h=null}),k=null))})}}}],ud=["$http","$templateCache","$anchorScroll","$animate","$sce",function(a,c,d,e,g){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Ta.noop,compile:function(f,k){var m=k.ngInclude||k.src,h=k.onload||"",l=k.autoscroll;return function(f,k,q,t,J){var w=0,u,s,x,z=function(){s&&(s.remove(),s=null),u&&(u.$destroy(),u=null),x&&(e.leave(x,function(){s=null}),s=x,x=null)};f.$watch(g.parseAsResourceUrl(m),function(g){var m=function(){!B(l)||l&&!f.$eval(l)||d()},q=++w;g?(a.get(g,{cache:c}).success(function(a){if(q===w){var c=f.$new();t.template=a,a=J(c,function(a){z(),e.enter(a,null,k,m)}),u=c,x=a,u.$emit("$includeContentLoaded"),f.$eval(h)}}).error(function(){q===w&&z()}),f.$emit("$includeContentRequested")):(z(),t.template=null)
})}}}}],Kd=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,g){d.html(g.template),a(d.contents())(c)}}}],vd=wa({priority:450,compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),wd=wa({terminal:!0,priority:1e3}),xd=["$locale","$interpolate",function(a,c){var d=/{}/g;return{restrict:"EA",link:function(e,g,f){var k=f.count,m=f.$attr.when&&g.attr(f.$attr.when),h=f.offset||0,l=e.$eval(m)||{},p={},n=c.startSymbol(),r=c.endSymbol(),t=/^when(Minus)?(.+)$/;q(f,function(a,c){t.test(c)&&(l[I(c.replace("when","").replace("Minus","-"))]=g.attr(f.$attr[c]))}),q(l,function(a,e){p[e]=c(a.replace(d,n+k+"-"+h+r))}),e.$watch(function(){var c=parseFloat(e.$eval(k));return isNaN(c)?"":(c in l||(c=a.pluralCat(c-h)),p[c](e,g,!0))},function(a){g.text(a)})}}}],yd=["$parse","$animate",function(a,c){var d=v("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function(e,g,f,k,m){var h=f.ngRepeat,l=h.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),p,n,r,t,s,w,u={$id:Ja};if(!l)throw d("iexp",h);if(f=l[1],k=l[2],(l=l[3])?(p=a(l),n=function(a,c,d){return w&&(u[w]=a),u[s]=c,u.$index=d,p(e,u)}):(r=function(a,c){return Ja(c)},t=function(a){return a}),l=f.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!l)throw d("iidexp",f);s=l[3]||l[1],w=l[2];var B={};e.$watchCollection(k,function(a){var f,k,l=g[0],p,u={},C,G,H,v,y,A,D=[];if(db(a))y=a,p=n||r;else{p=n||t,y=[];for(H in a)a.hasOwnProperty(H)&&"$"!=H.charAt(0)&&y.push(H);y.sort()}for(C=y.length,k=D.length=y.length,f=0;k>f;f++)if(H=a===y?f:y[f],v=a[H],v=p(H,v,f),Ba(v,"`track by` id"),B.hasOwnProperty(v))A=B[v],delete B[v],u[v]=A,D[f]=A;else{if(u.hasOwnProperty(v))throw q(D,function(a){a&&a.scope&&(B[a.id]=a)}),d("dupes",h,v);D[f]={id:v},u[v]=!1}for(H in B)B.hasOwnProperty(H)&&(A=B[H],f=Cb(A.clone),c.leave(f),q(f,function(a){a.$$NG_REMOVED=!0}),A.scope.$destroy());for(f=0,k=y.length;k>f;f++){if(H=a===y?f:y[f],v=a[H],A=D[f],D[f-1]&&(l=D[f-1].clone[D[f-1].clone.length-1]),A.scope){G=A.scope,p=l;do p=p.nextSibling;while(p&&p.$$NG_REMOVED);A.clone[0]!=p&&c.move(Cb(A.clone),null,x(l)),l=A.clone[A.clone.length-1]}else G=e.$new();G[s]=v,w&&(G[w]=H),G.$index=f,G.$first=0===f,G.$last=f===C-1,G.$middle=!(G.$first||G.$last),G.$odd=!(G.$even=0===(1&f)),A.scope||m(G,function(a){a[a.length++]=V.createComment(" end ngRepeat: "+h+" "),c.enter(a,null,x(l)),l=a,A.scope=G,A.clone=a,u[A.id]=A})}B=u})}}}],zd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngShow,function(c){a[Sa(c)?"removeClass":"addClass"](d,"ng-hide")})}}],sd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngHide,function(c){a[Sa(c)?"addClass":"removeClass"](d,"ng-hide")})}}],Ad=wa(function(a,c,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&q(d,function(a,d){c.css(d,"")}),a&&c.css(a)},!0)}),Bd=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,g){var f=[],k=[],m=[],h=[];c.$watch(e.ngSwitch||e.on,function(d){var p,n;for(p=0,n=m.length;n>p;++p)m[p].remove();for(p=m.length=0,n=h.length;n>p;++p){var r=k[p];h[p].$destroy(),m[p]=r,a.leave(r,function(){m.splice(p,1)})}k.length=0,h.length=0,(f=g.cases["!"+d]||g.cases["?"])&&(c.$eval(e.change),q(f,function(d){var e=c.$new();h.push(e),d.transclude(e,function(c){var e=d.element;k.push(c),a.enter(c,e.parent(),e)})}))})}}}],Cd=wa({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,c,d,e,g){e.cases["!"+d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[],e.cases["!"+d.ngSwitchWhen].push({transclude:g,element:c})}}),Dd=wa({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,c,d,e,g){e.cases["?"]=e.cases["?"]||[],e.cases["?"].push({transclude:g,element:c})}}),Fd=wa({link:function(a,c,d,e,g){if(!g)throw v("ngTransclude")("orphan",ga(c));g(function(a){c.empty(),c.append(a)})}}),fd=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,d){"text/ng-template"==d.type&&a.put(d.id,c[0].text)}}}],Ze=v("ngOptions"),Ed=$({terminal:!0}),gd=["$compile","$parse",function(a,c){var d=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,e={$setViewValue:A};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var m=this,h={},l=e,p;m.databound=d.ngModel,m.init=function(a,c,d){l=a,p=d},m.addOption=function(c){Ba(c,'"option value"'),h[c]=!0,l.$viewValue==c&&(a.val(c),p.parent()&&p.remove())},m.removeOption=function(a){this.hasOption(a)&&(delete h[a],l.$viewValue==a&&this.renderUnknownOption(a))},m.renderUnknownOption=function(c){c="? "+Ja(c)+" ?",p.val(c),a.prepend(p),a.val(c),p.prop("selected",!0)},m.hasOption=function(a){return h.hasOwnProperty(a)},c.$on("$destroy",function(){m.renderUnknownOption=A})}],link:function(e,f,k,m){function h(a,c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(y.parent()&&y.remove(),c.val(a),""===a&&w.prop("selected",!0)):D(a)&&w?c.val(""):e.renderUnknownOption(a)},c.on("change",function(){a.$apply(function(){y.parent()&&y.remove(),d.$setViewValue(c.val())})})}function l(a,c,d){var e;d.$render=function(){var a=new Za(d.$viewValue);q(c.find("option"),function(c){c.selected=B(a.get(c.value))})},a.$watch(function(){ya(e,d.$viewValue)||(e=la(d.$viewValue),d.$render())}),c.on("change",function(){a.$apply(function(){var a=[];q(c.find("option"),function(c){c.selected&&a.push(c.value)}),d.$setViewValue(a)})})}function p(e,f,g){function k(){var a={"":[]},c=[""],d,h,s,t,z;t=g.$modelValue,z=x(e)||[];var D=n?Vb(z):z,G,R,C;R={},s=!1;var E,I;if(r)if(w&&L(t))for(s=new Za([]),C=0;t.length>C;C++)R[m]=t[C],s.put(w(e,R),t[C]);else s=new Za(t);for(C=0;G=D.length,G>C;C++){if(h=C,n){if(h=D[C],"$"===h.charAt(0))continue;R[n]=h}R[m]=z[h],d=p(e,R)||"",(h=a[d])||(h=a[d]=[],c.push(d)),r?d=B(s.remove(w?w(e,R):q(e,R))):(w?(d={},d[m]=t,d=w(e,d)===w(e,R)):d=t===q(e,R),s=s||d),E=l(e,R),E=B(E)?E:"",h.push({id:w?w(e,R):n?D[C]:C,label:E,selected:d})}for(r||(v||null===t?a[""].unshift({id:"",label:"",selected:!s}):s||a[""].unshift({id:"?",label:"",selected:!0})),R=0,D=c.length;D>R;R++){for(d=c[R],h=a[d],R>=y.length?(t={element:A.clone().attr("label",d),label:h.label},z=[t],y.push(z),f.append(t.element)):(z=y[R],t=z[0],t.label!=d&&t.element.attr("label",t.label=d)),E=null,C=0,G=h.length;G>C;C++)s=h[C],(d=z[C+1])?(E=d.element,d.label!==s.label&&E.text(d.label=s.label),d.id!==s.id&&E.val(d.id=s.id),d.selected!==s.selected&&E.prop("selected",d.selected=s.selected)):(""===s.id&&v?I=v:(I=u.clone()).val(s.id).prop("selected",s.selected).text(s.label),z.push({element:I,label:s.label,id:s.id,selected:s.selected}),E?E.after(I):t.element.append(I),E=I);for(C++;z.length>C;)z.pop().element.remove()}for(;y.length>R;)y.pop()[0].element.remove()}var h;if(!(h=t.match(d)))throw Ze("iexp",t,ga(f));var l=c(h[2]||h[1]),m=h[4]||h[6],n=h[5],p=c(h[3]||""),q=c(h[2]?h[1]:m),x=c(h[7]),w=h[8]?c(h[8]):null,y=[[{element:f,label:""}]];v&&(a(v)(e),v.removeClass("ng-scope"),v.remove()),f.empty(),f.on("change",function(){e.$apply(function(){var a,c=x(e)||[],d={},h,k,l,p,t,u,v;if(r){for(k=[],p=0,u=y.length;u>p;p++)for(a=y[p],l=1,t=a.length;t>l;l++)if((h=a[l].element)[0].selected){if(h=h.val(),n&&(d[n]=h),w)for(v=0;c.length>v&&(d[m]=c[v],w(e,d)!=h);v++);else d[m]=c[h];k.push(q(e,d))}}else{if(h=f.val(),"?"==h)k=s;else if(""===h)k=null;else if(w){for(v=0;c.length>v;v++)if(d[m]=c[v],w(e,d)==h){k=q(e,d);break}}else d[m]=c[h],n&&(d[n]=h),k=q(e,d);y[0].length>1&&y[0][1].id!==h&&(y[0][1].selected=!1)}g.$setViewValue(k)})}),g.$render=k,e.$watch(k)}if(m[1]){var n=m[0];m=m[1];var r=k.multiple,t=k.ngOptions,v=!1,w,u=x(V.createElement("option")),A=x(V.createElement("optgroup")),y=u.clone();k=0;for(var z=f.children(),E=z.length;E>k;k++)if(""===z[k].value){w=v=z.eq(k);break}n.init(m,v,y),r&&(m.$isEmpty=function(a){return!a||0===a.length}),t?p(e,f,m):r?l(e,f,m):h(e,f,m,n)}}}}],id=["$interpolate",function(a){var c={addOption:A,removeOption:A};return{restrict:"E",priority:100,compile:function(d,e){if(D(e.value)){var g=a(d.text(),!0);g||e.$set("value",d.text())}return function(a,d,e){var h=d.parent(),l=h.data("$selectController")||h.parent().data("$selectController");l&&l.databound?d.prop("selected",!1):l=c,g?a.$watch(g,function(a,c){e.$set("value",a),a!==c&&l.removeOption(c),l.addOption(a)}):l.addOption(e.value),d.on("$destroy",function(){l.removeOption(e.value)})}}}}],hd=$({restrict:"E",terminal:!0});T.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):((Ca=T.jQuery)&&Ca.fn.on?(x=Ca,E(Ca.fn,{scope:Ka.scope,isolateScope:Ka.isolateScope,controller:Ka.controller,injector:Ka.injector,inheritedData:Ka.inheritedData}),Eb("remove",!0,!0,!1),Eb("empty",!1,!1,!1),Eb("html",!1,!1,!0)):x=S,Ta.element=x,$c(Ta),x(V).ready(function(){Xc(V,cc)}))})(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>');
                !function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function s(a){var b=a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return g.call(b,a)>=0!==c})}function D(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0}),b}function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready()}function K(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n.expando+Math.random()}function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}M.set(a,b,c)}else c=void 0;return c}function Z(){return!0}function $(){return!1}function _(){try{return l.activeElement}catch(a){}}function jb(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function kb(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function lb(a){var b=gb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function mb(a,b){for(var c=0,d=a.length;d>c;c++)L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"))}function nb(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)n.event.add(b,e,j[e][c])}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i))}}function ob(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function pb(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}function sb(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f}function tb(a){var b=l,c=rb[a];return c||(c=sb(a,b),"none"!==c&&c||(qb=(qb||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qb[0].contentDocument,b.write(),b.close(),c=sb(a,b),qb.detach()),rb[a]=c),c}function xb(a,b,c){var d,e,f,g,h=a.style;return c=c||wb(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),vb.test(g)&&ub.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function yb(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function Fb(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Eb.length;e--;)if(b=Eb[e]+c,b in a)return b;return d}function Gb(a,b,c){var d=Ab.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Hb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));return g}function Ib(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wb(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xb(a,b,f),(0>e||null==e)&&(e=a.style[b]),vb.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Hb(a,b,c||(g?"border":"content"),d,f)+"px"}function Jb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",tb(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Kb(a,b,c,d,e){return new Kb.prototype.init(a,b,c,d,e)}function Sb(){return setTimeout(function(){Lb=void 0}),Lb=n.now()}function Tb(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=R[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ub(a,b,c){for(var d,e=(Rb[b]||[]).concat(Rb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function Vb(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||tb(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Nb.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?tb(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Ub(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function Wb(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Xb(a,b,c){var d,e,f=0,g=Qb.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Lb||Sb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Lb||Sb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(Wb(k,j.opts.specialEasing);g>f;f++)if(d=Qb[f].call(j,a,k,j.opts))return d;return n.map(k,Ub,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function rc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function sc(a,b,c,d){function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}var e={},f=a===oc;return g(b.dataTypes[0])||!e["*"]&&g("*")}function tc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function uc(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function vc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function Bc(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||xc.test(a)?d(a,e):Bc(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Bc(a+"["+e+"]",b[e],c,d)}function Kc(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.1",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!n.isArray(a)&&a-parseFloat(a)>=0},isPlainObject:function(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g)for(;f>e&&(d=b.apply(a[e],c),d!==!1);e++);else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g)for(;f>e&&(d=b.call(a[e],e,a[e]),d!==!1);e++);else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:g.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function(){return a.apply(b||this,e.concat(d.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});var t=function(a){function fb(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],!a||"string"!=typeof a)return d;if(1!==(k=b.nodeType)&&9!==k)return[];if(p&&!e){if(f=_.exec(a))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return I.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return I.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=9===k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){for(o=g(a),(r=b.getAttribute("id"))?s=r.replace(bb,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;l--;)o[l]=s+qb(o[l]);w=ab.test(a)&&ob(b.parentNode)||b,x=o.join(",")}if(x)try{return I.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function gb(){function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}var a=[];return b}function hb(a){return a[u]=!0,a}function ib(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function jb(a,b){for(var c=a.split("|"),e=a.length;e--;)d.attrHandle[c[e]]=b}function kb(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||D)-(~a.sourceIndex||D);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function lb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function mb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function nb(a){return hb(function(b){return b=+b,hb(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function ob(a){return a&&typeof a.getElementsByTagName!==C&&a}function pb(){}function qb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function rb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function sb(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function tb(a,b,c){for(var d=0,e=b.length;e>d;d++)fb(a,b[d],c);return c}function ub(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function vb(a,b,c,d,e,f){return d&&!d[u]&&(d=vb(d)),e&&!e[u]&&(e=vb(e,f)),hb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||tb(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:ub(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d)for(j=ub(r,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l));if(f){if(e||a){if(e){for(j=[],k=r.length;k--;)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}for(k=r.length;k--;)(l=r[k])&&(j=e?K.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=ub(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):I.apply(g,r)})}function wb(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=rb(function(a){return a===b},h,!0),l=rb(function(a){return K.call(b,a)>-1},h,!0),m=[function(a,c,d){return!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>i;i++)if(c=d.relative[a[i].type])m=[rb(sb(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e&&!d.relative[a[e].type];e++);return vb(i>1&&sb(m),i>1&&qb(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&wb(a.slice(i,e)),f>e&&wb(a=a.slice(e)),f>e&&qb(a))}m.push(c)}return sb(m)}function xb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){for(m=0;o=a[m++];)if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){for(m=0;o=b[m++];)o(r,s,g,h);if(f){if(p>0)for(;q--;)r[q]||s[q]||(s[q]=G.call(i));s=ub(s)}I.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&fb.uniqueSort(i)}return k&&(w=v,j=t),r};return c?hb(f):f}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+-new Date,v=a.document,w=0,x=0,y=gb(),z=gb(),A=gb(),B=function(a,b){return a===b&&(l=!0),0},C="undefined",D=1<<31,E={}.hasOwnProperty,F=[],G=F.pop,H=F.push,I=F.push,J=F.slice,K=F.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",N="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=N.replace("w","w#"),P="\\["+M+"*("+N+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+M+"*\\]",Q=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+P+")*)|.*)\\)|)",R=RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),S=RegExp("^"+M+"*,"+M+"*"),T=RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),V=RegExp(Q),W=RegExp("^"+O+"$"),X={ID:RegExp("^#("+N+")"),CLASS:RegExp("^\\.("+N+")"),TAG:RegExp("^("+N.replace("w","w*")+")"),ATTR:RegExp("^"+P),PSEUDO:RegExp("^"+Q),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:RegExp("^(?:"+L+")$","i"),needsContext:RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ab=/[+~]/,bb=/'|\\/g,cb=RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),db=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(55296|d>>10,56320|1023&d)};try{I.apply(F=J.call(v.childNodes),v.childNodes),F[v.childNodes.length].nodeType}catch(eb){I={apply:F.length?function(a,b){H.apply(a,J.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}c=fb.support={},f=fb.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=fb.setDocument=function(a){var b,e=a?a.ownerDocument||a:v,g=e.defaultView;return e!==n&&9===e.nodeType&&e.documentElement?(n=e,o=e.documentElement,p=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener("unload",function(){m()},!1):g.attachEvent&&g.attachEvent("onunload",function(){m()})),c.attributes=ib(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ib(function(a){return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(e.getElementsByClassName)&&ib(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),c.getById=ib(function(a){return o.appendChild(a).id=u,!e.getElementsByName||!e.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==C&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){var c=typeof a.getAttributeNode!==C&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==C?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==C&&p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(e.querySelectorAll))&&(ib(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>",a.querySelectorAll("[msallowclip^='']").length&&q.push("[*^$]="+M+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+M+"*(?:value|"+L+")"),a.querySelectorAll(":checked").length||q.push(":checked")}),ib(function(a){var b=e.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+M+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ib(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",Q)}),q=q.length&&RegExp(q.join("|")),r=r.length&&RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===v&&t(v,a)?-1:b===e||b.ownerDocument===v&&t(v,b)?1:k?K.call(k,a)-K.call(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],i=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:k?K.call(k,a)-K.call(k,b):0;if(f===g)return kb(a,b);for(c=a;c=c.parentNode;)h.unshift(c);for(c=b;c=c.parentNode;)i.unshift(c);for(;h[d]===i[d];)d++;return d?kb(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},e):n},fb.matches=function(a,b){return fb(a,null,null,b)},fb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return fb(b,n,null,[a]).length>0},fb.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},fb.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&E.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},fb.error=function(a){throw Error("Syntax error, unrecognized expression: "+a)},fb.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){for(;b=a[f++];)b===a[f]&&(e=d.push(f));for(;e--;)a.splice(d[e],1)}return k=null,a},e=fb.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else for(;b=a[d++];)c+=e(b);return c},d=fb.selectors={cacheLength:50,createPseudo:hb,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(cb,db),a[3]=(a[3]||a[4]||a[5]||"").replace(cb,db),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||fb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&fb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(cb,db).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=RegExp("(^|"+M+")"+a+"("+M+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==C&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=fb.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[u]||(l[u]={}))[a]=[w,m]),l!==b)););return m-=e,m===d||0===m%d&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||fb.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?hb(function(a,c){for(var d,f=e(a,b),g=f.length;g--;)d=K.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:hb(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?hb(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:hb(function(a){return function(b){return fb(a,b).length>0}}),contains:hb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:hb(function(a){return W.test(a||"")||fb.error("unsupported lang: "+a),a=a.replace(cb,db).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:nb(function(){return[0]}),last:nb(function(a,b){return[b-1]}),eq:nb(function(a,b,c){return[0>c?c+b:c]}),even:nb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:nb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:nb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:nb(function(a,b,c){for(var d=0>c?c+b:c;b>++d;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=lb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=mb(b);return pb.prototype=d.filters=d.pseudos,d.setFilters=new pb,g=fb.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=d.preFilter;h;){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?fb.error(a):z(a,i).slice(0)},h=fb.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){for(b||(b=g(a)),c=b.length;c--;)f=wb(b[c]),f[u]?d.push(f):e.push(f);f=A(a,xb(e,d)),f.selector=a}return f},i=fb.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(cb,db),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}for(i=X.needsContext.test(a)?0:j.length;i--&&(k=j[i],!d.relative[l=k.type]);)if((m=d.find[l])&&(f=m(k.matches[0].replace(cb,db),ab.test(j[0].type)&&ob(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&qb(j),!a)return I.apply(e,f),e;break}}return(n||h(a,o))(f,b,!p,e,ab.test(a)&&ob(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ib(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ib(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||jb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ib(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||jb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ib(function(a){return null==a.getAttribute("disabled")})||jb(L,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),fb}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++)if(n.contains(e[b],this))return!0}));for(b=0;c>b;b++)n.find(a,e[b],d);
return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?y.ready!==void 0?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e)}});var E=/\S+/g,F={};n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++)if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable())},k={add:function(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c)})}(arguments),d?f=h.length:b&&(e=c,j(b))}return this},remove:function(){return h&&n.each(arguments,function(a,b){for(var c;(c=n.inArray(b,h,c))>-1;)h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],f=0,this},disable:function(){return h=i=b=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,b||k.disable(),this},locked:function(){return!i},fireWith:function(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!c}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=Array(e),j=Array(e),k=Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))))}}),n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b)},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},K.uid=1,K.accepts=n.acceptData,K.prototype={key:function(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,n.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var L=new K,M=new K,N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;n.extend({hasData:function(a){return M.hasData(a)||L.hasData(a)},data:function(a,b,c){return M.access(a,b,c)},removeData:function(a,b){M.remove(a,b)},_data:function(a,b,c){return L.access(a,b,c)},_removeData:function(a,b){L.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));L.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){M.set(this,a)}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){M.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),c>arguments.length?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return typeof n!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(E)||[""],j=b.length;j--;)h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){for(b=(b||"").match(E)||[""],j=b.length;j--;)if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){for(l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=0>q.indexOf(":")&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode)p.push(g),h=g;h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=p[f++])&&!b.isPropagationStopped();)b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){for(h=n.event.handlers.call(this,a,j),b=0;(f=h[b++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,c=0;(g=f.handlers[c++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return b.length>h&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==_()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===_()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function(a){return n().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});var ab=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bb=/<([\w:]+)/,cb=/<|&#?\w+;/,db=/<(?:script|style|link)/i,eb=/checked\s*(?:[^=]|=\s*.checked.)/i,fb=/^$|\/(?:java|ecma)script/i,gb=/^true\/(.*)/,hb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ib={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ib.optgroup=ib.option,ib.tbody=ib.tfoot=ib.colgroup=ib.caption=ib.thead,ib.th=ib.td,n.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=ob(h),f=ob(a),d=0,e=f.length;e>d;d++)pb(f[d],g[d]);if(b)if(c)for(f=f||ob(a),g=g||ob(h),d=0,e=f.length;e>d;d++)nb(f[d],g[d]);else nb(a,h);return g=ob(h,"script"),g.length>0&&mb(g,!i&&ob(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++)if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(cb.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(bb.exec(e)||["",""])[1].toLowerCase(),h=ib[g]||ib._default,f.innerHTML=h[1]+e.replace(ab,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;n.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=ob(k.appendChild(e),"script"),i&&mb(f),c))for(j=0;e=f[j++];)fb.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events)f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);L.cache[e]&&delete L.cache[e]}delete M.cache[c[M.expando]]}}}),n.fn.extend({text:function(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(ob(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&mb(ob(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(ob(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!db.test(a)&&!ib[(bb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(ab,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(ob(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(ob(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&eb.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(ob(c,"script"),kb),g=f.length;l>j;j++)h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,ob(h,"script"))),b.call(this[j],h,j);if(g)for(i=f[f.length-1].ownerDocument,n.map(f,lb),j=0;g>j;j++)h=f[j],fb.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(hb,"")))}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++)c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());return this.pushStack(d)}});var qb,rb={},ub=/^margin/,vb=RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};!function(){function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e)}var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");f.style&&(f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f),a.getComputedStyle&&n.extend(k,{pixelPosition:function(){return g(),b},boxSizingReliable:function(){return null==c&&g(),c},reliableMarginRight:function(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),b}}))}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var zb=/^(none|table(?!-c[ea]).+)/,Ab=RegExp("^("+Q+")(.*)$","i"),Bb=RegExp("^([+-])=("+Q+")","i"),Cb={position:"absolute",visibility:"hidden",display:"block"},Db={letterSpacing:"0",fontWeight:"400"},Eb=["Webkit","O","Moz","ms"];n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=xb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Bb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xb(a,b,d)),"normal"===e&&b in Db&&(e=Db[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?zb.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Cb,function(){return Ib(a,b,d)}):Ib(a,b,d):void 0},set:function(a,c,d){var e=d&&wb(a);return Gb(a,c,d?Hb(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),n.cssHooks.marginRight=yb(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xb,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+R[d]+b]=f[d]||f[d-2]||f[0];return e}},ub.test(a)||(n.cssHooks[a+b].set=Gb)}),n.fn.extend({css:function(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Jb(this,!0)},hide:function(){return Jb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide()})}}),n.Tween=Kb,Kb.prototype={constructor:Kb,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Kb.propHooks[this.prop];return a&&a.get?a.get(this):Kb.propHooks._default.get(this)},run:function(a){var b,c=Kb.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Kb.propHooks._default.set(this),this}},Kb.prototype.init.prototype=Kb.prototype,Kb.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Kb.propHooks.scrollTop=Kb.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=Kb.prototype.init,n.fx.step={};var Lb,Mb,Nb=/^(?:toggle|show|hide)$/,Ob=RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pb=/queueHooks$/,Qb=[Vb],Rb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Ob.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Ob.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};n.Animation=n.extend(Xb,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Rb[c]=Rb[c]||[],Rb[c].unshift(b)},prefilter:function(a,b){b?Qb.unshift(a):Qb.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=Xb(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Pb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Tb(b,!0),a,d,e)
}}),n.each({slideDown:Tb("show"),slideUp:Tb("hide"),slideToggle:Tb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(Lb=n.now();c.length>b;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),Lb=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Mb||(Mb=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(Mb),Mb=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value}();var Yb,Zb,$b=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return J(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;return a&&3!==f&&8!==f&&2!==f?typeof a.getAttribute===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Zb:Yb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b)):void 0},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)for(;c=f[e++];)d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),Zb={set:function(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$b[b]||n.find.attr;$b[b]=function(a,b,d){var e,f;return d||(f=$b[b],$b[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$b[b]=f),e}});var _b=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function(a,b){return J(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;return a&&3!==g&&8!==g&&2!==g?(f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]):void 0},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||_b.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),k.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var ac=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=n(this),f=a.match(E)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ac," ").indexOf(b)>=0)return!0;return!1}});var bc=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bc,""):null==c?"":c)):void 0}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=n.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var cc=n.now(),dc=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b};var ec,fc,gc=/#.*$/,hc=/([?&])_=[^&]*/,ic=/^(.*?):[ \t]*([^\r\n]*)$/gm,jc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,kc=/^(?:GET|HEAD)$/,lc=/^\/\//,mc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,nc={},oc={},pc="*/".concat("*");try{fc=location.href}catch(qc){fc=l.createElement("a"),fc.href="",fc=fc.href}ec=mc.exec(fc.toLowerCase())||[],n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:fc,type:"GET",isLocal:jc.test(ec[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":pc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?tc(tc(a,n.ajaxSettings),b):tc(n.ajaxSettings,a)},ajaxPrefilter:rc(nc),ajaxTransport:rc(oc),ajax:function(a,b){function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=uc(k,v,f)),u=vc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!f)for(f={};b=ic.exec(e);)f[b[1].toLowerCase()]=b[2];b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?e:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return c&&c.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||fc)+"").replace(gc,"").replace(lc,ec[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=mc.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===ec[1]&&h[2]===ec[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(ec[3]||("http:"===ec[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),sc(nc,k,b,v),2===t)return v;i=k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!kc.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(dc.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=hc.test(d)?d.replace(hc,"$1_="+cc++):d+(dc.test(d)?"&":"?")+"_="+cc++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+pc+"; q=0.01":""):k.accepts["*"]);for(j in k.headers)v.setRequestHeader(j,k.headers[j]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1})v[j](k[j]);if(c=sc(oc,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,c.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var wc=/%20/g,xc=/\[\]$/,yc=/\r?\n/g,zc=/^(?:submit|button|image|reset|file)$/i,Ac=/^(?:input|select|textarea|keygen)/i;n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Bc(c,a[c],b,e);return d.join("&").replace(wc,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Ac.test(this.nodeName)&&!zc.test(a)&&(this.checked||!T.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(yc,"\r\n")}}):{name:b.name,value:c.replace(yc,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Cc=0,Dc={},Ec={0:200,1223:204},Fc=n.ajaxSettings.xhr();a.ActiveXObject&&n(a).on("unload",function(){for(var a in Dc)Dc[a]()}),k.cors=!!Fc&&"withCredentials"in Fc,k.ajax=Fc=!!Fc,n.ajaxTransport(function(a){var b;return k.cors||Fc&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Cc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Dc[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Ec[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Dc[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),l.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Gc=[],Hc=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Gc.pop()||n.expando+"_"+cc++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Hc.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Hc.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Hc,"$1"+e):b.jsonp!==!1&&(b.url+=(dc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Gc.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var Ic=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Ic)return Ic.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var Jc=a.document.documentElement;n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;return f?(b=f.documentElement,n.contains(b,d)?(typeof d.getBoundingClientRect!==U&&(e=d.getBoundingClientRect()),c=Kc(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e):void 0},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Jc;a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position");)a=a.offsetParent;return a||Jc})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Kc(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=yb(k.pixelPosition,function(a,c){return c?(c=xb(a,b),vb.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Lc=a.jQuery,Mc=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Mc),b&&a.jQuery===n&&(a.jQuery=Lc),n},typeof b===U&&(a.jQuery=a.$=n),n});
                function WSAPIAggregator(){this.getWorkItem=function(oid,model,callback){console.log("fetch work item ",oid,model),Ext.create("Rally.data.WsapiDataStore",{model:model,fetch:!0,context:{workspace:Rally.util.Ref.getRelativeUri(),project:null},filters:[{property:"ObjectID",value:oid}]}).load({scope:this,callback:function(records){console.log("record loaded"),callback&&_.isFunction(callback)&&(records&&1==records.length?callback(records[0]):callback(null))}})}}
                $(document).ready(function(){$(".unselected").click(function(){$(this).parent().find(".selected").removeClass("selected").addClass("unselected"),$(this).removeClass("unselected").addClass("selected"),console.log($(this).text()),"History"===$(this).text()?($("#historyLog").show(),$("#realtimeLog").hide()):($("#realtimeLog").show(),$("#historyLog").hide()),$(".unselected").click(function(){$(this).parent().find(".selected").removeClass("selected").addClass("unselected"),$(this).removeClass("unselected").addClass("selected"),"History"===$(this).text()?($("#historyLog").show(),$("#realtimeLog").hide()):($("#realtimeLog").show(),$("#historyLog").hide())})})});
                window.me=window.me||{},function(){function domReady(){if(!isReady){if(!document.body)return setTimeout(domReady,13);document.removeEventListener?document.removeEventListener("DOMContentLoaded",domReady,!1):window.removeEventListener("load",domReady,!1),isReady=!0;for(var fn=0;readyList.length>fn;fn++)readyList[fn].call(window,[]);readyList.length=0}}function bindReady(){return readyBound?void 0:(readyBound=!0,"complete"===document.readyState?domReady():(document.addEventListener&&document.addEventListener("DOMContentLoaded",domReady,!1),window.addEventListener("load",domReady,!1),void 0))}function _init_ME(){me_initialized||(me.device._check(),me.save._init(),me.loader.setNocache(document.location.href.match(/\?nocache/)||!1),me.timer.init(),me.mapReader=new me.TMXMapReader,me.state.init(),me.pool.init(),me.device.isMobile===!1&&me.input._enableKeyboardEvent(),me.levelDirector.reset(),me_initialized=!0)}me.mod="melonJS",me.version="1.0.1","function"==typeof define&&define.amd&&define("me",[],function(){return me}),me.sys={fps:60,interpolation:!1,scale:null,scalingInterpolation:!1,gravity:void 0,stopOnAudioError:!0,pauseOnBlur:!0,resumeOnFocus:!0,stopOnBlur:!1,preRender:!1,checkVersion:function(first,second){second=second||me.version;for(var a=first.split("."),b=second.split("."),len=Math.min(a.length,b.length),result=0,i=0;len>i&&!(result=+a[i]-+b[i]);i++);return result?result:a.length-b.length}};var me_initialized=!1,readyBound=!1,isReady=!1,readyList=[];window.onReady=function(fn){return bindReady(),isReady?fn.call(window,[]):readyList.push(function(){return fn.call(window,[])}),this},me.skipAutoInit!==!0?window.onReady(function(){_init_ME()}):me.init=function(){_init_ME(),domReady()};var initializing=!1,fnTest=/var xyz/.test(function(){var xyz})?/\bparent\b/:/[\D|\d]*/;Object.defineProperty||(Object.defineProperty=function(obj,prop,desc){if(!obj.__defineGetter__)throw"melonJS: Object.defineProperty not supported";desc.get&&obj.__defineGetter__(prop,desc.get),desc.set&&obj.__defineSetter__(prop,desc.set)});var deepcopy=function(obj){if(null==obj||"object"!=typeof obj)return obj;var copy;if(obj instanceof Array){copy=[],Object.setPrototypeOf(copy,Object.getPrototypeOf(obj));for(var i=0,l=obj.length;l>i;i++)copy[i]=deepcopy(obj[i]);return copy}if(obj instanceof Date)return copy=new Date,copy.setTime(obj.getTime()),copy;copy={},Object.setPrototypeOf(copy,Object.getPrototypeOf(obj));for(var prop in obj)obj.hasOwnProperty(prop)&&(copy[prop]=deepcopy(obj[prop]));return copy};if(Object.extend=function(prop){function addSuper(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);return this.parent=tmp,ret}}function Class(){if(!initializing){for(var prop in this)"object"==typeof this[prop]&&(this[prop]=deepcopy(this[prop]));this.init&&this.init.apply(this,arguments)}return this}var parent=this.prototype;initializing=!0;var proto=new this;initializing=!1;for(var name in prop)prop.hasOwnProperty(name)&&(proto[name]="function"==typeof prop[name]&&"function"==typeof parent[name]&&fnTest.test(prop[name])?addSuper(name,prop[name]):prop[name]);return Class.prototype=proto,Class.constructor=Class,Class.extend=Object.extend,Class},"function"!=typeof Object.create&&(Object.create=function(o){var Fn=function(){};return Fn.prototype=o,new Fn}),!Function.prototype.bind){var Empty=function(){};Function.prototype.bind=function bind(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=Array.prototype.slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(Array.prototype.slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(Array.prototype.slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound}}if(window.throttle||(window.throttle=function(delay,no_trailing,callback){var last=window.performance.now(),deferTimer;return"boolean"!=typeof no_trailing&&(no_trailing=!1),function(){var now=window.performance.now(),elasped=now-last,args=arguments;return delay>elasped?(no_trailing===!1&&(clearTimeout(deferTimer),deferTimer=setTimeout(function(){return last=now,callback.apply(null,args)},elasped)),void 0):(last=now,callback.apply(null,args))}}),Date.now===void 0&&(Date.now=function(){return(new Date).getTime()}),window.performance===void 0&&(window.performance={}),!window.performance.now){var timeOffset=Date.now();window.performance.timing&&window.performance.timing.navigationStart&&(timeOffset=window.performance.timing.navigationStart),window.performance.now=function(){return Date.now()-timeOffset}}"undefined"==typeof console&&(console={log:function(){},info:function(){},error:function(){alert(Array.prototype.slice.call(arguments).join(", "))}}),Function.prototype.defer=function(){return setTimeout(this.bind.apply(this,arguments),.01)},Object.getPrototypeOf=Object.getPrototypeOf||function(obj){return obj.__proto__},Object.setPrototypeOf=Object.setPrototypeOf||function(obj,prototype){return obj.__proto__=prototype,obj},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),String.prototype.isNumeric=function(){return null!==this&&!isNaN(this)&&""!==this.trim()},String.prototype.isBoolean=function(){return null!==this&&("true"===this.trim()||"false"===this.trim())},String.prototype.contains||(String.prototype.contains=function(str,startIndex){return-1!==String.prototype.indexOf.call(this,str,startIndex)}),String.prototype.toHex=function(){for(var res="",c=0;this.length>c;)res+=this.charCodeAt(c++).toString(16);return res},Number.prototype.clamp=function(low,high){return low>this?low:this>high?high:+this},Number.prototype.random=function(min,max){return~~(Math.random()*(max-min+1))+min},Number.prototype.round=function(){var num=2>arguments.length?this:arguments[0],powres=Math.pow(10,arguments[1]||arguments[0]||0);return Math.round(num*powres)/powres},Number.prototype.toHex=function(){return"0123456789ABCDEF".charAt(this-this%16>>4)+"0123456789ABCDEF".charAt(this%16)},Number.prototype.sign=function(){return 0>this?-1:this>0?1:0},Number.prototype.degToRad=function(angle){return(angle||this)/180*Math.PI},Number.prototype.radToDeg=function(angle){return(angle||this)*(180/Math.PI)},Array.prototype.remove=function(obj){var i=Array.prototype.indexOf.call(this,obj);return-1!==i&&Array.prototype.splice.call(this,i,1),this},Array.prototype.forEach||(Array.prototype.forEach=function(callback,scope){for(var i=0,j=this.length;j--;i++)callback.call(scope||this,this[i],i,this)}),Array.isArray||(Array.isArray=function(vArg){var isArray;return isArray=vArg instanceof Array}),Object.defineProperty(me,"initialized",{get:function get(){return me_initialized}}),me.game=function(){var api={},frameBuffer=null,initialized=!1,isDirty=!0,frameCounter=0,frameRate=1;return api.viewport=null,api.collisionMap=null,api.currentLevel=null,api.world=null,api.mergeGroup=!0,api.sortOn="z",api.renderer=null,api.NO_OBJECT=0,api.ENEMY_OBJECT=1,api.COLLECTABLE_OBJECT=2,api.ACTION_OBJECT=3,api.onLevelLoaded=null,api.init=function(width,height){initialized||(width=width||me.video.getWidth(),height=height||me.video.getHeight(),api.viewport=new me.Viewport(0,0,width,height),api.world=new me.ObjectContainer(0,0,width,height),api.world.name="rootContainer",frameBuffer=me.video.getSystemContext(),me.event.publish(me.event.GAME_INIT),me.input._translatePointerEvents(),isDirty=!0,api.currentLevel={pos:{x:0,y:0}},api.defaultCollisionMap=new me.CollisionTiledLayer(0,0),initialized=!0)},api.reset=function(){api.world.destroy(),api.viewport&&api.viewport.reset(),api.currentLevel={pos:{x:0,y:0}},api.collisionMap=api.defaultCollisionMap,frameBuffer.setTransform(1,0,0,1,0,0),frameCounter=0,frameRate=Math.round(60/me.sys.fps)},api.getParentContainer=function(child){return child.ancestor},api.repaint=function(){isDirty=!0},api.update=function(time){0===++frameCounter%frameRate&&(frameCounter=0,me.timer.update(time),isDirty=api.world.update(me.timer.getDelta())||isDirty,isDirty=api.viewport.update(me.timer.getDelta())||isDirty)},api.draw=function(){if(isDirty){var translateX=api.viewport.pos.x+~~api.viewport.offset.x,translateY=api.viewport.pos.y+~~api.viewport.offset.y;api.world.transform.translate(-translateX,-translateY),api.viewport.screenX=translateX-api.currentLevel.pos.x,api.viewport.screenY=translateY-api.currentLevel.pos.y,api.world.draw(frameBuffer,api.viewport),api.world.transform.translate(translateX,translateY),api.viewport.draw(frameBuffer)}isDirty=!1,me.video.blitSurface()},api}()}(),function(){var capitalize=function(str){return str.substring(0,1).toUpperCase()+str.substring(1,str.length)};me.agent=function(){var api={},vendors=["ms","MS","moz","webkit","o"];return api.prefixed=function(name,obj){if(obj=obj||window,name in obj)return obj[name];var uc_name=capitalize(name),result;return vendors.some(function(vendor){var name=vendor+uc_name;return result=name in obj?obj[name]:void 0}),result},api.setPrefixed=function(name,value,obj){if(obj=obj||window,name in obj)return obj[name]=value,void 0;var uc_name=capitalize(name);vendors.some(function(vendor){var name=vendor+uc_name;return name in obj?(obj[name]=value,!0):!1})},api}()}(),function(){me.device=function(){function onDeviceMotion(e){e.reading?(obj.accelerationX=e.reading.accelerationX,obj.accelerationY=e.reading.accelerationY,obj.accelerationZ=e.reading.accelerationZ):(obj.accelerationX=e.accelerationIncludingGravity.x,obj.accelerationY=e.accelerationIncludingGravity.y,obj.accelerationZ=e.accelerationIncludingGravity.z)}function onDeviceRotate(e){obj.gamma=e.gamma,obj.beta=e.beta,obj.alpha=e.alpha}var obj={},accelInitialized=!1,deviceOrientationInitialized=!1,devicePixelRatio=null;return obj._check=function(){me.device._detectDevice(),me.device.pointerEnabled=me.agent.prefixed("pointerEnabled",navigator),navigator.maxTouchPoints=me.agent.prefixed("maxTouchPoints",navigator)||0,window.gesture=me.agent.prefixed("gesture"),me.device.touch="createTouch"in document||"ontouchstart"in window||navigator.isCocoonJS||navigator.maxTouchPoints>0,me.device.hasAccelerometer=window.DeviceMotionEvent!==void 0||window.Windows!==void 0&&"function"==typeof Windows.Devices.Sensors.Accelerometer,this.hasPointerLockSupport=me.agent.prefixed("pointerLockElement",document),this.hasPointerLockSupport&&(document.exitPointerLock=me.agent.prefixed("exitPointerLock",document)),window.DeviceOrientationEvent&&(me.device.hasDeviceOrientation=!0),this.hasFullscreenSupport=me.agent.prefixed("fullscreenEnabled",document)||document.mozFullScreenEnabled,document.exitFullscreen=me.agent.prefixed("cancelFullScreen",document)||me.agent.prefixed("exitFullscreen",document),navigator.vibrate=me.agent.prefixed("vibrate",navigator);try{obj.localStorage=!!window.localStorage}catch(e){obj.localStorage=!1}window.addEventListener("blur",function(){me.sys.stopOnBlur&&me.state.stop(!0),me.sys.pauseOnBlur&&me.state.pause(!0)},!1),window.addEventListener("focus",function(){me.sys.stopOnBlur&&me.state.restart(!0),me.sys.resumeOnFocus&&me.state.resume(!0)},!1);var hidden,visibilityChange;document.hidden!==void 0?(hidden="hidden",visibilityChange="visibilitychange"):document.mozHidden!==void 0?(hidden="mozHidden",visibilityChange="mozvisibilitychange"):document.msHidden!==void 0?(hidden="msHidden",visibilityChange="msvisibilitychange"):document.webkitHidden!==void 0&&(hidden="webkitHidden",visibilityChange="webkitvisibilitychange"),"string"==typeof visibilityChange&&document.addEventListener(visibilityChange,function(){document[hidden]?(me.sys.stopOnBlur&&me.state.stop(!0),me.sys.pauseOnBlur&&me.state.pause(!0)):(me.sys.stopOnBlur&&me.state.restart(!0),me.sys.resumeOnFocus&&me.state.resume(!0))},!1)},obj._detectDevice=function(){me.device.isMobile=me.device.ua.match(/Android|iPhone|iPad|iPod|BlackBerry|Windows Phone|Mobi/i)||!1,me.device.iOS=me.device.ua.match(/iPhone|iPad|iPod/i)||!1,me.device.android=me.device.ua.match(/android/i)||!1,me.device.android2=me.device.ua.match(/android 2/i)||!1,me.device.wp=me.device.ua.match(/Windows Phone/i)||!1},obj.ua=navigator.userAgent,obj.localStorage=!1,obj.hasAccelerometer=!1,obj.hasDeviceOrientation=!1,obj.hasFullscreenSupport=!1,obj.hasPointerLockSupport=!1,obj.nativeBase64="function"==typeof window.atob,obj.touch=!1,obj.isMobile=!1,obj.iOS=!1,obj.android=!1,obj.android2=!1,obj.wp=!1,obj.orientation=0,obj.accelerationX=0,obj.accelerationY=0,obj.accelerationZ=0,obj.gamma=0,obj.beta=0,obj.alpha=0,obj.requestFullscreen=function(element){this.hasFullscreenSupport&&(element=element||me.video.getWrapper(),element.requestFullscreen=me.agent.prefixed("requestFullscreen",element)||element.mozRequestFullScreen,element.requestFullscreen())},obj.exitFullscreen=function(){this.hasFullscreenSupport&&document.exitFullscreen()},obj.getPixelRatio=function(){if(null===devicePixelRatio){var _context=me.video.getScreenContext(),_devicePixelRatio=window.devicePixelRatio||1,_backingStoreRatio=me.agent.prefixed("backingStorePixelRatio",_context)||1;devicePixelRatio=_devicePixelRatio/_backingStoreRatio}return devicePixelRatio},obj.getStorage=function(type){switch(type=type||"local"){case"local":return me.save;default:}throw"melonJS : storage type "+type+" not supported"},obj.turnOnPointerLock=function(){if(this.hasPointerLockSupport){var element=me.video.getWrapper();if(me.device.ua.match(/Firefox/i)){var fullscreenchange=function(){(me.agent.prefixed("fullscreenElement",document)||document.mozFullScreenElement)===element&&(document.removeEventListener("fullscreenchange",fullscreenchange),document.removeEventListener("mozfullscreenchange",fullscreenchange),element.requestPointerLock=me.agent.prefixed("requestPointerLock",element),element.requestPointerLock())};document.addEventListener("fullscreenchange",fullscreenchange,!1),document.addEventListener("mozfullscreenchange",fullscreenchange,!1),me.device.requestFullscreen()}else element.requestPointerLock()}},obj.turnOffPointerLock=function(){this.hasPointerLockSupport&&document.exitPointerLock()},obj.watchAccelerometer=function(){if(me.device.hasAccelerometer){if(!accelInitialized){if("undefined"==typeof Windows)window.addEventListener("devicemotion",onDeviceMotion,!1);else{var accelerometer=Windows.Devices.Sensors.Accelerometer.getDefault();if(accelerometer){var minInterval=accelerometer.minimumReportInterval,Interval=minInterval>=16?minInterval:25;accelerometer.reportInterval=Interval,accelerometer.addEventListener("readingchanged",onDeviceMotion,!1)}}accelInitialized=!0}return!0}return!1},obj.unwatchAccelerometer=function(){if(accelInitialized){if("undefined"==typeof Windows)window.removeEventListener("devicemotion",onDeviceMotion,!1);else{var accelerometer=Windows.Device.Sensors.Accelerometer.getDefault();accelerometer.removeEventListener("readingchanged",onDeviceMotion,!1)}accelInitialized=!1}},obj.watchDeviceOrientation=function(){return me.device.hasDeviceOrientation&&!deviceOrientationInitialized&&(window.addEventListener("deviceorientation",onDeviceRotate,!1),deviceOrientationInitialized=!0),!1},obj.unwatchDeviceOrientation=function(){deviceOrientationInitialized&&(window.removeEventListener("deviceorientation",onDeviceRotate,!1),deviceOrientationInitialized=!1)},obj.vibrate=function(pattern){navigator.vibrate&&navigator.vibrate(pattern)},obj}(),Object.defineProperty(me.device,"isFullscreen",{get:function(){if(me.device.hasFullscreenSupport){var el=me.agent.prefixed("fullscreenElement",document)||document.mozFullScreenElement;return el===me.video.getWrapper()}return!1}}),Object.defineProperty(me.device,"sound",{get:function(){return!Howler.noAudio}})}(),function(){me.timer=function(){var api={},framecount=0,framedelta=0,last=0,now=0,delta=0,step=Math.ceil(1e3/me.sys.fps),minstep=1.25*(1e3/me.sys.fps),timers=[],timerId=0,clearTimer=function(timerId){for(var i=0,len=timers.length;len>i;i++)if(timers[i].timerId===timerId){timers.splice(i,1);break}},updateTimers=function(dt){for(var i=0,len=timers.length;len>i;i++){var _timer=timers[i];_timer.pauseable&&me.state.isPaused()||(_timer.elapsed+=dt),_timer.elapsed>=_timer.delay&&(_timer.func.apply(this),_timer.repeat===!0?_timer.elapsed-=_timer.delay:me.timer.clearTimeout(_timer.timerId))}};return api.tick=1,api.fps=0,api.init=function(){api.reset(),now=last=0},api.reset=function(){last=now=window.performance.now(),delta=0,framedelta=0,framecount=0},api.setTimeout=function(func,delay,pauseable){return timers.push({func:func,delay:delay,elapsed:0,repeat:!1,timerId:++timerId,pauseable:pauseable===!0||!0}),timerId},api.setInterval=function(func,delay,pauseable){return timers.push({func:func,delay:delay,elapsed:0,repeat:!0,timerId:++timerId,pauseable:pauseable===!0||!0}),timerId},api.clearTimeout=function(timeoutID){clearTimer.defer(this,timeoutID)},api.clearInterval=function(intervalID){clearTimer.defer(this,intervalID)},api.getTime=function(){return now},api.getDelta=function(){return delta},api.countFPS=function(){framecount++,framedelta+=delta,0===framecount%10&&(this.fps=(~~(1e3*framecount/framedelta)).clamp(0,me.sys.fps),framedelta=0,framecount=0)},api.update=function(time){return last=now,now=time,delta=now-last,api.tick=delta>minstep&&me.sys.interpolation?delta/step:1,updateTimers(delta),delta},api}()}(),function(){me.pool=function(){var api={},entityClass={};return api.init=function(){api.register("me.ObjectEntity",me.ObjectEntity),api.register("me.CollectableEntity",me.CollectableEntity),api.register("me.LevelEntity",me.LevelEntity),api.register("TileObject",me.SpriteObject),api.register("me.Tween",me.Tween,!0),api.register("me.Color",me.Color,!0),api.register("me.Particle",me.Particle,!0)},api.register=function(className,entityObj,pooling){return pooling?(entityClass[className.toLowerCase()]={"class":entityObj,pool:[]},void 0):(entityClass[className.toLowerCase()]={"class":entityObj,pool:void 0},void 0)},api.pull=function(data){var name="string"==typeof data?data.toLowerCase():void 0,args=Array.prototype.slice.call(arguments);if(name&&entityClass[name]){var proto;if(!entityClass[name].pool)return proto=entityClass[name]["class"],args[0]=proto,new(proto.bind.apply(proto,args));var obj,entity=entityClass[name];return proto=entity["class"],entity.pool.length>0?(obj=entity.pool.pop(),"function"==typeof obj.init&&obj.init.apply(obj,args.slice(1)),"function"==typeof obj.onResetEvent&&obj.onResetEvent.apply(obj,args.slice(1))):(args[0]=proto,obj=new(proto.bind.apply(proto,args)),obj.className=name),obj}return name&&console.error("Cannot instantiate entity of type '"+data+"': Class not found!"),null},api.purge=function(){for(var className in entityClass)entityClass.hasOwnProperty(className)&&(entityClass[className].pool=[])},api.push=function(obj){var name=obj.className;void 0!==name&&entityClass[name]&&entityClass[name].pool.push(obj)},api}()}(),function(){me.Vector2d=Object.extend({x:0,y:0,init:function(x,y){this.x=x||0,this.y=y||0},set:function(x,y){return this.x=x,this.y=y,this},setZero:function(){return this.set(0,0)},setV:function(v){return this.x=v.x,this.y=v.y,this},add:function(v){return this.x+=v.x,this.y+=v.y,this},sub:function(v){return this.x-=v.x,this.y-=v.y,this},scale:function(x,y){return this.x*=x,this.y*=y!==void 0?y:x,this},scaleV:function(v){return this.x*=v.x,this.y*=v.y,this},div:function(n){return this.x/=n,this.y/=n,this},abs:function(){return 0>this.x&&(this.x=-this.x),0>this.y&&(this.y=-this.y),this},clamp:function(low,high){return new me.Vector2d(this.x.clamp(low,high),this.y.clamp(low,high))},clampSelf:function(low,high){return this.x=this.x.clamp(low,high),this.y=this.y.clamp(low,high),this},minV:function(v){return this.x=this.x<v.x?this.x:v.x,this.y=this.y<v.y?this.y:v.y,this},maxV:function(v){return this.x=this.x>v.x?this.x:v.x,this.y=this.y>v.y?this.y:v.y,this},floor:function(){return new me.Vector2d(~~this.x,~~this.y)},floorSelf:function(){return this.x=~~this.x,this.y=~~this.y,this},ceil:function(){return new me.Vector2d(Math.ceil(this.x),Math.ceil(this.y))},ceilSelf:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},negate:function(){return new me.Vector2d(-this.x,-this.y)},negateSelf:function(){return this.x=-this.x,this.y=-this.y,this},copy:function(v){return this.x=v.x,this.y=v.y,this},equals:function(v){return this.x===v.x&&this.y===v.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var len=this.length();if(Number.MIN_VALUE>len)return 0;var invL=1/len;return this.x*=invL,this.y*=invL,len},dotProduct:function(v){return this.x*v.x+this.y*v.y},distance:function(v){return Math.sqrt((this.x-v.x)*(this.x-v.x)+(this.y-v.y)*(this.y-v.y))},angle:function(v){return Math.atan2(v.y-this.y,v.x-this.x)},clone:function(){return new me.Vector2d(this.x,this.y)},toString:function(){return"x:"+this.x+",y:"+this.y}})}(),function(){me.Rect=Object.extend({pos:new me.Vector2d,rangeV:new me.Vector2d,width:0,height:0,hWidth:0,hHeight:0,shapeType:"Rectangle",init:function(v,w,h){this.pos.setV(v),this.rangeV.set(0,0),this.width=w,this.height=h,this.hWidth=~~(w/2),this.hHeight=~~(h/2),Object.defineProperty(this,"left",{get:function(){var x=this.pos.x,xv=x+this.rangeV.x;return xv>x?x:xv},configurable:!0}),Object.defineProperty(this,"right",{get:function(){var x=this.pos.x+this.width,xv=x+this.rangeV.x;return x>xv?x:xv},configurable:!0}),Object.defineProperty(this,"top",{get:function(){var y=this.pos.y,yv=y+this.rangeV.y;return yv>y?y:yv},configurable:!0}),Object.defineProperty(this,"bottom",{get:function(){var y=this.pos.y+this.height,yv=y+this.rangeV.y;return y>yv?y:yv},configurable:!0})},setShape:function(v,w,h){return this.pos.setV(v),this.resize(w,h),this},resize:function(w,h){return this.width=w,this.height=h,this.hWidth=~~(w/2),this.hHeight=~~(h/2),this},getBounds:function(rect){return rect!==void 0?rect.setShape(this.pos,this.width,this.height):this.clone()},clone:function(){return new me.Rect(this.pos,this.width,this.height)},translate:function(x,y){return this.pos.x+=x,this.pos.y+=y,this},translateV:function(v){return this.translate(v.x,v.y)},addV:function(v){return this.rangeV.setV(v),this},union:function(r){var x1=Math.min(this.left,r.left),y1=Math.min(this.top,r.top);return this.resize(Math.max(this.right,r.right)-x1,Math.max(this.bottom,r.bottom)-y1),this.pos.set(x1,y1),this},flipX:function(sw){return this.pos.x=sw-this.width-this.pos.x,this},flipY:function(sh){return this.pos.y=sh-this.height-this.pos.y,this},equals:function(r){return this.left===r.left&&this.right===r.right&&this.top===r.top&&this.bottom===r.bottom},overlaps:function(r){return this.left<r.right&&r.left<this.right&&this.top<r.bottom&&r.top<this.bottom},within:function(r){return r.contains(this)},contains:function(r){return r.left>=this.left&&r.right<=this.right&&r.top>=this.top&&r.bottom<=this.bottom},containsPointV:function(v){return this.containsPoint(v.x,v.y)},containsPoint:function(x,y){return x>=this.left&&this.right>=x&&y>=this.top&&this.bottom>=y},collideWithRectangle:function(rect){var p=new me.Vector2d(0,0);if(this.overlaps(rect)){var dx=this.left+this.hWidth-rect.left-rect.hWidth,dy=this.top+this.hHeight-rect.top-rect.hHeight;p.x=rect.hWidth+this.hWidth-(0>dx?-dx:dx),p.y=rect.hHeight+this.hHeight-(0>dy?-dy:dy),p.x<p.y?(p.y=0,p.x=0>dx?-p.x:p.x):(p.x=0,p.y=0>dy?-p.y:p.y)}return p},draw:function(context,color){context.strokeStyle=color||"red",context.strokeRect(this.left,this.top,this.width,this.height)}})}(),function(){me.Ellipse=Object.extend({pos:new me.Vector2d,radius:new me.Vector2d,shapeType:"Ellipse",init:function(v,w,h){this.setShape(v,w,h)},setShape:function(v,w,h){return this.radius.set(w/2,h/2),this.pos.setV(v).add(this.radius),this},translate:function(x,y){return this.pos.x+=x,this.pos.y+=y,this},translateV:function(v){return this.pos.add(v),this},containsPointV:function(v){return this.containsPoint(v.x,v.y)},containsPoint:function(x,y){return x-=this.pos.x,y-=this.pos.y,1>=x*x/(this.radius.x*this.radius.x)+y*y/(this.radius.y*this.radius.y)},getBounds:function(rect){return rect!==void 0?rect.setShape(this.pos.clone().sub(this.radius),2*this.radius.x,2*this.radius.y):new me.Rect(this.pos.clone().sub(this.radius),2*this.radius.x,2*this.radius.y)},clone:function(){return new me.Ellipse(this.pos,2*this.radius.x,2*this.radius.y)},draw:function(context,color){context.save(),context.beginPath(),context.translate(this.pos.x-this.radius.x,this.pos.y-this.radius.y),context.scale(this.radius.x,this.radius.y),context.arc(1,1,1,0,2*Math.PI,!1),context.restore(),context.strokeStyle=color||"red",context.stroke()}})}(),function(){me.PolyShape=Object.extend({pos:new me.Vector2d,points:null,closed:!1,shapeType:"PolyShape",init:function(v,points,closed){this.setShape(v,points,closed)},setShape:function(v,points,closed){return this.pos.setV(v),this.points=points,this.closed=closed===!0,this.getBounds(),this},translate:function(x,y){return this.pos.x+=x,this.pos.y+=y,this},translateV:function(v){return this.pos.add(v),this},containsPointV:function(v){return this.containsPoint(v.x,v.y)},containsPoint:function(x,y){for(var intersects=!1,posx=this.pos.x,posy=this.pos.y,points=this.points,len=points.length,i=0,j=len-1;len>i;j=i++){var iy=points[i].y+posy,ix=points[i].x+posx,jy=points[j].y+posy,jx=points[j].x+posx;iy>y!=jy>y&&(jx-ix)*(y-iy)/(jy-iy)+ix>x&&(intersects=!intersects)}return intersects},getBounds:function(rect){var pos=this.pos.clone(),right=0,bottom=0;return this.points.forEach(function(point){pos.x=Math.min(pos.x,point.x),pos.y=Math.min(pos.y,point.y),right=Math.max(right,point.x),bottom=Math.max(bottom,point.y)}),rect!==void 0?rect.setShape(pos,right-pos.x,bottom-pos.y):new me.Rect(pos,right-pos.x,bottom-pos.y)},clone:function(){var copy=[];return this.points.forEach(function(point){copy.push(new me.Vector2d(point.x,point.y))}),new me.PolyShape(this.pos.clone(),copy,this.closed)},draw:function(context,color){context.save(),context.translate(-this.pos.x,-this.pos.y),context.strokeStyle=color||"red",context.beginPath(),context.moveTo(this.points[0].x,this.points[0].y),this.points.forEach(function(point){context.lineTo(point.x,point.y),context.moveTo(point.x,point.y)}),this.closed===!0&&context.lineTo(this.points[0].x,this.points[0].y),context.stroke(),context.restore()}})}(),function(){me.Matrix2d=Object.extend({a:1,b:0,c:0,d:1,e:0,f:0,init:function(a,b,c,d,e,f){this.set(a||1,b||0,c||0,d||1,e||0,f||0)},identity:function(){return this.set(1,0,0,1,0,0),this},set:function(a,b,c,d,e,f){return this.a=a,this.b=b,this.c=c,this.d=d,this.e=e!==void 0?e:this.e,this.f=f!==void 0?f:this.f,this},multiply:function(a,b,c,d,e,f){var a1=this.a,b1=this.b,c1=this.c,d1=this.d;return this.a=a*a1+b*c1,this.b=a*b1+b*d1,this.c=c*a1+d*c1,this.d=c*b1+d*d1,this.e=e*a1+f*c1+this.e,this.f=e*b1+f*d1+this.f,this},scale:function(sx,sy){return this.a*=sx,this.d*=sy,this.e*=sx,this.f*=sy,this},rotate:function(angle){if(0!==angle){var cos=Math.cos(angle),sin=Math.sin(angle),a=this.a,b=this.b,c=this.c,d=this.d,e=this.e,f=this.f;this.a=a*cos-b*sin,this.b=a*sin+b*cos,this.c=c*cos-d*sin,this.d=c*sin+d*cos,this.e=e*cos-f*sin,this.f=e*sin+f*cos}return this},translate:function(x,y){return this.e+=x,this.f+=y,this},translateV:function(v){return this.translate(v.x,v.y)},isIdentity:function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},clone:function(){return new me.Matrix2d(this.a,this.b,this.c,this.d,this.e,this.f)}})}(),function(){me.Renderable=me.Rect.extend({isRenderable:!0,GUID:void 0,inViewport:!1,alwaysUpdate:!1,updateWhenPaused:!1,isPersistent:!1,floating:!1,z:0,anchorPoint:new me.Vector2d,alpha:1,init:function(pos,width,height){this.parent(pos,width,height),this.anchorPoint.set(.5,.5),this.setOpacity(1)},getOpacity:function(){return this.alpha},setOpacity:function(alpha){"number"==typeof alpha&&(this.alpha=alpha.clamp(0,1),this.alpha!==this.alpha&&(this.alpha=1))},update:function(){return!1},draw:function(context,color){this.parent(context,color)}})}(),function(){me.SpriteObject=me.Renderable.extend({scale:new me.Vector2d,scaleFlag:!1,lastflipX:!1,lastflipY:!1,z:0,offset:new me.Vector2d,angle:0,_sourceAngle:0,image:null,flickering:!1,flickerDuration:0,flickercb:null,flickerState:!1,init:function(x,y,image,spritewidth,spriteheight){this.isSprite=!0,this.parent(new me.Vector2d(x,y),spritewidth||image.width,spriteheight||image.height),this.image=image,this.scale.set(1,1),this.lastflipX=this.lastflipY=!1,this.scaleFlag=!1,this.offset.set(0,0),this.isPersistent=!1,this.flickering=!1},setTransparency:function(col){col="#"===col.charAt(0)?col.substring(1,7):col,this.image=me.video.applyRGBFilter(this.image,"transparent",col.toUpperCase()).canvas},isFlickering:function(){return this.flickering},flicker:function(duration,callback){this.flickerDuration=duration,0>=this.flickerDuration?(this.flickering=!1,this.flickercb=null):this.flickering||(this.flickercb=callback,this.flickering=!0)},flipX:function(flip){flip!==this.lastflipX&&(this.lastflipX=flip,this.scale.x=-this.scale.x,this.scaleFlag=1!==this.scale.x||1!==this.scale.y)},flipY:function(flip){flip!==this.lastflipY&&(this.lastflipY=flip,this.scale.y=-this.scale.y,this.scaleFlag=1!==this.scale.x||1!==this.scale.y)},resize:function(ratioX,ratioY){var x=ratioX,y=ratioY===void 0?ratioX:ratioY;x>0&&(this.scale.x=0>this.scale.x?-x:x),y>0&&(this.scale.y=0>this.scale.y?-y:y),this.scaleFlag=1!==this.scale.x||1!==this.scale.y},resizeV:function(ratio){this.resize(ratio.x,ratio.y)},update:function(dt){return this.flickering?(this.flickerDuration-=dt,0>this.flickerDuration&&(this.flickercb&&this.flickercb(),this.flicker(-1)),!0):!1},draw:function(context){if(!this.flickering||(this.flickerState=!this.flickerState,this.flickerState)){context.save(),context.globalAlpha*=this.getOpacity();var xpos=~~this.pos.x,ypos=~~this.pos.y,w=this.width,h=this.height,angle=this.angle+this._sourceAngle;if(this.scaleFlag||0!==angle){var ax=w*this.anchorPoint.x,ay=h*this.anchorPoint.y;context.translate(xpos+ax,ypos+ay),this.scaleFlag&&context.scale(this.scale.x,this.scale.y),0!==angle&&context.rotate(angle),0!==this._sourceAngle?(w=this.height,h=this.width,xpos=-ay,ypos=-ax):(xpos=-ax,ypos=-ay)}context.drawImage(this.image,this.offset.x,this.offset.y,w,h,xpos,ypos,w,h),context.restore()}},destroy:function(){this.onDestroyEvent.apply(this,arguments)},onDestroyEvent:function(){}}),me.AnimationSheet=me.SpriteObject.extend({spacing:0,margin:0,animationpause:!1,animationspeed:100,init:function(x,y,image,spritewidth,spriteheight,spacing,margin,atlas,atlasIndices){this.anim={},this.resetAnim=null,this.current=null,this.animationspeed=100,this.spacing=spacing||0,this.margin=margin||0,this.parent(x,y,image,spritewidth,spriteheight,spacing,margin),this.textureAtlas=null,this.atlasIndices=null,this.buildLocalAtlas(atlas,atlasIndices),this.addAnimation("default",null),this.setCurrentAnimation("default")},buildLocalAtlas:function(atlas,indices){if(atlas!==void 0)this.textureAtlas=atlas,this.atlasIndices=indices;else{this.textureAtlas=[];for(var spritecount=new me.Vector2d(~~((this.image.width-this.margin)/(this.width+this.spacing)),~~((this.image.height-this.margin)/(this.height+this.spacing))),frame=0,count=spritecount.x*spritecount.y;count>frame;frame++)this.textureAtlas[frame]={name:""+frame,offset:new me.Vector2d(this.margin+(this.spacing+this.width)*(frame%spritecount.x),this.margin+(this.spacing+this.height)*~~(frame/spritecount.x)),width:this.width,height:this.height,hWidth:this.width/2,hHeight:this.height/2,angle:0}}},addAnimation:function(name,index,animationspeed){if(this.anim[name]={name:name,frame:[],idx:0,length:0,animationspeed:animationspeed||this.animationspeed,nextFrame:0},null==index){index=[];
var j=0;this.textureAtlas.forEach(function(){index[j]=j++})}for(var i=0,len=index.length;len>i;i++)if("number"==typeof index[i])this.anim[name].frame[i]=this.textureAtlas[index[i]];else{if(null===this.atlasIndices)throw"melonjs: string parameters for addAnimation  are only allowed for TextureAtlas ";this.anim[name].frame[i]=this.textureAtlas[this.atlasIndices[index[i]]]}this.anim[name].length=this.anim[name].frame.length},setCurrentAnimation:function(name,resetAnim){if(!this.anim[name])throw"melonJS: animation id '"+name+"' not defined";this.current=this.anim[name],this.resetAnim=resetAnim||null,this.setAnimationFrame(this.current.idx),this.current.nextFrame=this.current.animationspeed},isCurrentAnimation:function(name){return this.current.name===name},setAnimationFrame:function(idx){this.current.idx=(idx||0)%this.current.length;var frame=this.current.frame[this.current.idx];this.offset=frame.offset,this.width=frame.width,this.height=frame.height,this.hWidth=frame.hWidth,this.hHeight=frame.hHeight,this._sourceAngle=frame.angle},getCurrentAnimationFrame:function(){return this.current.idx},update:function(dt){if(!this.animationpause&&(this.current.nextFrame-=dt,0>=this.current.nextFrame)){if(this.setAnimationFrame(++this.current.idx),0===this.current.idx&&this.resetAnim)if("string"==typeof this.resetAnim)this.setCurrentAnimation(this.resetAnim);else if("function"==typeof this.resetAnim&&this.resetAnim()===!1)return this.current.idx=this.current.length-1,this.setAnimationFrame(this.current.idx),this.parent(dt),!1;return this.current.nextFrame=this.current.animationspeed,this.parent(dt)||!0}return this.parent(dt)}})}(),function(){var nhPI=-(Math.PI/2);me.TextureAtlas=Object.extend({format:null,texture:null,atlas:null,init:function(atlas,texture){if(atlas&&atlas.meta){if(atlas.meta.app.contains("texturepacker"))if(this.format="texturepacker",texture===void 0){var name=me.utils.getBasename(atlas.meta.image);if(this.texture=me.loader.getImage(name),null===this.texture)throw"melonjs: Atlas texture '"+name+"' not found"}else this.texture=texture;if(atlas.meta.app.contains("ShoeBox")){if(!atlas.meta.exporter||!atlas.meta.exporter.contains("melonJS"))throw"melonjs: ShoeBox requires the JSON exporter : https://github.com/melonjs/melonJS/tree/master/media/shoebox_JSON_export.sbx";this.format="ShoeBox",this.texture=texture}this.atlas=this.initFromTexturePacker(atlas)}if(null===this.atlas)throw"melonjs: texture atlas format not supported"},initFromTexturePacker:function(data){var atlas={};return data.frames.forEach(function(frame){frame.hasOwnProperty("filename")&&(atlas[frame.filename]={frame:new me.Rect(new me.Vector2d(frame.frame.x,frame.frame.y),frame.frame.w,frame.frame.h),source:new me.Rect(new me.Vector2d(frame.spriteSourceSize.x,frame.spriteSourceSize.y),frame.spriteSourceSize.w,frame.spriteSourceSize.h),rotated:frame.rotated===!0,trimmed:frame.trimmed===!0})}),atlas},getTexture:function(){return this.texture},getRegion:function(name){var region=this.atlas[name];return region?{name:name,pos:region.source.pos.clone(),offset:region.frame.pos.clone(),width:region.frame.width,height:region.frame.height,hWidth:region.frame.width/2,hHeight:region.frame.height/2,angle:region.rotated===!0?nhPI:0}:null},createSpriteFromName:function(name){var region=this.getRegion(name);if(region){var sprite=new me.SpriteObject(0,0,this.getTexture(),region.width,region.height);return sprite.offset.setV(region.offset),sprite._sourceAngle=region.angle,sprite}throw"melonjs: TextureAtlas - region for "+name+" not found"},createAnimationFromName:function(names){for(var tpAtlas=[],indices={},i=0;names.length>i;++i)if(tpAtlas[i]=this.getRegion(names[i]),indices[names[i]]=i,null==tpAtlas[i])throw"melonjs: TextureAtlas - region for "+names[i]+" not found";return new me.AnimationSheet(0,0,this.texture,0,0,0,0,tpAtlas,indices)}})}(),function(){var MIN=Math.min,MAX=Math.max;me.Viewport=me.Renderable.extend({AXIS:{NONE:0,HORIZONTAL:1,VERTICAL:2,BOTH:3},bounds:null,deadzone:null,target:null,follow_axis:0,_shake:null,_fadeIn:null,_fadeOut:null,screenX:0,screenY:0,init:function(minX,minY,maxX,maxY){this.parent(new me.Vector2d(minX,minY),maxX-minX,maxY-minY),this.bounds=new me.Rect(new me.Vector2d(-1/0,-1/0),1/0,1/0),this.offset=new me.Vector2d,this.target=null,this.follow_axis=this.AXIS.NONE,this._shake={intensity:0,duration:0,axis:this.AXIS.BOTH,onComplete:null},this._fadeOut={color:null,duration:0,tween:null},this._fadeIn={color:null,duration:0,tween:null},this.setDeadzone(this.width/6,this.height/6)},_followH:function(target){var _x=this.pos.x;return target.x-this.pos.x>this.deadzone.right?this.pos.x=~~MIN(target.x-this.deadzone.right,this.bounds.width-this.width):target.x-this.pos.x<this.deadzone.pos.x&&(this.pos.x=~~MAX(target.x-this.deadzone.pos.x,this.bounds.pos.x)),_x!==this.pos.x},_followV:function(target){var _y=this.pos.y;return target.y-this.pos.y>this.deadzone.bottom?this.pos.y=~~MIN(target.y-this.deadzone.bottom,this.bounds.height-this.height):target.y-this.pos.y<this.deadzone.pos.y&&(this.pos.y=~~MAX(target.y-this.deadzone.pos.y,this.bounds.pos.y)),_y!==this.pos.y},reset:function(x,y){this.pos.x=x||0,this.pos.y=y||0,this.target=null,this.follow_axis=null},setDeadzone:function(w,h){null===this.deadzone&&(this.deadzone=new me.Rect(new me.Vector2d,0,0)),this.deadzone.pos.set(~~((this.width-w)/2),~~((this.height-h)/2-.25*h)),this.deadzone.resize(w,h),this.updateTarget()},setBounds:function(x,y,w,h){this.bounds.pos.set(x,y),this.bounds.resize(w,h)},follow:function(target,axis){if(target instanceof me.ObjectEntity)this.target=target.pos;else{if(!(target instanceof me.Vector2d))throw"melonJS: invalid target for viewport.follow";this.target=target}this.follow_axis=axis===void 0?this.AXIS.BOTH:axis,this.updateTarget()},move:function(x,y){this.moveTo(~~(this.pos.x+x),~~(this.pos.y+y))},moveTo:function(x,y){this.pos.x=(~~x).clamp(this.bounds.pos.x,this.bounds.width-this.width),this.pos.y=(~~y).clamp(this.bounds.pos.y,this.bounds.height-this.height),me.event.publish(me.event.VIEWPORT_ONCHANGE,[this.pos])},updateTarget:function(){var updated=!1;if(this.target)switch(this.follow_axis){case this.AXIS.NONE:break;case this.AXIS.HORIZONTAL:updated=this._followH(this.target);break;case this.AXIS.VERTICAL:updated=this._followV(this.target);break;case this.AXIS.BOTH:updated=this._followH(this.target),updated=this._followV(this.target)||updated;break;default:}return updated},update:function(dt){var updated=this.updateTarget();return this._shake.duration>0&&(this._shake.duration-=dt,0>=this._shake.duration?(this._shake.duration=0,this.offset.setZero(),"function"==typeof this._shake.onComplete&&this._shake.onComplete()):((this._shake.axis===this.AXIS.BOTH||this._shake.axis===this.AXIS.HORIZONTAL)&&(this.offset.x=(Math.random()-.5)*this._shake.intensity),(this._shake.axis===this.AXIS.BOTH||this._shake.axis===this.AXIS.VERTICAL)&&(this.offset.y=(Math.random()-.5)*this._shake.intensity)),updated=!0),updated===!0&&me.event.publish(me.event.VIEWPORT_ONCHANGE,[this.pos]),(null!=this._fadeIn.tween||null!=this._fadeOut.tween)&&(updated=!0),updated},shake:function(intensity,duration,axis,onComplete){this._shake.duration>0||(this._shake={intensity:intensity,duration:duration,axis:axis||this.AXIS.BOTH,onComplete:onComplete})},fadeOut:function(color,duration,onComplete){this._fadeOut.color=me.pool.pull("me.Color").parseHex(color),this._fadeOut.color.alpha=1,this._fadeOut.duration=duration||1e3,this._fadeOut.tween=me.pool.pull("me.Tween",this._fadeOut.color).to({alpha:0},this._fadeOut.duration).onComplete(onComplete||null),this._fadeOut.tween.start()},fadeIn:function(color,duration,onComplete){this._fadeIn.color=me.pool.pull("me.Color").parseHex(color),this._fadeIn.color.alpha=0,this._fadeIn.duration=duration||1e3,this._fadeIn.tween=me.pool.pull("me.Tween",this._fadeIn.color).to({alpha:1},this._fadeIn.duration).onComplete(onComplete||null),this._fadeIn.tween.start()},getWidth:function(){return this.width},getHeight:function(){return this.height},focusOn:function(target){var bounds=target.getBounds();this.moveTo(target.pos.x+bounds.pos.x+bounds.hWidth,target.pos.y+bounds.pos.y+bounds.hHeight)},isVisible:function(rect){return rect.overlaps(this)},localToWorld:function(x,y,v){return v=v||new me.Vector2d,v.set(x,y).add(this.pos).sub(me.game.currentLevel.pos)},worldToLocal:function(x,y,v){return v=v||new me.Vector2d,v.set(x,y).sub(this.pos).add(me.game.currentLevel.pos)},draw:function(context){this._fadeIn.tween&&(me.video.clearSurface(context,this._fadeIn.color.toRGBA()),1===this._fadeIn.color.alpha&&(this._fadeIn.tween=null,me.pool.push(this._fadeIn.color),this._fadeIn.color=null)),this._fadeOut.tween&&(me.video.clearSurface(context,this._fadeOut.color.toRGBA()),0===this._fadeOut.color.alpha&&(this._fadeOut.tween=null,me.pool.push(this._fadeOut.color),this._fadeOut.color=null))}})}(),function(){me.GUI_Object=me.SpriteObject.extend({holdTimeout:null,holdThreshold:250,isHoldable:!1,isClickable:!0,updated:!1,released:!0,init:function(x,y,settings){this.parent(x,y,"string"==typeof settings.image?me.loader.getImage(settings.image):settings.image,settings.spritewidth,settings.spriteheight),this.floating=!0,me.input.registerPointerEvent("pointerdown",this,this.clicked.bind(this)),me.input.registerPointerEvent("pointerup",this,this.release.bind(this))},update:function(){return this.updated?(this.released||(this.updated=!1),!0):!1},clicked:function(event){return this.isClickable?(this.updated=!0,this.isHoldable&&(null!==this.holdTimeout&&me.timer.clearTimeout(this.holdTimeout),this.holdTimeout=me.timer.setTimeout(this.hold.bind(this),this.holdThreshold,!1),this.released=!1),this.onClick(event)):void 0},onClick:function(){return!1},release:function(event){return this.released=!0,me.timer.clearTimeout(this.holdTimeout),this.onRelease(event)},onRelease:function(){return!1},hold:function(){me.timer.clearTimeout(this.holdTimeout),this.released||this.onHold()},onHold:function(){},onDestroyEvent:function(){me.input.releasePointerEvent("pointerdown",this),me.input.releasePointerEvent("pointerup",this),me.timer.clearTimeout(this.holdTimeout)}})}(),function(){var deferredRemove=function(child,keepalive){child.ancestor&&child.ancestor.removeChildNow(child,keepalive)},globalTranslation=new me.Rect(new me.Vector2d,0,0),globalFloatingCounter=0;me.ObjectContainer=me.Renderable.extend({sortOn:"z",autoSort:!0,pendingSort:null,children:null,bounds:null,collidable:!0,transform:new me.Matrix2d,init:function(x,y,width,height){this.parent(new me.Vector2d(x||0,y||0),width||1/0,height||1/0),this.bounds=new me.Rect(new me.Vector2d(0,0),0,0),this.children=[],this.sortOn=me.game.sortOn,this.autoSort=!0,this.transform.identity()},addChild:function(child,zIndex){child.ancestor!==void 0?child.ancestor.removeChildNow(child):child.isRenderable&&(child.GUID=me.utils.createGUID()),"number"==typeof zIndex&&(child.z=zIndex),child.z===void 0&&(child.z=this.children.length),child.ancestor=this,this.children.push(child),this.autoSort===!0&&this.sort()},addChildAt:function(child,index){if(!(index>=0&&this.children.length>index))throw"melonJS (me.ObjectContainer): Index ("+index+") Out Of Bounds for addChildAt()";child.ancestor!==void 0?child.ancestor.removeChildNow(child):child.isRenderable&&(child.GUID=me.utils.createGUID()),child.ancestor=this,this.children.splice(index,0,child)},swapChildren:function(child,child2){var index=this.getChildIndex(child),index2=this.getChildIndex(child2);if(-1===index||-1===index2)throw"melonJS (me.ObjectContainer): "+child+" Both the supplied childs must be a child of the caller "+this;var _z=child.z;child.z=child2.z,child2.z=_z,this.children[index]=child2,this.children[index2]=child},getChildAt:function(index){if(index>=0&&this.children.length>index)return this.children[index];throw"melonJS (me.ObjectContainer): Index ("+index+") Out Of Bounds for getChildAt()"},getChildIndex:function(child){return this.children.indexOf(child)},hasChild:function(child){return this===child.ancestor},getChildByProp:function(prop,value){function compare(obj,prop){"string"==typeof obj[prop]?obj[prop].match(_regExp)&&objList.push(obj):obj[prop]===value&&objList.push(obj)}for(var objList=[],_regExp=RegExp(value,"i"),i=this.children.length,obj;i--,obj=this.children[i];)obj instanceof me.ObjectContainer?(compare(obj,prop),objList=objList.concat(obj.getChildByProp(prop,value))):compare(obj,prop);return objList},getChildByName:function(name){return this.getChildByProp("name",name)},getChildByGUID:function(guid){var obj=this.getChildByProp("GUID",guid);return obj.length>0?obj[0]:null},getBounds:function(rect){var _bounds=rect!==void 0?rect:this.bounds;_bounds.pos.set(1/0,1/0),_bounds.resize(-1/0,-1/0);for(var childBounds,i=this.children.length,child;i--,child=this.children[i];)child.isRenderable&&(childBounds=child.getBounds(),null!==childBounds&&_bounds.union(childBounds));return _bounds},removeChild:function(child,keepalive){child.ancestor&&deferredRemove.defer(this,child,keepalive)},removeChildNow:function(child,keepalive){if(!this.hasChild(child))throw"melonJS (me.ObjectContainer): "+child+" The supplied child must be a child of the caller "+this;child.ancestor=void 0,keepalive||("function"==typeof child.destroy&&child.destroy(),me.pool.push(child)),this.children.splice(this.getChildIndex(child),1)},setChildsProperty:function(prop,val,recursive){for(var i=this.children.length,obj;i--,obj=this.children[i];)recursive===!0&&obj instanceof me.ObjectContainer&&obj.setChildsProperty(prop,val,recursive),obj[prop]=val},moveUp:function(child){var childIndex=this.getChildIndex(child);childIndex-1>=0&&this.swapChildren(child,this.getChildAt(childIndex-1))},moveDown:function(child){var childIndex=this.getChildIndex(child);this.children.length>childIndex+1&&this.swapChildren(child,this.getChildAt(childIndex+1))},moveToTop:function(child){var childIndex=this.getChildIndex(child);childIndex>0&&(this.children.splice(0,0,this.children.splice(childIndex,1)[0]),child.z=this.children[1].z+1)},moveToBottom:function(child){var childIndex=this.getChildIndex(child);this.children.length-1>childIndex&&(this.children.splice(this.children.length-1,0,this.children.splice(childIndex,1)[0]),child.z=this.children[this.children.length-2].z-1)},collide:function(objA,multiple){return this.collideType(objA,null,multiple)},collideType:function(objA,type,multiple){var res,mres;multiple=multiple===!0?!0:!1,multiple===!0&&(mres=[]);for(var i=this.children.length,obj;i--,obj=this.children[i];)if((obj.inViewport||obj.alwaysUpdate)&&obj.collidable)if(obj instanceof me.ObjectContainer){if(res=obj.collideType(objA,type,multiple),multiple)mres.concat(res);else if(res)return res}else if(obj!==objA&&(!type||obj.type===type)&&(this._boundsA=obj.getBounds(this._boundsA).translateV(obj.pos),this._boundsB=objA.getBounds(this._boundsB).translateV(objA.pos),res=this._boundsA["collideWith"+this._boundsB.shapeType].call(this._boundsA,this._boundsB),0!==res.x||0!==res.y)){if(obj.onCollision.call(obj,res,objA),res.type=obj.type,res.obj=obj,!multiple)return res;mres.push(res)}return multiple?mres:null},sort:function(recursive){if(null===this.pendingSort){if(recursive===!0)for(var i=this.children.length,obj;i--,obj=this.children[i];)obj instanceof me.ObjectContainer&&obj.sort(recursive);this.pendingSort=function(self){self.children.sort(self["_sort"+self.sortOn.toUpperCase()]),self.pendingSort=null,me.game.repaint()}.defer(this,this)}},_sortZ:function(a,b){return b.z-a.z},_sortX:function(a,b){var result=b.z-a.z;return result?result:(b.pos&&b.pos.x)-(a.pos&&a.pos.x)||0},_sortY:function(a,b){var result=b.z-a.z;return result?result:(b.pos&&b.pos.y)-(a.pos&&a.pos.y)||0},destroy:function(){this.pendingSort&&(clearTimeout(this.pendingSort),this.pendingSort=null);for(var i=this.children.length,obj;i--,obj=this.children[i];)obj.isPersistent||this.removeChildNow(obj);this.transform.identity()},update:function(dt){for(var isDirty=!1,isFloating=!1,isPaused=me.state.isPaused(),isTranslated,x,y,viewport=me.game.viewport,i=this.children.length,obj;i--,obj=this.children[i];)(!isPaused||obj.updateWhenPaused)&&(obj.isRenderable?(isFloating=globalFloatingCounter>0||obj.floating,isFloating&&globalFloatingCounter++,isTranslated=!isFloating,isTranslated&&(x=obj.pos.x,y=obj.pos.y,globalTranslation.translateV(obj.pos),globalTranslation.resize(obj.width,obj.height)),obj.inViewport=isFloating||viewport.isVisible(globalTranslation),isDirty|=(obj.inViewport||obj.alwaysUpdate)&&obj.update(dt),isTranslated&&globalTranslation.translate(-x,-y),globalFloatingCounter>0&&globalFloatingCounter--):isDirty|=obj.update(dt));return isDirty},draw:function(context,rect){var viewport=me.game.viewport,isFloating=!1;this.drawCount=0,context.save(),context.transform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.e,this.transform.f),context.globalAlpha*=this.getOpacity(),context.translate(this.pos.x,this.pos.y);for(var i=this.children.length,obj;i--,obj=this.children[i];)isFloating=obj.floating,(obj.inViewport||isFloating)&&obj.isRenderable&&(isFloating===!0&&(context.save(),context.translate(viewport.screenX-this.pos.x,viewport.screenY-this.pos.y)),obj.draw(context,rect),isFloating===!0&&context.restore(),this.drawCount++);context.restore()}})}(),function(){me.ObjectSettings={name:null,image:null,transparent_color:null,spritewidth:null,spriteheight:null,type:0,collidable:!0},me.ObjectEntity=me.Renderable.extend({type:0,collidable:!0,shapes:[],shapeIndex:0,renderable:null,lastflipX:!1,lastflipY:!1,init:function(x,y,settings){if("number"!=typeof settings.width||"number"!=typeof settings.height)throw"melonjs: height and width properties are mandatory when passing settings parameters to an object entity";if(this.parent(this.pos.set(x,y),settings.width,settings.height),settings.image){var image="object"==typeof settings.image?settings.image:me.loader.getImage(settings.image);this.renderable=new me.AnimationSheet(0,0,image,~~(settings.spritewidth||settings.width),~~(settings.spriteheight||settings.height),~~settings.spacing,~~settings.margin),settings.transparent_color&&this.renderable.setTransparency(settings.transparent_color)}this.name=settings.name?settings.name.toLowerCase():"",this.vel===void 0&&(this.vel=new me.Vector2d),this.vel.set(0,0),this.accel===void 0&&(this.accel=new me.Vector2d),this.accel.set(0,0),this.friction===void 0&&(this.friction=new me.Vector2d),this.friction.set(0,0),this.maxVel===void 0&&(this.maxVel=new me.Vector2d),this.maxVel.set(1e3,1e3),this.gravity=me.sys.gravity!==void 0?me.sys.gravity:.98,this.alive=!0,this.falling=!1,this.jumping=!0,this.slopeY=0,this.onslope=!1,this.onladder=!1,this.disableTopLadderCollision=!1,this.collidable=settings.collidable!==void 0?settings.collidable:!0,this.type=settings.type||0,this.lastflipX=this.lastflipY=!1,this.collisionMap=me.game.collisionMap,this.canBreakTile=!1,this.onTileBreak=null,"function"==typeof settings.getShape&&(this.addShape(settings.getShape()),"PolyShape"===this.getShape().shapeType&&(this._bounds=this.getBounds(),this.resize(this._bounds.width,this._bounds.height)))},addShape:function(shape){this.shapes.push(shape)},getShape:function(){return this.shapes[this.shapeIndex]},setShape:function(index){if(this.shapes[index]!==void 0)return this.shapeIndex=index,void 0;throw"melonJS (me.Entity): Shape ("+index+") not defined"},onCollision:function(){this.collidable&&this.type===me.game.COLLECTABLE_OBJECT&&me.game.world.removeChild(this)},setVelocity:function(x,y){this.accel.x=0!==x?x:this.accel.x,this.accel.y=0!==y?y:this.accel.y,this.setMaxVelocity(x,y)},setMaxVelocity:function(x,y){this.maxVel.x=x,this.maxVel.y=y},setFriction:function(x,y){this.friction.x=x||0,this.friction.y=y||0},flipX:function(flip){flip!==this.lastflipX&&(this.lastflipX=flip,this.renderable&&this.renderable.flipX&&this.renderable.flipX(flip),this.shapes.length&&"function"==typeof this.getShape().flipX&&this.getShape().flipX(this.width))},flipY:function(flip){flip!==this.lastflipY&&(this.lastflipY=flip,this.renderable&&this.renderable.flipY&&this.renderable.flipY(flip),this.shapes.length&&"function"==typeof this.getShape().flipY&&this.getShape().flipY(this.height))},distanceTo:function(e){var dx=this.pos.x+this.hWidth-(e.pos.x+e.hWidth),dy=this.pos.y+this.hHeight-(e.pos.y+e.hHeight);return Math.sqrt(dx*dx+dy*dy)},distanceToPoint:function(v){var dx=this.pos.x+this.hWidth-v.x,dy=this.pos.y+this.hHeight-v.y;return Math.sqrt(dx*dx+dy*dy)},angleTo:function(e){var ax=e.pos.x+e.hWidth-(this.pos.x+this.hWidth),ay=e.pos.y+e.hHeight-(this.pos.y+this.hHeight);return Math.atan2(ay,ax)},angleToPoint:function(v){var ax=v.x-(this.pos.x+this.hWidth),ay=v.y-(this.pos.y+this.hHeight);return Math.atan2(ay,ax)},checkSlope:function(rect,tile,left){rect.pos.y=tile.pos.y-rect.height,this.slopeY=left?tile.height-(rect.right+this.vel.x-tile.pos.x):rect.left+this.vel.x-tile.pos.x,this.vel.y=0,rect.pos.y+=this.slopeY.clamp(0,tile.height)},computeVelocity:function(vel){this.gravity&&(vel.y+=this.onladder?0:this.gravity*me.timer.tick,this.falling=vel.y>0,this.jumping=this.falling?!1:this.jumping),this.friction.x&&(vel.x=me.utils.applyFriction(vel.x,this.friction.x)),this.friction.y&&(vel.y=me.utils.applyFriction(vel.y,this.friction.y)),0!==vel.y&&(vel.y=vel.y.clamp(-this.maxVel.y,this.maxVel.y)),0!==vel.x&&(vel.x=vel.x.clamp(-this.maxVel.x,this.maxVel.x))},updateMovement:function(){this.computeVelocity(this.vel);var collision;if(this.collidable){this._bounds=this.getBounds(this._bounds),this.__offsetX=this._bounds.pos.x,this.__offsetY=this._bounds.pos.y,this._bounds.translateV(this.pos),collision=this.collisionMap.checkCollision(this._bounds,this.vel),this.onslope=collision.yprop.isSlope||collision.xprop.isSlope,this.onladder=!1;var prop=collision.yprop,tile=collision.ytile;collision.y&&(this.onladder=prop.isLadder||prop.isTopLadder,collision.y>0?prop.isSolid||prop.isPlatform&&this._bounds.bottom-1<=tile.pos.y||prop.isTopLadder&&!this.disableTopLadderCollision?(this._bounds.pos.y=~~this._bounds.pos.y,this.vel.y=this.falling?tile.pos.y-this._bounds.bottom:0,this.falling=!1):prop.isSlope&&!this.jumping?(this.checkSlope(this._bounds,tile,prop.isLeftSlope),this.falling=!1):prop.isBreakable&&(this.canBreakTile?(me.game.currentLevel.clearTile(tile.col,tile.row),this.onTileBreak&&this.onTileBreak()):(this._bounds.pos.y=~~this._bounds.pos.y,this.vel.y=this.falling?tile.pos.y-this._bounds.bottom:0,this.falling=!1)):0>collision.y&&(prop.isPlatform||prop.isLadder||prop.isTopLadder||(this.gravity&&(this.falling=!0),this.vel.y=0))),prop=collision.xprop,tile=collision.xtile,collision.x&&(this.onladder=prop.isLadder||prop.isTopLadder,prop.isSlope&&!this.jumping?(this.checkSlope(this._bounds,tile,prop.isLeftSlope),this.falling=!1):prop.isPlatform||prop.isLadder||prop.isTopLadder||(prop.isBreakable&&this.canBreakTile?(me.game.currentLevel.clearTile(tile.col,tile.row),this.onTileBreak&&this.onTileBreak()):this.vel.x=0)),this.pos.set(this._bounds.pos.x-this.__offsetX,this._bounds.pos.y-this.__offsetY)}return this.pos.add(this.vel),collision},update:function(dt){return this.renderable?this.renderable.update(dt):!1},getBounds:function(rect){return this.shapes.length||this.addShape(this.parent().translate(-this.pos.x,-this.pos.y)),this.getShape().getBounds(rect)},draw:function(context){if(this.renderable){var bounds=this;this.shapes.length&&"PolyShape"===this.getShape().shapeType&&(bounds=this.getBounds(this._bounds).translateV(this.pos));var x=~~(bounds.pos.x+this.anchorPoint.x*(bounds.width-this.renderable.width)),y=~~(bounds.pos.y+this.anchorPoint.y*(bounds.height-this.renderable.height));context.translate(x,y),this.renderable.draw(context),context.translate(-x,-y)}},destroy:function(){this.renderable&&(this.renderable.destroy.apply(this.renderable,arguments),this.renderable=null),this.onDestroyEvent.apply(this,arguments),this.shapes=[],this.shapeIndex=0},onDestroyEvent:function(){}}),me.CollectableEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.type=me.game.COLLECTABLE_OBJECT}}),me.LevelEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.nextlevel=settings.to,this.fade=settings.fade,this.duration=settings.duration,this.fading=!1,this.gotolevel=settings.to},onFadeComplete:function(){me.levelDirector.loadLevel(this.gotolevel),me.game.viewport.fadeOut(this.fade,this.duration)},goTo:function(level){this.gotolevel=level||this.nextlevel,this.fade&&this.duration?this.fading||(this.fading=!0,me.game.viewport.fadeIn(this.fade,this.duration,this.onFadeComplete.bind(this))):me.levelDirector.loadLevel(this.gotolevel)},onCollision:function(){this.goTo()}})}(),function(){me.ScreenObject=Object.extend({init:function(){},reset:function(){me.game.reset(),this.onResetEvent.apply(this,arguments)},destroy:function(){this.onDestroyEvent.apply(this,arguments)},onResetEvent:function(){},onDestroyEvent:function(){}}),function(){var lastTime=0,requestAnimationFrame=me.agent.prefixed("requestAnimationFrame"),cancelAnimationFrame=me.agent.prefixed("cancelAnimationFrame")||me.agent.prefixed("cancelRequestAnimationFrame");requestAnimationFrame&&cancelAnimationFrame||(requestAnimationFrame=function(callback){var currTime=window.performance.now(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id},cancelAnimationFrame=function(id){window.clearTimeout(id)}),window.requestAnimationFrame=requestAnimationFrame,window.cancelAnimationFrame=cancelAnimationFrame}(),me.state=function(){function _startRunLoop(){-1===_animFrameId&&-1!==_state&&(me.timer.reset(),_animFrameId=window.requestAnimationFrame(_renderFrame))}function _resumeRunLoop(){_isPaused&&-1!==_state&&(me.timer.reset(),_isPaused=!1)}function _pauseRunLoop(){_isPaused=!0}function _renderFrame(time){me.game.update(time),me.game.draw(),-1!==_animFrameId&&(_animFrameId=window.requestAnimationFrame(_renderFrame))}function _stopRunLoop(){window.cancelAnimationFrame(_animFrameId),_animFrameId=-1}function _switchState(state){_stopRunLoop(),_screenObject[_state]&&_screenObject[_state].screen.destroy(),_screenObject[state]&&(_state=state,_screenObject[_state].screen.reset.apply(_screenObject[_state].screen,_extraArgs),_startRunLoop(),_onSwitchComplete&&_onSwitchComplete(),me.game.repaint())}var obj={},_state=-1,_animFrameId=-1,_isPaused=!1,_screenObject={},_fade={color:"",duration:0},_onSwitchComplete=null,_extraArgs=null,_pauseTime=0;return obj.LOADING=0,obj.MENU=1,obj.READY=2,obj.PLAY=3,obj.GAMEOVER=4,obj.GAME_END=5,obj.SCORE=6,obj.CREDITS=7,obj.SETTINGS=8,obj.USER=100,obj.onPause=null,obj.onResume=null,obj.onStop=null,obj.onRestart=null,obj.init=function(){obj.set(obj.LOADING,new me.DefaultLoadingScreen)},obj.stop=function(music){_state!==obj.LOADING&&obj.isRunning()&&(_stopRunLoop(),music===!0&&me.audio.pauseTrack(),_pauseTime=window.performance.now(),me.event.publish(me.event.STATE_STOP),"function"==typeof obj.onStop&&obj.onStop())},obj.pause=function(music){_state===obj.LOADING||obj.isPaused()||(_pauseRunLoop(),music===!0&&me.audio.pauseTrack(),_pauseTime=window.performance.now(),me.event.publish(me.event.STATE_PAUSE),"function"==typeof obj.onPause&&obj.onPause())},obj.restart=function(music){obj.isRunning()||(_startRunLoop(),music===!0&&me.audio.resumeTrack(),_pauseTime=window.performance.now()-_pauseTime,me.game.repaint(),me.event.publish(me.event.STATE_RESTART,[_pauseTime]),"function"==typeof obj.onRestart&&obj.onRestart())},obj.resume=function(music){obj.isPaused()&&(_resumeRunLoop(),music===!0&&me.audio.resumeTrack(),_pauseTime=window.performance.now()-_pauseTime,me.event.publish(me.event.STATE_RESUME,[_pauseTime]),"function"==typeof obj.onResume&&obj.onResume())},obj.isRunning=function(){return-1!==_animFrameId},obj.isPaused=function(){return _isPaused},obj.set=function(state,so){_screenObject[state]={},_screenObject[state].screen=so,_screenObject[state].transition=!0},obj.current=function(){return _screenObject[_state].screen},obj.transition=function(effect,color,duration){"fade"===effect&&(_fade.color=color,_fade.duration=duration)},obj.setTransition=function(state,enable){_screenObject[state].transition=enable},obj.change=function(state){if(_screenObject[state]===void 0)throw"melonJS : Undefined ScreenObject for state '"+state+"'";_extraArgs=null,arguments.length>1&&(_extraArgs=Array.prototype.slice.call(arguments,1)),_fade.duration&&_screenObject[state].transition?(_onSwitchComplete=function(){me.game.viewport.fadeOut(_fade.color,_fade.duration)},me.game.viewport.fadeIn(_fade.color,_fade.duration,function(){_switchState.defer(this,state)})):_switchState.defer(this,state)},obj.isCurrent=function(state){return _state===state},obj}()}(),function(){var ProgressBar=me.Renderable.extend({invalidate:!1,barHeight:4,progress:0,onProgressUpdate:function(progress){this.progress=Math.floor(progress*this.width),this.invalidate=!0},update:function(){return this.invalidate===!0?(this.invalidate=!1,!0):!1},draw:function(context){context.fillStyle="black",context.fillRect(0,this.height/2-this.barHeight/2,this.width,this.barHeight),context.fillStyle="#55aa00",context.fillRect(2,this.height/2-this.barHeight/2,this.progress,this.barHeight)}}),IconLogo=me.Renderable.extend({init:function(x,y){this.parent(new me.Vector2d(x,y),100,85)},draw:function(context){context.save(),context.translate(this.pos.x,this.pos.y),context.beginPath(),context.moveTo(.7,48.9),context.bezierCurveTo(10.8,68.9,38.4,75.8,62.2,64.5),context.bezierCurveTo(86.1,53.1,97.2,27.7,87,7.7),context.lineTo(87,7.7),context.bezierCurveTo(89.9,15.4,73.9,30.2,50.5,41.4),context.bezierCurveTo(27.1,52.5,5.2,55.8,.7,48.9),context.lineTo(.7,48.9),context.lineTo(.7,48.9),context.closePath(),context.fillStyle="rgb(255, 255, 255)",context.fill(),context.beginPath(),context.moveTo(84,7),context.bezierCurveTo(87.6,14.7,72.5,30.2,50.2,41.6),context.bezierCurveTo(27.9,53,6.9,55.9,3.2,48.2),context.bezierCurveTo(-.5,40.4,14.6,24.9,36.9,13.5),context.bezierCurveTo(59.2,2.2,80.3,-.8,84,7),context.lineTo(84,7),context.closePath(),context.lineWidth=5.3,context.strokeStyle="rgb(255, 255, 255)",context.lineJoin="miter",context.miterLimit=4,context.stroke(),context.restore()}}),TextLogo=me.Renderable.extend({init:function(w,h){this.parent(new me.Vector2d,w,h),this.logo1=new me.Font("century gothic",32,"white","middle"),this.logo2=new me.Font("century gothic",32,"#55aa00","middle"),this.logo2.bold(),this.logo1.textBaseline=this.logo2.textBaseline="alphabetic"},draw:function(context){var logo1_width=this.logo1.measureText(context,"melon").width,xpos=(this.width-logo1_width-this.logo2.measureText(context,"JS").width)/2,ypos=this.height/2+this.logo2.measureText(context,"melon").height;this.logo1.draw(context,"melon",xpos,ypos),xpos+=logo1_width,this.logo2.draw(context,"JS",xpos,ypos)}});me.DefaultLoadingScreen=me.ScreenObject.extend({onResetEvent:function(){me.game.reset(),me.game.world.addChild(new me.ColorLayer("background","#202020",0));var progressBar=new ProgressBar(new me.Vector2d,me.video.getWidth(),me.video.getHeight());this.handle=me.event.subscribe(me.event.LOADER_PROGRESS,progressBar.onProgressUpdate.bind(progressBar)),me.game.world.addChild(progressBar,1);var icon=new IconLogo((me.video.getWidth()-100)/2,me.video.getHeight()/2-progressBar.barHeight/2-90);me.game.world.addChild(icon,1),me.game.world.addChild(new TextLogo(me.video.getWidth(),me.video.getHeight()),1)},onDestroyEvent:function(){this.handle&&(me.event.unsubscribe(this.handle),this.handle=null)}})}(),function(){me.loader=function(){function checkLoadStatus(){loadCount===resourceCount?obj.onload?(clearTimeout(timerId),setTimeout(function(){obj.onload(),me.event.publish(me.event.LOADER_COMPLETE)},300)):console.error("no load callback defined"):timerId=setTimeout(checkLoadStatus,100)}function preloadImage(img,onload,onerror){imgList[img.name]=new Image,imgList[img.name].onload=onload,imgList[img.name].onerror=onerror,imgList[img.name].src=img.src+obj.nocache
}function preloadTMX(tmxData,onload,onerror){function addToTMXList(data,format){tmxList[tmxData.name]={data:data,isTMX:"tmx"===tmxData.type,format:format}}if("tmx"===tmxData.type&&me.levelDirector.addTMXLevel(tmxData.name),tmxData.data)return addToTMXList(tmxData.data,tmxData.format),onload(),void 0;var xmlhttp=new XMLHttpRequest,format=me.utils.getFileExtension(tmxData.src).toLowerCase();xmlhttp.overrideMimeType&&("json"===format?xmlhttp.overrideMimeType("application/json"):xmlhttp.overrideMimeType("text/xml")),xmlhttp.open("GET",tmxData.src+obj.nocache,!0),xmlhttp.ontimeout=onerror,xmlhttp.onreadystatechange=function(){if(4===xmlhttp.readyState)if(200===xmlhttp.status||0===xmlhttp.status&&xmlhttp.responseText){var result=null;switch(format){case"xml":case"tmx":result=me.device.ua.match(/msie/i)||!xmlhttp.responseXML?(new DOMParser).parseFromString(xmlhttp.responseText,"text/xml"):xmlhttp.responseXML,result=me.TMXUtils.parse(result).map,format="json";break;case"json":result=JSON.parse(xmlhttp.responseText);break;default:throw"melonJS: TMX file format "+format+"not supported !"}addToTMXList(result,format),onload()}else onerror()},xmlhttp.send(null)}function preloadJSON(data,onload,onerror){var xmlhttp=new XMLHttpRequest;xmlhttp.overrideMimeType&&xmlhttp.overrideMimeType("application/json"),xmlhttp.open("GET",data.src+obj.nocache,!0),xmlhttp.ontimeout=onerror,xmlhttp.onreadystatechange=function(){4===xmlhttp.readyState&&(200===xmlhttp.status||0===xmlhttp.status&&xmlhttp.responseText?(jsonList[data.name]=JSON.parse(xmlhttp.responseText),onload()):onerror())},xmlhttp.send(null)}function preloadBinary(data,onload,onerror){var httpReq=new XMLHttpRequest;httpReq.open("GET",data.src+obj.nocache,!0),httpReq.responseType="arraybuffer",httpReq.onerror=onerror,httpReq.onload=function(){var arrayBuffer=httpReq.response;if(arrayBuffer){for(var byteArray=new Uint8Array(arrayBuffer),buffer=[],i=0;byteArray.byteLength>i;i++)buffer[i]=String.fromCharCode(byteArray[i]);binList[data.name]=buffer.join(""),onload()}},httpReq.send()}var obj={},imgList={},tmxList={},binList={},jsonList={},resourceCount=0,loadCount=0,timerId=0;return obj.nocache="",obj.onload=void 0,obj.onProgress=void 0,obj.onResourceLoaded=function(res){loadCount++;var progress=obj.getLoadProgress();obj.onProgress&&obj.onProgress(progress,res),me.event.publish(me.event.LOADER_PROGRESS,[progress,res])},obj.onLoadingError=function(res){throw"melonJS: Failed loading resource "+res.src},obj.setNocache=function(enable){obj.nocache=enable?"?"+parseInt(1e7*Math.random(),10):""},obj.preload=function(res){for(var i=0;res.length>i;i++)resourceCount+=obj.load(res[i],obj.onResourceLoaded.bind(obj,res[i]),obj.onLoadingError.bind(obj,res[i]));checkLoadStatus()},obj.load=function(res,onload,onerror){switch(res.name=res.name.toLowerCase(),res.type){case"binary":return preloadBinary.call(this,res,onload,onerror),1;case"image":return preloadImage.call(this,res,onload,onerror),1;case"json":return preloadJSON.call(this,res,onload,onerror),1;case"tmx":case"tsx":return preloadTMX.call(this,res,onload,onerror),1;case"audio":return me.audio.load(res,onload,onerror),1;default:throw"melonJS: me.loader.load : unknown or invalid resource type : "+res.type}return 0},obj.unload=function(res){switch(res.name=res.name.toLowerCase(),res.type){case"binary":return res.name in binList?(delete binList[res.name],!0):!1;case"image":return res.name in imgList?("function"==typeof imgList[res.name].dispose&&imgList[res.name].dispose(),delete imgList[res.name],!0):!1;case"json":return res.name in jsonList?(delete jsonList[res.name],!0):!1;case"tmx":case"tsx":return res.name in tmxList?(delete tmxList[res.name],!0):!1;case"audio":return me.audio.unload(res.name);default:throw"melonJS: me.loader.unload : unknown or invalid resource type : "+res.type}},obj.unloadAll=function(){var name;for(name in binList)binList.hasOwnProperty(name)&&obj.unload({name:name,type:"binary"});for(name in imgList)imgList.hasOwnProperty(name)&&obj.unload({name:name,type:"image"});for(name in tmxList)tmxList.hasOwnProperty(name)&&obj.unload({name:name,type:"tmx"});for(name in jsonList)jsonList.hasOwnProperty(name)&&obj.unload({name:name,type:"json"});me.audio.unloadAll()},obj.getTMX=function(elt){return elt=""+elt,elt=elt.toLowerCase(),elt in tmxList?tmxList[elt].data:null},obj.getBinary=function(elt){return elt=""+elt,elt=elt.toLowerCase(),elt in binList?binList[elt]:null},obj.getImage=function(elt){return elt=""+elt,elt=elt.toLowerCase(),elt in imgList?imgList[elt]:null},obj.getJSON=function(elt){return elt=""+elt,elt=elt.toLowerCase(),elt in jsonList?jsonList[elt]:null},obj.getLoadProgress=function(){return loadCount/resourceCount},obj}()}(),function(){me.Font=me.Renderable.extend({font:"Arial",fontSize:new me.Vector2d,fillStyle:"#000000",strokeStyle:"#000000",lineWidth:1,textAlign:"left",textBaseline:"top",lineHeight:1,init:function(font,size,fillStyle,textAlign){this.setFont(font,size,fillStyle,textAlign),this.parent(this.pos,0,this.fontSize.y)},bold:function(){this.font="bold "+this.font},italic:function(){this.font="italic "+this.font},setFont:function(font,size,fillStyle,textAlign){var font_names=font.split(",").map(function(value){return value=value.trim(),/(^".*"$)|(^'.*'$)/.test(value)?value:'"'+value+'"'});this.fontSize.y=parseInt(size,10),this.height=this.fontSize.y,"number"==typeof size&&(size+="px"),this.font=size+" "+font_names.join(","),this.fillStyle=fillStyle,textAlign&&(this.textAlign=textAlign)},measureText:function(context,text){context.font=this.font,context.fillStyle=this.fillStyle,context.textAlign=this.textAlign,context.textBaseline=this.textBaseline,this.height=this.width=0;for(var strings=(""+text).split("\n"),i=0;strings.length>i;i++)this.width=Math.max(context.measureText(strings[i].trimRight()).width,this.width),this.height+=this.fontSize.y*this.lineHeight;return{width:this.width,height:this.height}},draw:function(context,text,x,y){this.pos.set(x,y),context.font=this.font,context.fillStyle=this.fillStyle,context.textAlign=this.textAlign,context.textBaseline=this.textBaseline;for(var strings=(""+text).split("\n"),i=0;strings.length>i;i++)context.fillText(strings[i].trimRight(),~~x,~~y),y+=this.fontSize.y*this.lineHeight},drawStroke:function(context,text,x,y){this.pos.set(x,y),context.font=this.font,context.fillStyle=this.fillStyle,context.strokeStyle=this.strokeStyle,context.lineWidth=this.lineWidth,context.textAlign=this.textAlign,context.textBaseline=this.textBaseline;for(var strings=(""+text).split("\n"),i=0;strings.length>i;i++){var _string=strings[i].trimRight();context.strokeText(_string,~~x,~~y),context.fillText(_string,~~x,~~y),y+=this.fontSize.y*this.lineHeight}}})}(),function(){me.BitmapFont=me.Font.extend({sSize:new me.Vector2d,firstChar:32,charCount:0,init:function(font,size,scale,firstChar){this.parent(font,null,null),this.firstChar=firstChar||32,this.loadFontMetrics(font,size),this.textAlign="left",this.textBaseline="top",scale&&this.resize(scale)},loadFontMetrics:function(font,size){this.font=me.loader.getImage(font),this.fontSize.x=size.x||size,this.fontSize.y=size.y||this.font.height,this.sSize.copy(this.fontSize),this.height=this.sSize.y,this.charCount=~~(this.font.width/this.fontSize.x)},set:function(textAlign,scale){this.textAlign=textAlign,scale&&this.resize(scale)},resize:function(scale){this.sSize.setV(this.fontSize),this.sSize.x*=scale,this.sSize.y*=scale,this.height=this.sSize.y},measureText:function(context,text){var strings=(""+text).split("\n");this.height=this.width=0;for(var i=0;strings.length>i;i++)this.width=Math.max(strings[i].trimRight().length*this.sSize.x,this.width),this.height+=this.sSize.y*this.lineHeight;return{width:this.width,height:this.height}},draw:function(context,text,x,y){var strings=(""+text).split("\n"),lX=x,height=this.sSize.y*this.lineHeight,_alpha=context.globalAlpha;context.globalAlpha*=this.getOpacity(),this.pos.set(x,y);for(var i=0;strings.length>i;i++){x=lX;var string=strings[i].trimRight(),width=string.length*this.sSize.x;switch(this.textAlign){case"right":x-=width;break;case"center":x-=.5*width;break;default:}switch(this.textBaseline){case"middle":y-=.5*height;break;case"ideographic":case"alphabetic":case"bottom":y-=height;break;default:}for(var c=0,len=string.length;len>c;c++){var idx=string.charCodeAt(c)-this.firstChar;idx>=0&&context.drawImage(this.font,this.fontSize.x*(idx%this.charCount),this.fontSize.y*~~(idx/this.charCount),this.fontSize.x,this.fontSize.y,~~x,~~y,this.sSize.x,this.sSize.y),x+=this.sSize.x}y+=height}context.globalAlpha=_alpha}})}(),function(){me.audio=function(){function soundLoadError(sound_id,onerror_cb){if(retry_counter++>3){var errmsg="melonJS: failed loading "+sound_id;if(me.sys.stopOnAudioError!==!1)throw errmsg;me.audio.disable(),onerror_cb&&onerror_cb(),console.log(errmsg+", disabling audio")}else audioTracks[sound_id].load()}function setTrackInstance(id){current_track_instance=id}var obj={},audioTracks={},callbacks={},current_track_id=null,current_track_instance=null,retry_counter=0;return obj.init=function(audioFormat){if(!me.initialized)throw"melonJS: me.audio.init() called before engine initialization.";audioFormat="string"==typeof audioFormat?audioFormat:"mp3",this.audioFormats=audioFormat.split(",")},obj.enable=function(){this.unmuteAll()},obj.disable=function(){this.muteAll()},obj.load=function(sound,onload_cb,onerror_cb){var urls=[];if(this.audioFormats===void 0||0===this.audioFormats.length)throw"melonJS: target audio extension(s) should be set through me.audio.init() before calling the preloader.";for(var i=0;this.audioFormats.length>i;i++)urls.push(sound.src+sound.name+"."+this.audioFormats[i]+me.loader.nocache);var soundclip=new Howl({urls:urls,volume:Howler.volume(),onend:function(soundId){callbacks[soundId]&&(callbacks[soundId](),callbacks[soundId]=null)},onloaderror:function(){soundLoadError.call(me.audio,sound.name,onerror_cb)},onload:function(){retry_counter=0,onload_cb&&onload_cb()}});return audioTracks[sound.name]=soundclip,1},obj.play=function(sound_id,loop,callback,volume){var sound=audioTracks[sound_id.toLowerCase()];return sound&&sound!==void 0?(sound.loop(loop||!1),sound.volume("number"==typeof volume?volume.clamp(0,1):Howler.volume()),sound.play(null,callback),sound):void 0},obj.stop=function(sound_id,instance_id){var sound=audioTracks[sound_id.toLowerCase()];sound&&sound!==void 0&&sound.stop(instance_id)},obj.pause=function(sound_id,instance_id){var sound=audioTracks[sound_id.toLowerCase()];sound&&sound!==void 0&&sound.pause(instance_id)},obj.playTrack=function(sound_id,volume){return current_track_id=sound_id.toLowerCase(),me.audio.play(current_track_id,!0,navigator.isCocoonJS&&!Howler.usingWebAudio?setTrackInstance:void 0,volume)},obj.stopTrack=function(){null!==current_track_id&&(audioTracks[current_track_id].stop(navigator.isCocoonJS&&!Howler.usingWebAudio?current_track_instance:void 0),current_track_id=null)},obj.pauseTrack=function(){null!==current_track_id&&audioTracks[current_track_id].pause(navigator.isCocoonJS&&!Howler.usingWebAudio?current_track_instance:void 0)},obj.resumeTrack=function(){null!==current_track_id&&audioTracks[current_track_id].play(null,navigator.isCocoonJS&&!Howler.usingWebAudio?setTrackInstance:void 0)},obj.getCurrentTrack=function(){return current_track_id},obj.setVolume=function(volume){Howler.volume(volume)},obj.getVolume=function(){return Howler.volume()},obj.mute=function(sound_id,mute){mute=mute===void 0?!0:!!mute;var sound=audioTracks[sound_id.toLowerCase()];sound&&sound!==void 0&&sound.mute(!0)},obj.unmute=function(sound_id){obj.mute(sound_id,!1)},obj.muteAll=function(){Howler.mute()},obj.unmuteAll=function(){Howler.unmute()},obj.unload=function(sound_id){return sound_id=sound_id.toLowerCase(),sound_id in audioTracks?(audioTracks[sound_id].unload(),delete audioTracks[sound_id],!0):!1},obj.unloadAll=function(){for(var sound_id in audioTracks)audioTracks.hasOwnProperty(sound_id)&&obj.unload(sound_id)},obj}()}(),function(){me.video=function(){var api={},canvas=null,context2D=null,backBufferCanvas=null,backBufferContext2D=null,wrapper=null,deferResizeId=-1,double_buffering=!1,game_width_zoom=0,game_height_zoom=0,auto_scale=!1,maintainAspectRatio=!0,maxWidth=1/0,maxHeight=1/0;return api.init=function(wrapperid,game_width,game_height,doublebuffering,scale,aspectRatio){if(!me.initialized)throw"melonJS: me.video.init() called before engine initialization.";if(double_buffering=doublebuffering||!1,auto_scale="auto"===scale||!1,maintainAspectRatio=aspectRatio!==void 0?aspectRatio:!0,scale="auto"!==scale?parseFloat(scale||1):1,me.sys.scale=new me.Vector2d(scale,scale),(auto_scale||1!==scale)&&(double_buffering=!0),game_width_zoom=game_width*me.sys.scale.x,game_height_zoom=game_height*me.sys.scale.y,window.addEventListener("resize",throttle(100,!1,function(event){me.event.publish(me.event.WINDOW_ONRESIZE,[event])}),!1),window.addEventListener("orientationchange",function(event){me.event.publish(me.event.WINDOW_ONORIENTATION_CHANGE,[event])},!1),me.event.subscribe(me.event.WINDOW_ONRESIZE,me.video.onresize.bind(me.video)),me.event.subscribe(me.event.WINDOW_ONORIENTATION_CHANGE,me.video.onresize.bind(me.video)),canvas=api.createCanvas(game_width_zoom,game_height_zoom,!0),wrapperid&&(wrapper=document.getElementById(wrapperid)),wrapper||(wrapper=document.body),wrapper.appendChild(canvas),!canvas.getContext)return!1;if(context2D=api.getContext2d(canvas),me.device.getPixelRatio()>1&&(canvas.style.width=canvas.width/me.device.getPixelRatio()+"px",canvas.style.height=canvas.height/me.device.getPixelRatio()+"px"),double_buffering?(backBufferCanvas=api.createCanvas(game_width,game_height,!1),backBufferContext2D=api.getContext2d(backBufferCanvas)):(backBufferCanvas=canvas,backBufferContext2D=context2D),window.getComputedStyle){var style=window.getComputedStyle(canvas,null);me.video.setMaxSize(parseInt(style.maxWidth,10),parseInt(style.maxHeight,10))}return me.video.onresize(null),me.game.init(),!0},api.getWrapper=function(){return wrapper},api.getWidth=function(){return backBufferCanvas.width},api.getPos=function(c){return c=c||canvas,c.getBoundingClientRect?c.getBoundingClientRect():{left:0,top:0}},api.getHeight=function(){return backBufferCanvas.height},api.setMaxSize=function(w,h){maxWidth=w||1/0,maxHeight=h||1/0},api.createCanvas=function(width,height,screencanvas){if(0===width||0===height)throw Error("melonJS: width or height was zero, Canvas could not be initialized !");var _canvas=document.createElement("canvas");return screencanvas===!0&&navigator.isCocoonJS&&me.device.android2!==!0&&(_canvas.screencanvas=!0),_canvas.width=width||backBufferCanvas.width,_canvas.height=height||backBufferCanvas.height,_canvas},api.getContext2d=function(canvas){var _context;return _context=navigator.isCocoonJS?canvas.getContext("2d",{antialias:me.sys.scalingInterpolation}):canvas.getContext("2d"),_context.canvas||(_context.canvas=canvas),me.video.setImageSmoothing(_context,me.sys.scalingInterpolation),_context},api.getScreenCanvas=function(){return canvas},api.getScreenContext=function(){return context2D},api.getSystemCanvas=function(){return backBufferCanvas},api.getSystemContext=function(){return backBufferContext2D},api.onresize=function(){var scaleX=1,scaleY=1;if(me.device.orientation=window.orientation!==void 0?window.orientation:window.outerWidth>window.outerHeight?90:0,auto_scale){var parent=me.video.getScreenCanvas().parentNode,_max_width=Math.min(maxWidth,parent.width||window.innerWidth),_max_height=Math.min(maxHeight,parent.height||window.innerHeight);if(maintainAspectRatio){var designRatio=me.video.getWidth()/me.video.getHeight(),screenRatio=_max_width/_max_height;scaleX=scaleY=designRatio>screenRatio?_max_width/me.video.getWidth():_max_height/me.video.getHeight()}else scaleX=_max_width/me.video.getWidth(),scaleY=_max_height/me.video.getHeight();if(scaleX*=me.device.getPixelRatio(),scaleY*=me.device.getPixelRatio(),1!==scaleX||1!==scaleY)return deferResizeId>=0&&clearTimeout(deferResizeId),deferResizeId=me.video.updateDisplaySize.defer(this,scaleX,scaleY),void 0}me.input._offset=me.video.getPos()},api.updateDisplaySize=function(scaleX,scaleY){me.sys.scale.set(scaleX,scaleY),canvas.width=game_width_zoom=backBufferCanvas.width*scaleX,canvas.height=game_height_zoom=backBufferCanvas.height*scaleY,me.device.getPixelRatio()>1&&(canvas.style.width=canvas.width/me.device.getPixelRatio()+"px",canvas.style.height=canvas.height/me.device.getPixelRatio()+"px"),me.video.setImageSmoothing(context2D,me.sys.scalingInterpolation),me.input._offset=me.video.getPos(),api.blitSurface(),deferResizeId=-1},api.clearSurface=function(context,col){var _canvas=context.canvas;context.save(),context.setTransform(1,0,0,1,0,0),context.fillStyle=col,context.fillRect(0,0,_canvas.width,_canvas.height),context.restore()},api.setImageSmoothing=function(context,enable){me.agent.setPrefixed("imageSmoothingEnabled",enable===!0,context)},api.setAlpha=function(context,enable){context.globalCompositeOperation=enable?"source-over":"copy"},api.blitSurface=function(){api.blitSurface=double_buffering?function(){context2D.drawImage(backBufferCanvas,0,0,backBufferCanvas.width,backBufferCanvas.height,0,0,game_width_zoom,game_height_zoom)}:function(){},api.blitSurface()},api.applyRGBFilter=function(object,effect,option){var _context=api.getContext2d(api.createCanvas(object.width,object.height,!1)),imgpix=me.utils.getPixels(object),pix=imgpix.data,i,n;switch(effect){case"b&w":for(i=0,n=pix.length;n>i;i+=4){var grayscale=3*pix[i]+4*pix[i+1]+pix[i+2]>>>3;pix[i]=grayscale,pix[i+1]=grayscale,pix[i+2]=grayscale}break;case"brightness":var brightness=Math.abs(option).clamp(0,1);for(i=0,n=pix.length;n>i;i+=4)pix[i]*=brightness,pix[i+1]*=brightness,pix[i+2]*=brightness;break;case"transparent":var refColor=me.pool.pull("me.Color").parseHex(option),pixel=me.pool.pull("me.Color");for(i=0,n=pix.length;n>i;i+=4)pixel.setColor(pix[i],pix[i+1],pix[i+2]),pixel.equals(refColor)&&(pix[i+3]=0);me.pool.push(refColor),me.pool.push(pixel);break;default:return null}return _context.putImageData(imgpix,0,0),_context},api}()}(),function(){me.input=function(){var obj={};return obj._preventDefault=function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,!1},obj.preventDefault=!0,obj}()}(),function(){var obj=me.input;obj._KeyBinding={};var keyStatus={},keyLock={},keyLocked={},keyRefs={},preventDefaultForKeys={},keyboardInitialized=!1;obj._enableKeyboardEvent=function(){keyboardInitialized||(window.addEventListener("keydown",obj._keydown,!1),window.addEventListener("keyup",obj._keyup,!1),keyboardInitialized=!0)},obj._keydown=function(e,keyCode,mouseButton){keyCode=keyCode||e.keyCode||e.which;var action=obj._KeyBinding[keyCode];if(me.event.publish(me.event.KEYDOWN,[action,keyCode,action?!keyLocked[action]:!0]),action){if(!keyLocked[action]){var trigger=mouseButton?mouseButton:keyCode;keyRefs[action][trigger]||(keyStatus[action]++,keyRefs[action][trigger]=!0)}return preventDefaultForKeys[keyCode]?obj._preventDefault(e):!0}return!0},obj._keyup=function(e,keyCode,mouseButton){keyCode=keyCode||e.keyCode||e.which;var action=obj._KeyBinding[keyCode];if(me.event.publish(me.event.KEYUP,[action,keyCode]),action){var trigger=mouseButton?mouseButton:keyCode;return keyRefs[action][trigger]=void 0,keyStatus[action]>0&&keyStatus[action]--,keyLocked[action]=!1,preventDefaultForKeys[keyCode]?obj._preventDefault(e):!0}return!0},obj.KEY={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,WINDOW_KEY:91,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWAND_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222},obj.isKeyPressed=function(action){return keyStatus[action]&&!keyLocked[action]?(keyLock[action]&&(keyLocked[action]=!0),!0):!1},obj.keyStatus=function(action){return keyStatus[action]>0},obj.triggerKeyEvent=function(keycode,status){status?obj._keydown({},keycode):obj._keyup({},keycode)},obj.bindKey=function(keycode,action,lock,preventDefault){obj._enableKeyboardEvent(),"boolean"!=typeof preventDefault&&(preventDefault=obj.preventDefault),obj._KeyBinding[keycode]=action,preventDefaultForKeys[keycode]=preventDefault,keyStatus[action]=0,keyLock[action]=lock?lock:!1,keyLocked[action]=!1,keyRefs[action]={}},obj.unlockKey=function(action){keyLocked[action]=!1},obj.unbindKey=function(keycode){var keybinding=obj._KeyBinding[keycode];keyStatus[keybinding]=0,keyLock[keybinding]=!1,keyRefs[keybinding]={},obj._KeyBinding[keycode]=null,preventDefaultForKeys[keycode]=null}}(),function(){function registerEventListener(eventList,callback){for(var x=2;eventList.length>x;++x)eventList[x]!==void 0&&me.video.getScreenCanvas().addEventListener(eventList[x],callback,!1)}function enablePointerEvent(){pointerInitialized||(changedTouches.push({x:0,y:0}),obj.mouse.pos=new me.Vector2d(0,0),obj._offset=me.video.getPos(),window.addEventListener("scroll",throttle(100,!1,function(e){obj._offset=me.video.getPos(),me.event.publish(me.event.WINDOW_ONSCROLL,[e])}),!1),activeEventList=navigator.pointerEnabled?pointerEventList:navigator.msPointerEnabled?MSPointerEventList:me.device.touch?touchEventList:mouseEventList,registerEventListener(activeEventList,onPointerEvent),wheeltype="onwheel"in document.createElement("div")?"wheel":"mousewheel",window.addEventListener(wheeltype,onMouseWheel,!1),obj.throttlingInterval===void 0&&(obj.throttlingInterval=Math.floor(1e3/me.sys.fps)),17>obj.throttlingInterval?me.video.getScreenCanvas().addEventListener(activeEventList[POINTER_MOVE],onMoveEvent,!1):me.video.getScreenCanvas().addEventListener(activeEventList[POINTER_MOVE],throttle(obj.throttlingInterval,!1,function(e){onMoveEvent(e)}),!1),pointerInitialized=!0)}function dispatchEvent(e){var handled=!1,handlers=evtHandlers[e.type];if(handlers||(handlers=activeEventList.indexOf(e.type)===POINTER_CANCEL?evtHandlers[activeEventList[POINTER_UP]]:evtHandlers[e.type]),handlers){me.game.viewport.localToWorld(0,0,viewportOffset);for(var t=0,l=changedTouches.length;l>t;t++){if(e.timeStamp!==void 0){if(lastTimeStamp>e.timeStamp)continue;lastTimeStamp=e.timeStamp}me.device.pointerEnabled||(e.pointerId=changedTouches[t].id),e.gameScreenX=changedTouches[t].x,e.gameScreenY=changedTouches[t].y,e.gameWorldX=e.gameScreenX+viewportOffset.x,e.gameWorldY=e.gameScreenY+viewportOffset.y;for(var i=handlers.length,handler;i--,handler=handlers[i];)if(handler.floating===!0?(e.gameX=e.gameScreenX,e.gameY=e.gameScreenY):(e.gameX=e.gameWorldX,e.gameY=e.gameWorldY),handler.bounds.containsPoint(e.gameX-handler.rect.pos.x,e.gameY-handler.rect.pos.y)&&handler.cb(e)===!1){handled=!0;break}}}return handled}function updateCoordFromEvent(event){var local;if(changedTouches.length=0,event.touches)for(var i=0,l=event.changedTouches.length;l>i;i++){var t=event.changedTouches[i];local=obj.globalToLocal(t.clientX,t.clientY),local.id=t.identifier,changedTouches.push(local)}else local=obj.globalToLocal(event.clientX,event.clientY),local.id=event.pointerId||1,changedTouches.push(local);event.isPrimary!==!1&&obj.mouse.pos.set(changedTouches[0].x,changedTouches[0].y)}function onMouseWheel(e){if(e.target===me.video.getScreenCanvas()){var _event={deltaMode:1,type:"mousewheel",deltaX:e.deltaX,deltaY:e.deltaY,deltaZ:e.deltaZ};if("mousewheel"===wheeltype&&(_event.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(_event.deltaX=-1/40*e.wheelDeltaX)),dispatchEvent(_event))return obj._preventDefault(e)}return!0}function onMoveEvent(e){return updateCoordFromEvent(e),dispatchEvent(e)?obj._preventDefault(e):!0}function onPointerEvent(e){if(updateCoordFromEvent(e),dispatchEvent(e))return obj._preventDefault(e);var button=e.button||0,keycode=obj.mouse.bind[button];return keycode?e.type===activeEventList[POINTER_DOWN]?obj._keydown(e,keycode,button+1):obj._keyup(e,keycode,button+1):!0}var obj=me.input,evtHandlers={},pointerInitialized=!1,wheeltype="mousewheel",lastTimeStamp=0,activeEventList=null,pointerEventList=["mousewheel","pointermove","pointerdown","pointerup","pointercancel",void 0,void 0],MSPointerEventList=["mousewheel","MSPointerMove","MSPointerDown","MSPointerUp","MSPointerCancel",void 0,void 0],mouseEventList=["mousewheel","mousemove","mousedown","mouseup",void 0,void 0,void 0],touchEventList=[void 0,"touchmove","touchstart","touchend","touchcancel",void 0,void 0],POINTER_MOVE=1,POINTER_DOWN=2,POINTER_UP=3,POINTER_CANCEL=4,viewportOffset=new me.Vector2d,changedTouches=[];obj._offset=null,obj.mouse={pos:null,LEFT:0,MIDDLE:1,RIGHT:2,bind:[0,0,0]},obj.throttlingInterval=void 0,obj.globalToLocal=function(x,y){var offset=obj._offset,pixelRatio=me.device.getPixelRatio();x-=offset.left,y-=offset.top;var scale=me.sys.scale;return(1!==scale.x||1!==scale.y)&&(x/=scale.x,y/=scale.y),new me.Vector2d(x*pixelRatio,y*pixelRatio)},obj.bindPointer=function(){var button=2>arguments.length?obj.mouse.LEFT:arguments[0],keyCode=2>arguments.length?arguments[0]:arguments[1];if(enablePointerEvent(),!obj._KeyBinding[keyCode])throw"melonJS : no action defined for keycode "+keyCode;obj.mouse.bind[button]=keyCode},obj.unbindPointer=function(button){obj.mouse.bind[button===void 0?me.input.mouse.LEFT:button]=null},obj.registerPointerEvent=function(eventType,rect,callback,floating){if(enablePointerEvent(),-1===pointerEventList.indexOf(eventType))throw"melonJS : invalid event type : "+eventType;pointerEventList!==activeEventList&&(eventType=activeEventList[pointerEventList.indexOf(eventType)]),evtHandlers[eventType]||(evtHandlers[eventType]=[]);var _float=rect.floating===!0?!0:!1;floating&&(_float=floating===!0?!0:!1);var bounds=rect.getBounds();rect.getShape===void 0&&bounds.translate(-rect.pos.x,-rect.pos.y),evtHandlers[eventType].push({rect:rect,bounds:bounds,cb:callback,floating:_float})},obj.releasePointerEvent=function(eventType,rect){if(-1===pointerEventList.indexOf(eventType))throw"melonJS : invalid event type : "+eventType;pointerEventList!==activeEventList&&(eventType=activeEventList[pointerEventList.indexOf(eventType)]),evtHandlers[eventType]||(evtHandlers[eventType]=[]);var handlers=evtHandlers[eventType];if(handlers)for(var i=handlers.length,handler;i--,handler=handlers[i];)handler.rect===rect&&(handler.rect=handler.bounds=handler.cb=handler.floating=null,evtHandlers[eventType].splice(i,1))},obj._translatePointerEvents=function(){obj.registerPointerEvent("pointermove",me.game.viewport,function(e){return me.event.publish(me.event.MOUSEMOVE,[e]),!1})}}(),function(){var Base64=function(){var singleton={},_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return singleton.decode=function(input){if(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,""),me.device.nativeBase64)return window.atob(input);for(var output=[],chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0;input.length>i;)enc1=_keyStr.indexOf(input.charAt(i++)),enc2=_keyStr.indexOf(input.charAt(i++)),enc3=_keyStr.indexOf(input.charAt(i++)),enc4=_keyStr.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,output.push(String.fromCharCode(chr1)),64!==enc3&&output.push(String.fromCharCode(chr2)),64!==enc4&&output.push(String.fromCharCode(chr3));return output=output.join("")},singleton}();me.utils=function(){var api={},GUID_base="",GUID_index=0,removepath=/^.*(\\|\/|\:)/,removeext=/\.[^\.]*$/;return api.decodeBase64=function(input){return Base64.decode(input)},api.decodeBase64AsArray=function(input,bytes){bytes=bytes||1;var dec=Base64.decode(input),i,j,len,ar;for(ar="function"==typeof window.Uint32Array?new Uint32Array(dec.length/bytes):[],i=0,len=dec.length/bytes;len>i;i++)for(ar[i]=0,j=bytes-1;j>=0;--j)ar[i]+=dec.charCodeAt(i*bytes+j)<<(j<<3);return ar},api.decompress=function(){throw"melonJS: GZIP/ZLIB compressed TMX Tile Map not supported!"},api.decodeCSV=function(input,limit){input=input.trim().split("\n");for(var result=[],i=0;input.length>i;i++)for(var entries=input[i].split(",",limit),e=0;entries.length>e;e++)result.push(+entries[e]);return result},api.getBasename=function(path){return path.replace(removepath,"").replace(removeext,"")},api.getFileExtension=function(path){return path.substring(path.lastIndexOf(".")+1,path.length)},api.getPixels=function(arg){if(arg instanceof HTMLImageElement){var _context=me.video.getContext2d(me.video.createCanvas(arg.width,arg.height));return _context.drawImage(arg,0,0),_context.getImageData(0,0,arg.width,arg.height)}return arg.getContext("2d").getImageData(0,0,arg.width,arg.height)},api.resetGUID=function(base){GUID_base=(""+base).toUpperCase().toHex(),GUID_index=0},api.createGUID=function(){return GUID_base+"-"+GUID_index++},api.applyFriction=function(v,f){return 0>v+f?v+f*me.timer.tick:v-f>0?v-f*me.timer.tick:0},api}()}(),function(){var cssToRGB={black:[0,0,0],silver:[192,192,129],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],orange:[255,165,0],aliceblue:[240,248,245],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,35],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],"darkgray[*]":[169,169,169],darkgreen:[0,100,0],"darkgrey[*]":[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]};
me.Color=Object.extend({r:0,g:0,b:0,alpha:1,init:function(r,g,b,a){return this.onResetEvent(r,g,b,a)},onResetEvent:function(r,g,b,a){return this.setColor(r,g,b,a)},setColor:function(r,g,b,a){return this.r=Math.floor(r||0).clamp(0,255),this.g=Math.floor(g||0).clamp(0,255),this.b=Math.floor(b||0).clamp(0,255),this.alpha=a===void 0?1:a.clamp(0,1),this},clone:function(){return me.pool.pull("me.Color",this.r,this.g,this.b,this.alpha)},add:function(color){return this.setColor(this.r+color.r,this.g+color.g,this.b+color.b,(this.alpha+color.alpha)/2)},darken:function(scale){return scale=scale.clamp(0,1),this.setColor(this.r*scale,this.g*scale,this.b*scale,this.alpha)},lighten:function(scale){return scale=scale.clamp(0,1),this.setColor(this.r+(255-this.r)*scale,this.g+(255-this.g)*scale,this.b+(255-this.b)*scale,this.alpha)},random:function(){return this.setColor(256*Math.random(),256*Math.random(),256*Math.random(),this.alpha)},equals:function(color){return this.r===color.r&&this.g===color.g&&this.b===color.b&&this.alpha===color.alpha},parseCSS:function(cssColor){return cssColor in cssToRGB?this.setColor.apply(this,cssToRGB[cssColor]):this.parseRGB(cssColor)},parseRGB:function(rgbColor){var start;if("rgba"===rgbColor.substring(0,4))start=5;else{if("rgb"!==rgbColor.substring(0,3))return this.parseHex(rgbColor);start=4}var color=rgbColor.slice(start,-1).split(/\s*,\s*/);return this.setColor.apply(this,color)},parseHex:function(hexColor){"#"===hexColor.charAt(0)&&(hexColor=hexColor.substring(1,hexColor.length));var r,g,b;return 6>hexColor.length?(r=parseInt(hexColor.charAt(0)+hexColor.charAt(0),16),g=parseInt(hexColor.charAt(1)+hexColor.charAt(1),16),b=parseInt(hexColor.charAt(2)+hexColor.charAt(2),16)):(r=parseInt(hexColor.substring(0,2),16),g=parseInt(hexColor.substring(2,4),16),b=parseInt(hexColor.substring(4,6),16)),this.setColor(r,g,b)},toHex:function(){return"#"+this.r.toHex()+this.g.toHex()+this.b.toHex()},toRGB:function(){return"rgb("+this.r+","+this.g+","+this.b+")"},toRGBA:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.alpha+")"}})}(),function(){me.save=function(){function isReserved(key){return"add"===key||"remove"===key}var data={},api={_init:function(){if(me.device.localStorage===!0){var keys=JSON.parse(localStorage.getItem("me.save"))||[];keys.forEach(function(key){data[key]=JSON.parse(localStorage.getItem("me.save."+key))})}},add:function(props){Object.keys(props).forEach(function(key){isReserved(key)||(function(prop){Object.defineProperty(api,prop,{configurable:!0,enumerable:!0,get:function(){return data[prop]},set:function(value){data[prop]=value,me.device.localStorage===!0&&localStorage.setItem("me.save."+prop,JSON.stringify(value))}})}(key),key in data||(api[key]=props[key]))}),me.device.localStorage===!0&&localStorage.setItem("me.save",JSON.stringify(Object.keys(data)))},remove:function(key){isReserved(key)||data[key]!==void 0&&(delete data[key],me.device.localStorage===!0&&(localStorage.removeItem("me.save."+key),localStorage.setItem("me.save",JSON.stringify(Object.keys(data)))))}};return api}()}(),function(){me.COLLISION_LAYER="collision",me.TMX_TAG_MAP="map",me.TMX_TAG_NAME="name",me.TMX_TAG_VALUE="value",me.TMX_TAG_VERSION="version",me.TMX_TAG_ORIENTATION="orientation",me.TMX_TAG_WIDTH="width",me.TMX_TAG_HEIGHT="height",me.TMX_TAG_TYPE="type",me.TMX_TAG_OPACITY="opacity",me.TMX_TAG_TRANS="trans",me.TMX_TAG_TILEWIDTH="tilewidth",me.TMX_TAG_TILEHEIGHT="tileheight",me.TMX_TAG_TILEOFFSET="tileoffset",me.TMX_TAG_FIRSTGID="firstgid",me.TMX_TAG_GID="gid",me.TMX_TAG_TILE="tile",me.TMX_TAG_ID="id",me.TMX_TAG_DATA="data",me.TMX_TAG_COMPRESSION="compression",me.TMX_TAG_GZIP="gzip",me.TMX_TAG_ZLIB="zlib",me.TMX_TAG_ENCODING="encoding",me.TMX_TAG_ATTR_BASE64="base64",me.TMX_TAG_CSV="csv",me.TMX_TAG_SPACING="spacing",me.TMX_TAG_MARGIN="margin",me.TMX_TAG_PROPERTIES="properties",me.TMX_TAG_PROPERTY="property",me.TMX_TAG_IMAGE="image",me.TMX_TAG_SOURCE="source",me.TMX_TAG_VISIBLE="visible",me.TMX_TAG_TILESET="tileset",me.TMX_TAG_LAYER="layer",me.TMX_TAG_TILE_LAYER="tilelayer",me.TMX_TAG_IMAGE_LAYER="imagelayer",me.TMX_TAG_OBJECTGROUP="objectgroup",me.TMX_TAG_OBJECT="object",me.TMX_TAG_X="x",me.TMX_TAG_Y="y",me.TMX_TAG_WIDTH="width",me.TMX_TAG_HEIGHT="height",me.TMX_TAG_POLYGON="polygon",me.TMX_TAG_POLYLINE="polyline",me.TMX_TAG_ELLIPSE="ellipse",me.TMX_TAG_POINTS="points",me.TMX_BACKGROUND_COLOR="backgroundcolor"}(),function(){me.TMXUtils=function(){function setTMXValue(value){if(!value||value.isBoolean())value=value?"true"===value:!0;else if(value.isNumeric())value=Number(value);else if(value.match(/^json:/i)){var match=value.split(/^json:/i)[1];try{value=JSON.parse(match)}catch(e){throw"Unable to parse JSON: "+match}}return value}var api={},parseAttributes=function(obj,elt){if(elt.attributes&&elt.attributes.length>0)for(var j=0;elt.attributes.length>j;j++){var attribute=elt.attributes.item(j);attribute.name!==void 0?obj[attribute.name]=setTMXValue(attribute.value):obj[attribute.nodeName]=setTMXValue(attribute.nodeValue)}};return api.parse=function(xml,draworder){var obj={},cacheValue="";if(draworder=draworder||1,1===xml.nodeType&&parseAttributes(obj,xml),xml.hasChildNodes()){for(var i=0;xml.childNodes.length>i;i++){var item=xml.childNodes.item(i),nodeName=item.nodeName;if(obj[nodeName]===void 0)if(3===item.nodeType){var value=item.nodeValue.trim();value&&value.length>0&&(cacheValue+=value)}else 1===item.nodeType&&(obj[nodeName]=me.TMXUtils.parse(item,draworder),obj[nodeName]._draworder=draworder++);else Array.isArray(obj[nodeName])===!1&&(obj[nodeName]=[obj[nodeName]]),obj[nodeName].push(me.TMXUtils.parse(item,draworder)),obj[nodeName][obj[nodeName].length-1]._draworder=draworder++}cacheValue.length>0&&(obj.value=cacheValue,cacheValue="")}return obj},api.applyTMXProperties=function(obj,data){var properties=data[me.TMX_TAG_PROPERTIES];if(properties!==void 0)if(properties.property!==void 0){var property=properties.property;Array.isArray(property)===!0?property.forEach(function(prop){obj[prop.name]=prop.value}):obj[property.name]=property.value}else for(var name in properties)properties.hasOwnProperty(name)&&(obj[name]=setTMXValue(properties[name]))},api}()}(),function(){me.TMXObjectGroup=Object.extend({name:null,width:0,height:0,z:0,objects:[],init:function(name,tmxObjGroup,tilesets,z){var self=this;this.name=name,this.width=tmxObjGroup[me.TMX_TAG_WIDTH],this.height=tmxObjGroup[me.TMX_TAG_HEIGHT],this.z=z,this.objects=[];var visible=tmxObjGroup[me.TMX_TAG_VISIBLE]!==void 0?tmxObjGroup[me.TMX_TAG_VISIBLE]:!0;this.opacity=visible===!0?parseFloat(tmxObjGroup[me.TMX_TAG_OPACITY]||1).clamp(0,1):0,me.TMXUtils.applyTMXProperties(this,tmxObjGroup);var _objects=tmxObjGroup.objects||tmxObjGroup.object;Array.isArray(_objects)===!0?_objects.forEach(function(tmxObj){self.objects.push(new me.TMXObject(tmxObj,tilesets,z))}):self.objects.push(new me.TMXObject(_objects,tilesets,z))},destroy:function(){this.objects=null},getObjectCount:function(){return this.objects.length},getObjectByIndex:function(idx){return this.objects[idx]}}),me.TMXObject=Object.extend({name:null,x:0,y:0,width:0,height:0,z:0,gid:void 0,type:void 0,isPolygon:!1,isPolyline:!1,points:void 0,init:function(tmxObj,tilesets,z){if(this.name=tmxObj[me.TMX_TAG_NAME],this.x=parseInt(tmxObj[me.TMX_TAG_X],10),this.y=parseInt(tmxObj[me.TMX_TAG_Y],10),this.z=parseInt(z,10),this.width=parseInt(tmxObj[me.TMX_TAG_WIDTH]||0,10),this.height=parseInt(tmxObj[me.TMX_TAG_HEIGHT]||0,10),this.gid=parseInt(tmxObj[me.TMX_TAG_GID],10)||null,this.type=tmxObj[me.TMX_TAG_TYPE],this.isEllipse=!1,this.isPolygon=!1,this.isPolyline=!1,this.gid)this.setImage(this.gid,tilesets);else if(tmxObj[me.TMX_TAG_ELLIPSE]!==void 0)this.isEllipse=!0;else{var points=tmxObj[me.TMX_TAG_POLYGON];if(points!==void 0?this.isPolygon=!0:(points=tmxObj[me.TMX_TAG_POLYLINE],points!==void 0&&(this.isPolyline=!0)),points!==void 0)if(this.points=[],points.points!==void 0){points=points.points.split(" ");for(var i=0,v;points.length>i;i++)v=points[i].split(","),this.points.push(new me.Vector2d(+v[0],+v[1]))}else{var self=this;points.forEach(function(point){self.points.push(new me.Vector2d(parseInt(point.x,10),parseInt(point.y,10)))})}}me.game.renderer.adjustPosition(this),me.TMXUtils.applyTMXProperties(this,tmxObj)},setImage:function(gid,tilesets){var tileset=tilesets.getTilesetByGid(this.gid);this.width=tileset.tilewidth,this.height=tileset.tileheight,this.spritewidth=this.width;var tmxTile=new me.Tile(this.x,this.y,tileset.tilewidth,tileset.tileheight,this.gid);this.image=tileset.getTileImage(tmxTile),this.name===void 0&&(this.name="TileObject")},getShape:function(){return this.isEllipse===!0?new me.Ellipse(new me.Vector2d(0,0),this.width,this.height):this.isPolygon===!0||this.isPolyline===!0?new me.PolyShape(new me.Vector2d(0,0),this.points,this.isPolygon):new me.Rect(new me.Vector2d(0,0),this.width,this.height)},getObjectPropertyByName:function(name){return this[name]}})}(),function(){var FlippedHorizontallyFlag=2147483648,FlippedVerticallyFlag=1073741824,FlippedAntiDiagonallyFlag=536870912;me.Tile=me.Rect.extend({tileId:null,tileset:null,transform:null,init:function(x,y,w,h,gid){this.parent(new me.Vector2d(x*w,y*h),w,h),this.col=x,this.row=y,this.tileId=gid,this.flipX=0!==(this.tileId&FlippedHorizontallyFlag),this.flipY=0!==(this.tileId&FlippedVerticallyFlag),this.flipAD=0!==(this.tileId&FlippedAntiDiagonallyFlag),this.flipped=this.flipX||this.flipY||this.flipAD,this.flipped===!0&&this.createTransform(),this.tileId&=~(FlippedHorizontallyFlag|FlippedVerticallyFlag|FlippedAntiDiagonallyFlag)},createTransform:function(){null===this.transform&&(this.transform=new me.Matrix2d),this.transform.identity(),this.flipAD&&(this.transform.set(0,1,1,0),this.transform.translate(0,this.height-this.width)),this.flipX&&(this.transform.a*=-1,this.transform.c*=-1,this.transform.translate(this.flipAD?this.height:this.width,0)),this.flipY&&(this.transform.b*=-1,this.transform.d*=-1,this.transform.translate(0,this.flipAD?this.width:this.height))}}),me.TMXTileset=Object.extend({type:{SOLID:"solid",PLATFORM:"platform",L_SLOPE:"lslope",R_SLOPE:"rslope",LADDER:"ladder",TOPLADDER:"topladder",BREAKABLE:"breakable"},TileProperties:[],tileXOffset:[],tileYOffset:[],init:function(tileset){this.firstgid=this.lastgid=tileset[me.TMX_TAG_FIRSTGID];var src=tileset[me.TMX_TAG_SOURCE];if(src&&"tsx"===me.utils.getFileExtension(src).toLowerCase()&&(src=me.utils.getBasename(src),tileset=me.loader.getTMX(src),!tileset))throw"melonJS:"+src+" TSX tileset not found";this.name=tileset[me.TMX_TAG_NAME],this.tilewidth=parseInt(tileset[me.TMX_TAG_TILEWIDTH],10),this.tileheight=parseInt(tileset[me.TMX_TAG_TILEHEIGHT],10),this.spacing=parseInt(tileset[me.TMX_TAG_SPACING]||0,10),this.margin=parseInt(tileset[me.TMX_TAG_MARGIN]||0,10),this.tileoffset=new me.Vector2d(0,0);var offset=tileset[me.TMX_TAG_TILEOFFSET];offset&&(this.tileoffset.x=parseInt(offset[me.TMX_TAG_X],10),this.tileoffset.y=parseInt(offset[me.TMX_TAG_Y],10));var tileInfo=tileset.tileproperties;if(tileInfo)for(var i in tileInfo)tileInfo.hasOwnProperty(i)&&this.setTileProperty(parseInt(i,10)+this.firstgid,tileInfo[i]);else if(tileset[me.TMX_TAG_TILE]){tileInfo=tileset[me.TMX_TAG_TILE],Array.isArray(tileInfo)||(tileInfo=[tileInfo]);for(var j=0;tileInfo.length>j;j++){var tileID=tileInfo[j][me.TMX_TAG_ID]+this.firstgid,prop={};me.TMXUtils.applyTMXProperties(prop,tileInfo[j]),this.setTileProperty(tileID,prop)}}var imagesrc="string"==typeof tileset[me.TMX_TAG_IMAGE]?tileset[me.TMX_TAG_IMAGE]:tileset[me.TMX_TAG_IMAGE].source;if(imagesrc=me.utils.getBasename(imagesrc),this.image=imagesrc?me.loader.getImage(imagesrc):null,this.image){this.hTileCount=~~((this.image.width-this.margin)/(this.tilewidth+this.spacing)),this.vTileCount=~~((this.image.height-this.margin)/(this.tileheight+this.spacing)),this.lastgid=this.firstgid+(this.hTileCount*this.vTileCount-1||0);var transparency=tileset[me.TMX_TAG_TRANS]||tileset[me.TMX_TAG_IMAGE][me.TMX_TAG_TRANS];transparency!==void 0&&(this.image=me.video.applyRGBFilter(this.image,"transparent",transparency.toUpperCase()).canvas)}else console.log("melonJS: '"+imagesrc+"' file for tileset '"+this.name+"' not found!")},setTileProperty:function(gid,prop){prop.isSolid=prop.type?prop.type.toLowerCase()===this.type.SOLID:!1,prop.isPlatform=prop.type?prop.type.toLowerCase()===this.type.PLATFORM:!1,prop.isLeftSlope=prop.type?prop.type.toLowerCase()===this.type.L_SLOPE:!1,prop.isRightSlope=prop.type?prop.type.toLowerCase()===this.type.R_SLOPE:!1,prop.isBreakable=prop.type?prop.type.toLowerCase()===this.type.BREAKABLE:!1,prop.isLadder=prop.type?prop.type.toLowerCase()===this.type.LADDER:!1,prop.isTopLadder=prop.type?prop.type.toLowerCase()===this.type.TOPLADDER:!1,prop.isSlope=prop.isLeftSlope||prop.isRightSlope,prop.isCollidable=!!prop.type,this.TileProperties[gid]=prop},contains:function(gid){return gid>=this.firstgid&&this.lastgid>=gid},getTileImage:function(tmxTile){var _context=me.video.getContext2d(me.video.createCanvas(this.tilewidth,this.tileheight));return this.drawTile(_context,0,0,tmxTile),_context.canvas},getTileProperties:function(tileId){return this.TileProperties[tileId]},isTileCollidable:function(tileId){return this.TileProperties[tileId].isCollidable},getTileOffsetX:function(tileId){var offset=this.tileXOffset[tileId];return offset===void 0&&(offset=this.tileXOffset[tileId]=this.margin+(this.spacing+this.tilewidth)*(tileId%this.hTileCount)),offset},getTileOffsetY:function(tileId){var offset=this.tileYOffset[tileId];return offset===void 0&&(offset=this.tileYOffset[tileId]=this.margin+(this.spacing+this.tileheight)*~~(tileId/this.hTileCount)),offset},drawTile:function(context,dx,dy,tmxTile){if(tmxTile.flipped){context.save();var transform=tmxTile.transform;context.transform(transform.a,transform.b,transform.c,transform.d,transform.e+dx,transform.f+dy),dx=dy=0}var tileid=tmxTile.tileId-this.firstgid;context.drawImage(this.image,this.getTileOffsetX(tileid),this.getTileOffsetY(tileid),this.tilewidth,this.tileheight,dx,dy,this.tilewidth,this.tileheight),tmxTile.flipped&&context.restore()}}),me.TMXTilesetGroup=Object.extend({init:function(){this.tilesets=[]},add:function(tileset){this.tilesets.push(tileset)},getTilesetByIndex:function(i){return this.tilesets[i]},getTilesetByGid:function(gid){for(var invalidRange=-1,i=0,len=this.tilesets.length;len>i;i++){if(this.tilesets[i].contains(gid))return this.tilesets[i];this.tilesets[i].firstgid===this.tilesets[i].lastgid&&gid>=this.tilesets[i].firstgid&&(invalidRange=i)}if(-1!==invalidRange)return this.tilesets[invalidRange];throw"no matching tileset found for gid "+gid}})}(),function(){me.TMXOrthogonalRenderer=Object.extend({init:function(cols,rows,tilewidth,tileheight){this.cols=cols,this.rows=rows,this.tilewidth=tilewidth,this.tileheight=tileheight},canRender:function(layer){return"orthogonal"===layer.orientation&&this.cols===layer.cols&&this.rows===layer.rows&&this.tilewidth===layer.tilewidth&&this.tileheight===layer.tileheight},pixelToTileCoords:function(x,y){return new me.Vector2d(x/this.tilewidth,y/this.tileheight)},tileToPixelCoords:function(x,y){return new me.Vector2d(x*this.tilewidth,y*this.tileheight)},adjustPosition:function(obj){"number"==typeof obj.gid&&(obj.y-=obj.height)},drawTile:function(context,x,y,tmxTile,tileset){tileset.drawTile(context,tileset.tileoffset.x+x*this.tilewidth,tileset.tileoffset.y+(y+1)*this.tileheight-tileset.tileheight,tmxTile)},drawTileLayer:function(context,layer,rect){var start=this.pixelToTileCoords(rect.pos.x,rect.pos.y).floorSelf(),end=this.pixelToTileCoords(rect.pos.x+rect.width+this.tilewidth,rect.pos.y+rect.height+this.tileheight).ceilSelf();end.x=end.x>this.cols?this.cols:end.x,end.y=end.y>this.rows?this.rows:end.y;for(var y=start.y;end.y>y;y++)for(var x=start.x;end.x>x;x++){var tmxTile=layer.layerData[x][y];tmxTile&&this.drawTile(context,x,y,tmxTile,tmxTile.tileset)}}}),me.TMXIsometricRenderer=Object.extend({init:function(cols,rows,tilewidth,tileheight){this.cols=cols,this.rows=rows,this.tilewidth=tilewidth,this.tileheight=tileheight,this.hTilewidth=tilewidth/2,this.hTileheight=tileheight/2,this.originX=this.rows*this.hTilewidth},canRender:function(layer){return"isometric"===layer.orientation&&this.cols===layer.cols&&this.rows===layer.rows&&this.tilewidth===layer.tilewidth&&this.tileheight===layer.tileheight},pixelToTileCoords:function(x,y){x-=this.originX;var tileY=y/this.tileheight,tileX=x/this.tilewidth;return new me.Vector2d(tileY+tileX,tileY-tileX)},tileToPixelCoords:function(x,y){return new me.Vector2d((x-y)*this.hTilewidth+this.originX,(x+y)*this.hTileheight)},adjustPosition:function(obj){var tilex=obj.x/this.hTilewidth,tiley=obj.y/this.tileheight,isoPos=this.tileToPixelCoords(tilex,tiley);isoPos.x-=obj.width/2,isoPos.y-=obj.height,obj.x=isoPos.x,obj.y=isoPos.y},drawTile:function(context,x,y,tmxTile,tileset){tileset.drawTile(context,(this.cols-1)*tileset.tilewidth+(x-y)*tileset.tilewidth>>1,-tileset.tilewidth+(x+y)*tileset.tileheight>>2,tmxTile)},drawTileLayer:function(context,layer,rect){var tileset=layer.tileset,offset=tileset.tileoffset,rowItr=this.pixelToTileCoords(rect.pos.x-tileset.tilewidth,rect.pos.y-tileset.tileheight).floorSelf(),TileEnd=this.pixelToTileCoords(rect.pos.x+rect.width+tileset.tilewidth,rect.pos.y+rect.height+tileset.tileheight).ceilSelf(),rectEnd=this.tileToPixelCoords(TileEnd.x,TileEnd.y),startPos=this.tileToPixelCoords(rowItr.x,rowItr.y);startPos.x-=this.hTilewidth,startPos.y+=this.tileheight;var inUpperHalf=startPos.y-rect.pos.y>this.hTileheight,inLeftHalf=rect.pos.x-startPos.x<this.hTilewidth;inUpperHalf&&(inLeftHalf?(rowItr.x--,startPos.x-=this.hTilewidth):(rowItr.y--,startPos.x+=this.hTilewidth),startPos.y-=this.hTileheight);for(var shifted=inUpperHalf^inLeftHalf,columnItr=rowItr.clone(),y=startPos.y;y-this.tileheight<rectEnd.y;y+=this.hTileheight){columnItr.setV(rowItr);for(var x=startPos.x;rectEnd.x>x;x+=this.tilewidth){if(columnItr.x>=0&&columnItr.y>=0&&columnItr.x<this.cols&&columnItr.y<this.rows){var tmxTile=layer.layerData[columnItr.x][columnItr.y];tmxTile&&(tileset=tmxTile.tileset,offset=tileset.tileoffset,tileset.drawTile(context,offset.x+x,offset.y+y-tileset.tileheight,tmxTile))}columnItr.x++,columnItr.y--}shifted?(rowItr.y++,startPos.x-=this.hTilewidth,shifted=!1):(rowItr.x++,startPos.x+=this.hTilewidth,shifted=!0)}}})}(),function(){me.ColorLayer=me.Renderable.extend({init:function(name,color,z){this.parent(new me.Vector2d(0,0),1/0,1/0),this.name=name,this.color=color,this.z=z},draw:function(context,rect){var _alpha=context.globalAlpha;context.globalAlpha*=this.getOpacity(),context.fillStyle=this.color,context.fillRect(rect.left,rect.top,rect.width,rect.height),context.globalAlpha=_alpha}}),me.ImageLayer=me.Renderable.extend({init:function(name,width,height,imagesrc,z,ratio){if(this.name=name,this.image=imagesrc?me.loader.getImage(me.utils.getBasename(imagesrc)):null,!this.image)throw"melonJS: '"+imagesrc+"' file for Image Layer '"+this.name+"' not found!";this.imagewidth=this.image.width,this.imageheight=this.image.height;var viewport=me.game.viewport;width=width?Math.min(viewport.width,width):viewport.width,height=height?Math.min(viewport.height,height):viewport.height,this.parent(new me.Vector2d(0,0),width,height),this.z=z,this.ratio=new me.Vector2d(1,1),ratio!==void 0&&("number"==typeof ratio?this.ratio.set(ratio,ratio):this.ratio.setV(ratio)),this.lastpos=viewport.pos.clone(),this.floating=!0,this._repeat="repeat",this.repeatX=!0,this.repeatY=!0,Object.defineProperty(this,"repeat",{get:function get(){return this._repeat},set:function set(val){switch(this._repeat=val,this._repeat){case"no-repeat":this.repeatX=!1,this.repeatY=!1;break;case"repeat-x":this.repeatX=!0,this.repeatY=!1;break;case"repeat-y":this.repeatX=!1,this.repeatY=!0;break;default:this.repeatX=!0,this.repeatY=!0}}}),this.anchorPoint.set(0,0),this.handle=me.event.subscribe(me.event.VIEWPORT_ONCHANGE,this.updateLayer.bind(this))},updateLayer:function(vpos){(0!==this.ratio.x||0!==this.ratio.y)&&(this.repeatX||this.repeatY?(this.pos.x+=(vpos.x-this.lastpos.x)*this.ratio.x%this.imagewidth,this.pos.x=(this.imagewidth+this.pos.x)%this.imagewidth,this.pos.y+=(vpos.y-this.lastpos.y)*this.ratio.y%this.imageheight,this.pos.y=(this.imageheight+this.pos.y)%this.imageheight):(this.pos.x+=(vpos.x-this.lastpos.x)*this.ratio.x,this.pos.y+=(vpos.y-this.lastpos.y)*this.ratio.y),this.lastpos.setV(vpos))},draw:function(context,rect){var viewport=me.game.viewport,shouldTranslate=0!==this.anchorPoint.y||0!==this.anchorPoint.x,translateX=~~(this.anchorPoint.x*(viewport.width-this.imagewidth)),translateY=~~(this.anchorPoint.y*(viewport.height-this.imageheight));shouldTranslate&&context.translate(translateX,translateY),context.globalAlpha*=this.getOpacity();var sw,sh;if(0===this.ratio.x&&0===this.ratio.y)sw=Math.min(rect.width,this.imagewidth),sh=Math.min(rect.height,this.imageheight),context.drawImage(this.image,rect.left,rect.top,sw,sh,rect.left,rect.top,sw,sh);else{var sx=~~this.pos.x,sy=~~this.pos.y,dx=0,dy=0;for(sw=Math.min(this.imagewidth-sx,this.width),sh=Math.min(this.imageheight-sy,this.height);;){do context.drawImage(this.image,sx,sy,sw,sh,dx,dy,sw,sh),sy=0,dy+=sh,sh=Math.min(this.imageheight,this.height-dy);while(this.repeatY&&this.height>dy);if(dx+=sw,!this.repeatX||dx>=this.width)break;sx=0,sw=Math.min(this.imagewidth,this.width-dx),sy=~~this.pos.y,dy=0,sh=Math.min(this.imageheight-~~this.pos.y,this.height)}}shouldTranslate&&context.translate(-translateX,-translateY)},destroy:function(){this.handle&&(me.event.unsubscribe(this.handle),this.handle=null),this.image=null,this.lastpos=null}}),me.CollisionTiledLayer=me.Renderable.extend({init:function(width,height){this.parent(new me.Vector2d(0,0),width,height),this.isCollisionMap=!0},checkCollision:function(obj,pv){var x=0>pv.x?obj.left+pv.x:obj.right+pv.x,y=0>pv.y?obj.top+pv.y:obj.bottom+pv.y,res={x:0,y:0,xprop:{},yprop:{}};return(0>=x||x>=this.width)&&(res.x=pv.x),(0>=y||y>=this.height)&&(res.y=pv.y),res}}),me.TMXLayer=me.Renderable.extend({layerData:null,init:function(tilewidth,tileheight,orientation,tilesets,zOrder){this.parent(new me.Vector2d(0,0),0,0),this.tilewidth=tilewidth,this.tileheight=tileheight,this.orientation=orientation,this.tilesets=tilesets,this.tileset=this.tilesets?this.tilesets.getTilesetByIndex(0):null,this.z=zOrder},initFromJSON:function(layer){this.name=layer[me.TMX_TAG_NAME],this.cols=parseInt(layer[me.TMX_TAG_WIDTH],10),this.rows=parseInt(layer[me.TMX_TAG_HEIGHT],10);var visible=layer[me.TMX_TAG_VISIBLE]!==void 0?layer[me.TMX_TAG_VISIBLE]:!0;this.setOpacity(visible?parseFloat(layer[me.TMX_TAG_OPACITY]):0),this.width=this.cols*this.tilewidth,this.height=this.rows*this.tileheight,me.TMXUtils.applyTMXProperties(this,layer),this.preRender===void 0&&(this.preRender=me.sys.preRender),this.isCollisionMap=this.name.toLowerCase().contains(me.COLLISION_LAYER),this.isCollisionMap===!0&&this.setOpacity(0),this.preRender===!0&&(this.layerCanvas=me.video.createCanvas(this.cols*this.tilewidth,this.rows*this.tileheight),this.layerSurface=me.video.getContext2d(this.layerCanvas))},destroy:function(){this.preRender&&(this.layerCanvas=null,this.layerSurface=null),this.renderer=null,this.layerData=null,this.tileset=null,this.tilesets=null},setRenderer:function(renderer){this.renderer=renderer},initArray:function(w,h){this.layerData=[];for(var x=0;w>x;x++){this.layerData[x]=[];for(var y=0;h>y;y++)this.layerData[x][y]=null}},getTileId:function(x,y){var tile=this.getTile(x,y);return tile?tile.tileId:null},getTile:function(x,y){return this.layerData[~~(x/this.tilewidth)][~~(y/this.tileheight)]},setTile:function(x,y,tileId){var tile=new me.Tile(x,y,this.tilewidth,this.tileheight,tileId);return tile.tileset=this.tileset.contains(tile.tileId)?this.tileset:this.tileset=this.tilesets.getTilesetByGid(tile.tileId),this.layerData[x][y]=tile,tile},clearTile:function(x,y){this.layerData[x][y]=null,this.preRender&&this.layerSurface.clearRect(x*this.tilewidth,y*this.tileheight,this.tilewidth,this.tileheight)},checkCollision:function(obj,pv){var x=0>pv.x?~~(obj.left+pv.x):Math.ceil(obj.right-1+pv.x),y=0>pv.y?~~(obj.top+pv.y):Math.ceil(obj.bottom-1+pv.y),res={x:0,xtile:void 0,xprop:{},y:0,ytile:void 0,yprop:{}};return 0>=x||x>=this.width?res.x=pv.x:0!==pv.x&&(res.xtile=this.getTile(x,Math.ceil(obj.bottom-1)),res.xtile&&this.tileset.isTileCollidable(res.xtile.tileId)?(res.x=pv.x,res.xprop=this.tileset.getTileProperties(res.xtile.tileId)):(res.xtile=this.getTile(x,~~obj.top),res.xtile&&this.tileset.isTileCollidable(res.xtile.tileId)&&(res.x=pv.x,res.xprop=this.tileset.getTileProperties(res.xtile.tileId)))),res.ytile=this.getTile(0>pv.x?~~obj.left:Math.ceil(obj.right-1),y),res.ytile&&this.tileset.isTileCollidable(res.ytile.tileId)?(res.y=pv.y||1,res.yprop=this.tileset.getTileProperties(res.ytile.tileId)):(res.ytile=this.getTile(0>pv.x?Math.ceil(obj.right-1):~~obj.left,y),res.ytile&&this.tileset.isTileCollidable(res.ytile.tileId)&&(res.y=pv.y||1,res.yprop=this.tileset.getTileProperties(res.ytile.tileId))),res},draw:function(context,rect){if(this.preRender){var width=Math.min(rect.width,this.width),height=Math.min(rect.height,this.height);this.layerSurface.globalAlpha=context.globalAlpha*this.getOpacity(),this.layerSurface.globalAlpha>0&&context.drawImage(this.layerCanvas,rect.pos.x,rect.pos.y,width,height,rect.pos.x,rect.pos.y,width,height)}else{var _alpha=context.globalAlpha;context.globalAlpha*=this.getOpacity(),context.globalAlpha>0&&this.renderer.drawTileLayer(context,this,rect),context.globalAlpha=_alpha}}})}(),function(){me.TMXTileMap=me.Renderable.extend({init:function(levelId){this.levelId=levelId,this.z=0,this.name=null,this.cols=0,this.rows=0,this.tilewidth=0,this.tileheight=0,this.tilesets=null,this.mapLayers=[],this.objectGroups=[],this.version="",this.orientation="",this.tilesets=null,this.initialized=!1,this.parent(new me.Vector2d,0,0)},getObjectGroupByName:function(name){var objectGroup=null;name=name.trim().toLowerCase();for(var i=this.objectGroups.length;i--;)if(this.objectGroups[i].name.toLowerCase().contains(name)){objectGroup=this.objectGroups[i];break}return objectGroup},getObjectGroups:function(){return this.objectGroups},getLayers:function(){return this.mapLayers},getLayerByName:function(name){var layer=null;name=name.trim().toLowerCase();for(var i=this.mapLayers.length;i--;)if(this.mapLayers[i].name.toLowerCase().contains(name)){layer=this.mapLayers[i];break}return name.toLowerCase().contains(me.COLLISION_LAYER)&&null==layer&&(layer=new me.CollisionTiledLayer(me.game.currentLevel.width,me.game.currentLevel.height)),layer},clearTile:function(x,y){for(var i=this.mapLayers.length;i--;)this.mapLayers[i]instanceof me.TMXLayer&&this.mapLayers[i].clearTile(x,y)},destroy:function(){var i;if(this.initialized===!0){for(i=this.mapLayers.length;i--;)this.mapLayers[i]=null;for(i=this.objectGroups.length;i--;)this.objectGroups[i].destroy(),this.objectGroups[i]=null;this.tilesets=null,this.mapLayers.length=0,this.objectGroups.length=0,this.pos.set(0,0),this.initialized=!1}}})}(),function(){me.TMXMapReader=Object.extend({JSONReader:null,readMap:function(map){if(!map.initialized){if(null===this.JSONReader&&(this.JSONReader=new JSONMapReader),this.JSONReader.readJSONMap(map,me.loader.getTMX(map.levelId)),map.width<me.game.viewport.width||map.height<me.game.viewport.height){var shiftX=~~((me.game.viewport.width-map.width)/2),shiftY=~~((me.game.viewport.height-map.height)/2);map.pos.add({x:shiftX>0?shiftX:0,y:shiftY>0?shiftY:0})}map.initialized=!0}},getNewDefaultRenderer:function(obj){switch(obj.orientation){case"orthogonal":return new me.TMXOrthogonalRenderer(obj.cols,obj.rows,obj.tilewidth,obj.tileheight);case"isometric":return new me.TMXIsometricRenderer(obj.cols,obj.rows,obj.tilewidth,obj.tileheight);default:throw"melonJS: "+obj.orientation+" type TMX Tile Map not supported!"}},setLayerData:function(layer,rawdata,encoding,compression){layer.initArray(layer.cols,layer.rows);var data=Array.isArray(rawdata)===!0?rawdata:rawdata.value;switch(encoding){case"json":data=rawdata;break;case me.TMX_TAG_CSV:case me.TMX_TAG_ATTR_BASE64:encoding===me.TMX_TAG_CSV?data=me.utils.decodeCSV(data,layer.cols):(data=me.utils.decodeBase64AsArray(data,4),null!==compression&&(data=me.utils.decompress(data,compression)));break;default:throw"melonJS: TMX Tile Map "+encoding+" encoding not supported!"}for(var idx=0,y=0;layer.rows>y;y++)for(var x=0;layer.cols>x;x++){var gid=null==encoding?this.TMXParser.getIntAttribute(data[idx++],me.TMX_TAG_GID):data[idx++];if(0!==gid){var tile=layer.setTile(x,y,gid);layer.preRender&&layer.renderer.drawTile(layer.layerSurface,x,y,tile,tile.tileset)}}}});var JSONMapReader=me.TMXMapReader.extend({readJSONMap:function(map,data){if(!data)throw"melonJS:"+map.levelId+" TMX map not found";var zOrder=0,self=this;map.version=data[me.TMX_TAG_VERSION],map.orientation=data[me.TMX_TAG_ORIENTATION],map.cols=parseInt(data[me.TMX_TAG_WIDTH],10),map.rows=parseInt(data[me.TMX_TAG_HEIGHT],10),map.tilewidth=parseInt(data[me.TMX_TAG_TILEWIDTH],10),map.tileheight=parseInt(data[me.TMX_TAG_TILEHEIGHT],10),map.width=map.cols*map.tilewidth,map.height=map.rows*map.tileheight,map.backgroundcolor=data[me.TMX_BACKGROUND_COLOR],map.z=zOrder++,me.TMXUtils.applyTMXProperties(map,data),map.backgroundcolor&&map.mapLayers.push(new me.ColorLayer("background_color",map.backgroundcolor,zOrder++)),map.background_image&&map.mapLayers.push(new me.ImageLayer("background_image",map.width,map.height,map.background_image,zOrder++)),null!==me.game.renderer&&me.game.renderer.canRender(map)||(me.game.renderer=this.getNewDefaultRenderer(map)),map.tilesets||(map.tilesets=new me.TMXTilesetGroup);var tilesets=data.tilesets||data.tileset;if(Array.isArray(tilesets)===!0?tilesets.forEach(function(tileset){map.tilesets.add(self.readTileset(tileset))}):map.tilesets.add(self.readTileset(tilesets)),data.layers!==void 0)data.layers.forEach(function(layer){switch(layer.type){case me.TMX_TAG_IMAGE_LAYER:map.mapLayers.push(self.readImageLayer(map,layer,zOrder++));break;case me.TMX_TAG_TILE_LAYER:map.mapLayers.push(self.readLayer(map,layer,zOrder++));break;case me.TMX_TAG_OBJECTGROUP:map.objectGroups.push(self.readObjectGroup(map,layer,zOrder++));break;default:}});else if(data.layer!==void 0){var layers=data.layer;if(Array.isArray(layers)===!0?layers.forEach(function(layer){map.mapLayers.push(self.readLayer(map,layer,layer._draworder))}):map.mapLayers.push(self.readLayer(map,layers,layers._draworder)),data[me.TMX_TAG_OBJECTGROUP]!==void 0){var groups=data[me.TMX_TAG_OBJECTGROUP];Array.isArray(groups)===!0?groups.forEach(function(group){map.objectGroups.push(self.readObjectGroup(map,group,group._draworder))}):map.objectGroups.push(self.readObjectGroup(map,groups,groups._draworder))}if(data[me.TMX_TAG_IMAGE_LAYER]!==void 0){var imageLayers=data[me.TMX_TAG_IMAGE_LAYER];Array.isArray(imageLayers)===!0?imageLayers.forEach(function(imageLayer){map.mapLayers.push(self.readImageLayer(map,imageLayer,imageLayer._draworder))}):map.mapLayers.push(self.readImageLayer(map,imageLayers,imageLayers._draworder))}}},readLayer:function(map,data,z){var layer=new me.TMXLayer(map.tilewidth,map.tileheight,map.orientation,map.tilesets,z);layer.initFromJSON(data),me.game.renderer.canRender(layer)?layer.setRenderer(me.game.renderer):layer.setRenderer(me.mapReader.getNewDefaultRenderer(layer));var encoding=Array.isArray(data[me.TMX_TAG_DATA])?data[me.TMX_TAG_ENCODING]:data[me.TMX_TAG_DATA][me.TMX_TAG_ENCODING];return this.setLayerData(layer,data[me.TMX_TAG_DATA],encoding||"json",null),layer},readImageLayer:function(map,data,z){var iln=data[me.TMX_TAG_NAME],ilw=parseInt(data[me.TMX_TAG_WIDTH],10),ilh=parseInt(data[me.TMX_TAG_HEIGHT],10),ilsrc="string"!=typeof data[me.TMX_TAG_IMAGE]?data[me.TMX_TAG_IMAGE].source:data[me.TMX_TAG_IMAGE],imageLayer=new me.ImageLayer(iln,ilw*map.tilewidth,ilh*map.tileheight,ilsrc,z),visible=data[me.TMX_TAG_VISIBLE]!==void 0?data[me.TMX_TAG_VISIBLE]:!0;return imageLayer.setOpacity(visible===!0?parseFloat(data[me.TMX_TAG_OPACITY]||1).clamp(0,1):0),me.TMXUtils.applyTMXProperties(imageLayer,data),"number"==typeof imageLayer.ratio&&(imageLayer.ratio=new me.Vector2d(parseFloat(imageLayer.ratio),parseFloat(imageLayer.ratio))),imageLayer
},readTileset:function(data){return new me.TMXTileset(data)},readObjectGroup:function(map,data,z){return new me.TMXObjectGroup(data[me.TMX_TAG_NAME],data,map.tilesets,z)}})}(),function(){me.levelDirector=function(){var obj={},levels={},levelIdx=[],currentLevelIdx=0,loadTMXLevel=function(level,container){container.autoSort=!1,me.game.currentLevel=level,me.game.collisionMap=me.game.currentLevel.getLayerByName("collision"),me.game.collisionMap&&me.game.collisionMap.isCollisionMap||console.error("WARNING : no collision map detected");for(var layers=level.getLayers(),i=layers.length;i--;)container.addChild(layers[i]);me.game.viewport.setBounds(0,0,Math.max(level.width,me.game.viewport.width),Math.max(level.height,me.game.viewport.height));for(var targetContainer=container,objectGroups=level.getObjectGroups(),g=0;objectGroups.length>g;g++){var group=objectGroups[g];me.game.mergeGroup===!1&&(targetContainer=new me.ObjectContainer,targetContainer.name=group.name,targetContainer.z=group.z,targetContainer.setOpacity(group.opacity),targetContainer.autoSort=!1);for(var o=0;group.objects.length>o;o++){var settings=group.objects[o],obj=me.pool.pull(settings.name,settings.x,settings.y,"TileObject"===settings.name?settings.image:settings);obj&&(obj.z=group.z,me.game.mergeGroup===!0&&obj.isRenderable===!0&&(obj.setOpacity(obj.getOpacity()*group.opacity),obj.renderable instanceof me.Renderable&&obj.renderable.setOpacity(obj.renderable.getOpacity()*group.opacity)),targetContainer.addChild(obj))}me.game.mergeGroup===!1&&(container.addChild(targetContainer),targetContainer.autoSort=!0)}container.sort(!0),container.autoSort=!0,me.game.world.transform.translateV(me.game.currentLevel.pos),me.game.onLevelLoaded&&me.game.onLevelLoaded.call(me.game.onLevelLoaded,level.name),me.event.publish(me.event.LEVEL_LOADED,[level.name])};return obj.reset=function(){},obj.addLevel=function(){throw"melonJS: no level loader defined"},obj.addTMXLevel=function(levelId,callback){return null!=levels[levelId]?!1:(levels[levelId]=new me.TMXTileMap(levelId),levels[levelId].name=levelId,levelIdx.push(levelId),callback&&callback(),!0)},obj.loadLevel=function(levelId){if(levelId=(""+levelId).toLowerCase(),levels[levelId]===void 0)throw"melonJS: level "+levelId+" not found";if(!(levels[levelId]instanceof me.TMXTileMap))throw"melonJS: no level loader defined";var wasRunning=me.state.isRunning();return wasRunning&&me.state.stop(),me.game.reset(),me.utils.resetGUID(levelId),levels[obj.getCurrentLevelId()]&&levels[obj.getCurrentLevelId()].destroy(),me.mapReader.readMap(levels[levelId]),currentLevelIdx=levelIdx.indexOf(levelId),loadTMXLevel(levels[levelId],me.game.world),wasRunning&&me.state.restart.defer(this),!0},obj.getCurrentLevelId=function(){return levelIdx[currentLevelIdx]},obj.reloadLevel=function(){return obj.loadLevel(obj.getCurrentLevelId())},obj.nextLevel=function(){return levelIdx.length>currentLevelIdx+1?obj.loadLevel(levelIdx[currentLevelIdx+1]):!1},obj.previousLevel=function(){return currentLevelIdx-1>=0?obj.loadLevel(levelIdx[currentLevelIdx-1]):!1},obj.levelCount=function(){return levelIdx.length},obj}()}(),function(){me.Tween=function(object){var _object=object,_valuesStart={},_valuesEnd={},_valuesStartRepeat={},_duration=1e3,_repeat=0,_yoyo=!1,_reversed=!1,_delayTime=0,_startTime=null,_easingFunction=me.Tween.Easing.Linear.None,_interpolationFunction=me.Tween.Interpolation.Linear,_chainedTweens=[],_onStartCallback=null,_onStartCallbackFired=!1,_onUpdateCallback=null,_onCompleteCallback=null;for(var field in object)_valuesStart[field]=parseFloat(object[field],10);this.onResetEvent=function(object){_object=object,_valuesStart={},_valuesEnd={},_valuesStartRepeat={},_easingFunction=me.Tween.Easing.Linear.None,_interpolationFunction=me.Tween.Interpolation.Linear,_yoyo=!1,_reversed=!1,_duration=1e3,_delayTime=0,_onStartCallback=null,_onStartCallbackFired=!1,_onUpdateCallback=null,_onCompleteCallback=null},this.to=function(properties,duration){return void 0!==duration&&(_duration=duration),_valuesEnd=properties,this},this.start=function(time){_onStartCallbackFired=!1,me.game.world.addChild(this),_startTime=(time===void 0?me.timer.getTime():time)+_delayTime;for(var property in _valuesEnd){if(_valuesEnd[property]instanceof Array){if(0===_valuesEnd[property].length)continue;_valuesEnd[property]=[_object[property]].concat(_valuesEnd[property])}_valuesStart[property]=_object[property],_valuesStart[property]instanceof Array==!1&&(_valuesStart[property]*=1),_valuesStartRepeat[property]=_valuesStart[property]||0}return this},this.stop=function(){return me.game.world.hasChild(this)&&me.game.world.removeChildNow(this),this},this.delay=function(amount){return _delayTime=amount,this},me.event.subscribe(me.event.STATE_RESUME,function onResume(elapsed){_startTime&&(_startTime+=elapsed)}),this.repeat=function(times){return _repeat=times,this},this.yoyo=function(yoyo){return _yoyo=yoyo,this},this.easing=function(easing){if("function"!=typeof easing)throw"melonJS: invalid easing function for me.Tween.easing()";return _easingFunction=easing,this},this.interpolation=function(interpolation){return _interpolationFunction=interpolation,this},this.chain=function(){return _chainedTweens=arguments,this},this.onStart=function(callback){return _onStartCallback=callback,this},this.onUpdate=function(callback){return _onUpdateCallback=callback,this},this.onComplete=function(callback){return _onCompleteCallback=callback,this},this.update=function(dt){var time=me.timer.getTime(),property;if(_startTime>time)return!0;_onStartCallbackFired===!1&&(null!==_onStartCallback&&_onStartCallback.call(_object),_onStartCallbackFired=!0);var elapsed=(time-_startTime)/_duration;elapsed=elapsed>1?1:elapsed;var value=_easingFunction(elapsed);for(property in _valuesEnd){var start=_valuesStart[property]||0,end=_valuesEnd[property];end instanceof Array?_object[property]=_interpolationFunction(end,value):("string"==typeof end&&(end=start+parseFloat(end,10)),"number"==typeof end&&(_object[property]=start+(end-start)*value))}if(null!==_onUpdateCallback&&_onUpdateCallback.call(_object,value),1===elapsed){if(_repeat>0){isFinite(_repeat)&&_repeat--;for(property in _valuesStartRepeat){if("string"==typeof _valuesEnd[property]&&(_valuesStartRepeat[property]=_valuesStartRepeat[property]+parseFloat(_valuesEnd[property],10)),_yoyo){var tmp=_valuesStartRepeat[property];_valuesStartRepeat[property]=_valuesEnd[property],_valuesEnd[property]=tmp,_reversed=!_reversed}_valuesStart[property]=_valuesStartRepeat[property]}return _startTime=time+_delayTime,!0}me.game.world.removeChildNow(this),null!==_onCompleteCallback&&_onCompleteCallback.call(_object);for(var i=0,numChainedTweens=_chainedTweens.length;numChainedTweens>i;i++)_chainedTweens[i].start(time);return!1}return!0}},me.Tween.Easing={Linear:{None:function(k){return k}},Quadratic:{In:function(k){return k*k},Out:function(k){return k*(2-k)},InOut:function(k){return 1>(k*=2)?.5*k*k:-.5*(--k*(k-2)-1)}},Cubic:{In:function(k){return k*k*k},Out:function(k){return--k*k*k+1},InOut:function(k){return 1>(k*=2)?.5*k*k*k:.5*((k-=2)*k*k+2)}},Quartic:{In:function(k){return k*k*k*k},Out:function(k){return 1- --k*k*k*k},InOut:function(k){return 1>(k*=2)?.5*k*k*k*k:-.5*((k-=2)*k*k*k-2)}},Quintic:{In:function(k){return k*k*k*k*k},Out:function(k){return--k*k*k*k*k+1},InOut:function(k){return 1>(k*=2)?.5*k*k*k*k*k:.5*((k-=2)*k*k*k*k+2)}},Sinusoidal:{In:function(k){return 1-Math.cos(k*Math.PI/2)},Out:function(k){return Math.sin(k*Math.PI/2)},InOut:function(k){return.5*(1-Math.cos(Math.PI*k))}},Exponential:{In:function(k){return 0===k?0:Math.pow(1024,k-1)},Out:function(k){return 1===k?1:1-Math.pow(2,-10*k)},InOut:function(k){return 0===k?0:1===k?1:1>(k*=2)?.5*Math.pow(1024,k-1):.5*(-Math.pow(2,-10*(k-1))+2)}},Circular:{In:function(k){return 1-Math.sqrt(1-k*k)},Out:function(k){return Math.sqrt(1- --k*k)},InOut:function(k){return 1>(k*=2)?-.5*(Math.sqrt(1-k*k)-1):.5*(Math.sqrt(1-(k-=2)*k)+1)}},Elastic:{In:function(k){var s,a=.1,p=.4;return 0===k?0:1===k?1:(!a||1>a?(a=1,s=p/4):s=p*Math.asin(1/a)/(2*Math.PI),-(a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*2*Math.PI/p)))},Out:function(k){var s,a=.1,p=.4;return 0===k?0:1===k?1:(!a||1>a?(a=1,s=p/4):s=p*Math.asin(1/a)/(2*Math.PI),a*Math.pow(2,-10*k)*Math.sin((k-s)*2*Math.PI/p)+1)},InOut:function(k){var s,a=.1,p=.4;return 0===k?0:1===k?1:(!a||1>a?(a=1,s=p/4):s=p*Math.asin(1/a)/(2*Math.PI),1>(k*=2)?-.5*a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*2*Math.PI/p):.5*a*Math.pow(2,-10*(k-=1))*Math.sin((k-s)*2*Math.PI/p)+1)}},Back:{In:function(k){var s=1.70158;return k*k*((s+1)*k-s)},Out:function(k){var s=1.70158;return--k*k*((s+1)*k+s)+1},InOut:function(k){var s=2.5949095;return 1>(k*=2)?.5*k*k*((s+1)*k-s):.5*((k-=2)*k*((s+1)*k+s)+2)}},Bounce:{In:function(k){return 1-me.Tween.Easing.Bounce.Out(1-k)},Out:function(k){return 1/2.75>k?7.5625*k*k:2/2.75>k?7.5625*(k-=1.5/2.75)*k+.75:2.5/2.75>k?7.5625*(k-=2.25/2.75)*k+.9375:7.5625*(k-=2.625/2.75)*k+.984375},InOut:function(k){return.5>k?.5*me.Tween.Easing.Bounce.In(2*k):.5*me.Tween.Easing.Bounce.Out(2*k-1)+.5}}},me.Tween.Interpolation={Linear:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f),fn=me.Tween.Interpolation.Utils.Linear;return 0>k?fn(v[0],v[1],f):k>1?fn(v[m],v[m-1],m-f):fn(v[i],v[i+1>m?m:i+1],f-i)},Bezier:function(v,k){var b=0,n=v.length-1,pw=Math.pow,bn=me.Tween.Interpolation.Utils.Bernstein,i;for(i=0;n>=i;i++)b+=pw(1-k,n-i)*pw(k,i)*v[i]*bn(n,i);return b},CatmullRom:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f),fn=me.Tween.Interpolation.Utils.CatmullRom;return v[0]===v[m]?(0>k&&(i=Math.floor(f=m*(1+k))),fn(v[(i-1+m)%m],v[i],v[(i+1)%m],v[(i+2)%m],f-i)):0>k?v[0]-(fn(v[0],v[0],v[1],v[1],-f)-v[0]):k>1?v[m]-(fn(v[m],v[m],v[m-1],v[m-1],f-m)-v[m]):fn(v[i?i-1:0],v[i],v[i+1>m?m:i+1],v[i+2>m?m:i+2],f-i)},Utils:{Linear:function(p0,p1,t){return(p1-p0)*t+p0},Bernstein:function(n,i){var fc=me.Tween.Interpolation.Utils.Factorial;return fc(n)/fc(i)/fc(n-i)},Factorial:function(){var a=[1];return function(n){var s=1,i;if(a[n])return a[n];for(i=n;i>1;i--)s*=i;return a[n]=s}}(),CatmullRom:function(p0,p1,p2,p3,t){var v0=.5*(p2-p0),v1=.5*(p3-p1),t2=t*t,t3=t*t2;return(2*p1-2*p2+v0+v1)*t3+(-3*p1+3*p2-2*v0-v1)*t2+v0*t+p1}}}}(),function(){me.event=function(){var obj={},cache={};return obj.STATE_PAUSE="me.state.onPause",obj.STATE_RESUME="me.state.onResume",obj.STATE_STOP="me.state.onStop",obj.STATE_RESTART="me.state.onRestart",obj.GAME_INIT="me.game.onInit",obj.LEVEL_LOADED="me.game.onLevelLoaded",obj.LOADER_COMPLETE="me.loader.onload",obj.LOADER_PROGRESS="me.loader.onProgress",obj.KEYDOWN="me.input.keydown",obj.KEYUP="me.input.keyup",obj.MOUSEMOVE="me.game.pointermove",obj.DRAGSTART="me.game.dragstart",obj.DRAGEND="me.game.dragend",obj.WINDOW_ONRESIZE="window.onresize",obj.WINDOW_ONORIENTATION_CHANGE="window.orientationchange",obj.WINDOW_ONSCROLL="window.onscroll",obj.VIEWPORT_ONCHANGE="viewport.onchange",obj.publish=function(channel,args){for(var subs=cache[channel],len=subs?subs.length:0;len--;)subs[len].apply(window,args||[])},obj.subscribe=function(channel,callback){return cache[channel]||(cache[channel]=[]),cache[channel].push(callback),[channel,callback]},obj.unsubscribe=function(handle,callback){var subs=cache[callback?handle:handle[0]],len=subs?subs.length:0;for(callback=callback||handle[1];len--;)subs[len]===callback&&subs.splice(len,1)},obj}()}(),function(){var cache={},ctx=null,usingWebAudio=!0,noAudio=!1;try{"undefined"!=typeof AudioContext?ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?ctx=new webkitAudioContext:usingWebAudio=!1}catch(e){usingWebAudio=!1}if(!usingWebAudio)if("undefined"!=typeof Audio)try{new Audio}catch(e){noAudio=!0}else noAudio=!0;if(usingWebAudio){var masterGain=ctx.createGain===void 0?ctx.createGainNode():ctx.createGain();masterGain.gain.value=1,masterGain.connect(ctx.destination)}var HowlerGlobal=function(){this._volume=1,this._muted=!1,this.usingWebAudio=usingWebAudio,this.noAudio=noAudio,this._howls=[]};HowlerGlobal.prototype={volume:function(vol){var self=this;if(vol=parseFloat(vol),vol>=0&&1>=vol){self._volume=vol,usingWebAudio&&(masterGain.gain.value=vol);for(var key in self._howls)if(self._howls.hasOwnProperty(key)&&self._howls[key]._webAudio===!1)for(var i=0;self._howls[key]._audioNode.length>i;i++)self._howls[key]._audioNode[i].volume=self._howls[key]._volume*self._volume;return self}return usingWebAudio?masterGain.gain.value:self._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(muted){var self=this;self._muted=muted,usingWebAudio&&(masterGain.gain.value=muted?0:self._volume);for(var key in self._howls)if(self._howls.hasOwnProperty(key)&&self._howls[key]._webAudio===!1)for(var i=0;self._howls[key]._audioNode.length>i;i++)self._howls[key]._audioNode[i].muted=muted}};var Howler=new HowlerGlobal,audioTest=null;if(!noAudio){audioTest=new Audio;var codecs={mp3:!!audioTest.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!audioTest.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!audioTest.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!audioTest.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),m4a:!!(audioTest.canPlayType("audio/x-m4a;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(audioTest.canPlayType("audio/x-mp4;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!audioTest.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")}}var Howl=function(o){var self=this;self._autoplay=o.autoplay||!1,self._buffer=o.buffer||!1,self._duration=o.duration||0,self._format=o.format||null,self._loop=o.loop||!1,self._loaded=!1,self._sprite=o.sprite||{},self._src=o.src||"",self._pos3d=o.pos3d||[0,0,-.5],self._volume=void 0!==o.volume?o.volume:1,self._urls=o.urls||[],self._rate=o.rate||1,self._model=o.model||null,self._onload=[o.onload||function(){}],self._onloaderror=[o.onloaderror||function(){}],self._onend=[o.onend||function(){}],self._onpause=[o.onpause||function(){}],self._onplay=[o.onplay||function(){}],self._onendTimer=[],self._webAudio=usingWebAudio&&!self._buffer,self._audioNode=[],self._webAudio&&self._setupAudioNode(),Howler._howls.push(self),self.load()};if(Howl.prototype={load:function(){var self=this,url=null;if(noAudio)return self.on("loaderror"),void 0;for(var i=0;self._urls.length>i;i++){var ext,urlItem;if(self._format)ext=self._format;else{if(urlItem=self._urls[i].toLowerCase().split("?")[0],ext=urlItem.match(/.+\.([^?]+)(\?|$)/),ext=ext&&ext.length>=2?ext:urlItem.match(/data\:audio\/([^?]+);/),!ext)return self.on("loaderror"),void 0;ext=ext[1]}if(codecs[ext]){url=self._urls[i];break}}if(!url)return self.on("loaderror"),void 0;if(self._src=url,self._webAudio)loadBuffer(self,url);else{var newNode=new Audio;newNode.addEventListener("error",function(){newNode.error&&4===newNode.error.code&&(HowlerGlobal.noAudio=!0),self.on("loaderror",{type:newNode.error?newNode.error.code:0})},!1),self._audioNode.push(newNode),newNode.src=url,newNode._pos=0,newNode.preload="auto",newNode.volume=Howler._muted?0:self._volume*Howler.volume(),cache[url]=self;var listener=function(){self._duration=Math.ceil(10*newNode.duration)/10,0===Object.getOwnPropertyNames(self._sprite).length&&(self._sprite={_default:[0,1e3*self._duration]}),self._loaded||(self._loaded=!0,self.on("load")),self._autoplay&&self.play(),newNode.removeEventListener("canplaythrough",listener,!1)};newNode.addEventListener("canplaythrough",listener,!1),newNode.load()}return self},urls:function(urls){var self=this;return urls?(self.stop(),self._urls="string"==typeof urls?[urls]:urls,self._loaded=!1,self.load(),self):self._urls},play:function(sprite,callback){var self=this;return"function"==typeof sprite&&(callback=sprite),sprite&&"function"!=typeof sprite||(sprite="_default"),self._loaded?self._sprite[sprite]?(self._inactiveNode(function(node){node._sprite=sprite;var pos=node._pos>0?node._pos:self._sprite[sprite][0]/1e3,duration=self._sprite[sprite][1]/1e3-node._pos,loop=!(!self._loop&&!self._sprite[sprite][2]),soundId="string"==typeof callback?callback:Math.round(Date.now()*Math.random())+"",timerId;if(function(){var data={id:soundId,sprite:sprite,loop:loop};timerId=setTimeout(function(){!self._webAudio&&loop&&self.stop(data.id).play(sprite,data.id),self._webAudio&&!loop&&(self._nodeById(data.id).paused=!0,self._nodeById(data.id)._pos=0),self._webAudio||loop||self.stop(data.id),self.on("end",soundId)},1e3*duration),self._onendTimer.push({timer:timerId,id:data.id})}(),self._webAudio){var loopStart=self._sprite[sprite][0]/1e3,loopEnd=self._sprite[sprite][1]/1e3;node.id=soundId,node.paused=!1,refreshBuffer(self,[loop,loopStart,loopEnd],soundId),self._playStart=ctx.currentTime,node.gain.value=self._volume,node.bufferSource.start===void 0?node.bufferSource.noteGrainOn(0,pos,duration):node.bufferSource.start(0,pos,duration)}else{if(4!==node.readyState&&(node.readyState||!navigator.isCocoonJS))return self._clearEndTimer(soundId),function(){var sound=self,playSprite=sprite,fn=callback,newNode=node,listener=function(){sound.play(playSprite,fn),newNode.removeEventListener("canplaythrough",listener,!1)};newNode.addEventListener("canplaythrough",listener,!1)}(),self;node.readyState=4,node.id=soundId,node.currentTime=pos,node.muted=Howler._muted||node.muted,node.volume=self._volume*Howler.volume(),setTimeout(function(){node.play()},0)}return self.on("play"),"function"==typeof callback&&callback(soundId),self}),self):("function"==typeof callback&&callback(),self):(self.on("load",function(){self.play(sprite,callback)}),self)},pause:function(id){var self=this;if(!self._loaded)return self.on("play",function(){self.pause(id)}),self;self._clearEndTimer(id);var activeNode=id?self._nodeById(id):self._activeNode();if(activeNode)if(activeNode._pos=self.pos(null,id),self._webAudio){if(!activeNode.bufferSource||activeNode.paused)return self;activeNode.paused=!0,activeNode.bufferSource.stop===void 0?activeNode.bufferSource.noteOff(0):activeNode.bufferSource.stop(0)}else activeNode.pause();return self.on("pause"),self},stop:function(id){var self=this;if(!self._loaded)return self.on("play",function(){self.stop(id)}),self;self._clearEndTimer(id);var activeNode=id?self._nodeById(id):self._activeNode();if(activeNode)if(activeNode._pos=0,self._webAudio){if(!activeNode.bufferSource||activeNode.paused)return self;activeNode.paused=!0,activeNode.bufferSource.stop===void 0?activeNode.bufferSource.noteOff(0):activeNode.bufferSource.stop(0)}else isNaN(activeNode.duration)||(activeNode.pause(),activeNode.currentTime=0);return self},mute:function(id){var self=this;if(!self._loaded)return self.on("play",function(){self.mute(id)}),self;var activeNode=id?self._nodeById(id):self._activeNode();return activeNode&&(self._webAudio?activeNode.gain.value=0:activeNode.muted=!0),self},unmute:function(id){var self=this;if(!self._loaded)return self.on("play",function(){self.unmute(id)}),self;var activeNode=id?self._nodeById(id):self._activeNode();return activeNode&&(self._webAudio?activeNode.gain.value=self._volume:activeNode.muted=!1),self},volume:function(vol,id){var self=this;if(vol=parseFloat(vol),vol>=0&&1>=vol){if(self._volume=vol,!self._loaded)return self.on("play",function(){self.volume(vol,id)}),self;var activeNode=id?self._nodeById(id):self._activeNode();return activeNode&&(self._webAudio?activeNode.gain.value=vol:activeNode.volume=vol*Howler.volume()),self}return self._volume},loop:function(loop){var self=this;return"boolean"==typeof loop?(self._loop=loop,self):self._loop},sprite:function(sprite){var self=this;return"object"==typeof sprite?(self._sprite=sprite,self):self._sprite},pos:function(pos,id){var self=this;if(!self._loaded)return self.on("load",function(){self.pos(pos)}),"number"==typeof pos?self:self._pos||0;pos=parseFloat(pos);var activeNode=id?self._nodeById(id):self._activeNode();if(activeNode)return pos>=0?(self.pause(id),activeNode._pos=pos,self.play(activeNode._sprite,id),self):self._webAudio?activeNode._pos+(ctx.currentTime-self._playStart):activeNode.currentTime;if(pos>=0)return self;for(var i=0;self._audioNode.length>i;i++)if(self._audioNode[i].paused&&4===self._audioNode[i].readyState)return self._webAudio?self._audioNode[i]._pos:self._audioNode[i].currentTime},pos3d:function(x,y,z,id){var self=this;if(y=void 0!==y&&y?y:0,z=void 0!==z&&z?z:-.5,!self._loaded)return self.on("play",function(){self.pos3d(x,y,z,id)}),self;if(!(x>=0||0>x))return self._pos3d;if(self._webAudio){var activeNode=id?self._nodeById(id):self._activeNode();activeNode&&(self._pos3d=[x,y,z],activeNode.panner.setPosition(x,y,z),activeNode.panner.panningModel=self._model||"HRTF")}return self},fade:function(from,to,len,callback,id){var self=this,diff=Math.abs(from-to),dir=from>to?"down":"up",steps=diff/.01,stepTime=len/steps;if(!self._loaded)return self.on("load",function(){self.fade(from,to,len,callback,id)}),self;self.volume(from,id);for(var i=1;steps>=i;i++)(function(){var change=self._volume+("up"===dir?.01:-.01)*i,vol=Math.round(1e3*change)/1e3,toVol=to;setTimeout(function(){self.volume(vol,id),vol===toVol&&callback&&callback()},stepTime*i)})()},fadeIn:function(to,len,callback){return this.volume(0).play().fade(0,to,len,callback)},fadeOut:function(to,len,callback,id){var self=this;return self.fade(self._volume,to,len,function(){callback&&callback(),self.pause(id),self.on("end")},id)},_nodeById:function(id){for(var self=this,node=self._audioNode[0],i=0;self._audioNode.length>i;i++)if(self._audioNode[i].id===id){node=self._audioNode[i];break}return node},_activeNode:function(){for(var self=this,node=null,i=0;self._audioNode.length>i;i++)if(!self._audioNode[i].paused){node=self._audioNode[i];break}return self._drainPool(),node},_inactiveNode:function(callback){for(var self=this,node=null,i=0;self._audioNode.length>i;i++)if(self._audioNode[i].paused&&4===self._audioNode[i].readyState){callback(self._audioNode[i]),node=!0;break}if(self._drainPool(),!node){var newNode;self._webAudio?(newNode=self._setupAudioNode(),callback(newNode)):(self.load(),newNode=self._audioNode[self._audioNode.length-1],newNode.addEventListener(navigator.isCocoonJS?"canplaythrough":"loadedmetadata",function(){callback(newNode)}))}},_drainPool:function(){var self=this,inactive=0,i;for(i=0;self._audioNode.length>i;i++)self._audioNode[i].paused&&inactive++;for(i=self._audioNode.length-1;i>=0&&!(5>=inactive);i--)self._audioNode[i].paused&&(self._webAudio&&self._audioNode[i].disconnect(0),inactive--,self._audioNode.splice(i,1))},_clearEndTimer:function(soundId){for(var self=this,index=0,i=0;self._onendTimer.length>i;i++)if(self._onendTimer[i].id===soundId){index=i;break}var timer=self._onendTimer[index];timer&&(clearTimeout(timer.timer),self._onendTimer.splice(index,1))},_setupAudioNode:function(){var self=this,node=self._audioNode,index=self._audioNode.length;return node[index]=ctx.createGain===void 0?ctx.createGainNode():ctx.createGain(),node[index].gain.value=self._volume,node[index].paused=!0,node[index]._pos=0,node[index].readyState=4,node[index].connect(masterGain),node[index].panner=ctx.createPanner(),node[index].panner.panningModel=self._model||"equalpower",node[index].panner.setPosition(self._pos3d[0],self._pos3d[1],self._pos3d[2]),node[index].panner.connect(node[index]),node[index]},on:function(event,fn){var self=this,events=self["_on"+event];if("function"==typeof fn)events.push(fn);else for(var i=0;events.length>i;i++)fn?events[i].call(self,fn):events[i].call(self);return self},off:function(event,fn){for(var self=this,events=self["_on"+event],fnString=""+fn,i=0;events.length>i;i++)if(fnString===""+events[i]){events.splice(i,1);break}return self},unload:function(){for(var self=this,nodes=self._audioNode,i=0;self._audioNode.length>i;i++)nodes[i].paused||self.stop(nodes[i].id),self._webAudio?nodes[i].disconnect(0):nodes[i].src="";for(i=0;self._onendTimer.length>i;i++)clearTimeout(self._onendTimer[i].timer);var index=Howler._howls.indexOf(self);null!==index&&index>=0&&Howler._howls.splice(index,1),delete cache[self._src],self=null}},usingWebAudio)var loadBuffer=function(obj,url){if(url in cache)obj._duration=cache[url].duration,loadSound(obj);else{var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="arraybuffer",xhr.onload=function(){ctx.decodeAudioData(xhr.response,function(buffer){buffer&&(cache[url]=buffer,loadSound(obj,buffer))},function(err){obj.on("loaderror")})},xhr.onerror=function(){obj._webAudio&&(obj._buffer=!0,obj._webAudio=!1,obj._audioNode=[],delete obj._gainNode,obj.load())};try{xhr.send()}catch(e){xhr.onerror()}}},loadSound=function(obj,buffer){obj._duration=buffer?buffer.duration:obj._duration,0===Object.getOwnPropertyNames(obj._sprite).length&&(obj._sprite={_default:[0,1e3*obj._duration]}),obj._loaded||(obj._loaded=!0,obj.on("load")),obj._autoplay&&obj.play()},refreshBuffer=function(obj,loop,id){var node=obj._nodeById(id);node.bufferSource=ctx.createBufferSource(),node.bufferSource.buffer=cache[obj._src],node.bufferSource.connect(node.panner),node.bufferSource.loop=loop[0],loop[0]&&(node.bufferSource.loopStart=loop[1],node.bufferSource.loopEnd=loop[1]+loop[2]),node.bufferSource.playbackRate.value=obj._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:Howler,Howl:Howl}}),"undefined"!=typeof exports&&(exports.Howler=Howler,exports.Howl=Howl),"undefined"!=typeof window&&(window.Howler=Howler,window.Howl=Howl)}(),function(){me.plugin=function(){var singleton={};return singleton.Base=Object.extend({version:void 0,init:function(){}}),singleton.patch=function(proto,name,fn){if(proto.prototype!==void 0&&(proto=proto.prototype),"function"==typeof proto[name]){var _parent=proto[name];proto[name]=function(name,fn){return function(){var tmp=this.parent;this.parent=_parent;var ret=fn.apply(this,arguments);return this.parent=tmp,ret}}(name,fn)}else console.error(name+" is not an existing function")},singleton.register=function(plugin,name){if(me.plugin[name]&&console.error("plugin "+name+" already registered"),plugin.prototype.version===void 0)throw"melonJS: Plugin version not defined!";if(me.sys.checkVersion(plugin.prototype.version)>0)throw"melonJS: Plugin version mismatch, expected: "+plugin.prototype.version+", got: "+me.version;var _args=[];if(arguments.length>2&&(_args=Array.prototype.slice.call(arguments,1)),_args[0]=plugin,me.plugin[name]=new(plugin.bind.apply(plugin,_args)),!(me.plugin[name]instanceof me.plugin.Base))throw"melonJS: Plugin should extend the me.plugin.Base Class !"},singleton}()}(),me.DraggableEntity=function(Entity,Input,Event,Vector){"use strict";return Entity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.dragging=!1,this.dragId=null,this.grabOffset=new Vector(0,0),this.onPointerEvent=Input.registerPointerEvent,this.removePointerEvent=Input.releasePointerEvent,this.initEvents()},initEvents:function(){var self=this;this.mouseDown=function(e){this.translatePointerEvent(e,Event.DRAGSTART)},this.mouseUp=function(e){this.translatePointerEvent(e,Event.DRAGEND)},this.onPointerEvent("pointerdown",this,this.mouseDown.bind(this)),this.onPointerEvent("pointerup",this,this.mouseUp.bind(this)),Event.subscribe(Event.MOUSEMOVE,this.dragMove.bind(this)),Event.subscribe(Event.DRAGSTART,function(e,draggable){draggable===self&&self.dragStart(e)}),Event.subscribe(Event.DRAGEND,function(e,draggable){draggable===self&&self.dragEnd(e)})},translatePointerEvent:function(e,translation){Event.publish(translation,[e,this])},dragStart:function(e){return this.dragging===!1?(this.dragging=!0,this.dragId=e.pointerId,this.grabOffset.set(e.gameX,e.gameY),this.grabOffset.sub(this.pos),!1):void 0},dragMove:function(e){this.dragging===!0&&this.dragId===e.pointerId&&(this.pos.set(e.gameX,e.gameY),this.pos.sub(this.grabOffset))},dragEnd:function(){return this.dragging===!0?(this.pointerId=void 0,this.dragging=!1,!1):void 0},destroy:function(){Event.unsubscribe(Event.MOUSEMOVE,this.dragMove),Event.unsubscribe(Event.DRAGSTART,this.dragStart),Event.unsubscribe(Event.DRAGEND,this.dragEnd),this.removePointerEvent("pointerdown",this),this.removePointerEvent("pointerup",this)}})}(me.ObjectEntity,me.input,me.event,me.Vector2d),me.DroptargetEntity=function(Entity,Event){"use strict";return Entity.extend({CHECKMETHOD_OVERLAP:"overlaps",CHECKMETHOD_CONTAINS:"contains",checkMethod:null,init:function(x,y,settings){this.parent(x,y,settings),Event.subscribe(Event.DRAGEND,this.checkOnMe.bind(this)),this.checkMethod=this[this.CHECKMETHOD_OVERLAP]},setCheckMethod:function(checkMethod){this[checkMethod]!==void 0&&(this.checkMethod=this[checkMethod])},checkOnMe:function(e,draggableEntity){draggableEntity&&this.checkMethod(draggableEntity.getBounds().translateV(draggableEntity.pos))&&this.drop(draggableEntity)},drop:function(){},destroy:function(){Event.unsubscribe(Event.DRAGEND,this.checkOnMe)}})}(me.ObjectEntity,me.event),function(){var pixel=function(){var canvas=me.video.createCanvas(1,1),context=me.video.getContext2d(canvas);return context.fillStyle="#fff",context.fillRect(0,0,1,1),canvas}();me.ParticleEmitterSettings={width:0,height:0,image:pixel,totalParticles:50,angle:Math.PI/2,angleVariation:0,minLife:1e3,maxLife:3e3,speed:2,speedVariation:1,minRotation:0,maxRotation:0,minStartScale:1,maxStartScale:1,minEndScale:0,maxEndScale:0,gravity:0,wind:0,followTrajectory:!1,textureAdditive:!1,onlyInViewport:!0,floating:!1,maxParticles:10,frequency:100,duration:1/0,framesToSkip:0},me.ParticleEmitter=me.Rect.extend({_stream:!1,_frequencyTimer:0,_durationTimer:0,_enabled:!1,isRenderable:!1,init:function(x,y,settings){this.parent(new me.Vector2d(x,y),1/0,1/0),this.autoSort=!1,this.container=new me.ParticleContainer(this),Object.defineProperty(this,"z",{get:function(){return this.container.z},set:function(value){this.container.z=value},enumerable:!0,configurable:!0}),Object.defineProperty(this,"floating",{get:function(){return this.container.floating},set:function(value){this.container.floating=value},enumerable:!0,configurable:!0}),this.reset(settings)},destroy:function(){this.reset()},getRandomPoint:function(){var vector=this.pos.clone();return vector.x+=Number.prototype.random(0,this.width),vector.y+=Number.prototype.random(0,this.height),vector},reset:function(settings){settings=settings||{};var defaults=me.ParticleEmitterSettings,width="number"==typeof settings.width?settings.width:defaults.width,height="number"==typeof settings.height?settings.height:defaults.height;this.resize(width,height),this.image=settings.image||defaults.image,this.totalParticles="number"==typeof settings.totalParticles?settings.totalParticles:defaults.totalParticles,this.angle="number"==typeof settings.angle?settings.angle:defaults.angle,this.angleVariation="number"==typeof settings.angleVariation?settings.angleVariation:defaults.angleVariation,this.minLife="number"==typeof settings.minLife?settings.minLife:defaults.minLife,this.maxLife="number"==typeof settings.maxLife?settings.maxLife:defaults.maxLife,this.speed="number"==typeof settings.speed?settings.speed:defaults.speed,this.speedVariation="number"==typeof settings.speedVariation?settings.speedVariation:defaults.speedVariation,this.minRotation="number"==typeof settings.minRotation?settings.minRotation:defaults.minRotation,this.maxRotation="number"==typeof settings.maxRotation?settings.maxRotation:defaults.maxRotation,this.minStartScale="number"==typeof settings.minStartScale?settings.minStartScale:defaults.minStartScale,this.maxStartScale="number"==typeof settings.maxStartScale?settings.maxStartScale:defaults.maxStartScale,this.minEndScale="number"==typeof settings.minEndScale?settings.minEndScale:defaults.minEndScale,this.maxEndScale="number"==typeof settings.maxEndScale?settings.maxEndScale:defaults.maxEndScale,this.gravity="number"==typeof settings.gravity?settings.gravity:defaults.gravity,this.wind="number"==typeof settings.wind?settings.wind:defaults.wind,this.followTrajectory="boolean"==typeof settings.followTrajectory?settings.followTrajectory:defaults.followTrajectory,this.textureAdditive="boolean"==typeof settings.textureAdditive?settings.textureAdditive:defaults.textureAdditive,this.onlyInViewport="boolean"==typeof settings.onlyInViewport?settings.onlyInViewport:defaults.onlyInViewport,this.floating="boolean"==typeof settings.floating?settings.floating:defaults.floating,this.maxParticles="number"==typeof settings.maxParticles?settings.maxParticles:defaults.maxParticles,this.frequency="number"==typeof settings.frequency?settings.frequency:defaults.frequency,this.duration="number"==typeof settings.duration?settings.duration:defaults.duration,this.framesToSkip="number"==typeof settings.framesToSkip?settings.framesToSkip:defaults.framesToSkip,this.container.destroy()
},addParticles:function(count){for(var i=0;~~count>i;i++){var particle=me.pool.pull("me.Particle",this);particle.isRenderable=!1,this.container.addChild(particle)}},isRunning:function(){return this._enabled&&this._stream},streamParticles:function(duration){this._enabled=!0,this._stream=!0,this.frequency=Math.max(this.frequency,1),this._durationTimer="number"==typeof duration?duration:this.duration},stopStream:function(){this._enabled=!1},burstParticles:function(total){this._enabled=!0,this._stream=!1,this.addParticles("number"==typeof total?total:this.totalParticles),this._enabled=!1},update:function(dt){if(this._enabled&&this._stream){if(1/0!==this._durationTimer&&(this._durationTimer-=dt,0>=this._durationTimer))return this.stopStream(),!1;this._frequencyTimer+=dt;var particlesCount=this.container.children.length;this.totalParticles>particlesCount&&this._frequencyTimer>=this.frequency&&(particlesCount+this.maxParticles<=this.totalParticles?this.addParticles(this.maxParticles):this.addParticles(this.totalParticles-particlesCount),this._frequencyTimer=0)}return!0}})}(),function(){me.ParticleContainer=me.ObjectContainer.extend({init:function(emitter){this.parent(),this.autoSort=!1,this._updateCount=0,this._dt=0,this._emitter=emitter},update:function(dt){if(++this._updateCount>this._emitter.framesToSkip&&(this._updateCount=0),this._updateCount>0)return this._dt+=dt,!1;dt+=this._dt,this._dt=0;for(var viewport=me.game.viewport,i=this.children.length-1;i>=0;--i){var particle=this.children[i];particle.isRenderable=!0,particle.inViewport=this.floating||particle.pos.x<viewport.pos.x+viewport.width&&viewport.pos.x<particle.pos.x+particle.width&&particle.pos.y<viewport.pos.y+viewport.height&&viewport.pos.y<particle.pos.y+particle.height,particle.update(dt)||this.removeChildNow(particle)}return!0},draw:function(context,rect){if(this.children.length>0){var gco;this._emitter.textureAdditive&&(gco=context.globalCompositeOperation,context.globalCompositeOperation="lighter"),this.parent(context,rect),this._emitter.textureAdditive&&(context.globalCompositeOperation=gco)}}})}(),function(){me.Particle=me.Renderable.extend({init:function(emitter){this.parent(emitter.getRandomPoint(),emitter.image.width,emitter.image.height),this.alwaysUpdate=!0,this.image=emitter.image;var angle=emitter.angle+(emitter.angleVariation>0?(2*Math.random()-1)*emitter.angleVariation:0),speed=emitter.speed+(emitter.speedVariation>0?(2*Math.random()-1)*emitter.speedVariation:0);this.vel=new me.Vector2d(speed*Math.cos(angle),-speed*Math.sin(angle)),this.life=Number.prototype.random(emitter.minLife,emitter.maxLife),this.startLife=this.life,this.startScale=Number.prototype.random(emitter.minStartScale,emitter.maxStartScale).clamp(emitter.minStartScale,emitter.maxStartScale),this.endScale=Number.prototype.random(emitter.minEndScale,emitter.maxEndScale).clamp(emitter.minEndScale,emitter.maxEndScale),this.gravity=emitter.gravity,this.wind=emitter.wind,this.followTrajectory=emitter.followTrajectory,this.onlyInViewport=emitter.onlyInViewport,this.z=emitter.z,this._deltaInv=me.sys.fps/1e3,this.transform=new me.Matrix2d,emitter.followTrajectory||(this.angle=Number.prototype.random(emitter.minRotation,emitter.maxRotation))},update:function(dt){var skew=dt*this._deltaInv;this.life=this.life>dt?this.life-dt:0;var ageRatio=this.life/this.startLife,scale=this.startScale;this.startScale>this.endScale?(scale*=ageRatio,scale=this.endScale>scale?this.endScale:scale):this.startScale<this.endScale&&(scale/=ageRatio,scale=scale>this.endScale?this.endScale:scale),this.alpha=ageRatio,this.vel.x+=this.wind*skew,this.vel.y+=this.gravity*skew;var angle=this.followTrajectory?Math.atan2(this.vel.y,this.vel.x):this.angle;return this.transform.set(scale,0,0,scale,0,0).rotate(angle),this.pos.x+=this.vel.x*skew,this.pos.y+=this.vel.y*skew,(this.inViewport||!this.onlyInViewport)&&this.life>0},draw:function(context){context.save(),context.globalAlpha*=this.alpha;var transform=this.transform;context.transform(transform.a,transform.b,transform.c,transform.d,~~this.pos.x,~~this.pos.y);var w=this.width,h=this.height;context.drawImage(this.image,0,0,w,h,-w/2,-h/2,w,h),context.restore()}})}(window);
                (function($){me.debug=me.debug||{},debugPanel=me.plugin.Base.extend({GUID:null,area:{},rect:null,z:1/0,visible:!1,frameUpdateTime:0,frameDrawTime:0,version:"1.0.1",init:function(showKey,hideKey){this.parent(),this.rect=new me.Rect(new me.Vector2d(0,0),me.video.getWidth(),35),this.GUID="debug-"+me.utils.createGUID(),this.name="me.debugPanel",this.isPersistent=!0,this.floating=!0,this.isRenderable=!0,this.alwaysUpdate=!0;var s=10;this.mod=1,500>me.game.viewport.width&&(s=7,this.mod=.7),this.font=new me.Font("courier",s,"white"),this.area.renderHitBox=new me.Rect(new me.Vector2d(160,5),15,15),this.area.renderVelocity=new me.Rect(new me.Vector2d(165,18),15,15),this.area.renderDirty=new me.Rect(new me.Vector2d(270,5),15,15),this.area.renderCollisionMap=new me.Rect(new me.Vector2d(270,18),15,15),this.help_str="(s)how/(h)ide",this.help_str_len=this.font.measureText(me.video.getSystemContext(),this.help_str).width,this.fps_str_len=this.font.measureText(me.video.getSystemContext(),"00/00 fps").width,this.memoryPositionX=2.2*this.font.measureText(me.video.getSystemContext(),"Draw   : ").width+310*this.mod,this.help_str="(s)how/(h)ide",this.help_str_len=this.font.measureText(me.video.getSystemContext(),this.help_str).width,this.fps_str_len=this.font.measureText(me.video.getSystemContext(),"00/00 fps").width,me.debug.displayFPS=!0,me.input.bindKey(showKey||me.input.KEY.S,"show",!1,!1),me.input.bindKey(hideKey||me.input.KEY.H,"hide",!1,!1);var self=this;this.keyHandler=me.event.subscribe(me.event.KEYDOWN,function(action,keyCode,edge){"show"===action?self.show():"hide"===action&&self.hide()}),this.levelHandler=me.event.subscribe(me.event.LEVEL_LOADED,function(){var layer=me.game.currentLevel.getLayerByName("collision");layer&&layer.setOpacity(me.debug.renderCollisionMap===!0?1:0)}),this.samples=[],this.patchSystemFn(),this.show()},patchSystemFn:function(){me.debug.renderHitBox=me.debug.renderHitBox||!1,me.debug.renderVelocity=me.debug.renderVelocity||!1,me.debug.renderCollisionMap=me.debug.renderCollisionMap||!1;var _this=this;me.plugin.patch(me.timer,"update",function(time){this.parent(time),me.timer.countFPS()}),me.plugin.patch(me.game,"update",function(time){var frameUpdateStartTime=window.performance.now();this.parent(time),_this.frameUpdateTime=window.performance.now()-frameUpdateStartTime}),me.plugin.patch(me.game,"draw",function(){var frameDrawStartTime=window.performance.now();this.parent(),_this.frameDrawTime=window.performance.now()-frameDrawStartTime}),me.plugin.patch(me.SpriteObject,"draw",function(context){this.parent(context),me.debug.renderHitBox&&(context.strokeStyle="green",context.strokeRect(this.left,this.top,this.width,this.height))}),me.plugin.patch(me.ObjectEntity,"draw",function(context){if(this.parent(context),me.debug.renderHitBox&&this.shapes.length){var translateX=this.pos.x,translateY=this.pos.y;context.translate(translateX,translateY),this.getShape().draw(context,"red"),"Rectangle"!==this.getShape().shapeType&&this.getShape().getBounds().draw(context,"red"),context.translate(-translateX,-translateY)}if(me.debug.renderVelocity){var x=~~(this.pos.x+this.hWidth),y=~~(this.pos.y+this.hHeight);context.strokeStyle="blue",context.lineWidth=1,context.beginPath(),context.moveTo(x,y),context.lineTo(x+~~(this.vel.x*this.hWidth),y+~~(this.vel.y*this.hHeight)),context.stroke()}})},show:function(){this.visible||(me.input.registerPointerEvent("pointerdown",this.rect,this.onClick.bind(this),!0),me.game.world.addChild(this,1/0),this.visible=!0)},hide:function(){this.visible&&(me.input.releasePointerEvent("pointerdown",this.rect),me.game.world.removeChild(this),this.visible=!1)},update:function(){return me.input.isKeyPressed("show")?this.show():me.input.isKeyPressed("hide")&&this.hide(),!0},getBounds:function(){return this.rect},onClick:function(e){if(this.area.renderHitBox.containsPoint(e.gameX,e.gameY))me.debug.renderHitBox=!me.debug.renderHitBox;else if(this.area.renderCollisionMap.containsPoint(e.gameX,e.gameY)){var layer=me.game.currentLevel.getLayerByName("collision");layer&&(0===layer.getOpacity()?(layer.setOpacity(1),me.debug.renderCollisionMap=!0):(layer.setOpacity(0),me.debug.renderCollisionMap=!1))}else this.area.renderVelocity.containsPoint(e.gameX,e.gameY)&&(me.debug.renderVelocity=!me.debug.renderVelocity);me.game.repaint()},drawMemoryGraph:function(context,endX){if(window.performance&&window.performance.memory){var usedHeap=Number.prototype.round(window.performance.memory.usedJSHeapSize/1048576,2),totalHeap=Number.prototype.round(window.performance.memory.totalJSHeapSize/1048576,2),len=endX-this.memoryPositionX;this.samples.shift(),this.samples[len]=25*(usedHeap/totalHeap);for(var x=len;x>=0;x--){var where=endX-(len-x);context.beginPath(),context.strokeStyle="lightblue",context.moveTo(where,30*this.mod),context.lineTo(where,(30-(this.samples[x]||0))*this.mod),context.stroke()}this.font.draw(context,"Heap : "+usedHeap+"/"+totalHeap+" MB",this.memoryPositionX,5*this.mod)}else this.font.draw(context,"Heap : ??/?? MB",this.memoryPositionX,5*this.mod)},draw:function(context){context.save(),context.globalAlpha=.5,context.fillStyle="black",context.fillRect(this.rect.left,this.rect.top,this.rect.width,this.rect.height),context.globalAlpha=1,this.font.draw(context,"#objects : "+me.game.world.children.length,5*this.mod,5*this.mod),this.font.draw(context,"#draws   : "+me.game.world.drawCount,5*this.mod,18*this.mod),this.font.draw(context,"?hitbox   ["+(me.debug.renderHitBox?"x":" ")+"]",100*this.mod,5*this.mod),this.font.draw(context,"?velocity ["+(me.debug.renderVelocity?"x":" ")+"]",100*this.mod,18*this.mod),this.font.draw(context,"?dirtyRect  [ ]",200*this.mod,5*this.mod),this.font.draw(context,"?col. layer ["+(me.debug.renderCollisionMap?"x":" ")+"]",200*this.mod,18*this.mod),this.font.draw(context,"Update : "+this.frameUpdateTime.toFixed(2)+" ms",310*this.mod,5*this.mod),this.font.draw(context,"Draw   : "+this.frameDrawTime.toFixed(2)+" ms",310*this.mod,18*this.mod);var endX=this.rect.width-25;this.drawMemoryGraph(context,endX-this.help_str_len),this.font.draw(context,this.help_str,endX-this.help_str_len,18*this.mod);var fps_str=""+me.timer.fps+"/"+me.sys.fps+" fps";this.font.draw(context,fps_str,this.rect.width-this.fps_str_len-5,5*this.mod),context.restore()},onDestroyEvent:function(){this.hide(),me.input.unbindKey(me.input.KEY.S),me.input.unbindKey(me.input.KEY.H),me.event.unsubscribe(this.keyHandler),me.event.unsubscribe(this.levelHandler)}})})(window);
                function Point(x,y){this.x=x,this.y=y}
                var game={WINDOW_WIDTH:1024,WINDOW_HEIGHT:512,PADDING:8,WIDTH:1e3,ENEMY_ENTITY_SMALL:96,ENEMY_ENTITY_MEDIUM:97,ENEMY_ENTITY_LARGE:98,ENEMY_ENTITY_SUPER:99,SHOW_LABEL:!0,PLAYER:88,BULLET:77,EXPLOSION:66,canShoot:!0,FIRE_PROBABILITY:3e3,PENDING_REMOVE:[],OID_MAP:{},FEATURE_COLUMN:{},AVAILABLE_POSITIONS:{},PLAYER_SHIP:null,MOTHERSHIP:{width:320,height:160},FEATURE_SHIP:{width:64,height:64},STORY_SHIP:{width:32,height:32},TASK_SHIP:{width:16,height:16},data:{score:{}},log:{addItem:function(logEvent,date,className){angular.element($("#root")).scope().addLogItem(logEvent,date,className)},updateStatus:function(status){angular.element($("#root")).scope().updateStatus(status)}},PROJECT_MAPPING:{},PENDING_SCORES:{},scoreboard:{checkPending:function(){_.each(game.PENDING_SCORES,function(value,key){if(game.PROJECT_MAPPING[key])for(var i=0;value.length>i;i++){var obj=value.pop();game.scoreboard.addPoints(obj.team,obj.points)}})},addPoints:function(team,points){game.PROJECT_MAPPING[team]?angular.element($("#root")).scope().addPoints(game.PROJECT_MAPPING[team],points):game.PENDING_SCORES[team]?game.PENDING_SCORES[team].push({team:team,points:points}):game.PENDING_SCORES[team]=[{team:team,points:points}]}},onload:function(){return me.sys.fps=45,me.sys.pauseOnBlur=!1,me.video.init("screen",game.WINDOW_WIDTH,game.WINDOW_HEIGHT,!0,"auto")?("#debug"===document.location.hash&&window.onReady(function(){me.plugin.register.defer(this,debugPanel,"debug")}),me.audio.init("mp3,ogg"),me.loader.onload=this.loaded.bind(this),me.loader.preload(game.resources),me.state.change(me.state.LOADING),void 0):(alert("Your browser does not support HTML5 canvas."),void 0)},loaded:function(){me.state.set(me.state.MENU,new game.TitleScreen),me.state.set(me.state.PLAY,new game.PlayScreen),me.state.set(me.state.VICTORY,new game.VictoryScreen),me.pool.register("mainPlayer",game.PlayerEntity),me.pool.register("bullet",game.BulletEntity),me.pool.register("enemyShip",game.Ship),me.pool.register("explosion",game.ExplosionEntity),me.pool.register("label",game.LabelEntity),me.input.bindKey(me.input.KEY.LEFT,"left"),me.input.bindKey(me.input.KEY.RIGHT,"right"),me.input.bindKey(me.input.KEY.SPACE,"shoot"),me.state.change(me.state.MENU)},reveal:function(){$($(".rally-app")[0]).hide(),$("#root").show(),$("body").removeClass("x-body"),$("html").removeClass("x-viewport"),$("#screen > canvas").focus(),Ext.getBody().unmask()},addAvailablePosition:function(ship){switch(ship.type){case game.ENEMY_ENTITY_SMALL:if(game.AVAILABLE_POSITIONS.tasks.push(new Point(ship.startingX,ship.startingY)),game.AVAILABLE_POSITIONS.pendingTasks.length>1){var pendingOid=game.AVAILABLE_POSITIONS.pendingTasks[0];game.OID_MAP[pendingOid]&&(game.shipScreen.addTask(game.OID_MAP[pendingOid].record,pendingOid,game.OID_MAP[pendingOid].date),game.AVAILABLE_POSITIONS.pendingTasks.shift())}break;case game.ENEMY_ENTITY_MEDIUM:if(game.AVAILABLE_POSITIONS.pendingStories.length>0)for(var pendingObj=!1;!pendingObj;){var oid=game.AVAILABLE_POSITIONS.pendingStories.shift();if(!oid)break;if(pendingObj=game.OID_MAP[oid],pendingObj&&!pendingObj.displayed)return game.shipScreen.addEnemy(pendingObj.record,oid,pendingObj.date,"medium",game.ENEMY_ENTITY_MEDIUM,game.STORY_SHIP.height,game.STORY_SHIP.width,ship.startingX,ship.startingY),void 0}game.AVAILABLE_POSITIONS.stories.push(new Point(ship.startingX,ship.startingY));break;case game.ENEMY_ENTITY_LARGE:if(game.AVAILABLE_POSITIONS.features.push(new Point(ship.startingX,ship.startingY)),game.AVAILABLE_POSITIONS.pendingFeatures.length>1){var pendingOid=game.AVAILABLE_POSITIONS.pendingFeatures[0];game.OID_MAP[pendingOid]&&(game.shipScreen.addFeature(game.OID_MAP[pendingOid].record,pendingOid,game.OID_MAP[pendingOid].date),game.AVAILABLE_POSITIONS.pendingFeatures.shift())}break;default:console.log("default",ship,ship.type)}},cleanup:function(){_.each(game.PENDING_REMOVE,function(remove){me.game.world.removeChild(remove)}),game.PENDING_REMOVE=[]},cleanupOld:function(){for(var i=0;game.PENDING_REMOVE.length-2>i;i++)me.game.world.removeChild(game.PENDING_REMOVE.shift())}};
                game.resources=[{name:"player",type:"image",src:"game/data/img/player_ship.png"},{name:"xlarge",type:"image",src:"game/data/img/shipSuper.png"},{name:"large",type:"image",src:"game/data/img/shipLarge.png"},{name:"medium",type:"image",src:"game/data/img/shipMedium.png"},{name:"small",type:"image",src:"game/data/img/shipSmall.png"},{name:"bullet",type:"image",src:"game/data/img/bullet_sprite.png"},{name:"explosionSmall",type:"image",src:"game/data/img/animations/explosionSmall.png"},{name:"explosionMedium",type:"image",src:"game/data/img/animations/explosionMedium.png"},{name:"explosionLarge",type:"image",src:"game/data/img/animations/explosionLarge.png"},{name:"explosionSuper",type:"image",src:"game/data/img/animations/explosionSuper.png"},{name:"titleScreen",type:"image",src:"game/data/img/titleScreen.png"},{name:"background",type:"image",src:"game/data/img/background-2.png"},{name:"sprites",type:"image",src:"game/data/sprites.png"},{name:"area51",type:"tmx",src:"game/data/map/area51-1024.tmx"}];
                game.LabelEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x+settings.width/2,y,settings),this.font=new me.Font("Arial",settings.fontSize||24,"white","center"),this.formattedId=settings.formattedId,this.displayed=!1},update:function(){return this.vel.x=0,this.vel.y=0,!1},draw:function(context){game.SHOW_LABEL?(this.font.draw(context,this.formattedId,this.pos.x,this.pos.y),this.displayed=!0):me.game.world.removeChild(this)}});
                game.PlayerEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.gravity=0,this.setVelocity(10,0),this.type=game.PLAYER,this.targets=[],this.stepNum=0,this.steps=0,this.hunting=0},update:function(dt){if(this.hunting--,0!==this.targets.length&&0>this.hunting){var myPos=this.pos.x+this.width/2,targetPos=this.targets[0].pos.x+this.targets[0].width/2,move=this.accel.x*me.timer.tick;return Math.abs(myPos-targetPos)>move+1&&game.canShoot?myPos>targetPos?this.vel.x-=move:this.vel.x+=move:game.canShoot?(this.vel.x=0,this.targets[0].setVulnerable(!0),this.shoot()):this.vel.x=0,this.updateMovement(),!0}return 0===this.stepNum?(this.pos.x>game.WINDOW_WIDTH/2&&this.stepNum++,this.vel.x+=this.accel.x*me.timer.tick):1==this.stepNum?(32>this.pos.x&&(this.stepNum++,game.cleanup()),this.vel.x-=this.accel.x*me.timer.tick):2==this.stepNum?(this.pos.x>game.WINDOW_WIDTH-64&&this.stepNum++,this.vel.x+=this.accel.x*me.timer.tick):3==this.stepNum?(this.pos.x<game.WINDOW_WIDTH/2&&this.stepNum++,this.vel.x-=this.accel.x*me.timer.tick):4==this.stepNum?(this.pos.x>game.WINDOW_WIDTH-64&&this.stepNum++,this.vel.x+=this.accel.x*me.timer.tick):5==this.stepNum?(32>this.pos.x&&(this.stepNum=0),this.vel.x-=this.accel.x*me.timer.tick):(this.stepNum=0,this.vel.x=0),game.canShoot&&me.input.isKeyPressed("shoot")&&this.shoot(),this.updateMovement(),0!==this.vel.x||0!==this.vel.y?(this.parent(dt),!0):!0},shoot:function(){var x=this.pos.x+this.width/2,shot=me.pool.pull("bullet",x,this.pos.y,{height:16,image:"bullet",name:"shot",spriteheight:16,spritewidth:16,width:16,shootDown:!1});game.canShoot=!1,me.game.world.addChild(shot,Number.POSITIVE_INFINITY)},addTarget:function(target){Ext.Array.push(this.targets,target)},removeTarget:function(target){game.cleanupOld();var destroyed=this.targets.shift();destroyed.type==game.ENEMY_ENTITY_SUPER&&(game.VICTORY_ANIMATIONS={SUPER:new Point(destroyed.pos.x+destroyed.width/2,destroyed.pos.y+destroyed.height/2),LARGE:[new Point(Math.random()*(game.WINDOW_WIDTH-50),Math.random()*(game.WINDOW_HEIGHT-50))],MEDIUM:[new Point(Math.random()*(game.WINDOW_WIDTH-50),Math.random()*(game.WINDOW_HEIGHT-50))],SMALL:[new Point(Math.random()*(game.WINDOW_WIDTH-50),Math.random()*(game.WINDOW_HEIGHT-50))]},me.state.change(me.state.VICTORY)),this.hunting=0},removePotentialTarget:function(target){for(var oid=target.objectID,index=-1,i=0;this.targets.length>i;i++)if(oid==this.targets[i].objectID){index=i;break}-1!=index&&this.targets.splice(index,1)},setDelay:function(delay){this.delay=delay},sortTargetsByDate:function(){this.targets=_.sortBy(this.targets,function(target){return target.date?new Date(target.date).getTime():-1})}});
                game.Ship=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,1-settings.height,settings),this.startingX=x,this.startingY=y,this.gravity=0,this.setVelocity(0,0),this.type=settings.type,this.numSteps=0,this.moveRight=!0,this.collidable=!0,this.objectID=settings.objectID,this.record=settings.record,this.date=settings.date,this.isVulnerable=!1,this.goToY=y,this.setupComplete=!1,this.isDestructable=function(){return this.isVulnerable},this.flyOff=function(){var right=Math.floor(2*Math.random());this.update=function(){this.pos.y--,0==right?this.pos.x--:this.pos.x++,this.pos.y<=1-this.height&&(delete game.OID_MAP[this.objectID],me.game.world.removeChild(this))}}},update:function(){return this.setupComplete?(this.type==game.ENEMY_ENTITY_SUPER&&(this.update=function(){this.normalMovement()}),game.INITIATIVE_SHIP&&1==game.INITIATIVE_SHIP.numSteps&&!game.INITIATIVE_SHIP.moveRight&&(this.setupComplete=!0,this.numSteps=1,this.pos.x+=1,this.moveRight=game.INITIATIVE_SHIP.moveRight,this.update=function(){this.normalMovement()}),!0):(this.pos.y++,this.pos.y==this.goToY&&(this.setupComplete=!0),!0)},normalMovement:function(){0===this.numSteps%3&&(0===this.numSteps%(3*(game.WINDOW_WIDTH-game.farRight))&&(this.moveRight=!this.moveRight,this.numSteps=0),this.moveRight?this.pos.x-=1:this.pos.x+=1),this.numSteps++},setVulnerable:function(vulnerability){this.isVulnerable=vulnerability,me.game.world.moveToBottom(this),me.game.world.moveUp(this)},flashShields:function(){}});
                game.BulletEntity=me.ObjectEntity.extend({init:function(x,y,settings){this.parent(x,y,settings),this.gravity=0,this.setVelocity(0,6),this.type=game.BULLET,this.shootDown=settings.shootDown},update:function(){16>this.pos.y&&!this.shootDown?(game.canShoot=!0,me.game.world.removeChild(this)):this.pos.y>game.WINDOW_HEIGHT-16&&me.game.world.removeChild(this);var res=me.game.world.collide(this);if(res){var image=null;if(res.obj.type==game.ENEMY_ENTITY_SUPER?image=me.loader.getImage("explosionSuper"):res.obj.type==game.ENEMY_ENTITY_LARGE?image=me.loader.getImage("explosionLarge"):res.obj.type==game.ENEMY_ENTITY_MEDIUM?image=me.loader.getImage("explosionMedium"):res.obj.type==game.ENEMY_ENTITY_SMALL&&(image=me.loader.getImage("explosionSmall")),image&&!this.shootDown&&res.obj.isDestructable()){game.canShoot=!0,me.game.world.removeChild(this);var emitter=new me.ParticleEmitter(res.obj.pos.x+res.obj.width/2,res.obj.pos.y+res.obj.height/2,{image:image,width:4,totalParticles:12,angle:.0856797996433583,angleVariation:3.14159265358979,minLife:400,maxLife:1800,speed:.954545454545454,speedVariation:9.95454545454546,minRotation:1.34231686107927,minStartScale:1.43181818181818,maxParticles:17,frequency:19,duration:400,framesToSkip:1});return emitter.name="fire",game.OID_MAP[res.obj.objectID]&&delete game.OID_MAP[res.obj.objectID],emitter.z=res.obj.z+1,me.game.world.addChild(emitter),me.game.world.addChild(emitter.container),emitter.streamParticles(),game.PENDING_REMOVE.push(emitter),game.PENDING_REMOVE.push(emitter.container),game.addAvailablePosition(res.obj),game.scoreboard.addPoints(res.obj.record.get("Project"),res.obj.record.get("PlanEstimate")),game.log.addItem(res.obj.record.get("Name")+" completed",moment(res.obj.date).format("MM-DD HH:mm"),"completed"),game.PLAYER_SHIP.removeTarget(res.obj),me.game.world.removeChild(res.obj),!0}if(image&&!this.shootDown&&!res.obj.isDestructable(),res.obj.type==game.PLAYER&&this.shootDown){me.game.world.removeChild(this),image=me.loader.getImage("explosionSmall");var explosion=new me.ParticleEmitter(res.obj.pos.x+res.obj.width/2,res.obj.pos.y+res.obj.height/2,{image:image,width:4,totalParticles:12,angle:.0856797996433583,angleVariation:3.14159265358979,minLife:200,maxLife:400,speed:.5,speedVariation:4,minRotation:1.34231686107927,minStartScale:1.43181818181818,maxParticles:17,frequency:19,duration:200,framesToSkip:1});explosion.name="fire",explosion.z=res.obj.z+1,me.game.world.addChild(explosion),me.game.world.addChild(explosion.container),game.PENDING_REMOVE.push(explosion),game.PENDING_REMOVE.push(explosion.container),explosion.streamParticles()}}return this.shootDown?this.vel.y+=this.accel.y*me.timer.tick:this.vel.y-=this.accel.y*me.timer.tick,this.updateMovement(),!0}});
                game.VictoryScreen=me.ScreenObject.extend({onResetEvent:function(){me.game.world.addChild(new me.SpriteObject(0,0,me.loader.getImage("background")),1);var largeImg=me.loader.getImage("explosionSuper"),superEmitter=new me.ParticleEmitter(game.VICTORY_ANIMATIONS.SUPER.x,game.VICTORY_ANIMATIONS.SUPER.y,{image:largeImg,width:4,totalParticles:12,angle:.0856797996433583,angleVariation:3.14159265358979,minLife:400,maxLife:1800,speed:.954545454545454,speedVariation:9.95454545454546,minRotation:1.34231686107927,minStartScale:1.43181818181818,maxParticles:17,frequency:19,duration:400,framesToSkip:1});superEmitter.name="fire",superEmitter.z=Number.POSITIVE_INFINITY,me.game.world.addChild(superEmitter),me.game.world.addChild(superEmitter.container),superEmitter.streamParticles(),game.PENDING_REMOVE.push(superEmitter),game.PENDING_REMOVE.push(superEmitter.container),delete game.VICTORY_ANIMATIONS.SUPER;var time=-1;this.explosions(time);var victory=this;setInterval(function(){victory.explosions(time++)},1500),me.game.world.addChild(new(me.Renderable.extend({init:function(){this.parent(new me.Vector2d(0,0),me.game.viewport.width,me.game.viewport.height),this.font=new me.Font("pressStart",32,"white","center"),this.scrollertween=new me.Tween(this).to({scrollerpos:-600},3e3).onComplete(this.scrollover.bind(this)).start(),this.scroller=game.INITIATIVE_SHIP.record.get("Name")+" COMPLETED",this.scrollerpos=3e3},scrollover:function(){this.scrollerpos=1500,this.scrollertween.to({scrollerpos:-600},1e4).onComplete(this.scrollover.bind(this)).start()},update:function(dt){return!0},draw:function(context){this.font.draw(context,"VICTORY!",450,350),this.font.draw(context,this.scroller,this.scrollerpos,256)},onDestroyEvent:function(){this.scrollertween.stop()}})),2)},explosions:function(time){time++,time>0&&game.cleanup(),_.each(game.VICTORY_ANIMATIONS,function(el,index){var image;image="LARGE"==index?me.loader.getImage("explosionLarge"):"MEDIUM"==index?me.loader.getImage("explosionMedium"):"SMALL"==index?me.loader.getImage("explosionSmall"):me.loader.getImage("explosionSuper"),_.each(el,function(point){var emitter=new me.ParticleEmitter(point.x,point.y,{image:image,width:4,totalParticles:12,angle:.0856797996433583,angleVariation:3.14159265358979,minLife:400,maxLife:1800,speed:.954545454545454,speedVariation:9.95454545454546,minRotation:1.34231686107927,minStartScale:1.43181818181818,maxParticles:17,frequency:19,duration:400,framesToSkip:1});emitter.name="fire",emitter.z=Number.POSITIVE_INFINITY,me.game.world.addChild(emitter,emitter.z),me.game.world.addChild(emitter.container,emitter.z-1),emitter.streamParticles(),game.PENDING_REMOVE.push(emitter),game.PENDING_REMOVE.push(emitter.container)})}),game.VICTORY_ANIMATIONS={SUPER:[new Point(Math.random()*(game.WINDOW_WIDTH-50),Math.random()*(game.WINDOW_HEIGHT-50))],LARGE:[new Point(Math.random()*(game.WINDOW_WIDTH-50),Math.random()*(game.WINDOW_HEIGHT-50))],MEDIUM:[new Point(Math.random()*(game.WINDOW_WIDTH-50),Math.random()*(game.WINDOW_HEIGHT-50))],SMALL:[new Point(Math.random()*(game.WINDOW_WIDTH-50),Math.random()*(game.WINDOW_HEIGHT-50))]}},onDestroyEvent:function(){}});
                game.TitleScreen=me.ScreenObject.extend({onResetEvent:function(){me.game.world.addChild(new me.SpriteObject(0,0,me.loader.getImage("background")),1),me.game.world.addChild(new(me.Renderable.extend({init:function(){this.parent(new me.Vector2d(0,0),me.game.viewport.width,me.game.viewport.height),this.font=new me.Font("arcadeClassic",32,"white","center"),this.scrollertween=new me.Tween(this).to({scrollerpos:-600},3e3).onComplete(this.scrollover.bind(this)).start(),this.scroller="A PORTFOLIO ITEM VISUALIZATION USING SPACE INVADERS",this.scrollerpos=3e3},scrollover:function(){this.scrollerpos=1500,this.scrollertween.to({scrollerpos:-600},1e4).onComplete(this.scrollover.bind(this)).start()},update:function(dt){return!0},draw:function(context){this.font.draw(context,"PRESS ENTER TO PLAY",450,350),this.font.draw(context,this.scroller,this.scrollerpos,256)},onDestroyEvent:function(){this.scrollertween.stop()}})),2),me.input.bindKey(me.input.KEY.ENTER,"enter",!0),me.input.bindPointer(me.input.mouse.LEFT,me.input.KEY.ENTER),this.handler=me.event.subscribe(me.event.KEYDOWN,function(action,keyCode,edge){"enter"===action&&me.state.change(me.state.PLAY)})},onDestroyEvent:function(){me.input.unbindKey(me.input.KEY.ENTER),me.input.unbindPointer(me.input.mouse.LEFT),me.event.unsubscribe(this.handler)}});
                game.PlayScreen=me.ScreenObject.extend({zIndex:10,numInitiative:0,numFeatures:0,numStories:0,numTasks:0,MAX_FEATURE_ROWS:2,MAX_STORY_ROWS:3,MAX_TASK_ROWS:4,onResetEvent:function(){me.levelDirector.loadLevel("area51"),this.showLegend(),game.farRight=game.WIDTH,game.shipScreen=this,this.eventDrivenSetup()},eventDrivenSetup:function(){game.AVAILABLE_POSITIONS.features=[],game.AVAILABLE_POSITIONS.stories=[],game.AVAILABLE_POSITIONS.tasks=[],game.AVAILABLE_POSITIONS.pendingFeatures=[],game.AVAILABLE_POSITIONS.pendingStories=[],game.AVAILABLE_POSITIONS.pendingTasks=[];var numFeatures=Math.floor(game.WIDTH/game.FEATURE_SHIP.width),numStories=Math.floor(game.WIDTH/game.STORY_SHIP.width),numTasks=Math.floor(game.WIDTH/game.TASK_SHIP.width),i;for(i=0;numFeatures>i;i++)game.AVAILABLE_POSITIONS.features.push(new Point(i*game.FEATURE_SHIP.width,game.PADDING+game.MOTHERSHIP.height));for(i=0;2*numStories>i;i++)game.AVAILABLE_POSITIONS.stories.push(new Point(i%numStories*game.STORY_SHIP.width,game.PADDING+game.MOTHERSHIP.height+game.FEATURE_SHIP.height+game.STORY_SHIP.height*Math.floor(i/numStories)));for(i=0;2*numTasks>i;i++)game.AVAILABLE_POSITIONS.tasks.push(new Point(i%numTasks*game.STORY_SHIP.width,game.PADDING+game.MOTHERSHIP.height+game.FEATURE_SHIP.height+2*game.STORY_SHIP.height+game.TASK_SHIP.height*Math.floor(i/numTasks)));var scope=angular.element($("#root")).scope();scope.eventHandler.playThrough();var players=me.game.world.getChildByProp("type",game.PLAYER);1==players.length?game.PLAYER_SHIP=players[0]:console.error("no player")},addInitiative:function(record,oid,date){1>this.numInitiative&&(this.addEnemy(record,oid,date,"xlarge",game.ENEMY_ENTITY_SUPER,game.MOTHERSHIP.height,game.MOTHERSHIP.width,game.WIDTH/2-game.MOTHERSHIP.width/2,game.PADDING),this.numInitiative=1,game.initiative=record)},addFeature:function(record,oid,date){var index=Math.floor(Math.random()*game.AVAILABLE_POSITIONS.features.length),point=game.AVAILABLE_POSITIONS.features[index];point?(this.addEnemy(record,oid,date,"large",game.ENEMY_ENTITY_LARGE,game.FEATURE_SHIP.height,game.FEATURE_SHIP.width,point.x,point.y),game.AVAILABLE_POSITIONS.features.splice(index,1),this.numFeatures++,this.updateFeature(record,oid,date)):(game.OID_MAP[oid]={displayed:!1,formattedId:record.get("FormattedID"),record:record,date:date},game.AVAILABLE_POSITIONS.pendingFeatures.push(oid))},addStory:function(record,oid,date){var index=Math.floor(Math.random()*game.AVAILABLE_POSITIONS.stories.length),point=game.AVAILABLE_POSITIONS.stories[index];point?(this.addEnemy(record,oid,date,"medium",game.ENEMY_ENTITY_MEDIUM,game.STORY_SHIP.height,game.STORY_SHIP.width,point.x,point.y),game.AVAILABLE_POSITIONS.stories.splice(index,1),this.numStories++,this.updateStory(record,oid,date)):(game.OID_MAP[oid]={displayed:!1,formattedId:record.get("FormattedID"),record:record,date:date},game.AVAILABLE_POSITIONS.pendingStories.push(oid))},addTask:function(record,oid,date){var index=Math.floor(Math.random()*game.AVAILABLE_POSITIONS.tasks.length),point=game.AVAILABLE_POSITIONS.tasks[index],point=game.AVAILABLE_POSITIONS.stories[index];point?(this.addEnemy(record,oid,date,"small",game.ENEMY_ENTITY_SMALL,game.TASK_SHIP.height,game.TASK_SHIP.width,point.x,point.y),game.AVAILABLE_POSITIONS.tasks.splice(index,1),this.numTasks++,this.updateTask(record,oid,date)):(game.OID_MAP[oid]={displayed:!1,formattedId:record.get("FormattedID"),record:record,date:date},game.AVAILABLE_POSITIONS.pendingTasks.push(oid))},recycleShip:function(oid,date){var obj=game.OID_MAP[oid];if(obj&&obj.displayed&&obj.ship){var ship=obj.ship;game.log.addItem(ship.record.get("Name")+" recycled",date,"recycled"),ship.flyOff(),game.addAvailablePosition(ship),game.PLAYER_SHIP.removePotentialTarget(ship)}else obj&&!obj.displayed&&game.log.addItem(obj.record.get("Name")+" recycled",date,"recycled");delete game.OID_MAP[oid]},updateInitiative:function(record,oid,date){game.INITIATIVE_SHIP&&(game.INITIATIVE_SHIP.record=record),this.updateShip(record,oid,date,function(rec){var endDate=record.get("ActualEndDate");return endDate&&moment(endDate).isBefore(moment())})},updateFeature:function(record,oid,date){this.updateShip(record,oid,date,function(rec){var endDate=record.get("ActualEndDate");return endDate&&moment(endDate).isBefore(moment())})},updateStory:function(record,oid,date){this.updateShip(record,oid,date,function(rec){var state=rec.get("ScheduleState"),recycle=rec.get("Recycled");return recycle&&console.error(">>>story recycled"),"Completed"==state||"Accepted"==state||"Released"==state})},updateTask:function(record,oid,date){this.updateShip(record,oid,date,function(rec){return"Completed"==rec.get("State")})},updateShip:function(record,oid,date,addTarget){var obj=game.OID_MAP[oid];if(obj&&obj.displayed&&obj.ship){var ship=obj.ship;ship.record=record,!obj.targeted&&addTarget(record)&&(obj.targeted=!0,game.PLAYER_SHIP.addTarget(ship))}else obj&&!obj.displayed&&(addTarget(record)?(game.log.addItem(record.get("Name")+" completed",moment(date).format("MM-DD HH:mm"),"completed"),delete game.OID_MAP[oid]):game.OID_MAP[oid].record=record)},addEnemy:function(record,oid,date,image,type,height,width,x,y){var ship=me.pool.pull("enemyShip",x,y,{height:height,image:image,spriteheight:height,spritewidth:width,width:width,objectID:oid,z:this.zIndex,type:type,date:date,record:record});"xlarge"==image&&(game.INITIATIVE_SHIP=ship),game.log.addItem(record.get("Name")+" created",date,"created"),game.OID_MAP[oid]={displayed:!0,formattedId:record.get("FormattedID"),ship:ship},me.game.world.addChild(ship,this.zIndex++)},showLegend:function(){function changeShip(num){var ships=$(".shipContainer");num>=ships.length&&(num=0),$(ships[num]).fadeIn().delay(5e3).fadeOut(function(){changeShip(num+1)})}$(".shipContainer.logo").hide(),changeShip(1)},onDestroyEvent:function(){_.each(game.OID_MAP,function(element,index,list){if(element.displayed&&element.ship){destroy=element.ship;var offset;switch(destroy.type){case game.ENEMY_ENTITY_LARGE:offset="LARGE";break;case game.ENEMY_ENTITY_MEDIUM:offset="MEDIUM";break;default:offset="SMALL"}game.VICTORY_ANIMATIONS[offset].push(new Point(destroy.pos.x+destroy.width/2,destroy.pos.y+destroy.height/2)),me.game.world.removeChild(destroy)}})}});
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",items:[{xtype:"rallysolrartifactchooserdialog",id:"portfolioItemPicker",artifactTypes:["portfolioitem/initiative"],autoShow:!0,height:250,title:"Choose an Initiative",storeConfig:{context:{workspace:Rally.util.Ref.getRelativeUri(),project:null}},listeners:{scope:this,artifactchosen:function(picker,selectedRecord){Ext.getBody().mask("Loading");var injector=angular.bootstrap(document.body,["angularBlastdown"]);injector.get("LookbackService").connect(selectedRecord.get("ObjectID"));var scope=angular.element(document.body).scope();scope.app=Rally.getApp().getContext().map.map,scope.$digest()}}}]});
                module=angular.module("angularBlastdown",[]),module.controller("dataController",["$scope","RealtimeService","LookbackService",function($scope,RealtimeService,LookbackService){$scope.eventHandler=new GameEventHandler,$scope.selectedTypes=[],$scope.filters={},$scope.setSelectedOption=function(option){$scope.filters.class=option},$scope.logItems=[{date:Ext.Date.format(new Date,"m-d H:i"),note:"Space Invaders Blast Down Initialized","class":"init"}],$scope.realtimeStatus="Waiting",$scope.connectRealtime=function(uuids){$scope.realtimeStatus="Connecting",RealtimeService.connect(uuids)},$scope.updateStatus=function(status){$scope.realtimeStatus=status},game.onload(),$scope.addLogItem=function(logItem,date,className){var dateString;dateString=date?date instanceof Date?moment(date).format("MM-DD HH:mm"):date:moment().format("MM-DD HH:mm"),$scope.logItems.unshift({date:dateString,note:logItem,"class":className}),$scope.$apply()},$scope.scoreboard={},$scope.addPoints=function(team,points){if($scope.scoreboard[team])$scope.scoreboard[team].points+=points;else{var newPoints=points||0;$scope.scoreboard[team]={points:newPoints}}}}]);
                module.factory("LookbackService",function(){var eventTrigger=$("body"),PAGE_SIZE=50,projects=[],lookbackStore,oids={},initiative,triggerEvents=function(records,operation,success){_.each(records,function(record){var prev=oids[record.get("ObjectID")],currentOid=record.get("ObjectID");if(projects.push(record.get("Project")),prev){if("PortfolioItem/Feature"==prev.type){var previousStories=prev.record.get("UserStories"),currentStories=record.get("UserStories");if(previousStories&&currentStories&&previousStories.length>currentStories.length){var remove=_.find(previousStories,function(story){return!_.contains(currentStories,story)});remove&&oids[remove]&&(eventTrigger.trigger(oids[remove].type+"-Recycled",{record:null,oid:remove,date:new Date(record.get("_ValidFrom"))}),delete oids[remove])}}else if("UserStory"==prev.type){var previousTasks=prev.record.get("Tasks"),currentTasks=record.get("Tasks");if(previousTasks&&currentTasks&&previousTasks.length>currentTasks.length){var remove=_.find(previousTasks,function(task){return!_.contains(currentTasks,previousTasks[i])});remove&&oids[remove]&&eventTrigger.trigger(oids[remove].type+"-Recycled",{record:null,oid:remove,date:new Date(record.get("_ValidFrom"))})}}else if("PortfolioItem/Initiative"==prev.type){var previousFeatures=prev.record.get("Children"),currentFeatures=record.get("Children");if(previousFeatures&&currentFeatures&&previousFeatures.length>currentFeatures.length){var remove=_.find(previousFeatures,function(feature){return!_.contains(currentFeatures,feature)});-1!=remove&&oids[remove]&&(eventTrigger.trigger(oids[remove].type+"-Recycled",{record:null,oid:remove,date:new Date(record.get("_ValidFrom"))}),delete oids[remove])}}var changes=[];_.each(oids[currentOid].record.data,function(prevValue,prevIdx){prevValue!=record.get(prevIdx)&&changes.push(prevIdx)}),changes=_.without(changes,"_ValidFrom","_ValidTo","_TypeHierarchy"),changes.length>0&&(oids[currentOid]={type:oids[currentOid].type,record:record},eventTrigger.trigger(oids[currentOid].type+"-Updated",{record:record,oid:currentOid,changes:changes,date:new Date(record.get("_ValidFrom"))}))}else{var types=record.get("_TypeHierarchy");if(types&&types.length>0){var dataType=types[types.length-1];"HierarchicalRequirement"===dataType&&(dataType="UserStory"),oids[currentOid]={type:dataType,record:record},eventTrigger.trigger(dataType+"-Created",{record:record,oid:currentOid,changes:[],date:new Date(record.get("_ValidTo"))})}}}),projects=_.uniq(projects)},loadPage=function(page){lookbackStore.loadPage(page,{scope:this,callback:function(records,operation,success){page++,triggerEvents(records,operation,success),records.length==PAGE_SIZE?loadPage(page):setupRealtime()}})},setupRealtime=function(){Ext.create("Rally.data.WsapiDataStore",{model:"Project",fetch:["Name","ObjectID"],limit:1/0,context:{workspace:Rally.util.Ref.getRelativeUri(),project:null}}).load({scope:this,callback:function(records,operation,success){var projectUUIDs=[],allProjects=[];_.each(records,function(record){_.indexOf(projects,record.get("ObjectID"))>=0&&allProjects.push(record)}),_.each(allProjects,function(project){projectUUIDs.push(project.get("_refObjectUUID")),eventTrigger.trigger("Project",{record:project})});var scope=angular.element($("#root")).scope();scope.connectRealtime(projectUUIDs)}})};return{connect:function(itemHierarchy){lookbackStore=Ext.create("Rally.data.lookback.SnapshotStore",{fetch:["Recycled","ActualEndDate","ScheduleState","State","_TypeHierarchy","Project","FormattedID","Name","Parent","Feature","DirectChildrenCount","Children","UserStories","Tasks","PlanEstimate"],hydrate:["Recycled","ScheduleState","State","_TypeHierarchy","FormattedID","Children","UserStories","Project"],pageSize:PAGE_SIZE,findConfig:{_ItemHierarchy:itemHierarchy}}),loadPage(1),game.reveal()}}});
                function ReconnectingWebSocket(url,protocols){function connect(reconnectAttempt){ws=new WebSocket(url,protocols),self.onconnecting(),(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",url);var localWs=ws,timeout=setTimeout(function(){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",url),timedOut=!0,localWs.close(),timedOut=!1},self.timeoutInterval);ws.onopen=function(event){clearTimeout(timeout),(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onopen",url),self.readyState=WebSocket.OPEN,reconnectAttempt=!1,self.onopen(event)},ws.onclose=function(event){clearTimeout(timeout),ws=null,forcedClose?(self.readyState=WebSocket.CLOSED,self.onclose(event)):(self.readyState=WebSocket.CONNECTING,self.onconnecting(),reconnectAttempt||timedOut||((self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onclose",url),self.onclose(event)),setTimeout(function(){connect(!0)},self.reconnectInterval))},ws.onmessage=function(event){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",url,event.data),self.onmessage(event)},ws.onerror=function(event){(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onerror",url,event),self.onerror(event)}}protocols=protocols||[],this.debug=!1,this.reconnectInterval=1e3,this.timeoutInterval=2e3;var self=this,ws,forcedClose=!1,timedOut=!1;this.url=url,this.protocols=protocols,this.readyState=WebSocket.CONNECTING,this.URL=url,this.onopen=function(event){},this.onclose=function(event){},this.onconnecting=function(event){},this.onmessage=function(event){},this.onerror=function(event){},connect(url),this.send=function(data){if(ws)return(self.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","send",url,data),ws.send(data);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(){ws&&(forcedClose=!0,ws.close())},this.refresh=function(){ws&&ws.close()}}ReconnectingWebSocket.debugAll=!1;
                function Realtime(){this.ENDPOINT="wss://realtime.rally1.rallydev.com/_websocket",this.getSubscribeMessage=function(){var projectUuid=Rally.environment.getContext().getProject()._refObjectUUID;return console.log("project",Rally.environment.getContext().getProject()),console.log("ProjectUuid",projectUuid),JSON.stringify({uri:"/_subscribe","request-method":"post",body:{topic:projectUuid}})},this.getSubscribeMessageByUuid=function(projectUuid){return JSON.stringify({uri:"/_subscribe","request-method":"post",body:{topic:projectUuid}})},this.getStateFieldValue=function(data,name){var field=_.find(_.values(data.data.state),{name:name});return field&&field.value},this.getExtCompatibleRecordData=function(data,Model,useOldValue){var values=_.values(data.data.state).concat(_.values(data.data.changes)),recordData=_.reduce(values,function(rd,v){return rd[v.name]=useOldValue?v.old_value:v.value,rd},{});return recordData._type=Model.typePath,recordData},this.getTypeFromScope=function(data){if(data&&data.data&&data.data.scope){var match=data.data.scope.match(/([^\/]*)$/);if(match){var typeString=match.pop(),typeMap={"user-story":"UserStory"};return typeMap[typeString]||typeString}}},this.buildRecord=function(data,callback){var recordType=this.getStateFieldValue(data,"object_type")||this.getTypeFromScope(data);if(!recordType)return console.log("failed to get the type of artifact that changed",data),void 0;var me=this;Rally.data.WsapiModelFactory.getModel({type:recordType,success:function(Model){var record=new Model(me.getExtCompatibleRecordData(data,Model,"Recycled"===data.data.action));callback(record)}})},this.getChangedFields=function(data){return _.pluck(_.values(data.data.changes),"name")},this.getMessageToPublish=function(data){if(data&&data.data&&data.data.action){var action=data.data.action;console.log("action: ",action);var actionMap={Updated:Rally.Message.objectUpdate,Created:Rally.Message.objectCreate,Recycled:Rally.Message.objectDestroy};return actionMap[action]}},this.getArgsForMessage=function(message,record,changedFields,cmp){return message===Rally.Message.objectUpdate||message===Rally.Message.objectCreate?[message,record,changedFields,cmp]:[message,record,cmp,[]]},this.publishObjectChanged=function(data,cmp){var message=this.getMessageToPublish(data),me=this;message&&this.buildRecord(data,function(record){var changedFields=me.getChangedFields(data),args=me.getArgsForMessage(message,record,changedFields,cmp),mb=Rally.environment.getMessageBus();mb.publish.apply(mb,args)})},this.connectTo=function(uuids){console.log("realtime: connecting");var connection=new ReconnectingWebSocket(this.ENDPOINT),me=this;return connection.onopen=function(){console.log("realtime: connected"),_.each(uuids,function(uuid){connection.send(me.getSubscribeMessageByUuid(uuid))})},connection.onerror=function(e){console.log("realtime: error",arguments)},connection}}
                function RealtimeDataHandler(){var oidUUID="06841c63-ebce-4b6f-a2fc-8fd4ed0776ce",typeUUID="7d92c78a-8273-4784-99c5-c9187dc4fe8c",subscriptions={},eventTrigger=$("body"),wsapiAggregator=new WSAPIAggregator;this.handleRealtimeMessage=function(data){if(data&&"event"==data.type&&data.data&&data.data.action){var offset,valueOffset;data.data.state&&data.data.state[typeUUID]?(offset="state",valueOffset="value"):data.data.changes&&data.data.changes[typeUUID]&&(offset="changes",valueOffset="old_value");var changed=_.uniq(_.pluck(data.data.changes,"name"));"Recycled"==data.data.action?eventTrigger.trigger(data.data[offset][typeUUID][valueOffset]+"-"+data.data.action,{record:null,oid:data.data[offset][oidUUID][valueOffset],changes:null,date:new Date}):wsapiAggregator.getWorkItem(data.data[offset][oidUUID][valueOffset],data.data[offset][typeUUID][valueOffset],function(record){eventTrigger.trigger(data.data[offset][typeUUID][valueOffset]+"-"+data.data.action,{record:record,oid:data.data[offset][oidUUID][valueOffset],changes:changed,date:new Date})})}else data.status?eventTrigger.trigger("RealtimeConnection-Status",{status:data.status,date:new Date}):eventTrigger.trigger("RealtimeConnection-Other",{data:data,date:new Date})},this.setEventTrigger=function(el){el&&"string"==typeof el&&(eventTrigger=$(el))}}
                module.factory("RealtimeService",function(){var realtime=new Realtime,realtimeHandler=new RealtimeDataHandler;return{connect:function(uuids){var websocket=realtime.connectTo(uuids);console.log(realtime),websocket.onmessage=Ext.bind(function(e){var data=JSON.parse(e.data);realtime.publishObjectChanged(data,this),realtimeHandler.handleRealtimeMessage(data)},this)}}});
                var GameEventHandler=function(realtime){var listenTo="body",eventQueue=[],handler=this,timer=null,dequeue=function(){return eventQueue.length>0?eventQueue.shift():null};$(listenTo).on("Task-Updated Task-Recycled Task-Created UserStory-Updated UserStory-Recycled UserStory-Created PortfolioItem/Feature-Updated PortfolioItem/Feature-Recycled PortfolioItem/Feature-Created PortfolioItem/Initiative-Updated PortfolioItem/Initiative-Recycled PortfolioItem/Initiative-Created",null,null,function(event,data){eventQueue.push({event:event,data:data})}),$(listenTo).on("Project",null,null,function(event,data){game.PROJECT_MAPPING[data.record.get("ObjectID")]=data.record.get("Name"),game.scoreboard.checkPending()}),$(listenTo).on("RealtimeConnection-Status",null,null,function(event,data){var status=data&&data.status&&200==data.status?"Connected":"Disconnected";game.log.updateStatus(status)}),this.playThrough=function(){timer||(timer=setInterval(function(){var object=dequeue();if(object&&object.event&&object.event.type){var func=handler[object.event.type.replace("/","").replace("-","_")];func&&func(object.data)}},50))},this.PortfolioItemInitiative_Created=function(data){game.shipScreen.addInitiative(data.record,data.oid,data.date)},this.PortfolioItemFeature_Created=function(data){game.shipScreen.addFeature(data.record,data.oid,data.date)},this.UserStory_Created=function(data){game.shipScreen.addStory(data.record,data.oid,data.date)},this.Task_Created=function(data){game.shipScreen.addTask(data.record,data.oid,data.date)},this.PortfolioItemInitiative_Updated=function(data){game.shipScreen.updateInitiative(data.record,data.oid,data.date)},this.PortfolioItemFeature_Updated=function(data){game.shipScreen.updateFeature(data.record,data.oid,data.date)},this.UserStory_Updated=function(data){game.shipScreen.updateStory(data.record,data.oid,data.date)},this.Task_Updated=function(data){game.shipScreen.updateTask(data.record,data.oid,data.date)},this.PortfolioItemInitiative_Recycled=function(data){game.shipScreen.recycleShip(data.oid,data.date)},this.PortfolioItemFeature_Recycled=function(data){game.shipScreen.recycleShip(data.oid,data.date)},this.UserStory_Recycled=function(data){game.shipScreen.recycleShip(data.oid,data.date)},this.Task_Recycled=function(data){game.shipScreen.recycleShip(data.oid,data.date)}};
                module.service("RallyDataService",function(RealtimeService){var lookbackStore=Ext.create("Rally.data.lookback.SnapshotStore",{fetch:!0,hydrate:["ScheduleState","State","_TypeHierarchy","Project","FormattedID"],findConfig:{_ItemHierarchy:GLOBAL.ObjectID,__At:"current"}});return{getData:function(connect,callbackData){lookbackStore.load({scope:this,callback:function(records,operation,success){aggregateData={initiative:{},features:{},storiesAndDefects:{},parentless:[],teamsPoints:{}};var tasks=[];_.each(records,function(artifact){var types=artifact.raw._TypeHierarchy;switch(console.log(artifact),types[types.length-1]){case"Defect":aggregateData.storiesAndDefects[artifact.data.ObjectID]={artifact:artifact.raw,children:[]};break;case"HierarchicalRequirement":aggregateData.storiesAndDefects[artifact.data.ObjectID]={artifact:artifact.raw,children:[],completedTasks:[]};break;case"PortfolioItem/Feature":aggregateData.features[artifact.data.ObjectID]={feature:artifact.raw,children:[],completedTasks:[]};break;case"Task":Ext.Array.push(tasks,artifact.raw);break;default:}});var organizedData={initiative:{},features:[],closedStories:[],scoreboard:{}};console.log(angular.element(document.body).scope().initiative),Ext.create("Rally.data.WsapiDataStore",{model:"PortfolioItem/Initiative",fetch:!0,limit:1/0,context:{workspace:Rally.util.Ref.getRelativeUri(),project:null},filters:[{property:"ObjectID",value:GLOBAL.ObjectID}]}).load({scope:this,callback:function(records,operation,success){console.error("GOT INITIATIVE",records),organizedData.initiative=records&&records.length>0?records[0].data:GLOBAL;var projects=[];_.each(tasks,function(task){var parent=task.WorkProduct;aggregateData.storiesAndDefects[parent]&&("Completed"==task.State?Ext.Array.push(aggregateData.storiesAndDefects[parent].completedTasks,task):(console.log("task not complete",task),Ext.Array.push(aggregateData.storiesAndDefects[parent].children,task)))}),_.each(aggregateData.storiesAndDefects,function(object,oid){var parent,types=object.artifact._TypeHierarchy;Ext.Array.include(projects,object.artifact.Project),aggregateData.teamsPoints[object.artifact.Project]||(aggregateData.teamsPoints[object.artifact.Project]={score:0,lives:5});var state=object.artifact.ScheduleState;if(("Completed"==state||"Accepted"==state||"Released"==state)&&(Ext.Array.push(organizedData.closedStories,object),console.log(state,object.artifact)),"HierarchicalRequirement"===types[types.length-1])parent=object.artifact.PortfolioItem;else{var requirement=aggregateData.storiesAndDefects[object.artifact.Requirement];requirement&&(parent=requirement.artifact.PortfolioItem)}aggregateData.features[parent]&&Ext.Array.push(aggregateData.features[parent].children,object)}),Ext.create("Rally.data.WsapiDataStore",{model:"Project",fetch:["Name","ObjectID"],limit:1/0,context:{workspace:Rally.util.Ref.getRelativeUri(),project:null}}).load({scope:this,callback:function(records,operation,success){projectUUIDs=[];var allProjects=[];_.each(records,function(record){_.indexOf(projects,record.get("ObjectID"))>=0&&Ext.Array.push(allProjects,record)}),_.each(allProjects,function(project){console.log(project),Ext.Array.push(projectUUIDs,project.data._refObjectUUID),organizedData.scoreboard[project.data.Name]=aggregateData.teamsPoints[project.data.ObjectID]}),console.log(aggregateData.teamsPoints,organizedData.scoreboard),organizedData.features=_.toArray(aggregateData.features);var scope=angular.element($("#root")).scope();scope.realtimeConnection=function(){RealtimeService.connect(projectUUIDs)},scope.realtimeConnection()}})}})}})}}});

            Rally.launchApp('CustomApp', {
                name:"Space Invaders",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        body{background-color:#222;color:#fff;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;-webkit-user-select:none;user-select:none;-ms-touch-action:none;touch-action:none;padding:0;margin:0;font-family:pressStart}#screen canvas{width:1024px;height:512px;display:block;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:optimize-contrast;-ms-interpolation-mode:nearest-neighbor}@font-face{font-family:arcadeClassic;src:url(data/font/ARCADECLASSIC.ttf)}@font-face{font-family:pressStart;src:url(data/font/prstartk.ttf)}#scores{width:1024px;height:208px}#screen{width:1024px;height:512px}#log{height:512px;overflow:hidden}#log,#legend{margin-left:1024px;min-width:256px !important}#log>.content{height:100%;width:100%;border:none;overflow:auto}#log,#scores{font-family:"Helvetica Neue",Arial,Sans}#legend{height:208px}#scores>.content>table{margin-left:auto;margin-right:auto}#screen,#scores{float:left}.content{padding:10px}#root{display:table;position:absolute;height:100%;width:100%}.middle{display:table-cell;vertical-align:middle;width:100%}.shipContainer{text-align:center;display:none}.shipContainer>img{display:block;margin-left:auto;margin-right:auto;width:auto;height:64px}.logo{display:block}ul{list-style-type:none}li{margin:0 0 5px 0}.completed{color:#EE1C25}.recycled{color:#E6E6E6;font-style:italic}.created{font-weight:bold}.init{font-family:pressStart;font-size:10px}#realtimeStatus{text-align:center;-webkit-border-radius:20px;-moz-border-radius:20px;border-radius:20px}.waiting{background-color:#D6D6D6}.connected{background-color:#00A9E0}.connecting{background-color:#A9A9A9}.disconnected{background-color:#EE1C25}
    </style>
    <style type="text/css">
        .x-body{min-height:720px;min-width:1280px;background-image:url('game/data/img/background8bit.png');background-repeat:no-repeat;background-size:720px 720px;background-position:center;background-color:#eb2027}td.dataColumn{text-align:center}.x-mask{background:none !important}
    </style>
</head>
<body>
    <div style="display:none;" ng-controller="dataController" id="root">
    <div class="middle">
        <div id="spaceInvadersContainer">
            <div>
                <div id="scores">
                    <div class="content">
                        <table>
                            <tr>
                                <th>
                                    Team
                                </th>
                                <th ng-repeat="(teamName, teamInfo) in scoreboard">
                                    {{teamName}}
                                </th>
                            </tr>
                            <tr>
                                <td>
                                    Score
                                </td>
                                <td class="dataColumn" ng-repeat="(teamName, teamInfo) in scoreboard">
                                    {{teamInfo.points}}
                                </td>
                            </tr>
<!--                             <tr>
                                <td>
                                    Lives
                                </td>
                                <td class="dataColumn" ng-repeat="(teamName, teamInfo) in scoreboard">
                                    {{teamInfo.lives}}
                                </td>
                            </tr> -->
                        </table>
                    </div>
                </div>
                <div id="legend">
                    <div class="content">
                        <div class="shipContainer logo">
                            <img src="game/data/img/rally8bit.png">
                        </div>
                        <div class="shipContainer">
                            Initiative
                            <br />
                            <img src="game/data/img/shipSuper.png">
                        </div>
                        <div class="shipContainer">
                            Feature
                            <br />
                            <img src="game/data/img/shipLarge.png">
                        </div>
                        <div class="shipContainer">
                            User Story / Defect
                            <img src="game/data/img/shipMedium.png">
                        </div>
                        <div class="shipContainer">
                            Task
                            <br />
                            <img src="game/data/img/shipSmall.png">
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <div id="screen">
                </div>
                <div id="log">
                    <div class="content">
                        <div id="realtimeStatus" class="{{realtimeStatus.toLowerCase()}}">
                            Realtime Status: {{realtimeStatus}}
                        </div>
                        <select ng-model="selectedOption" ng-change="setSelectedOption(selectedOption)" id="filterEvents">
                          <option value="">All</option>
                          <option value="created">Created</option>
                          <option value="completed">Completed</option>
                          <option value="recycled">Recycled</option>
                        </select>
                        <ul id="historyLog">
                          <li ng-repeat="logItem in logItems | filter:filters" class="{{logItem.class}}">[{{logItem.date}}] - {{logItem.note}}</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
